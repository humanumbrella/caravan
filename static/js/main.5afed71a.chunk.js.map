{"version":3,"sources":["components/ScriptExplorer/styles.module.scss","../../unchained-wallets/lib/coldcard.js","../../unchained-wallets/lib/custom.js","../../unchained-wallets/lib/hermit.js","../../unchained-wallets/lib/ledger.js","../../unchained-wallets/lib/trezor.js","images/logo.png","utils/constants.js","utils/ExternalLink.jsx","utils/index.js","components/Disclaimer.jsx","components/Help.jsx","block_explorer.js","bitcoind.js","blockchain.js","utils/slices.js","selectors/wallet.js","actions/transactionActions.js","actions/errorNotificationActions.js","actions/walletActions.js","actions/braidActions.js","components/BitcoinIcon.jsx","components/EditableName.jsx","components/Wallet/WalletInfoCard.jsx","actions/settingsActions.js","components/NetworkPicker.jsx","components/QuorumPicker.jsx","components/AddressTypePicker.jsx","actions/utils.js","actions/clientActions.js","components/ClientPicker/PrivateClientSettings.jsx","components/ClientPicker/index.jsx","components/StartingAddressIndexPicker.jsx","components/Wallet/ConfirmWallet.jsx","proptypes/utils.js","proptypes/slice.js","proptypes/client.js","proptypes/settings.js","components/Copyable.jsx","components/ScriptExplorer/UTXOSet.jsx","components/MultisigDetails.jsx","components/ImportAddressesButton.jsx","actions/signatureImporterActions.js","components/ScriptExplorer/TextSignatureImporter.jsx","components/InteractionMessages.jsx","components/ScriptExplorer/DirectSignatureImporter.jsx","components/Hermit/HermitReader.jsx","components/Hermit/HermitDisplayer.jsx","components/Hermit/HermitSignatureImporter.jsx","components/ScriptExplorer/IndirectSignatureImporter.jsx","components/Coldcard/ColdcardSigningButtons.jsx","components/Coldcard/ColdcardSigner.jsx","components/Coldcard/ColdcardSignatureImporter.jsx","components/ScriptExplorer/SignatureImporter.jsx","components/Wallet/ExtendedPublicKeySelector.jsx","components/Slices/ConfirmAddress.jsx","components/Slices/SliceDetails.jsx","components/Slices/SlicesTable.jsx","components/Wallet/WalletDeposit.jsx","components/Wallet/AddressExpander.jsx","components/Wallet/Node.jsx","components/Wallet/NodeSet.jsx","components/ScriptExplorer/OutputEntry.jsx","components/ScriptExplorer/OutputsForm.jsx","components/Wallet/constants.js","components/ScriptExplorer/Transaction.jsx","components/UnsignedTransaction.jsx","components/Wallet/WalletSign.jsx","components/Wallet/TransactionPreview.jsx","components/Wallet/WalletSpend.jsx","components/Slices/SlicesTableContainer.jsx","components/Wallet/WalletControl.jsx","components/Wallet/WalletConfigInteractionButtons.jsx","actions/extendedPublicKeyImporterActions.js","components/Wallet/WalletGenerator.jsx","components/Wallet/DirectExtendedPublicKeyImporter.jsx","components/Wallet/TextExtendedPublicKeyImporter.jsx","components/CreateAddress/Conflict.jsx","components/Wallet/IndirectExtendedPublicKeyImporter.jsx","components/Coldcard/ColdcardExtendedPublicKeyImporter.jsx","components/Hermit/HermitExtendedPublicKeyImporter.jsx","components/Wallet/ExtendedPublicKeyImporter.jsx","components/Wallet/WalletActionsPanel.jsx","components/Wallet/index.jsx","actions/publicKeyImporterActions.js","components/CreateAddress/AddressGenerator.jsx","components/CreateAddress/TextPublicKeyImporter.jsx","components/CreateAddress/ExtendedPublicKeyPublicKeyImporter.jsx","components/CreateAddress/HermitPublicKeyImporter.jsx","components/CreateAddress/HardwareWalletPublicKeyImporter.jsx","components/CreateAddress/PublicKeyImporter.jsx","components/CreateAddress/index.jsx","actions/testSuiteRunActions.js","actions/keystoreActions.js","actions/testRunActions.js","components/TestSuiteRun/Note.jsx","components/TestSuiteRun/KeystorePicker.jsx","tests/Test.js","components/TestSuiteRun/TestSuiteRunSummary.jsx","components/TestSuiteRun/TestRun.jsx","components/TestSuiteRun/Seed.jsx","components/TestSuiteRun/index.jsx","components/ScriptExplorer/ScriptEntry.jsx","actions/ownershipActions.js","components/ScriptExplorer/ConfirmOwnership.jsx","components/ScriptExplorer/index.jsx","components/Navbar.jsx","components/Footer.jsx","components/ErrorBoundary.jsx","components/ErrorNotification.jsx","components/App.jsx","components/AppContainer.jsx","registerServiceWorker.js","reducers/utils.js","reducers/settingsReducer.js","reducers/clientReducer.js","reducers/braidReducer.js","reducers/quorumReducer.js","reducers/addressReducer.js","reducers/walletReducer.js","reducers/ownershipReducer.js","reducers/signatureImportersReducer.js","reducers/transactionReducer.js","reducers/keystoreReducer.js","tests/publicKeys.jsx","tests/extendedPublicKeys.jsx","tests/signing.jsx","tests/trezor.js","tests/ledger.js","tests/hermit.js","tests/coldcard.js","tests/index.js","reducers/testSuiteRunReducer.js","reducers/errorNotificationReducer.js","reducers/index.js","index.jsx","../../unchained-wallets/lib/interaction.js","components/Coldcard/ColdcardFileReader.jsx","components/Coldcard/ColdcardFileReader.module.scss","../../unchained-wallets/lib/index.js"],"names":["module","exports","Object","defineProperty","value","ColdcardMultisigWalletConfig","ColdcardSignMultisigTransaction","ColdcardExportExtendedPublicKey","ColdcardExportPublicKey","ColdcardInteraction","COLDCARD_WALLET_CONFIG_VERSION","COLDCARD_BASE_BIP32_PATHS","COLDCARD","require","_unchainedBitcoin","_interaction","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","Constructor","protoProps","staticProps","_get","property","receiver","Reflect","get","base","object","hasOwnProperty","call","_getPrototypeOf","_superPropBase","desc","getOwnPropertyDescriptor","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_assertThisInitialized","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","P2SH","P2SH_P2WSH","replace","P2WSH","COLDCARD_BASE_CHROOTS","keys","_IndirectKeystoreInte","this","apply","arguments","IndirectKeystoreInteraction","ColdcardMultisigSettingsFileParser","_ColdcardInteraction","_ref","_this","network","bip32Path","MAINNET","TESTNET","find","net","Error","bip32ValidationErrorMessage","bip32ValidationError","validateColdcardBip32Path","messages","entries","push","state","PENDING","level","ERROR","code","text","INFO","chroot","startsWith","bip32PathError","validateBIP32Path","coldcardChroot","chrootForBIP32Path","relativePath","getRelativeBIP32Path","relativePathError","mode","unknownColdcardParentBip32PathError","concat","file","data","JSON","parse","error","p2sh_deriv","p2sh","p2wsh_deriv","p2wsh","p2wsh_p2sh_deriv","p2wsh_p2sh","p2sh_p2wsh_deriv","p2sh_p2wsh","xpubClass","ExtendedPublicKey","fromBase58","xfp","depth","xfpFromWithinXpub","fingerprintToFixedLengthHex","parentFingerprint","toLowerCase","rootFingerprint","result","knownColdcardChroot","addressType","includes","prefix","baseXpub","convertExtendedPublicKey","deriveChildExtendedPublicKey","_ColdcardMultisigSett","_ref2","xpubJSONFile","xpub","deriveDeeperXpubIfNecessary","publicKey","pubkey","_ColdcardMultisigSett2","_ref3","_ColdcardInteraction2","_ref4","_this2","inputs","outputs","bip32Paths","psbt","unsignedMultisigPSBT","e","ACTIVE","psbtObject","signatures","parseSignaturesFromPSBT","_ref5","jsonConfig","uuid","name","quorum","requiredSigners","totalSigners","extendedPublicKeys","every","isNaN","Number","output","map","derivation","repeat","join","CustomSignMultisigTransaction","CustomExportExtendedPublicKey","CustomInteraction","CUSTOM","_CustomInteraction","validationErrorMessages","forEach","undefined","pkLen","substring","validateRootFingerprint","message","numSlashes","split","bipDepth","base58String","_CustomInteraction2","parseHermitQRCodeData","encodeHermitQRCodeData","HermitSignTransaction","HermitExportExtendedPublicKey","HermitExportPublicKey","HermitDisplayer","HermitReader","HermitInteraction","HERMIT","_hiBase","_interopRequireDefault","_pako","_bignumber","__esModule","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","_defineProperty","encodedString","errorPrefix","compressedBytes","decode","asBytes","json","inflate","to","jsonString","stringify","deflate","gzip","encode","commandMessage","source","getOwnPropertyDescriptors","defineProperties","_objectSpread","instructions","command","_HermitInteraction","reader","_HermitReader","displayer","_HermitReader2","_this3","bip32_path","deleteProperty","_HermitReader3","_this4","_HermitDisplayer","_this5","inputAddressType","inputsAreSupported","outputsAreSupported","address","match","input","multisigAddressType","multisig","MULTISIG_ADDRESS_TYPES","UNSUPPORTED","signatureRequestData","hermitInputsByRedeemScript","redeemScriptHex","scriptToHex","multisigRedeemScript","txid","index","amount","amountSats","toNumber","values","inputSignature","LedgerSignMultisigTransaction","LedgerExportExtendedPublicKey","LedgerExportPublicKey","LedgerGetMetadata","LedgerBitcoinInteraction","LedgerDashboardInteraction","LedgerInteraction","LEDGER_BOTH_BUTTONS","LEDGER_RIGHT_BUTTON","LEDGER_LEFT_BUTTON","LEDGER","_splitTransaction","_serializeTransaction","_bitcoinjsLib","_bufferutils","_slicedToArray","arr","Array","isArray","_arrayWithHoles","toString","_arr","_n","_d","_e","_s","_i","next","done","err","_iterableToArrayLimit","_nonIterableRest","_toConsumableArray","arr2","_arrayWithoutHoles","iter","from","_iterableToArray","_nonIterableSpread","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","Promise","then","_asyncToGenerator","fn","args","TransportU2F","TransportWebUSB","LedgerBtc","_DirectKeystoreIntera","_withTransport","mark","_callee","callback","transport","_transport","wrap","_context","prev","environment","satisfies","firefox","sent","abrupt","t0","t1","stop","_x","withTransport","_callee2","app","_context2","_x2","_callee3","_context3","close","_x3","DirectKeystoreInteraction","_LedgerInteraction","_LedgerInteraction2","_LedgerDashboardInter","_run","_callee5","_context5","_callee4","rawResult","_context4","setScrambleKey","send","parseMetadata","finish","_x4","response","byteArray","slice","targetId","Buffer","readUIntBE","seVersionLength","seVersion","flagsLength","flags","mcuVersionLength","mcuVersion","allocUnsafeSlow","version","flag","_split2","Boolean","majorVersion","minorVersion","patchVersion","_split4","mcuMajorVersion","mcuMinorVersion","MODEL_RANGES","minTargetId","model","range","spec","major","minor","patch","string","console","LedgerExportHDNode","_LedgerBitcoinInterac","_ref6","indices","bip32PathToSequence","hardened0","hardenedBIP32Index","hardened44","hardened100","_getFingerprint","_callee6","root","fp","_args6","_context6","getMultisigRootPublicKey","getParentPublicKey","getFingerprintFromPublicKey","withApp","_ref7","_callee7","parentPath","_context7","getParentBIP32Path","getWalletPublicKey","_x5","_ref8","_callee8","_context8","_x6","_ref9","_callee9","_context9","_x7","_LedgerExportHDNode","_ref10","_ref10$includeXFP","includeXFP","_run2","_callee10","_context10","parsePublicKey","getFingerprint","compressPublicKey","_LedgerExportHDNode2","_ref11","_this6","_run3","_callee11","walletPublicKey","fingerprint","_context11","deriveExtendedPublicKey","chainCode","_LedgerBitcoinInterac2","_ref12","_this7","Psbt","fromBase64","networkData","txInputs","dataInput","fundingTxHex","nonWitnessUtxo","fundingTx","Transaction","fromHex","generateMultisigFromHex","redeemScript","outs","transactionHex","reverseBuffer","hash","txOutputs","log","WARNING","preProcessingTime","postProcessingTime","anySegwitInputs","action","_this8","_ref13","_callee12","transactionSignature","_context12","setExchangeTimeout","signP2SHTransaction","ledgerInputs","associatedKeysets","ledgerKeysets","outputScriptHex","ledgerOutputScriptHex","lockTime","sigHashType","segwit","transactionVersion","_x8","_x9","signatureNoSighashType","inputTransaction","splitTransaction","scriptFn","multisigWitnessScript","scriptHex","_this9","ledgerBIP32Path","txHex","unsignedMultisigTransaction","toHex","splitTx","serializeTransactionOutputs","trezorCoin","TrezorConfirmMultisigAddress","TrezorSignMultisigTransaction","TrezorExportExtendedPublicKey","TrezorExportPublicKey","TrezorExportHDNode","TrezorGetMetadata","TrezorInteraction","TREZOR_PUSH_AND_HOLD_BUTTON","TREZOR_BOTH_BUTTONS","TREZOR_RIGHT_BUTTON","TREZOR_LEFT_BUTTON","TREZOR","_ADDRESS_SCRIPT_TYPES","_index","TrezorConnect","ADDRESS_SCRIPT_TYPES","manifest","email","appUrl","_this$connectParams","_this$connectParams2","method","params","connectParams","success","payload","_TrezorInteraction","getFeatures","major_version","minor_version","patch_version","label","pin_protection","passphrase_protection","pin","passphrase","_TrezorInteraction2","keyMaterial","serializedPath","MULTISIG_ROOT","getPublicKey","bundle","path","coin","crossChain","_TrezorExportHDNode","_this$extractDetailsF","extractDetailsFromPayload","_TrezorExportHDNode2","_this$extractDetailsF2","_TrezorInteraction3","signTransaction","inputIndex","multisigRequiredSigners","publicKeys","multisigPublicKeys","script_type","m","pubkeys","trezorPublicKey","fill","prev_hash","prev_index","address_n","trezorInput","toFixed","trezorOutput","_TrezorInteraction4","getAddress","showOnTrezor","multisigAddress","scriptType","keyPair","ECPair","fromPublicKey","payments","p2pkh","node","child_num","chain_code","public_key","DUST_IN_BTC","satoshisToBitcoins","BigNumber","url","href","rel","downloadFile","body","filename","blob","Blob","type","window","navigator","msSaveOrOpenBlob","msSaveBlob","elem","document","createElement","URL","createObjectURL","download","appendChild","click","removeChild","naiveCoinSelection","options","changeRequired","slices","reduce","count","balance","utxos","balanceSats","plus","numInputs","walletBalance","outputTotal","total","selectedUtxos","inputTotal","spendAll","config","numOutputs","estimatedFees","estimateMultisigTransactionFee","isGreaterThan","minus","isLessThanOrEqualTo","isSpendAll","j","change","feesWithoutChange","feesWithChange","inputOutputDiff","isGreaterThanOrEqualTo","Disclaimer","Card","CardHeader","title","CardContent","Help","Box","mt","mb","Typography","variant","Grid","container","spacing","item","md","direction","alignItems","justify","xs","Button","data-cy","size","color","startIcon","AccountBalanceWallet","SportsVolleyball","List","ListItem","ListItemIcon","Description","ListItemText","externalLink","YouTube","GitHub","CardActions","BugReport","Speed","a","axios","blockExplorerAPIURL","utxosResult","all","utxo","transactionResult","confirmed","status","vout","time","block_time","addressesult","addressData","used","chain_stats","funded_txo_count","mempool_stats","feeEstimatesResult","feeEstimates","Math","ceil","post","broadcastResult","callBitcoind","auth","headers","Accept","jsonrpc","id","resp","catch","isWalletAddressNotFoundError","bitcoindParams","client","username","password","addresses","addressParam","promises","previousTransactions","mapindex","confirmations","bitcoinsToSatoshis","hex","blocktime","bitcoindGetAddressStatus","warn","numBlocks","feeRate","feerate","bitcoindImportMulti","rescan","scriptPubKey","timestamp","fetchAddressUTXOsUnsorted","blockExplorerGetAddresesUTXOs","bitcoindListUnspent","fetchAddressUTXOs","updates","fetchedUTXOs","fetchUTXOsError","unsortedUTXOs","addressKnown","sortInputs","accumulator","currentValue","getAddressStatus","blockExplorerGetAddressStatus","fetchFeeEstimate","blockExplorerGetFeeEstimate","bitcoindEstimateSmartFee","broadcastTransaction","blockExplorerBroadcastTransaction","bitcoindSendRawTransaction","initSortDir","order","compareSlicesByPath","b","orderDir","aint","parseInt","reverse","bint","compareSlicesByBalance","isEqualTo","compareSlicesByUTXOCount","compareSlicesByTime","lastUsed","lastUsedTime","amax","max","bmax","isChange","prefixLength","DEFAULT_PREFIX","indexes","getDepositSlices","wallet","deposits","nodes","getWalletSlices","getTotalSigners","settings","extendedPublicKeyImporterBIP32Path","number","extendedPublicKeyImporter","extendedPublicKeyImporters","rootXfp","extendedPublicKey","getTotalBalance","createSelector","getPendingBalance","currentSlice","getConfirmedBalance","totalBalance","pendingBalance","getSlicesWithLastUsed","addressUsed","maxtime","Date","toLocaleDateString","getSpendableSlices","getSpentSlices","getSlicesWithBalance","getZeroBalanceSlices","getUnknownAddressSlices","getUnknownAddresses","getDepositableSlices","getWalletDetailsText","common","walletName","extendedPublicKeyImporterBIP32Paths","startingAddressIndex","clientDetails","setRequiredSigners","setInputs","addOutput","setChangeOutputIndex","setOutputAddress","setOutputAmount","amountString","setChangeAddressAction","deleteOutput","setFeeRate","valueString","setFee","finalizeOutputs","finalized","setBalanceError","updateAutoSpendAction","setSigningKey","extendedPublicKeyImporterIndex","setSpendStep","SET_ERROR_NOTIFICATION","CLEAR_ERROR_NOTIFICATION","setErrorNotification","clearErrorNotification","WALLET_MODES","updateDepositSliceAction","updateChangeSliceAction","updateWalletNameAction","resetWalletView","resetWallet","fetchSliceData","dispatch","getState","sliceDataPromises","addressStatus","updater","updatedSlice","BitcoinIcon","SvgIcon","htmlColor","xmlns","aria-hidden","focusable","data-prefix","data-icon","className","role","viewBox","d","defaultProps","EditableName","componentDidMount","setState","newName","render","editing","TextField","autoFocus","onChange","handleChange","onFocus","event","setTimeout","select","bind","onKeyDown","submit","hasError","helperText","IconButton","onClick","disabled","Check","cancel","Clear","startEditing","Edit","style","cursor","preventDefault","setName","React","Component","useStyles","makeStyles","theme","height","fontSize","gutter","paddingLeft","paddingRight","paddingTop","WalletInfoCard","editable","classes","fontWeight","NETWORKS","setNetwork","setTotalSigners","setAddressType","setFrozen","NetworkPicker","handleNetworkChange","frozen","FormControl","component","RadioGroup","FormControlLabel","control","Radio","checked","FormHelperText","mapDispatchToProps","setNetworkAction","connect","QuorumPicker","renderIncrementRequiredSigners","handleIncrementRequiredSigners","AddCircle","renderDecrementRequiredSigners","handleDecrementRequiredSigners","RemoveCircle","renderIncrementTotalSigners","handleIncrementTotalSigners","renderDecrementTotalSigners","handleDecrementTotalSigners","setTotalSignersAction","setRequiredSignersAction","AddressTypePicker","handleTypeChange","setType","actionWrapper","wrappedActions","mapping","actionIndex","wrappedMapping","actionFunctionNames","actionFunctionName","actionType","numberedActionWrapper","wrappedNumberedActions","PrivateClientSettings","handleUrlChange","handleUsernameChange","handlePasswordChange","urlError","usernameError","passwordError","privateNotes","connectSuccess","connectError","testConnection","fullWidth","ClientPicker","setUrl","urlEdited","setUrlError","validateUrl","setUsername","setUsernameError","validateUsername","setPassword","setPasswordError","validatePassword","onSuccess","host","exec","StartingAddressIndexPicker","handleIndexChange","setStartingAddressIndex","validateBIP32Index","startingAddressIndexField","startingAddressIndexError","handleCustomIndexChange","customIndex","Tooltip","WalletConfirmation","Alert","severity","Table","TableHead","TableRow","TableCell","TableBody","renderConfirmationInfo","importer","bigNumberPropTypes","c","PropTypes","arrayOf","isRequired","s","bool","array","shape","copyText","Copyable","newline","children","showIcon","showText","otherProps","useState","copied","setCopied","timer","setTimer","enqueueSnackbar","useSnackbar","useEffect","clearTimeout","TextComponent","stopPropagation","onCopy","timerTimeout","shortenedText","preventDuplicate","showSnackbarMessage","format","fontStyle","overflowWrap","FileCopy","UTXOSet","filterInputs","localInputs","transactionStoreInputs","filterToMyInputs","included","toggleInput","toggleAll","setInputsAndUpdateDisplay","setTo","toggled","incomingInputs","existingTransactionInputs","setSpendCheckbox","inputsToSpend","satsSelected","inputsSatsSelected","totalInputsToSpend","notMyInputs","numLocalInputsToSpend","renderInputs","showSelection","finalizedOutputs","confirmedStyle","styles","utxoTxid","unconfirmed","confirmedTitle","hover","Checkbox","data-testid","blockExplorerTransactionURL","OpenInNew","inputsTotalSats","selectAll","prevProps","prevMyInputsBeingSpent","myInputsBeingSpent","isFullSpend","spend","hideSelectAllInHeader","TableFooter","colSpan","setInputsAction","transaction","MultisigDetails","renderScript","script","ops","scriptToOps","sm","showAddress","witnessScript","maxWidth","align","blockExplorerAddressURL","Chip","networkLabel","multisigTotalSigners","tooltip","ImportAddressesButton","importCallback","imported","setImported","importError","setImportError","setRescanPreference","addressesError","setAddressesError","enableImport","setEnableImport","checkAddress","errorMessage","statusText","pluralOrSingularAddress","capitalize","responseError","successes","addr","rescanTooltip","ml","Switch","setSignatureImporterName","setSignatureImporterMethod","setSignatureImporterBIP32Path","setSignatureImporterPublicKeys","setSignatureImporterSignature","setSignatureImporterFinalized","setSignatureImporterComplete","TextSignatureImporter","signatureJSON","multiline","rows","finalize","setError","parseError","validateAndSetSignature","MessagesList","maxHeight","overflow","dense","renderMessage","messageIcon","renderMessageBodyAndSubmessages","renderMessageBody","image","src","mimeType","alt","Warning","VersionTabPanel","currentVersion","hidden","aria-labelledby","filteredMessages","InteractionMessages","versions","Paper","square","Tabs","aria-label","Tab","aria-controls","newValue","excludeCodes","excludeCode","DirectSignatureImporter","resetBIP32Path","interaction","signatureImporter","keystore","SignMultisigTransaction","isWallet","messageTextFor","handleBIP32PathChange","hasBIP32PathError","bip32PathIsDefault","renderAction","renderDeviceConfirmInfo","messagesFor","fee","renderTargets","signatureError","sign","hasMessagesFor","setBIP32PathError","validateAndSetBIP32Path","defaultBIP32Path","disableChangeMethod","enableChangeMethod","run","signature","stateUpdate","isSupported","width","startText","messageFor","handleStart","delay","onError","handleError","onScan","handleScan","facingMode","handleStop","onStart","onClear","HermitSignatureImporter","request","import","clear","IndirectSignatureImporter","Signer","FormGroup","onReceive","onReceivePSBT","setActive","signatureData","signatureSetsKeys","errorType","ColdcardSigningButtons","handlePSBTDownloadClick","handleWalletConfigDownloadClick","ColdcardSigner","toBase64","moment","walletDetailsText","reshapeConfig","walletDetails","walletConfig","ConfigAdapter","KEYSTORE","adapt","ColdcardSignatureImporter","SignatureImporter","titleRef","createRef","scrollToTitle","componentDidUpdate","getCurrent","current","scrollIntoView","behavior","renderImport","notMyTurn","labelId","InputLabel","Select","handleMethodChange","MenuItem","renderImportByMethod","signatureImporters","setMethod","reset","setSignature","setPublicKeys","setFinalized","multisigBIP32Root","multisigBIP32Path","setBIP32Path","errback","renderSignature","inputsSignatures","setComplete","numSignatureSets","finalizedSignatureImporters","inputNumber","validateHex","validateMultisigSignature","finalizedSignatureImporterNum","finalizedSignatureImporter","signaturesToCheck","filterKnownSignatures","signatureSetNumber","signatureSet","publicKeySet","knownSignatures","x","k","ref","setSigningKeyAction","ownProps","ExtendedPublicKeySelector","signingKeys","updateKeySelection","selection","renderKeySelectorMenu","renderSignatureImporter","getAssociatedExtendedPublicKeyImporter","associatedExtendedPublicKeyImporter","handleKeyChange","renderKeySelectorMenuItems","extendedPublicKeyImporterNotUsed","derivedKey","deriveChildPublicKey","importerIndex","publicKeyIndex","extendedPublicKeyImporterNum","importMethod","initialInteractionState","keySelected","deviceType","hasInteraction","interactionState","interactionError","interactionMessage","interactionReducer","ConfirmAddress","useReducer","setInteraction","_event","fullBip32Path","ConfirmMultisigAddress","flexGrow","backgroundColor","palette","background","paper","createTab","tab","tooltipTab","a11yProps","arrow","TabPanel","other","display","SliceDetails","tabIndex","setTabIndex","tabs","panel","my","AppBar","position","newIndex","centered","boxShadow","grey","spent","textDecoration","SlicesTable","search","paging","detailPanelType","showTitle","emptyRowsWhenPaging","pageSize","pageSizeOptions","toolbar","columns","field","rowData","defaultSort","customSort","sorting","column","detailPanel","depositTimer","WalletDeposit","getNextDepositAddress","depositIndex","getDepositAddress","updateDepositSlice","depositableSlices","clearInterval","setInterval","resetDepositAddressIndex","handleAmountChange","decimal","amountError","qrString","InputProps","endAdornment","InputAdornment","anchor","resetWalletViewAction","withSnackbar","AddressExpander","defaultMode","addressContent","expandMode","showMenu","showMenuIcon","handleMenu","float","hasAdditionalOptions","aria-haspopup","Menu","anchorEl","keepMounted","open","onClose","handleClose","selected","canConfirm","panelExpand","expanded","ExpansionPanel","ExpansionPanelSummary","expandIcon","ExpansionPanelDetails","expandContent","renderAddressConfirmation","confirmAddressDescription","confirmOnDevice","resetInteractionState","Node","generate","indeterminate","markSpending","updateNode","walletMode","spending","handleSpend","maxUtxoDate","renderAddress","braidNode","present","addNode","newInputs","updateAutoSpend","getAttribute","setFeeRateAction","updateAutoSpendActionImport","braid","NodeSet","sortAddresses","orderBy","page","renderFilters","filterIncludeSpent","filterIncludeZeroBalance","row","FormLabel","mr","filterAddresses","getNodeSet","changeNodes","depositNodes","returnValue","nodeSet","sort","amin","min","bmin","nodesObject","currentNode","renderNodes","nodesPerPage","startingIndex","nodesRows","whichOne","nodeRow","handlePageChange","handleChangeRowsPerPage","pageCount","rowCount","tableLayout","TableSortLabel","active","TablePagination","rowsPerPage","backIconButtonProps","nextIconButtonProps","onChangePage","onChangeRowsPerPage","OutputEntry","displayBalanceAction","autoSpend","hasBalanceError","isBalanceable","addChangeAddress","changeNode","setAddress","setChangeOutput","renderChangeAdornment","changeOutputIndex","disable","placement","handleAddressChange","hasAddressError","addressError","setAmount","hasAmountError","isNotBalanceable","feeError","newAmount","autoBalancedAmount","validateOutputAmount","balanceError","outputTotalSats","feeSats","balanceAction","handleBalance","handleDelete","remove","handleMaxSpend","setMaxSpend","gridSpacing","placeholder","outputsFormInput","startAdornment","maxSpend","Delete","outputIndex","spendableSlices","confirmedBalance","estimatedFee","n","feesPerByteInSatoshis","totalOutputValue","spendAllAmount","isLessThan","nextNode","OutputsForm","outputsTotal","initialOutputState","renderOutputs","inputsTotal","outputsAndFeeTotal","updatesComplete","hasFeeRateFetchError","feeRateFetchError","hasFeeRateError","feeRateError","hasFeeError","handleAddOutput","handleFeeRateChange","rate","parseFloat","handleFeeChange","handleFinalize","handleReset","resetOutputs","getFeeEstimate","feeEstimate","gatherSignaturesDisabled","inputProps","outputAmount","feeDisplay","outputsFormLabel","minimum","step","unitLabel","readOnly","disableUnderline","addOutputAction","setOutputAmountAction","setFeeAction","finalizeOutputsAction","buildSignedTransaction","signedMultisigTransaction","handleBroadcast","setTxid","signedTransaction","broadcasting","transactionURL","signedTransactionHex","UnsignedTransaction","showUnsignedTransaction","unsignedTransaction","handleHideUnsignedTransaction","handleShowUnsignedTransaction","WalletSign","renderKeySelectors","keySelectors","keySelectorNum","signaturesFinalized","handleReturn","resetTransaction","handleCancel","changeSlice","updateTxSlices","retries","skipAddresses","Set","changeAddress","nextDepositSlice","depositSlices","changeSlices","fetchSliceStatus","sliceUpdates","addressSet","has","add","queriedSlices","utxoCount","setSpendStepAction","TransactionPreview","renderAddresses","addressWithUtxos","mapAddresses","renderOutputAddresses","mapped","mappedAddresses","editTransaction","handleSignTransaction","setChangeOutputMultisig","WalletSpend","outputsAmount","coinSelection","feeAmount","showPreview","previewDisabled","showSignTransaction","handleShowPreview","autoSelectCoins","showCreate","resetNodesSpend","deleteChangeOutput","handleSpendMode","spendingStep","changeAmount","updateChangeSlice","setChangeAddress","SlicesTableContainer","setDisplaySlices","displaySlices","slicesWithBalance","newProps","zeroBalanceSlices","spentSlices","newDisplaySlices","PureComponent","WalletControl","scrollRef","handleModeChange","indicatorColor","textColor","addressesAreLoaded","renderModeComponent","progress","textAlign","marginBottom","CircularProgress","LinearProgress","trailingEmptyNodes","nodesLoaded","fetchUTXOsErrors","setMode","WalletConfigInteractionButtons","onClearFn","onDownloadFn","sessionStorage","removeItem","handleClearClick","setExtendedPublicKeyImporterName","resetExtendedPublicKeyImporterBIP32Path","setExtendedPublicKeyImporterBIP32Path","setExtendedPublicKeyImporterMethod","setExtendedPublicKeyImporterExtendedPublicKey","setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint","setExtendedPublicKeyImporterFinalized","setExtendedPublicKeyImporterVisible","WalletGenerator","extendedPublicKeyCount","cb","toggleImporters","setImportersVisible","configuring","initialLoadComplete","setGenerating","freeze","startingDepositBIP32Suffix","startingChangeBIP32Suffix","update","attemptToKeepGenerating","generateMultisig","multisigUpdates","generateRichExtendedPublicKeys","generateBraid","deriveMultisigByPath","fetchUTXOs","utxoUpdates","generateNextNodeIfNecessary","allBIP32Paths","p1","p2","p1Segments","p2Segments","pathSegments","maxIndex","nextBIP32Path","refreshNodes","resetNodesFetchErrors","allNodes","previousFetchErrors","unknownClient","debouncedTestConnection","debounce","trailing","leading","prevPassword","setIsWallet","setRootFingerprint","setBip32Path","addBase58String","downloadWalletDetails","generating","hasConflict","some","conflict","ConfirmWallet","defaultValue","onSubmit","handlePasswordEnter","fetchSliceDataAction","resetWalletAction","DirectExtendedPublicKeyImporter","ExportExtendedPublicKey","extendedPublicKeyError","validateAndSetExtendedPublicKey","validateAndSetRootFingerprint","TextExtendedPublicKeyImporter","Conflict","IndirectExtendedPublicKeyImporter","Reader","ColdcardExtendedPublicKeyImporter","COLDCARD_MULTISIG_BIP32_PATH","getColdcardBip32Path","coinPath","coldcardP2SHPath","resetColdcardBIP32Path","ColdcardJSONReader","coldcardBIP32Path","HermitExtendedPublicKeyImporter","ExtendedPublicKeyImporter","setExtendedPublicKey","renderBIP32Path","renderExtendedPublicKey","conversionMessage","conversionAppend","networkError","validateExtendedPublicKey","actualExtendedPublicKey","validationError","setExtendedPublicKeyRootXfp","finalizedNetwork","conflictMessage","ExtendedPublicKeyImporterWithStyles","withStyles","lineHeight","card","flexDirection","cardContent","flex","pointerEvents","MuiButton","ButtonWithTooltip","tooltipText","adjustedButtonProps","WalletActionsPanel","handleRefresh","onClearConfig","onDownloadConfig","onImportAddresses","refreshing","walletActivated","ButtonGroup","RefreshOutlined","GetAppOutlined","ExitToAppOutlined","CreateWallet","handleImport","fileReader","FileReader","files","onload","configJson","setConfigJson","readAsText","configError","refresh","generatorRefresh","resetErrorAndClearTargetValue","importDetails","setClientType","setClientUrl","setClientUsername","walletConfiguration","renderWalletImporter","htmlFor","accept","marginTop","renderSettings","renderExtendedPublicKeyImporters","walletDetailsFilename","clearConfig","unknownAddresses","walletLoadError","afterImportAddresses","padding","properties","configObj","validProperties","validateProperties","String","clientProperties","validClient","validQuorum","validateExtendedPublicKeys","xpubs","tmpNetwork","xpubFields","pathError","seen","xpubIndex","keyIndex","valueError","getItem","validateConfig","setItem","_val","val","importedAddresses","unknownSlices","importedSlices","indexOf","updateWalletNameActionImport","setAddressTypeAction","setExtendedPublicKeyImporterMethodAction","setExtendedPublicKeyImporterExtendedPublicKeyAction","setExtendedPublicKeyImporterBIP32PathAction","setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprintAction","setExtendedPublicKeyImporterNameAction","setExtendedPublicKeyImporterFinalizedAction","setExtendedPublicKeyImporterVisibleAction","setClientPassword","updateDepositNode","updateChangeNode","walletSelectors","setPublicKeyImporterName","resetPublicKeyImporterBIP32Path","setPublicKeyImporterBIP32Path","setPublicKeyImporterMethod","setPublicKeyImporterPublicKey","setPublicKeyImporterFinalized","movePublicKeyImporterUp","movePublicKeyImporterDown","AddressGenerator","isInConflict","publicKeyImporters","publicKeyCount","validatePublicKey","publicKeysAreCanonicallySorted","publicKeyImporter","sortedPublicKeys","canonicallySortPublicKeys","sortPublicKeyImporters","setMultisigAddress","publicKeyImporterNum","generateMultisigFromPublicKeys","downloadAddressDetails","addressDetailsText","addressDetailsFilename","redeemScriptLine","witnessScriptLine","scriptsSpacer","publicKeyImporterBIP32Paths","publicKeyImporterBIP32Path","canonicallySorted","TextPublicKeyImporter","validateAndSetPublicKey","ExtendedPublicKeyPublicKeyImporter","setBIP32PathToDefault","handleExtendedPublicKeyChange","hasExtendedPublicKeyError","validateExtendedPublicKeyForNetwork","HermitPublicKeyImporter","ExportPublicKey","publicKeyError","HardwareWalletPublicKeyImporter","PublicKeyImporter","moveUp","ArrowUpward","moveDown","ArrowDownward","setPublicKey","renderPublicKey","publicKeyImporterIndex","CreateAddress","renderPublicKeyImporters","publicNotes","START_TEST_SUITE_RUN","SET_CURRENT_TEST_RUN","startTestSuiteRun","setCurrentTestRun","runIndex","SET_KEYSTORE","SET_KEYSTORE_NOTE","SET_KEYSTORE_STATUS","setKeystore","keystoreType","setKeystoreNote","setKeystoreStatus","START_TEST_RUN","END_TEST_RUN","RESET_TEST_RUN","SET_TEST_RUN_NOTE","startTestRun","testRunIndex","endTestRun","resetTestRun","setTestRunNote","note","NoteBase","setNote","newNote","mapDispatchToKeystoreNoteProps","mapDispatchToTestRunNoteProps","KeystoreNote","TestRunNote","testSuiteRun","currentTestRunIndex","testRuns","NO_VERSION_DETECTION","INDIRECT_KEYSTORES","KeystorePickerBase","detectVersion","GetMetadata","handleVersionChange","keystoreActions","setErrorNotificationAction","KeystorePicker","Test","thing","expected","actual","diffChars","diffArrays","diffJson","description","postprocess","sendToResolver","tpub","matches","diff","SUCCESS","FAILURE","TestSuiteRunSummaryBase","Bowser","getParser","userAgent","getOSName","getOSVersion","getBrowserName","getBrowserVersion","UNCHAINED_WALLETS_VERSION","keystoreName","subheader","renderTests","testRun","Divider","renderTestRun","button","testRunChooser","started","renderTestRunResult","test","duration","endedAt","startedAt","asSeconds","setCurrentTestRunAction","TestSuiteRunSummary","TestRunBase","addEventListener","handleKeyDown","componentWillUnmount","removeEventListener","isLastTest","nextTest","keyCode","tagName","start","handleDownloadPSBTClick","nameBits","handledDownloadWalletConfigClick","startParse","isTest","fileType","validFileFormats","renderInteractionMessages","testComplete","renderResult","handleResult","runParse","formatMessage","formatOutput","formatDiffSegment","segment","diffSegmentClass","added","removed","testRunActions","errorNotificationActions","TestRun","bip39Phrase","TEST_FIXTURES","open_source","SeedBase","renderSeedWord","word","Seed","TestSuiteRunBase","currentTestIsActive","isFirstTest","previousTest","tag","startDisabled","renderBody","renderSetup","ArrowBack","ArrowForward","testSuiteRunActions","TestSuiteRun","ScriptEntry","hasScriptError","scriptError","hasFetchUTXOsError","scriptName","scriptTitle","charAt","toUpperCase","handleScriptChange","newScriptHex","multisigScriptHex","renderDetails","chosePerformSpend","choseConfirmOwnership","buttonsDisabled","performSpend","confirmOwnership","choosePerformSpend","fetchUTXOsResult","chooseConfirmOwnership","setOwnershipMultisig","setFrozenAction","ownership","chosen","ConfirmOwnership","renderConfirmation","GreenListItemIcon","styled","selectLabelId","Spend","spendable","renderSignatureImporters","signatureImporterNum","addressFinalized","menuButton","marginRight","menuItem","paddingBottom","paddingX","menuLink","NavItem","Navbar","setAnchorEl","Toolbar","currentTarget","logo","Footer","now","getFullYear","ErrorBoundary","errorInfo","mx","whiteSpace","componentStack","clearErrorNotificationAction","ErrorNotification","errorNotification","Snackbar","anchorOrigin","vertical","horizontal","ContentProps","Close","App","CssBaseline","maxSnack","Container","ScriptExplorer","Wallet","AppContainer","history","createBrowserHistory","resetApp","unlisten","listen","isLocalhost","location","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","updateState","initialState","intialSliceState","spendingSats","updateSlice","newSlices","updatedState","currentNodeBalance","nodeFoundWithValue","otherNode","getNextNode","resetSpend","thisNode","updatedNodes","getTime","initialExtendedPublicKeyImporterState","bip32PathModified","createInitialState","importers","finalizedAddressType","setConflict","updateExtendedPublicKeyImporterState","extendedPublicKeyImporterChange","newState","sum","updateTotalSigners","finalizedCount","updateImporterPaths","updateNetwork","updateAddressType","updateFinalizedSettings","initialPublicKeyImporterState","abovePublicKeyImporter","belowPublicKeyImporter","sortedPublicKeyImporters","publicKeyImportersChange","updatePublicKeyImporterState","publicKeyImporterChange","stub","resetWalletViews","updateMultisig","initialSignatureImporterState","updateSignatureImporterState","signatureImporterChange","finalizeSignatureImporterState","y","updateInputs","setFeeForRate","feeRateString","nout","newOutputs","updateFeeRate","validateFeeRate","updateFee","feeString","validateFee","updateOutputAddress","validateAddress","updateOutputMultisig","updateOutputAmount","dp","unsignedTransactionPSBT","unsignedTransactionObjectFromPSBT","updateRequiredSigners","updateSigningKey","outputInitialStateForMode","resetTransactionState","validateTransaction","calcOutputTotalSats","absoluteValue","minFee","ExportPublicKeyTest","pub","publicKeyTests","ExportExtendedPublicKeyTest","extendedPublicKeyTests","SignMultisigTransactionTest","outputAddress","outputAmountSats","changeOutputAddress","changeOutputAmountSats","unsignedTx","signingTests","transactions","fixture","SUITE","trezorTests","ledgerTests","hermitTests","coldcardTests","initialTestRunState","testRunsForKeystore","updatedTestRun","spendReducers","combineReducers","keyResetState","walletReducers","braidReducer","appReducer","rootReducer","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","reducers","applyMiddleware","ReduxPromise","thunk","ReactDOM","getElementById","process","origin","fetch","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","UnsupportedInteraction","KeystoreInteraction","LEVELS","STATES","_bowser","_KeystoreInteraction","_KeystoreInteraction2","direct","_KeystoreInteraction3","indirect","ColdcardFileReaderBase","maxFileSize","dropzoneDull","dropzone","onDrop","multiple","minSize","maxSize","disableClick","uploadIcon","instruction","singleAcceptedFile","acceptedFiles","rejectedFiles","arrayBuffer","psbtData","psbtHex","PSBT_MAGIC_HEX","ColdcardPSBTReader","_exportNames","VERSION","DIRECT_KEYSTORES","KEYSTORES","_ledger","_trezor","_coldcard","_hermit","_custom","_package"],"mappings":"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","file":"static/js/main.5afed71a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"feeMagicBtn\":\"styles_feeMagicBtn__QX0iX\",\"utxoTxid\":\"styles_utxoTxid__1p6kt\",\"outputsFormInput\":\"styles_outputsFormInput__3Osdm\",\"unconfirmed\":\"styles_unconfirmed__3KzJ4\",\"spent\":\"styles_spent__10i2F\",\"outputsFormLabel\":\"styles_outputsFormLabel__NZOnp\",\"maxSpend\":\"styles_maxSpend__32e8a\"};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ColdcardMultisigWalletConfig = exports.ColdcardSignMultisigTransaction = exports.ColdcardExportExtendedPublicKey = exports.ColdcardExportPublicKey = exports.ColdcardInteraction = exports.COLDCARD_WALLET_CONFIG_VERSION = exports.COLDCARD_BASE_BIP32_PATHS = exports.COLDCARD = void 0;\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.string.repeat\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.number.constructor\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.reflect.get\");\n\nrequire(\"core-js/modules/es7.array.includes\");\n\nrequire(\"core-js/modules/es6.string.includes\");\n\nrequire(\"core-js/modules/es6.string.starts-with\");\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/es6.array.find\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nvar _unchainedBitcoin = require(\"unchained-bitcoin\");\n\nvar _interaction = require(\"./interaction\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar COLDCARD = \"coldcard\"; // Our constants use 'P2SH-P2WSH', their file uses 'P2SH_P2WSH' :\\\n\nexports.COLDCARD = COLDCARD;\nvar COLDCARD_BASE_BIP32_PATHS = {\n  \"m/45'\": _unchainedBitcoin.P2SH,\n  \"m/48'/0'/0'/1'\": _unchainedBitcoin.P2SH_P2WSH.replace(\"-\", \"_\"),\n  \"m/48'/0'/0'/2'\": _unchainedBitcoin.P2WSH,\n  \"m/48'/1'/0'/1'\": _unchainedBitcoin.P2SH_P2WSH.replace(\"-\", \"_\"),\n  \"m/48'/1'/0'/2'\": _unchainedBitcoin.P2WSH\n};\nexports.COLDCARD_BASE_BIP32_PATHS = COLDCARD_BASE_BIP32_PATHS;\nvar COLDCARD_BASE_CHROOTS = Object.keys(COLDCARD_BASE_BIP32_PATHS);\nvar COLDCARD_WALLET_CONFIG_VERSION = \"1.0.0\";\n/**\n * Base class for interactions with Coldcard\n *\n * @extends {module:interaction.IndirectKeystoreInteraction}\n */\n\nexports.COLDCARD_WALLET_CONFIG_VERSION = COLDCARD_WALLET_CONFIG_VERSION;\n\nvar ColdcardInteraction =\n/*#__PURE__*/\nfunction (_IndirectKeystoreInte) {\n  _inherits(ColdcardInteraction, _IndirectKeystoreInte);\n\n  function ColdcardInteraction() {\n    _classCallCheck(this, ColdcardInteraction);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ColdcardInteraction).apply(this, arguments));\n  }\n\n  return ColdcardInteraction;\n}(_interaction.IndirectKeystoreInteraction);\n/**\n * Base class for JSON Multisig file-based interactions with Coldcard\n * This class handles the file that comes from the `Export XPUB` menu item.\n *\n * @extends {module:coldcard.ColdcardInteraction}\n */\n\n\nexports.ColdcardInteraction = ColdcardInteraction;\n\nvar ColdcardMultisigSettingsFileParser =\n/*#__PURE__*/\nfunction (_ColdcardInteraction) {\n  _inherits(ColdcardMultisigSettingsFileParser, _ColdcardInteraction);\n\n  /**\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network (needed for derivations)\n   * @param {string} options.bip32Path - bip32Path to interrogate\n   */\n  function ColdcardMultisigSettingsFileParser(_ref) {\n    var _this;\n\n    var network = _ref.network,\n        bip32Path = _ref.bip32Path;\n\n    _classCallCheck(this, ColdcardMultisigSettingsFileParser);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ColdcardMultisigSettingsFileParser).call(this));\n\n    if ([_unchainedBitcoin.MAINNET, _unchainedBitcoin.TESTNET].find(function (net) {\n      return net === network;\n    })) {\n      _this.network = network;\n    } else {\n      throw new Error(\"Unknown network.\");\n    }\n\n    _this.bip32Path = bip32Path;\n    _this.bip32ValidationErrorMessage = {};\n    _this.bip32ValidationError = _this.validateColdcardBip32Path(bip32Path);\n    return _this;\n  }\n\n  _createClass(ColdcardMultisigSettingsFileParser, [{\n    key: \"isSupported\",\n    value: function isSupported() {\n      return !this.bip32ValidationError.length;\n    } // TODO make these messages more robust\n    //   (e.g use `menuchoices` as an array of `menuchoicemessages`)\n\n  }, {\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(ColdcardMultisigSettingsFileParser.prototype), \"messages\", this).call(this);\n\n      if (Object.entries(this.bip32ValidationErrorMessage).length) {\n        messages.push({\n          state: _interaction.PENDING,\n          level: _interaction.ERROR,\n          code: this.bip32ValidationErrorMessage.code,\n          text: this.bip32ValidationErrorMessage.text\n        });\n      }\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"coldcard.export_xpub\",\n        text: \"Go to Settings > Multisig Wallets > Export XPUB\"\n      });\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"coldcard.select_account\",\n        text: \"Enter 0 for account\"\n      });\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"coldcard.upload_key\",\n        text: \"Upload the JSON file from your Coldcard.\"\n      });\n      return messages;\n    }\n  }, {\n    key: \"chrootForBIP32Path\",\n    value: function chrootForBIP32Path(bip32Path) {\n      for (var i = 0; i < COLDCARD_BASE_CHROOTS.length; i++) {\n        var chroot = COLDCARD_BASE_CHROOTS[i];\n\n        if (bip32Path.startsWith(chroot)) {\n          return chroot;\n        }\n      }\n\n      return null;\n    }\n    /**\n     * This validates three things for an incoming Coldcard bip32Path\n     *\n     * 1. Is the bip32path valid syntactically?\n     * 2. Does the bip32path start with one of the known Coldcard chroots?\n     * 3. Are there any hardened indices in the relative path below the chroot?\n     *\n     * @param {string} bip32Path - bip32Path to validate against Coldcard chroots\n     * @return {string} empty or with the appropriate error message\n     */\n\n  }, {\n    key: \"validateColdcardBip32Path\",\n    value: function validateColdcardBip32Path(bip32Path) {\n      var bip32PathError = (0, _unchainedBitcoin.validateBIP32Path)(bip32Path);\n\n      if (bip32PathError.length) {\n        this.bip32ValidationErrorMessage = {\n          text: bip32PathError,\n          code: \"coldcard.bip32_path.path_error\"\n        };\n        return bip32PathError;\n      }\n\n      var coldcardChroot = this.chrootForBIP32Path(bip32Path);\n\n      if (coldcardChroot) {\n        if (coldcardChroot === bip32Path) {\n          // asking for known base path, no deeper derivation\n          return \"\";\n        }\n\n        var relativePath = (0, _unchainedBitcoin.getRelativeBIP32Path)(coldcardChroot, bip32Path);\n        var relativePathError = (0, _unchainedBitcoin.validateBIP32Path)(relativePath, {\n          mode: \"unhardened\"\n        });\n\n        if (relativePathError) {\n          this.bip32ValidationErrorMessage = {\n            text: relativePathError,\n            code: \"coldcard.bip32_path.no_hardened_relative_path_error\"\n          };\n          return relativePathError;\n        }\n\n        return \"\";\n      }\n\n      var unknownColdcardParentBip32PathError = \"The bip32Path must begin with one of the known Coldcard paths: \".concat(COLDCARD_BASE_CHROOTS);\n      this.bip32ValidationErrorMessage = {\n        text: unknownColdcardParentBip32PathError,\n        code: \"coldcard.bip32_path.unknown_chroot_error\"\n      };\n      return unknownColdcardParentBip32PathError;\n    }\n    /**\n     * Parse the Coldcard JSON file and do some basic error checking\n     * add a field for rootFingerprint (it can sometimes be calculated\n     * if not explicitly included)\n     *\n     * @param {Object} file JSON file exported from Coldcard\n     * @returns {Object} the parsed response\n     *\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(file) {\n      //In the case of keys (json), the file will look like:\n      //\n      //{\n      //   \"p2sh_deriv\": \"m/45'\",\n      //   \"p2sh\": \"tpubDA4nUAdTmY...MmtZaVFEU5MtMfj7H\",\n      //   \"p2wsh_p2sh_deriv\": \"m/48'/1'/0'/1'\",          // originally they had this backwards\n      //   \"p2wsh_p2sh\": \"Upub5THcs...Qh27gWiL2wDoVwaW\",  // originally they had this backwards\n      //   \"p2sh_p2wsh_deriv\": \"m/48'/1'/0'/1'\",          // now it's right\n      //   \"p2sh_p2wsh\": \"Upub5THcs...Qh27gWiL2wDoVwaW\",  // now it's right\n      //   \"p2wsh_deriv\": \"m/48'/1'/0'/2'\",\n      //   \"p2wsh\": \"Vpub5n7tBWyvv...2hTzyeSKtZ5PQ1MRN\",\n      //   \"xfp\": \"12abcdef\"\n      // }\n      //\n      // For now, we will derive unhardened from `p2sh_deriv`\n      // FIXME: assume we will gain the ability to ask Coldcard for an arbitrary path\n      //   (or at least a p2sh hardened path deeper than m/45')\n      var data;\n\n      if (_typeof(file) === \"object\") {\n        data = file;\n      } else if (typeof file === \"string\") {\n        try {\n          data = JSON.parse(file);\n        } catch (error) {\n          throw new Error(\"Unable to parse JSON.\");\n        }\n      } else {\n        throw new Error(\"Not valid JSON.\");\n      }\n\n      if (Object.keys(data).length === 0) {\n        throw new Error(\"Empty JSON file.\");\n      } // Coldcard changed the format of keys in the exported file to match\n      // the convention of p2sh-p2wsh instead of what they had before\n      // which was p2wsh-p2sh ... so one of these sets needs to be\n      // in the file.\n\n\n      if (!data.p2sh_deriv || !data.p2sh || !data.p2wsh_deriv || !data.p2wsh || (!data.p2wsh_p2sh_deriv || !data.p2wsh_p2sh) && (!data.p2sh_p2wsh_deriv || !data.p2sh_p2wsh)) {\n        throw new Error(\"Missing required params. Was this file exported from a Coldcard?  If you are using firmware version 4.1.0 please upgrade to 4.1.1 or later.\");\n      }\n\n      var xpubClass = _unchainedBitcoin.ExtendedPublicKey.fromBase58(data.p2sh);\n\n      if (!data.xfp && xpubClass.depth !== 1) {\n        throw new Error(\"No xfp in JSON file.\");\n      } // We can only find the fingerprint in the xpub if the depth is one\n      // because the xpub includes its parent's fingerprint.\n\n\n      var xfpFromWithinXpub = xpubClass.depth === 1 ? (0, _unchainedBitcoin.fingerprintToFixedLengthHex)(xpubClass.parentFingerprint) : null; // Sanity check if you send in a depth one xpub, we should get the same fingerprint\n\n      if (xfpFromWithinXpub && data.xfp && xfpFromWithinXpub !== data.xfp.toLowerCase()) {\n        throw new Error(\"Computed fingerprint does not match the one in the file.\");\n      }\n\n      var rootFingerprint = data.xfp ? data.xfp : xfpFromWithinXpub;\n      data.rootFingerprint = rootFingerprint.toLowerCase();\n      return data;\n    }\n    /**\n     * This method will take the result from the Coldcard JSON and:\n     *\n     * 1. determine which t/U/V/x/Y/Zpub to use\n     * 2. derive deeper if necessary (and able) using functionality\n     *    from unchained-bitcoin\n     *\n     * @param {Object} result - parsed data from ColdcardJSON\n     * @returns {Object} the desired xpub (if possible)\n     *\n     */\n\n  }, {\n    key: \"deriveDeeperXpubIfNecessary\",\n    value: function deriveDeeperXpubIfNecessary(result) {\n      var knownColdcardChroot = this.chrootForBIP32Path(this.bip32Path);\n      var relativePath = (0, _unchainedBitcoin.getRelativeBIP32Path)(knownColdcardChroot, this.bip32Path);\n      var addressType = COLDCARD_BASE_BIP32_PATHS[knownColdcardChroot]; // result could have p2wsh_p2sh or p2sh_p2wsh based on firmware version. Blah!\n\n      if (addressType.includes(\"_\") && !result[addressType.toLowerCase()]) {\n        // Firmware < v3.2.0\n        addressType = \"p2wsh_p2sh\";\n      }\n\n      var prefix = this.network === _unchainedBitcoin.TESTNET ? \"tpub\" : \"xpub\"; // If the addressType is segwit, the imported key will not be in the xpub/tpub format,\n      // so convert it.\n\n      var baseXpub = addressType.toLowerCase().includes(\"w\") ? (0, _unchainedBitcoin.convertExtendedPublicKey)(result[addressType.toLowerCase()], prefix) : result[addressType.toLowerCase()];\n      return relativePath.length ? (0, _unchainedBitcoin.deriveChildExtendedPublicKey)(baseXpub, relativePath, this.network) : baseXpub;\n    }\n  }]);\n\n  return ColdcardMultisigSettingsFileParser;\n}(ColdcardInteraction);\n/**\n * Reads a public key and (optionally) derives deeper from data in an\n * exported JSON file uploaded from the Coldcard.\n *\n * @extends {ColdcardMultisigSettingsFileParser}\n * @example\n * const interaction = new ColdcardExportPublicKey();\n * const reader = new FileReader(); // application dependent\n * const jsonFile = reader.readAsText('ccxp-0F056943.json'); // application dependent\n * const {publicKey, rootFingerprint, bip32Path} = interaction.parse(jsonFile);\n * console.log(publicKey);\n * // \"026942...\"\n * console.log(rootFingerprint);\n * // \"0f056943\"\n * console.log(bip32Path);\n * // \"m/45'/0/0\"\n */\n\n\nvar ColdcardExportPublicKey =\n/*#__PURE__*/\nfunction (_ColdcardMultisigSett) {\n  _inherits(ColdcardExportPublicKey, _ColdcardMultisigSett);\n\n  /**\n   *\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network (needed for derivations)\n   * @param {string} options.bip32Path - BIP32 path\n   */\n  function ColdcardExportPublicKey(_ref2) {\n    var network = _ref2.network,\n        bip32Path = _ref2.bip32Path;\n\n    _classCallCheck(this, ColdcardExportPublicKey);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ColdcardExportPublicKey).call(this, {\n      network: network,\n      bip32Path: bip32Path\n    }));\n  }\n\n  _createClass(ColdcardExportPublicKey, [{\n    key: \"messages\",\n    value: function messages() {\n      return _get(_getPrototypeOf(ColdcardExportPublicKey.prototype), \"messages\", this).call(this);\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(xpubJSONFile) {\n      var result = _get(_getPrototypeOf(ColdcardExportPublicKey.prototype), \"parse\", this).call(this, xpubJSONFile);\n\n      var xpub = this.deriveDeeperXpubIfNecessary(result);\n      return {\n        publicKey: _unchainedBitcoin.ExtendedPublicKey.fromBase58(xpub).pubkey,\n        rootFingerprint: result.rootFingerprint,\n        bip32Path: this.bip32Path\n      };\n    }\n  }]);\n\n  return ColdcardExportPublicKey;\n}(ColdcardMultisigSettingsFileParser);\n/**\n * Reads an extended public key and (optionally) derives deeper from data in an\n * exported JSON file uploaded from the Coldcard.\n *\n * @extends {ColdcardMultisigSettingsFileParser}\n * @example\n * const interaction = new ColdcardExportExtendedPublicKey({network: MAINNET, bip32Path: 'm/45'/0/0'});\n * const reader = new FileReader(); // application dependent\n * const jsonFile = reader.readAsText('ccxp-0F056943.json'); // application dependent\n * const {xpub, rootFingerprint, bip32Path} = interaction.parse(jsonFile);\n * console.log(xpub);\n * // \"xpub...\"\n * console.log(rootFingerprint);\n * // \"0f056943\"\n * console.log(bip32Path);\n * // \"m/45'/0/0\"\n */\n\n\nexports.ColdcardExportPublicKey = ColdcardExportPublicKey;\n\nvar ColdcardExportExtendedPublicKey =\n/*#__PURE__*/\nfunction (_ColdcardMultisigSett2) {\n  _inherits(ColdcardExportExtendedPublicKey, _ColdcardMultisigSett2);\n\n  /**\n   *\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network (needed for derivations)\n   * @param {string} options.bip32Path - BIP32 paths\n   */\n  function ColdcardExportExtendedPublicKey(_ref3) {\n    var network = _ref3.network,\n        bip32Path = _ref3.bip32Path;\n\n    _classCallCheck(this, ColdcardExportExtendedPublicKey);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ColdcardExportExtendedPublicKey).call(this, {\n      network: network,\n      bip32Path: bip32Path\n    }));\n  }\n\n  _createClass(ColdcardExportExtendedPublicKey, [{\n    key: \"messages\",\n    value: function messages() {\n      return _get(_getPrototypeOf(ColdcardExportExtendedPublicKey.prototype), \"messages\", this).call(this);\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(xpubJSONFile) {\n      var result = _get(_getPrototypeOf(ColdcardExportExtendedPublicKey.prototype), \"parse\", this).call(this, xpubJSONFile);\n\n      var xpub = this.deriveDeeperXpubIfNecessary(result);\n      return {\n        xpub: xpub,\n        rootFingerprint: result.rootFingerprint,\n        bip32Path: this.bip32Path\n      };\n    }\n  }]);\n\n  return ColdcardExportExtendedPublicKey;\n}(ColdcardMultisigSettingsFileParser);\n/**\n * Returns signature request data via a PSBT for a Coldcard to sign and\n * accepts a PSBT for parsing signatures from a Coldcard device\n *\n * @extends {module:coldcard.ColdcardInteraction}\n * @example\n * const interaction = new ColdcardSignMultisigTransaction({network, inputs, outputs, bip32paths, psbt});\n * console.log(interaction.request());\n * // \"cHNidP8BA...\"\n *\n * // Parse signatures from a signed PSBT\n * const signatures = interaction.parse(psbt);\n * console.log(signatures);\n * // {'029e866...': ['3045...01', ...]}\n *\n */\n\n\nexports.ColdcardExportExtendedPublicKey = ColdcardExportExtendedPublicKey;\n\nvar ColdcardSignMultisigTransaction =\n/*#__PURE__*/\nfunction (_ColdcardInteraction2) {\n  _inherits(ColdcardSignMultisigTransaction, _ColdcardInteraction2);\n\n  /**\n   *\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   * @param {array<object>} options.inputs - inputs for the transaction\n   * @param {array<object>} options.outputs - outputs for the transaction\n   * @param {array<string>} options.bip32Paths - BIP32 paths\n   * @param {object} [options.psbt] - PSBT of the transaction to sign, include it or we will generate it\n   */\n  function ColdcardSignMultisigTransaction(_ref4) {\n    var _this2;\n\n    var network = _ref4.network,\n        inputs = _ref4.inputs,\n        outputs = _ref4.outputs,\n        bip32Paths = _ref4.bip32Paths,\n        psbt = _ref4.psbt;\n\n    _classCallCheck(this, ColdcardSignMultisigTransaction);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(ColdcardSignMultisigTransaction).call(this));\n    _this2.network = network;\n    _this2.inputs = inputs;\n    _this2.outputs = outputs;\n    _this2.bip32Paths = bip32Paths;\n\n    if (psbt) {\n      _this2.psbt = psbt;\n    } else {\n      try {\n        _this2.psbt = (0, _unchainedBitcoin.unsignedMultisigPSBT)(network, inputs, outputs);\n      } catch (e) {\n        throw new Error(\"Unable to build the PSBT from the provided parameters.\");\n      }\n    }\n\n    return _this2;\n  }\n\n  _createClass(ColdcardSignMultisigTransaction, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(ColdcardSignMultisigTransaction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"coldcard.install_multisig_config\",\n        text: \"Ensure your Coldcard has the multisig wallet installed.\"\n      });\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"coldcard.download_psbt\",\n        text: \"Download and save this PSBT file to your SD card.\"\n      });\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"coldcard.transfer_psbt\",\n        text: \"Transfer the PSBT file to your Coldcard.\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"coldcard.transfer_psbt\",\n        text: \"Transfer the PSBT file to your Coldcard.\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"coldcard.select_psbt\",\n        text: \"Choose 'Ready To Sign' and select the PSBT.\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"coldcard.sign_psbt\",\n        text: \"Verify the transaction details and sign.\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"coldcard.upload_signed_psbt\",\n        text: \"Upload the signed PSBT below.\"\n      });\n      return messages;\n    }\n    /**\n     * Request for the PSBT data that needs to be signed.\n     *\n     * NOTE: the application may be expecting the PSBT in some format\n     * other than the direct Object.\n     *\n     * E.g. PSBT in Base64 is interaction().request().toBase64()\n     *\n     * @returns {Object} Returns the local unsigned PSBT from transaction details\n     */\n\n  }, {\n    key: \"request\",\n    value: function request() {\n      return this.psbt;\n    }\n    /**\n     *\n     * @param {Object} psbtObject - the PSBT\n     * @returns {Object} signatures - This calls a function in unchained-bitcoin which parses\n     * PSBT files for sigantures and then returns an object with the format\n     * {\n     *   pubkey1 : [sig1, sig2, ...],\n     *   pubkey2 : [sig1, sig2, ...]\n     * }\n     * This format may change in the future or there may be additional options for return type.\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(psbtObject) {\n      var signatures = (0, _unchainedBitcoin.parseSignaturesFromPSBT)(psbtObject);\n\n      if (!signatures || signatures.length === 0) {\n        throw new Error(\"No signatures found in the PSBT. Did you upload the right one?\");\n      }\n\n      return signatures;\n    }\n  }]);\n\n  return ColdcardSignMultisigTransaction;\n}(ColdcardInteraction);\n/**\n * Returns a valid multisig wallet config text file to send over to a Coldcard\n *\n * NOTE: technically only the root xfp of the signing device is required to be\n * correct, but we recommend only setting up the multisig wallet on the Coldcard\n * with complete xfp information. Here we actually turn this recommendation into a\n * requirement so as to minimize the number of wallet-config installations.\n *\n * This will likely move to its own generic class soon, and we'll only leave\n * the specifics of `adapt()` behind.\n *\n * This is an example Coldcard config file from\n * https://coldcardwallet.com/docs/multisig\n *\n * # Coldcard Multisig setup file (exported from 4369050F)\n * #\n * Name: MeMyself\n * Policy: 2 of 4\n * Derivation: m/45'\n * Format: P2WSH\n *\n * D0CFA66B: tpubD9429UXFGCTKJ9NdiNK4rC5...DdP9\n * 8E697B74: tpubD97nVL37v5tWyMf9ofh5rzn...XgSc\n * BE26B07B: tpubD9ArfXowvGHnuECKdGXVKDM...FxPa\n * 4369050F: tpubD8NXmKsmWp3a3DXhbihAYbY...9C8n\n *\n */\n\n\nexports.ColdcardSignMultisigTransaction = ColdcardSignMultisigTransaction;\n\nvar ColdcardMultisigWalletConfig =\n/*#__PURE__*/\nfunction () {\n  function ColdcardMultisigWalletConfig(_ref5) {\n    var jsonConfig = _ref5.jsonConfig;\n\n    _classCallCheck(this, ColdcardMultisigWalletConfig);\n\n    if (_typeof(jsonConfig) === \"object\") {\n      this.jsonConfig = jsonConfig;\n    } else if (typeof jsonConfig === \"string\") {\n      try {\n        this.jsonConfig = JSON.parse(jsonConfig);\n      } catch (error) {\n        throw new Error(\"Unable to parse JSON.\");\n      }\n    } else {\n      throw new Error(\"Not valid JSON.\");\n    }\n\n    if (this.jsonConfig.uuid || this.jsonConfig.name) {\n      this.name = this.jsonConfig.uuid || this.jsonConfig.name;\n    } else {\n      throw new Error(\"Configuration file needs a UUID or a name.\");\n    }\n\n    if (this.jsonConfig.quorum.requiredSigners && this.jsonConfig.quorum.totalSigners) {\n      this.requiredSigners = this.jsonConfig.quorum.requiredSigners;\n      this.totalSigners = this.jsonConfig.quorum.totalSigners;\n    } else {\n      throw new Error(\"Configuration file needs quorum.requiredSigners and quorum.totalSigners.\");\n    }\n\n    if (this.jsonConfig.addressType) {\n      this.addressType = jsonConfig.addressType;\n    } else {\n      throw new Error(\"Configuration file needs addressType.\");\n    }\n\n    if (this.jsonConfig.extendedPublicKeys && this.jsonConfig.extendedPublicKeys.every(function (xpub) {\n      // For each xpub, check that xfp exists, the length is 8, type is string, and valid hex\n      if (!xpub.xfp || xpub.xfp === \"Unknown\") {\n        throw new Error(\"ExtendedPublicKeys missing at least one xfp.\");\n      }\n\n      if (typeof xpub.xfp !== \"string\") {\n        throw new Error(\"XFP not a string\");\n      }\n\n      if (xpub.xfp.length !== 8) {\n        throw new Error(\"XFP not length 8\");\n      }\n\n      if (isNaN(Number(\"0x\".concat(xpub.xfp)))) {\n        throw new Error(\"XFP is invalid hex\");\n      }\n\n      return true;\n    })) {\n      this.extendedPublicKeys = this.jsonConfig.extendedPublicKeys;\n    } else {\n      throw new Error(\"Configuration file needs extendedPublicKeys.\");\n    }\n  }\n  /**\n   * @returns {string} output to be written to a text file and uploaded to Coldcard.\n   */\n\n\n  _createClass(ColdcardMultisigWalletConfig, [{\n    key: \"adapt\",\n    value: function adapt() {\n      var output = \"# Coldcard Multisig setup file (exported from unchained-wallets)\\n# https://github.com/unchained-capital/unchained-wallets\\n# v\".concat(COLDCARD_WALLET_CONFIG_VERSION, \"\\n# \\nName: \").concat(this.name, \"\\nPolicy: \").concat(this.requiredSigners, \" of \").concat(this.totalSigners, \"\\nFormat: \").concat(this.addressType, \"\\n\\n\"); // We need to loop over xpubs and output `Derivation: bip32path` and `xfp: xpub` for each\n\n      var xpubs = this.extendedPublicKeys.map(function (xpub) {\n        // Mask the derivation to the appropriate depth if it is not known\n        var unknownBip32 = xpub.bip32Path.toLowerCase().includes(\"unknown\");\n        var derivation = unknownBip32 ? \"m\".concat(\"/0\".repeat(_unchainedBitcoin.ExtendedPublicKey.fromBase58(xpub.xpub).depth)) : xpub.bip32Path;\n        return \"Derivation: \".concat(derivation, \"\\n\").concat(xpub.xfp, \": \").concat(xpub.xpub);\n      });\n      output += xpubs.join(\"\\n\");\n      output += \"\\n\";\n      return output;\n    }\n  }]);\n\n  return ColdcardMultisigWalletConfig;\n}();\n\nexports.ColdcardMultisigWalletConfig = ColdcardMultisigWalletConfig;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CustomSignMultisigTransaction = exports.CustomExportExtendedPublicKey = exports.CustomInteraction = exports.CUSTOM = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.reflect.get\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.string.starts-with\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.array.find\");\n\nvar _unchainedBitcoin = require(\"unchained-bitcoin\");\n\nvar _interaction = require(\"./interaction\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar CUSTOM = \"custom\";\n/**\n * Base class for interactions with Custom \"devices\"\n *\n * @extends {module:interaction.IndirectKeystoreInteraction}\n */\n\nexports.CUSTOM = CUSTOM;\n\nvar CustomInteraction =\n/*#__PURE__*/\nfunction (_IndirectKeystoreInte) {\n  _inherits(CustomInteraction, _IndirectKeystoreInte);\n\n  function CustomInteraction() {\n    _classCallCheck(this, CustomInteraction);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(CustomInteraction).apply(this, arguments));\n  }\n\n  return CustomInteraction;\n}(_interaction.IndirectKeystoreInteraction);\n/**\n * Base class for text-based (or clipboard pasted) ExtendedPublicKey\n * This class handles parsing/validating the xpub and relevant\n * derivation properties. If no root fingerprint is provided, one will\n * be deterministically assigned.\n *\n * @extends {module:custom.CustomInteraction}\n * @example\n * const interaction = new CustomExportExtendedPublicKey({network: MAINNET, bip32Path: \"m/45'/0'/0'\"});\n * const {xpub, rootFingerprint, bip32Path} = interaction.parse({xpub: xpub..., rootFingerprint: 0f056943});\n * console.log(xpub);\n * // \"xpub...\"\n * console.log(rootFingerprint);\n * // \"0f056943\"\n * console.log(bip32Path);\n * // \"m/45'/0'/0'\"\n * ** OR **\n * * const {xpub, rootFingerprint, bip32Path} = interaction.parse({xpub: xpub...});\n * console.log(xpub);\n * // \"xpub...\"\n * console.log(rootFingerprint);\n * // \"096aed5e\"\n * console.log(bip32Path);\n * // \"m/45'/0'/0'\"\n */\n\n\nexports.CustomInteraction = CustomInteraction;\n\nvar CustomExportExtendedPublicKey =\n/*#__PURE__*/\nfunction (_CustomInteraction) {\n  _inherits(CustomExportExtendedPublicKey, _CustomInteraction);\n\n  /**\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network (needed for derivations)\n   * @param {string} options.bip32Path - bip32Path to interrogate\n   */\n  function CustomExportExtendedPublicKey(_ref) {\n    var _this;\n\n    var network = _ref.network,\n        bip32Path = _ref.bip32Path;\n\n    _classCallCheck(this, CustomExportExtendedPublicKey);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CustomExportExtendedPublicKey).call(this));\n\n    if ([_unchainedBitcoin.MAINNET, _unchainedBitcoin.TESTNET].find(function (net) {\n      return net === network;\n    })) {\n      _this.network = network;\n    } else {\n      throw new Error(\"Unknown network.\");\n    }\n\n    _this.validationErrorMessages = [];\n    _this.bip32Path = bip32Path;\n    var bip32PathError = (0, _unchainedBitcoin.validateBIP32Path)(bip32Path);\n\n    if (bip32PathError.length) {\n      _this.validationErrorMessages.push({\n        code: \"custom.bip32_path.path_error\",\n        text: bip32PathError\n      });\n    }\n\n    return _this;\n  }\n\n  _createClass(CustomExportExtendedPublicKey, [{\n    key: \"isSupported\",\n    value: function isSupported() {\n      return this.validationErrorMessages.length === 0;\n    }\n  }, {\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(CustomExportExtendedPublicKey.prototype), \"messages\", this).call(this);\n\n      if (this.validationErrorMessages.length) {\n        this.validationErrorMessages.forEach(function (e) {\n          messages.push({\n            state: _interaction.PENDING,\n            level: _interaction.ERROR,\n            code: e.code,\n            text: e.text\n          });\n        });\n      }\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"custom.import_xpub\",\n        text: \"Type or paste the extended public key here.\"\n      });\n      return messages;\n    }\n    /**\n     * Parse the provided JSON and do some basic error checking\n     *\n     * @param {Object} data - JSON object with incoming data to be parsed (read: reformatted)\n     * @returns {Object} Object - ExtendedPublicKeyDerivation {xpub, bip32path, rootFingerprint}\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(data) {\n      // build ExtendedPublicKey struct (validation happens in constructor)\n      var xpubClass;\n      var rootFingerprint;\n\n      try {\n        xpubClass = _unchainedBitcoin.ExtendedPublicKey.fromBase58(data.xpub);\n      } catch (e) {\n        throw new Error(\"Not a valid ExtendedPublicKey.\");\n      }\n\n      try {\n        if (data.rootFingerprint === \"\" || data.rootFingerprint === undefined) {\n          var pkLen = xpubClass.pubkey.length; // If no fingerprint is provided, we will assign one deterministically\n\n          rootFingerprint = xpubClass.pubkey.substring(pkLen - 8);\n        } else {\n          (0, _unchainedBitcoin.validateRootFingerprint)(data.rootFingerprint);\n          rootFingerprint = data.rootFingerprint;\n        }\n      } catch (e) {\n        throw new Error(\"Root fingerprint validation error: \".concat(e.message.toLowerCase(), \".\"));\n      }\n\n      var numSlashes = this.bip32Path.split(\"/\").length;\n      var bipDepth = this.bip32Path.startsWith(\"m/\") ? numSlashes - 1 : numSlashes;\n\n      if (xpubClass.depth !== bipDepth) {\n        throw new Error(\"Depth of ExtendedPublicKey (\".concat(xpubClass.depth, \") does not match depth of BIP32 path (\").concat(bipDepth, \").\"));\n      }\n\n      return {\n        xpub: xpubClass.base58String,\n        rootFingerprint: rootFingerprint,\n        bip32Path: this.bip32Path\n      };\n    }\n  }]);\n\n  return CustomExportExtendedPublicKey;\n}(CustomInteraction);\n/**\n * Returns signature request data via a PSBT for a Custom \"device\" to sign and\n * accepts a PSBT for parsing signatures from a Custom \"device\"\n *\n * @extends {module:custom.CustomInteraction}\n * @example\n * const interaction = new CustomSignMultisigTransaction({network, inputs, outputs, bip32paths, psbt});\n * console.log(interaction.request());\n * // \"cHNidP8BA...\"\n *\n * // Parse signatures from a signed PSBT\n * const signatures = interaction.parse(psbt);\n * console.log(signatures);\n * // {'029e866...': ['3045...01', ...]}\n *\n */\n\n\nexports.CustomExportExtendedPublicKey = CustomExportExtendedPublicKey;\n\nvar CustomSignMultisigTransaction =\n/*#__PURE__*/\nfunction (_CustomInteraction2) {\n  _inherits(CustomSignMultisigTransaction, _CustomInteraction2);\n\n  /**\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   * @param {array<object>} options.inputs - inputs for the transaction\n   * @param {array<object>} options.outputs - outputs for the transaction\n   * @param {array<string>} options.bip32Paths - BIP32 paths\n   * @param {object} [options.psbt] - PSBT of the transaction to sign, included or generated from the other options\n   */\n  function CustomSignMultisigTransaction(_ref2) {\n    var _this2;\n\n    var network = _ref2.network,\n        inputs = _ref2.inputs,\n        outputs = _ref2.outputs,\n        bip32Paths = _ref2.bip32Paths,\n        psbt = _ref2.psbt;\n\n    _classCallCheck(this, CustomSignMultisigTransaction);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(CustomSignMultisigTransaction).call(this));\n    _this2.network = network;\n    _this2.inputs = inputs;\n    _this2.outputs = outputs;\n    _this2.bip32Paths = bip32Paths;\n\n    if (psbt) {\n      _this2.psbt = psbt;\n    } else {\n      try {\n        _this2.psbt = (0, _unchainedBitcoin.unsignedMultisigPSBT)(network, inputs, outputs);\n      } catch (e) {\n        throw new Error(\"Unable to build the PSBT from the provided parameters.\");\n      }\n    }\n\n    return _this2;\n  }\n\n  _createClass(CustomSignMultisigTransaction, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(CustomSignMultisigTransaction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"custom.download_psbt\",\n        text: \"Download and save this PSBT file.\"\n      });\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        code: \"custom.sign_psbt\",\n        text: \"Add your signature to the PSBT.\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"custom.sign_psbt\",\n        text: \"Verify the transaction details and sign.\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"custom.upload_signed_psbt\",\n        text: \"Upload the signed PSBT.\"\n      });\n      return messages;\n    }\n    /**\n     * Request for the PSBT data that needs to be signed.\n     *\n     * NOTE: the application may be expecting the PSBT in some format\n     * other than the direct Object.\n     *\n     * E.g. PSBT in Base64 is interaction().request().toBase64()\n     *\n     * @returns {Object} Returns the local unsigned PSBT from transaction details\n     */\n\n  }, {\n    key: \"request\",\n    value: function request() {\n      return this.psbt;\n    }\n    /**\n     *\n     * @param {Object} psbtObject - the PSBT\n     * @returns {Object} signatures - This calls a function in unchained-bitcoin which parses\n     * PSBT files for sigantures and then returns an object with the format\n     * {\n     *   pubkey1 : [sig1, sig2, ...],\n     *   pubkey2 : [sig1, sig2, ...]\n     * }\n     * This format may change in the future or there may be additional options for return type.\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(psbtObject) {\n      var signatures = (0, _unchainedBitcoin.parseSignaturesFromPSBT)(psbtObject);\n\n      if (!signatures || signatures.length === 0) {\n        throw new Error(\"No signatures found in the PSBT. Did you upload the right one?\");\n      }\n\n      return signatures;\n    }\n  }]);\n\n  return CustomSignMultisigTransaction;\n}(CustomInteraction);\n\nexports.CustomSignMultisigTransaction = CustomSignMultisigTransaction;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseHermitQRCodeData = parseHermitQRCodeData;\nexports.encodeHermitQRCodeData = encodeHermitQRCodeData;\nexports.HermitSignTransaction = exports.HermitExportExtendedPublicKey = exports.HermitExportPublicKey = exports.HermitDisplayer = exports.HermitReader = exports.HermitInteraction = exports.HERMIT = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.reflect.get\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.object.define-properties\");\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es7.object.values\");\n\nrequire(\"core-js/modules/es6.regexp.match\");\n\nrequire(\"core-js/modules/es6.reflect.delete-property\");\n\nrequire(\"core-js/modules/es6.string.starts-with\");\n\nvar _hiBase = _interopRequireDefault(require(\"hi-base32\"));\n\nvar _pako = _interopRequireDefault(require(\"pako\"));\n\nvar _bignumber = _interopRequireDefault(require(\"bignumber.js\"));\n\nvar _unchainedBitcoin = require(\"unchained-bitcoin\");\n\nvar _interaction = require(\"./interaction\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar HERMIT = 'hermit';\n/**\n * Parse the data from a Hermit-created QR-code.\n *\n * @param {string} encodedString - base32-encoded, gzipped, JSON data\n * @returns {object} the parsed data\n */\n\nexports.HERMIT = HERMIT;\n\nfunction parseHermitQRCodeData(encodedString) {\n  var errorPrefix = \"Unable to parse QR code\";\n\n  try {\n    var compressedBytes = _hiBase[\"default\"].decode.asBytes(encodedString);\n\n    try {\n      var json = _pako[\"default\"].inflate(compressedBytes, {\n        to: 'string'\n      });\n\n      try {\n        return JSON.parse(json);\n      } catch (e) {\n        throw new Error(\"\".concat(errorPrefix, \" (JSON parse error)\"));\n      }\n    } catch (e) {\n      if (e.message && e.message.startsWith(errorPrefix)) {\n        throw e;\n      } else {\n        throw new Error(\"\".concat(errorPrefix, \" (gzip decompression error)\"));\n      }\n    }\n  } catch (e) {\n    if (e.message && e.message.startsWith(errorPrefix)) {\n      throw e;\n    } else {\n      throw new Error(\"\".concat(errorPrefix, \" (Base32 decode error)\"));\n    }\n  }\n}\n/**\n * Encode the given `data` as a string to be put into a\n * Hermit-readable QR code.\n *\n * @param {object} data plain JavaScript object to encode\n * @returns {string} base32-encoded, gzipped, JSON data\n */\n\n\nfunction encodeHermitQRCodeData(data) {\n  var errorPrefix = \"Unable to create QR code\";\n\n  try {\n    var jsonString = JSON.stringify(data);\n\n    try {\n      var compressedBytes = _pako[\"default\"].deflate(jsonString, {\n        gzip: true\n      });\n\n      try {\n        return _hiBase[\"default\"].encode(compressedBytes);\n      } catch (e) {\n        throw new Error(\"\".concat(errorPrefix, \" (Base32 encode error)\"));\n      }\n    } catch (e) {\n      if (e.message && e.message.startsWith(errorPrefix)) {\n        throw e;\n      } else {\n        throw new Error(\"\".concat(errorPrefix, \" (gzip compression error)\"));\n      }\n    }\n  } catch (e) {\n    if (e.message && e.message.startsWith(errorPrefix)) {\n      throw e;\n    } else {\n      throw new Error(\"\".concat(errorPrefix, \" (JSON encode error)\"));\n    }\n  }\n}\n\nfunction commandMessage(data) {\n  return _objectSpread({}, {\n    state: _interaction.PENDING,\n    level: _interaction.INFO,\n    code: \"hermit.command\",\n    mode: \"wallet\"\n  }, {}, {\n    text: \"\".concat(data.instructions, \" '\").concat(data.command, \"'\")\n  }, {}, data);\n}\n/**\n * Base class for interactions with Hermit.\n *\n * @extends {module:interaction.IndirectKeystoreInteraction}\n */\n\n\nvar HermitInteraction =\n/*#__PURE__*/\nfunction (_IndirectKeystoreInte) {\n  _inherits(HermitInteraction, _IndirectKeystoreInte);\n\n  function HermitInteraction() {\n    _classCallCheck(this, HermitInteraction);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(HermitInteraction).apply(this, arguments));\n  }\n\n  return HermitInteraction;\n}(_interaction.IndirectKeystoreInteraction);\n/**\n * Base class for interactions which read a QR code displayed by a\n * Hermit command.\n *\n * @extends {module:hermit.HermitInteraction}\n */\n\n\nexports.HermitInteraction = HermitInteraction;\n\nvar HermitReader =\n/*#__PURE__*/\nfunction (_HermitInteraction) {\n  _inherits(HermitReader, _HermitInteraction);\n\n  function HermitReader() {\n    var _this;\n\n    _classCallCheck(this, HermitReader);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HermitReader).call(this));\n    _this.reader = true;\n    return _this;\n  }\n\n  _createClass(HermitReader, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(HermitReader.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        code: \"hermit.scanning\",\n        text: \"Scan Hermit QR code now.\"\n      });\n      return messages;\n    }\n  }]);\n\n  return HermitReader;\n}(HermitInteraction);\n/**\n * Base class for interactions which display data as a QR code for\n * Hermit to read and then read the QR code Hermit displays in\n * response.\n *\n * @extends {module:hermit.HermitInteraction}\n */\n\n\nexports.HermitReader = HermitReader;\n\nvar HermitDisplayer =\n/*#__PURE__*/\nfunction (_HermitReader) {\n  _inherits(HermitDisplayer, _HermitReader);\n\n  function HermitDisplayer() {\n    var _this2;\n\n    _classCallCheck(this, HermitDisplayer);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(HermitDisplayer).call(this));\n    _this2.displayer = true;\n    return _this2;\n  }\n\n  return HermitDisplayer;\n}(HermitReader);\n/**\n * Reads a public key from data in a Hermit QR code.\n *\n * @extends {module:hermit.HermitReader}\n * @example\n * const interaction = new HermitExportPublicKey();\n * const encodedString = readHermitQRCode(); // application dependent\n * const {pubkey, bip32Path} = interaction.parse(encoodedString);\n * console.log(pubkey);\n * // \"03...\"\n * console.log(bip32Path);\n * // \"m/45'/0'/0'/0/0\"\n */\n\n\nexports.HermitDisplayer = HermitDisplayer;\n\nvar HermitExportPublicKey =\n/*#__PURE__*/\nfunction (_HermitReader2) {\n  _inherits(HermitExportPublicKey, _HermitReader2);\n\n  function HermitExportPublicKey(_ref) {\n    var _this3;\n\n    var bip32Path = _ref.bip32Path;\n\n    _classCallCheck(this, HermitExportPublicKey);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(HermitExportPublicKey).call(this));\n    _this3.bip32Path = bip32Path;\n    return _this3;\n  }\n\n  _createClass(HermitExportPublicKey, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(HermitExportPublicKey.prototype), \"messages\", this).call(this);\n\n      messages.push(commandMessage({\n        instructions: \"Run the following Hermit command, replacing the BIP32 path if you need to:\",\n        command: \"export-pub \".concat(this.bip32Path)\n      }));\n      return messages;\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(encodedString) {\n      var result = parseHermitQRCodeData(encodedString);\n      var xpub = result.xpub,\n          pubkey = result.pubkey;\n      var bip32Path = result.bip32_path;\n\n      if (!pubkey) {\n        if (xpub) {\n          throw new Error(\"Make sure you export a plain public key and NOT an extended public key.\");\n        } else {\n          throw new Error(\"No public key in QR code.\");\n        }\n      }\n\n      if (!bip32Path) {\n        throw new Error(\"No BIP32 path in QR code.\");\n      }\n\n      result.bip32Path = bip32Path;\n      Reflect.deleteProperty(result, \"bip32_path\");\n      return result;\n    }\n  }]);\n\n  return HermitExportPublicKey;\n}(HermitReader);\n/**\n * Reads an extended public key from data in a Hermit QR code.\n *\n * @extends {module:hermit.HermitReader}\n * @example\n * const interaction = new HermitExportExtendedPublicKey();\n * const encodedString = readHermitQRCode(); // application dependent\n * const {xpub, bip32Path} = interaction.parse(encoodedString);\n * console.log(xpub);\n * // \"xpub...\"\n * console.log(bip32Path);\n * // \"m/45'/0'/0'\"\n */\n\n\nexports.HermitExportPublicKey = HermitExportPublicKey;\n\nvar HermitExportExtendedPublicKey =\n/*#__PURE__*/\nfunction (_HermitReader3) {\n  _inherits(HermitExportExtendedPublicKey, _HermitReader3);\n\n  function HermitExportExtendedPublicKey(_ref2) {\n    var _this4;\n\n    var bip32Path = _ref2.bip32Path;\n\n    _classCallCheck(this, HermitExportExtendedPublicKey);\n\n    _this4 = _possibleConstructorReturn(this, _getPrototypeOf(HermitExportExtendedPublicKey).call(this));\n    _this4.bip32Path = bip32Path;\n    return _this4;\n  }\n\n  _createClass(HermitExportExtendedPublicKey, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(HermitExportExtendedPublicKey.prototype), \"messages\", this).call(this);\n\n      messages.push(commandMessage({\n        instructions: \"Run the following Hermit command, replacing the BIP32 path if you need to:\",\n        command: \"export-xpub \".concat(this.bip32Path)\n      }));\n      return messages;\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(encodedString) {\n      var result = parseHermitQRCodeData(encodedString);\n      var xpub = result.xpub,\n          pubkey = result.pubkey;\n      var bip32Path = result.bip32_path;\n\n      if (!xpub) {\n        if (pubkey) {\n          throw new Error(\"Make sure you export an extended public key and NOT a plain public key.\");\n        } else {\n          throw new Error(\"No extended public key in QR code.\");\n        }\n      }\n\n      if (!bip32Path) {\n        throw new Error(\"No BIP32 path in QR code.\");\n      }\n\n      result.bip32Path = bip32Path;\n      Reflect.deleteProperty(result, \"bip32_path\");\n      return result;\n    }\n  }]);\n\n  return HermitExportExtendedPublicKey;\n}(HermitReader);\n/**\n * Returns signature request data to display in a QR code for Hermit\n * and reads the signature data passed back by Hermit in another QR\n * code.\n *\n * NOTE: Transactions with inputs & outputs to non-P2SH addresses are not supported by Hermit.\n *\n * @extends {module:hermit.HermitDisplayer}\n * @example\n * const interaction = new HermitSignTransaction({inputs, outputs, bip32Paths});\n * console.log(interaction.request());\n * // \"IJQXGZI...\"\n *\n * // Display a QR code containing the above data to Hermit running\n * // `sign-bitcoin` and it will return another QR code which needs\n * // parsed.\n * const encodedString = readHermitQRCode(); // application dependent\n * const signatures = interaction.parse(encoodedString);\n * console.log(signatures);\n * // [\"ababa...01\", ... ]\n *\n */\n\n\nexports.HermitExportExtendedPublicKey = HermitExportExtendedPublicKey;\n\nvar HermitSignTransaction =\n/*#__PURE__*/\nfunction (_HermitDisplayer) {\n  _inherits(HermitSignTransaction, _HermitDisplayer);\n\n  /**\n   *\n   * @param {object} options - options argument\n   * @param {array<object>} options.inputs - inputs for the transaction\n   * @param {array<object>} options.outputs - outputs for the transaction\n   * @param {array<string>} options.bip32Paths - BIP32 paths\n   */\n  function HermitSignTransaction(_ref3) {\n    var _this5;\n\n    var inputs = _ref3.inputs,\n        outputs = _ref3.outputs,\n        bip32Paths = _ref3.bip32Paths;\n\n    _classCallCheck(this, HermitSignTransaction);\n\n    _this5 = _possibleConstructorReturn(this, _getPrototypeOf(HermitSignTransaction).call(this));\n    _this5.inputs = inputs;\n    _this5.outputs = outputs;\n    _this5.bip32Paths = bip32Paths;\n    _this5.inputAddressType = '';\n    return _this5;\n  }\n\n  _createClass(HermitSignTransaction, [{\n    key: \"isSupported\",\n    value: function isSupported() {\n      return this.inputsAreSupported() && this.outputsAreSupported();\n    }\n  }, {\n    key: \"outputsAreSupported\",\n    value: function outputsAreSupported() {\n      if (this.outputs && this.outputs.length) {\n        for (var i = 0; i < this.outputs.length; i++) {\n          var output = this.outputs[i];\n\n          if (output.address.match(/^(tb|bc)/)) {\n            return false;\n          }\n        }\n      }\n\n      return true;\n    }\n  }, {\n    key: \"inputsAreSupported\",\n    value: function inputsAreSupported() {\n      if (this.inputs && this.inputs.length) {\n        for (var i = 0; i < this.inputs.length; i++) {\n          var input = this.inputs[i];\n          var inputAddressType = (0, _unchainedBitcoin.multisigAddressType)(input.multisig);\n\n          if (inputAddressType !== _unchainedBitcoin.MULTISIG_ADDRESS_TYPES.P2SH) {\n            this.inputAddressType = inputAddressType;\n            return false;\n          }\n        }\n      }\n\n      return true;\n    }\n  }, {\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(HermitSignTransaction.prototype), \"messages\", this).call(this);\n\n      if (!this.inputsAreSupported()) {\n        messages.push({\n          state: _interaction.UNSUPPORTED,\n          level: _interaction.ERROR,\n          code: \"hermit.unsupported.inputaddress\",\n          text: \"Unsupported input address type \".concat(this.inputAddressType, \", must be P2SH.\")\n        });\n      }\n\n      if (!this.outputsAreSupported()) {\n        messages.push({\n          state: _interaction.UNSUPPORTED,\n          level: _interaction.ERROR,\n          code: \"hermit.unsupported.outputaddress\",\n          text: \"Unsupported output address type. bech32 addresses are unsupported.\"\n        });\n      }\n\n      if (!this.inputsAreSupported() || !this.outputsAreSupported()) return messages;\n      messages.push(commandMessage({\n        instructions: \"Scan this QR code into Hermit by running the following command:\",\n        command: \"sign-bitcoin\"\n      }));\n      return messages;\n    }\n  }, {\n    key: \"request\",\n    value: function request() {\n      var data = this.signatureRequestData();\n      return encodeHermitQRCodeData(data);\n    }\n  }, {\n    key: \"signatureRequestData\",\n    value: function signatureRequestData() {\n      var hermitInputsByRedeemScript = {};\n\n      for (var i = 0; i < this.inputs.length; i++) {\n        var input = this.inputs[i];\n        var bip32Path = this.bip32Paths[i];\n        var redeemScriptHex = (0, _unchainedBitcoin.scriptToHex)((0, _unchainedBitcoin.multisigRedeemScript)(input.multisig));\n\n        if (!hermitInputsByRedeemScript[redeemScriptHex]) {\n          hermitInputsByRedeemScript[redeemScriptHex] = [redeemScriptHex, bip32Path];\n        }\n\n        hermitInputsByRedeemScript[redeemScriptHex].push({\n          txid: input.txid,\n          index: input.index,\n          amount: new _bignumber[\"default\"](input.amountSats).toNumber()\n        });\n      }\n\n      return {\n        inputs: Object.values(hermitInputsByRedeemScript),\n        outputs: this.outputs.map(function (output) {\n          return {\n            address: output.address,\n            amount: new _bignumber[\"default\"](output.amountSats).toNumber()\n          };\n        })\n      };\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(encodedString) {\n      var result = parseHermitQRCodeData(encodedString);\n      var signatures = result.signatures;\n\n      if (!signatures || signatures.length === 0) {\n        throw new Error(\"No signatures in QR code.\");\n      }\n\n      return (signatures || []).map(function (inputSignature) {\n        return \"\".concat(inputSignature, \"01\");\n      });\n    }\n  }]);\n\n  return HermitSignTransaction;\n}(HermitDisplayer);\n\nexports.HermitSignTransaction = HermitSignTransaction;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LedgerSignMultisigTransaction = exports.LedgerExportExtendedPublicKey = exports.LedgerExportPublicKey = exports.LedgerGetMetadata = exports.LedgerBitcoinInteraction = exports.LedgerDashboardInteraction = exports.LedgerInteraction = exports.LEDGER_BOTH_BUTTONS = exports.LEDGER_RIGHT_BUTTON = exports.LEDGER_LEFT_BUTTON = exports.LEDGER = void 0;\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.array.from\");\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.reflect.get\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.regexp.match\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es7.array.includes\");\n\nrequire(\"core-js/modules/es6.string.includes\");\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.date.to-string\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _unchainedBitcoin = require(\"unchained-bitcoin\");\n\nvar _interaction = require(\"./interaction\");\n\nvar _splitTransaction = require(\"@ledgerhq/hw-app-btc/lib/splitTransaction\");\n\nvar _serializeTransaction = require(\"@ledgerhq/hw-app-btc/lib/serializeTransaction\");\n\nvar _bitcoinjsLib = require(\"bitcoinjs-lib\");\n\nvar _bufferutils = require(\"bitcoinjs-lib/src/bufferutils\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n/**\n * Constant defining Ledger interactions.\n *\n * @type {string}\n * @default ledger\n */\nvar LEDGER = 'ledger';\nexports.LEDGER = LEDGER;\n\nvar TransportU2F = require(\"@ledgerhq/hw-transport-u2f\")[\"default\"];\n\nvar TransportWebUSB = require(\"@ledgerhq/hw-transport-webusb\")[\"default\"];\n\nvar LedgerBtc = require(\"@ledgerhq/hw-app-btc\")[\"default\"];\n/**\n * Constant representing the action of pushing the left button on a\n * Ledger device.\n *\n * @type {string}\n * @default 'ledger_left_button'\n */\n\n\nvar LEDGER_LEFT_BUTTON = 'ledger_left_button';\n/**\n * Constant representing the action of pushing the right button on a\n * Ledger device.\n *\n * @type {string}\n * @default 'ledger_right_button'\n */\n\nexports.LEDGER_LEFT_BUTTON = LEDGER_LEFT_BUTTON;\nvar LEDGER_RIGHT_BUTTON = 'ledger_right_button';\n/**\n * Constant representing the action of pushing both buttons on a\n * Ledger device.\n *\n * @type {string}\n * @default 'ledger_both_buttons'\n */\n\nexports.LEDGER_RIGHT_BUTTON = LEDGER_RIGHT_BUTTON;\nvar LEDGER_BOTH_BUTTONS = 'ledger_both_buttons';\n/**\n * Base class for interactions with Ledger hardware wallets.\n *\n * Subclasses must implement their own `run()` method.  They may use\n * the `withTransport` and `withApp` methods to connect to the Ledger\n * API's transport or app layers, respectively.\n *\n * Errors are not caught, so users of this class (and its subclasses)\n * should use `try...catch` as always.\n *\n * @extends {module:interaction.DirectKeystoreInteraction}\n * @example\n * import {LedgerInteraction} from \"unchained-wallets\";\n * // Simple subclass\n *\n * class SimpleLedgerInteraction extends LedgerInteraction {\n *\n *   constructor({param}) {\n *     super({});\n *     this.param =  param;\n *   }\n *\n *   async run() {\n *     return await this.withApp(async (app, transport) => {\n *       return app.doSomething(this.param); // Not a real Ledger API call\n *     });\n *   }\n * \n * }\n *\n * // usage\n * const interaction = new SimpleLedgerInteraction({param: \"foo\"});\n * const result = await interaction.run();\n * console.log(result); // whatever value `app.doSomething(...)` returns\n *\n */\n\nexports.LEDGER_BOTH_BUTTONS = LEDGER_BOTH_BUTTONS;\n\nvar LedgerInteraction =\n/*#__PURE__*/\nfunction (_DirectKeystoreIntera) {\n  _inherits(LedgerInteraction, _DirectKeystoreIntera);\n\n  function LedgerInteraction() {\n    _classCallCheck(this, LedgerInteraction);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LedgerInteraction).apply(this, arguments));\n  }\n\n  _createClass(LedgerInteraction, [{\n    key: \"messages\",\n\n    /**\n     * Adds `pending` messages at the `info` level about ensuring the\n     * device is plugged in (`device.connect`) and unlocked\n     * (`device.unlock`).  Adds an `active` message at the `info` level\n     * when communicating with the device (`device.active`).\n     *\n     * @return {module:interaction.Message[]} messages for ths interaction\n     */\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(LedgerInteraction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        text: \"Please plug in and unlock your Ledger.\",\n        code: \"device.setup\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        text: \"Communicating with Ledger...\",\n        code: \"device.active\"\n      });\n      return messages;\n    }\n    /**\n     * Can be called by a subclass during its `run()` method.\n     *\n     * Creates a transport layer connection and passes control to the\n     * `callback` function, with the transport API as the first argument\n     * to the function.\n     *\n     * See the [Ledger API]{@link https://github.com/LedgerHQ/ledgerjs} for general information or a [specific transport API]{@link https://github.com/LedgerHQ/ledgerjs/tree/master/packages/hw-transport-u2f} for examples of API calls.\n     *\n     * @param {function} callback -- asynchronous function accepting a single parameter `transport`\n     * @returns {Promise} does the work of setting up a transport connection\n     * @example\n     * async run() {\n     *   return await this.withTransport(async (transport) => {\n     *     return transport.doSomething(); // Not a real Ledger transport API call\n     *   });\n     * }\n     */\n\n  }, {\n    key: \"withTransport\",\n    value: function () {\n      var _withTransport = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(callback) {\n        var useU2F, transport, _transport;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                useU2F = this.environment.satisfies({\n                  firefox: \">70\"\n                });\n\n                if (!useU2F) {\n                  _context.next = 12;\n                  break;\n                }\n\n                _context.prev = 2;\n                _context.next = 5;\n                return TransportU2F.create();\n\n              case 5:\n                transport = _context.sent;\n                return _context.abrupt(\"return\", callback(transport));\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](2);\n                throw new Error(_context.t0.message);\n\n              case 12:\n                _context.prev = 12;\n                _context.next = 15;\n                return TransportWebUSB.create();\n\n              case 15:\n                _transport = _context.sent;\n                return _context.abrupt(\"return\", callback(_transport));\n\n              case 19:\n                _context.prev = 19;\n                _context.t1 = _context[\"catch\"](12);\n\n                if (_context.t1.message) {\n                  if (_context.t1.message === 'No device selected.') {\n                    _context.t1.message = \"Select your device in the WebUSB dialog box. Make sure it's plugged in, unlocked, and has the Bitcoin app open.\";\n                  }\n\n                  if (_context.t1.message === 'undefined is not an object (evaluating \\'navigator.usb.getDevices\\')') {\n                    _context.t1.message = \"Safari is not a supported browser.\";\n                  }\n                }\n\n                throw new Error(_context.t1.message);\n\n              case 23:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 9], [12, 19]]);\n      }));\n\n      function withTransport(_x) {\n        return _withTransport.apply(this, arguments);\n      }\n\n      return withTransport;\n    }()\n    /**\n     * Can be called by a subclass during its `run()` method.\n     *\n     * Creates a transport layer connection, initializes a bitcoin app\n     * object, and passes control to the `callback` function, with the\n     * app API as the first argument to the function and the transport\n     * API as the second.\n     *\n     * See the [Ledger API]{@link https://github.com/LedgerHQ/ledgerjs} for general information or the [bitcoin app API]{@link https://github.com/LedgerHQ/ledgerjs/tree/master/packages/hw-app-btc} for examples of API calls.\n     *\n     * @param {function} callback -- accepts two parameters, `app` and `transport`, which are the Ledger APIs for the bitcoin app and the transport layer, respectively.\n     * @returns {Promise} does the work of setting up an app instance (and transport connection)\n     * @example\n     * async run() {\n     *   return await this.withApp(async (app, transport) => {\n     *     return app.doSomething(); // Not a real Ledger bitcoin app API call\n     *   });\n     * }\n     */\n\n  }, {\n    key: \"withApp\",\n    value: function withApp(callback) {\n      return this.withTransport(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee2(transport) {\n          var app;\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  app = new LedgerBtc(transport);\n                  return _context2.abrupt(\"return\", callback(app, transport));\n\n                case 2:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function (_x2) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n    /**\n     * Close the Transport to free the interface (E.g. could be used in another tab\n     * now that the interaction is over)\n     *\n     * The way the pubkey/xpub/fingerprints are grabbed makes this a little tricky.\n     * Instead of re-writing how that works, let's just add a way to explicitly\n     * close the transport.\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"closeTransport\",\n    value: function closeTransport() {\n      return this.withTransport(\n      /*#__PURE__*/\n      function () {\n        var _ref2 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee3(transport) {\n          return regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  _context3.next = 2;\n                  return transport.close();\n\n                case 2:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3);\n        }));\n\n        return function (_x3) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n  }]);\n\n  return LedgerInteraction;\n}(_interaction.DirectKeystoreInteraction);\n/**\n * Base class for interactions which must occur when the Ledger device\n * is not in any app but in the dashboard.\n *\n * @extends {module:ledger.LedgerInteraction}\n *\n */\n\n\nexports.LedgerInteraction = LedgerInteraction;\n\nvar LedgerDashboardInteraction =\n/*#__PURE__*/\nfunction (_LedgerInteraction) {\n  _inherits(LedgerDashboardInteraction, _LedgerInteraction);\n\n  function LedgerDashboardInteraction() {\n    _classCallCheck(this, LedgerDashboardInteraction);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LedgerDashboardInteraction).apply(this, arguments));\n  }\n\n  _createClass(LedgerDashboardInteraction, [{\n    key: \"messages\",\n\n    /**\n     * Adds `pending` and `active` messages at the `info` level urging\n     * the user to be in the Ledger dashboard, not the bitcoin app\n     * (`ledger.app.dashboard`).\n     *\n     * @return {module:interaction.Message[]} messages for this interaction\n     */\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(LedgerDashboardInteraction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        text: \"Make sure you have the main Ledger dashboard open, NOT the Bitcoin app.\",\n        code: \"ledger.app.dashboard\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        text: \"Make sure you have the main Ledger dashboard open, NOT the Bitcoin app.\",\n        code: \"ledger.app.dashboard\"\n      });\n      return messages;\n    }\n  }]);\n\n  return LedgerDashboardInteraction;\n}(LedgerInteraction);\n/**\n * Base class for interactions which must occur when the Ledger device\n * is open to the bitcoin app.\n *\n * @extends {module:ledger.LedgerInteraction}\n */\n\n\nexports.LedgerDashboardInteraction = LedgerDashboardInteraction;\n\nvar LedgerBitcoinInteraction =\n/*#__PURE__*/\nfunction (_LedgerInteraction2) {\n  _inherits(LedgerBitcoinInteraction, _LedgerInteraction2);\n\n  function LedgerBitcoinInteraction() {\n    _classCallCheck(this, LedgerBitcoinInteraction);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LedgerBitcoinInteraction).apply(this, arguments));\n  }\n\n  _createClass(LedgerBitcoinInteraction, [{\n    key: \"messages\",\n\n    /**\n     * Adds `pending` and `active` messages at the `info` level urging\n     * the user to be in the bitcoin app (`ledger.app.bitcoin`).\n     *\n     * @return {module:interaction.Message[]} messages for this interaction\n     */\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(LedgerBitcoinInteraction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        text: \"Then open the Bitcoin app.\",\n        code: \"ledger.app.bitcoin\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        text: \"Make sure you have opened the Bitcoin app.\",\n        code: \"ledger.app.bitcoin\"\n      });\n      return messages;\n    }\n  }]);\n\n  return LedgerBitcoinInteraction;\n}(LedgerInteraction);\n/**\n * Returns metadata about Ledger device.\n *\n * Includes model name, firmware & MCU versions.\n *\n * @extends {module:ledger.LedgerDashboardInteraction}\n * @example\n * import {LedgerGetMetadata} from \"unchained-wallets\";\n * const interaction = new LedgerGetMetadata();\n * const result = await interaction.run();\n * console.log(result);\n * {\n *   spec: \"Nano S v1.4.2 (MCU v1.7)\",\n *   model: \"Nano S\",\n *   version: {\n *     major: \"1\",\n *     minor: \"4\",\n *     patch: \"2\",\n *     string: \"1.4.2\",\n *   },\n *   mcuVersion: {\n *     major: \"1\",\n *     minor: \"7\",\n *     string: \"1.7\",\n *   }\n * }\n *\n */\n\n\nexports.LedgerBitcoinInteraction = LedgerBitcoinInteraction;\n\nvar LedgerGetMetadata =\n/*#__PURE__*/\nfunction (_LedgerDashboardInter) {\n  _inherits(LedgerGetMetadata, _LedgerDashboardInter);\n\n  function LedgerGetMetadata() {\n    _classCallCheck(this, LedgerGetMetadata);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LedgerGetMetadata).apply(this, arguments));\n  }\n\n  _createClass(LedgerGetMetadata, [{\n    key: \"run\",\n    // FIXME entire implementation here is rickety AF.\n    value: function () {\n      var _run = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5() {\n        var _this = this;\n\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt(\"return\", this.withTransport(\n                /*#__PURE__*/\n                function () {\n                  var _ref3 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  regeneratorRuntime.mark(function _callee4(transport) {\n                    var rawResult;\n                    return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            _context4.prev = 0;\n                            transport.setScrambleKey('B0L0S');\n                            _context4.next = 4;\n                            return transport.send(0xe0, 0x01, 0x00, 0x00);\n\n                          case 4:\n                            rawResult = _context4.sent;\n                            return _context4.abrupt(\"return\", _this.parseMetadata(rawResult));\n\n                          case 6:\n                            _context4.prev = 6;\n                            _context4.next = 9;\n                            return _get(_getPrototypeOf(LedgerGetMetadata.prototype), \"closeTransport\", _this).call(_this);\n\n                          case 9:\n                            return _context4.finish(6);\n\n                          case 10:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4, null, [[0,, 6, 10]]);\n                  }));\n\n                  return function (_x4) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }()));\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function run() {\n        return _run.apply(this, arguments);\n      }\n\n      return run;\n    }()\n    /**\n     * Parses the binary data returned from the Ledger API call into a\n     * metadata object.\n     *\n     * @param {ByteArray} response - binary response data\n     * @returns {Object} - device metadata\n     */\n\n  }, {\n    key: \"parseMetadata\",\n    value: function parseMetadata(response) {\n      try {\n        // From\n        //\n        //   https://github.com/LedgerHQ/ledger-live-common/blob/master/src/hw/getVersion.js\n        //   https://github.com/LedgerHQ/ledger-live-common/blob/master/src/hw/getDeviceInfo.js\n        //   https://git.xmr.pm/LedgerHQ/ledger-live-common/commit/9ffc75acfc7f1e9aa9101a32b3e7481770fb3b89\n        var PROVIDERS = {\n          \"\": 1,\n          das: 2,\n          club: 3,\n          shitcoins: 4,\n          ee: 5\n        };\n        var ManagerAllowedFlag = 0x08;\n        var PinValidatedFlag = 0x80;\n\n        var byteArray = _toConsumableArray(response);\n\n        var data = byteArray.slice(0, byteArray.length - 2);\n        var targetIdStr = Buffer.from(data.slice(0, 4));\n        var targetId = targetIdStr.readUIntBE(0, 4);\n        var seVersionLength = data[4];\n        var seVersion = Buffer.from(data.slice(5, 5 + seVersionLength)).toString();\n        var flagsLength = data[5 + seVersionLength];\n        var flags = Buffer.from(data.slice(5 + seVersionLength + 1, 5 + seVersionLength + 1 + flagsLength));\n        var mcuVersionLength = data[5 + seVersionLength + 1 + flagsLength];\n        var mcuVersion = Buffer.from(data.slice(7 + seVersionLength + flagsLength, 7 + seVersionLength + flagsLength + mcuVersionLength));\n\n        if (mcuVersion[mcuVersion.length - 1] === 0) {\n          mcuVersion = mcuVersion.slice(0, mcuVersion.length - 1);\n        }\n\n        mcuVersion = mcuVersion.toString();\n\n        if (!seVersionLength) {\n          seVersion = \"0.0.0\";\n          flags = Buffer.allocUnsafeSlow(0);\n          mcuVersion = \"\";\n        }\n        /* eslint-disable no-unused-vars, no-bitwise */\n\n\n        var isOSU = seVersion.includes(\"-osu\");\n        var version = seVersion.replace(\"-osu\", \"\");\n        var m = seVersion.match(/([0-9]+.[0-9]+)(.[0-9]+)?(-(.*))?/);\n\n        var _ref4 = m || [],\n            _ref5 = _slicedToArray(_ref4, 5),\n            majMin = _ref5[1],\n            providerName = _ref5[4];\n\n        var providerId = PROVIDERS[providerName] || 1;\n        var isBootloader = (targetId & 0xf0000000) !== 0x30000000;\n        var flag = flags.length > 0 ? flags[0] : 0;\n        var managerAllowed = Boolean(flag & ManagerAllowedFlag);\n        var pin = Boolean(flag & PinValidatedFlag);\n        /* eslint-enable */\n\n        var _split = (version || '').split('.'),\n            _split2 = _slicedToArray(_split, 3),\n            majorVersion = _split2[0],\n            minorVersion = _split2[1],\n            patchVersion = _split2[2];\n\n        var _split3 = (mcuVersion || '').split('.'),\n            _split4 = _slicedToArray(_split3, 2),\n            mcuMajorVersion = _split4[0],\n            mcuMinorVersion = _split4[1]; // https://gist.github.com/TamtamHero/b7651ffe6f1e485e3886bf4aba673348\n        // +-----------------+------------+\n        // |    FirmWare     | Target ID  |\n        // +-----------------+------------+\n        // | Nano S <= 1.3.1 | 0x31100002 |\n        // | Nano S 1.4.x    | 0x31100003 |\n        // | Nano S 1.5.x    | 0x31100004 |\n        // |                 |            |\n        // | Blue 2.0.x      | 0x31000002 |\n        // | Blue 2.1.x      | 0x31000004 |\n        // | Blue 2.1.x V2   | 0x31010004 |\n        // |                 |            |\n        // | Nano X          | 0x33000004 |\n        // |                 |            |\n        // | MCU,any version | 0x01000001 |\n        // +-----------------+------------+\n        //\n        //  Order matters -- high to low minTargetId\n\n\n        var MODEL_RANGES = [{\n          minTargetId: 0x33000004,\n          model: \"Nano X\"\n        }, {\n          minTargetId: 0x31100002,\n          model: \"Nano S\"\n        }, {\n          minTargetId: 0x31100002,\n          model: \"Blue\"\n        }, {\n          minTargetId: 0x01000001,\n          model: \"MCU\"\n        }];\n        var model = 'Unknown';\n\n        if (targetId) {\n          for (var i = 0; i < MODEL_RANGES.length; i++) {\n            var range = MODEL_RANGES[i];\n\n            if (targetId >= range.minTargetId) {\n              model = range.model;\n              break;\n            }\n          }\n        }\n\n        var spec = \"\".concat(model, \" v\").concat(version, \" (MCU v\").concat(mcuVersion, \")\"); // if (pin) {\n        //   spec += \" w/PIN\";\n        // }\n\n        return {\n          spec: spec,\n          model: model,\n          version: {\n            major: majorVersion,\n            minor: minorVersion,\n            patch: patchVersion,\n            string: version\n          },\n          mcuVersion: {\n            major: mcuMajorVersion,\n            minor: mcuMinorVersion,\n            string: mcuVersion\n          } // pin,\n\n        };\n      } catch (e) {\n        console.error(e);\n        throw new Error(\"Unable to parse metadata from Ledger device.\");\n      }\n    }\n  }]);\n\n  return LedgerGetMetadata;\n}(LedgerDashboardInteraction);\n/**\n * Base class for interactions exporting information about an HD node\n * at a given BIP32 path.\n *\n * You may want to use `LedgerExportPublicKey` or\n * `LedgerExportExtendedPublicKey` directly.\n *\n * @extends {module:ledger.LedgerBitcoinInteraction}\n * @example\n * import {MAINNET} from \"unchained-bitcoin\";\n * import {LedgerExportHDNode} from \"unchained-wallets\";\n * const interaction = new LedgerExportHDNode({network: MAINNET, bip32Path: \"m/48'/0'/0'/2'/0\"});\n * const node = await interaction.run();\n * console.log(node);\n */\n\n\nexports.LedgerGetMetadata = LedgerGetMetadata;\n\nvar LedgerExportHDNode =\n/*#__PURE__*/\nfunction (_LedgerBitcoinInterac) {\n  _inherits(LedgerExportHDNode, _LedgerBitcoinInterac);\n\n  /**\n   * Requires a valid BIP32 path to the node to export.\n   *\n   * @param {object} options - options argument\n   * @param {string} bip32Path - the BIP32 path for the HD node\n   */\n  function LedgerExportHDNode(_ref6) {\n    var _this2;\n\n    var bip32Path = _ref6.bip32Path;\n\n    _classCallCheck(this, LedgerExportHDNode);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(LedgerExportHDNode).call(this));\n    _this2.bip32Path = bip32Path;\n    _this2.bip32ValidationErrorMessage = {};\n    var bip32PathError = (0, _unchainedBitcoin.validateBIP32Path)(bip32Path);\n\n    if (bip32PathError.length) {\n      _this2.bip32ValidationErrorMessage = {\n        text: bip32PathError,\n        code: 'ledger.bip32_path.path_error'\n      };\n    }\n\n    return _this2;\n  }\n  /**\n   * Adds messages related to the warnings Ledger devices produce on various BIP32 paths.\n   *\n   * @returns {module:interaction.Message[]} messages for this interaction\n   */\n\n\n  _createClass(LedgerExportHDNode, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(LedgerExportHDNode.prototype), \"messages\", this).call(this);\n\n      if (Object.entries(this.bip32ValidationErrorMessage).length) {\n        messages.push({\n          state: _interaction.PENDING,\n          level: _interaction.ERROR,\n          code: this.bip32ValidationErrorMessage.code,\n          text: this.bip32ValidationErrorMessage.text\n        });\n      }\n\n      return messages;\n    }\n    /**\n     * Returns whether or not the Ledger device will display a warning\n     * to the user about an unusual BIP32 path.\n     *\n     * A \"usual\" BIP32 path is exactly 5 segments long.  The segments\n     * have the following constraints:\n     *\n     * - Segment 1: Must be equal to `44'`\n     * - Segment 2: Can have any value\n     * - Segment 3: Must be between `0'` and `100'`\n     * - Segment 4: Must be equal to `0`\n     * - Segment 5: Must be between `0 and 50000`\n     *\n     * Any other kind of path is considered unusual and will trigger the\n     * warning.\n     *\n     * @returns {boolean} whether a BIP32 path warning will be displayed\n     */\n\n  }, {\n    key: \"hasBIP32PathWarning\",\n    value: function hasBIP32PathWarning() {\n      // 0 -> 44'\n      // 1 -> anything\n      // 2 -> 0' - 100'\n      // 3 -> 0\n      // 4 -> 0 - 50000\n      var indices = (0, _unchainedBitcoin.bip32PathToSequence)(this.bip32Path);\n      var hardened0 = (0, _unchainedBitcoin.hardenedBIP32Index)(0);\n      var hardened44 = (0, _unchainedBitcoin.hardenedBIP32Index)(44);\n      var hardened100 = (0, _unchainedBitcoin.hardenedBIP32Index)(100);\n\n      if (indices.length !== 5) {\n        return true;\n      }\n\n      if (indices[0] !== hardened44) {\n        return true;\n      }\n\n      if (indices[2] < hardened0 || indices[2] > hardened100) {\n        return true;\n      }\n\n      if (indices[3] !== 0) {\n        return true;\n      }\n\n      return indices[4] < 0 || indices[4] > 50000;\n    }\n    /**\n     * Get fingerprint from parent pubkey. This is useful for generating xpubs\n     * which need the fingerprint of the parent pubkey\n     *\n     * Optionally get root fingerprint for device. This is useful for keychecks and necessary\n     * for PSBTs\n     *\n     * @param {boolean} root fingerprint or not\n     * @returns {string} fingerprint\n     */\n\n  }, {\n    key: \"getFingerprint\",\n    value: function () {\n      var _getFingerprint = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee6() {\n        var root,\n            pubkey,\n            fp,\n            _args6 = arguments;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                root = _args6.length > 0 && _args6[0] !== undefined ? _args6[0] : false;\n\n                if (!root) {\n                  _context6.next = 7;\n                  break;\n                }\n\n                _context6.next = 4;\n                return this.getMultisigRootPublicKey();\n\n              case 4:\n                _context6.t0 = _context6.sent;\n                _context6.next = 10;\n                break;\n\n              case 7:\n                _context6.next = 9;\n                return this.getParentPublicKey();\n\n              case 9:\n                _context6.t0 = _context6.sent;\n\n              case 10:\n                pubkey = _context6.t0;\n                fp = (0, _unchainedBitcoin.getFingerprintFromPublicKey)(pubkey); // If asked for a root XFP, zero pad it to length of 8.\n\n                return _context6.abrupt(\"return\", root ? (0, _unchainedBitcoin.fingerprintToFixedLengthHex)(fp) : fp);\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function getFingerprint() {\n        return _getFingerprint.apply(this, arguments);\n      }\n\n      return getFingerprint;\n    }()\n  }, {\n    key: \"getParentPublicKey\",\n    value: function getParentPublicKey() {\n      var _this3 = this;\n\n      return this.withApp(\n      /*#__PURE__*/\n      function () {\n        var _ref7 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee7(app) {\n          var parentPath;\n          return regeneratorRuntime.wrap(function _callee7$(_context7) {\n            while (1) {\n              switch (_context7.prev = _context7.next) {\n                case 0:\n                  parentPath = (0, _unchainedBitcoin.getParentBIP32Path)(_this3.bip32Path);\n                  _context7.next = 3;\n                  return app.getWalletPublicKey(parentPath);\n\n                case 3:\n                  return _context7.abrupt(\"return\", _context7.sent.publicKey);\n\n                case 4:\n                case \"end\":\n                  return _context7.stop();\n              }\n            }\n          }, _callee7);\n        }));\n\n        return function (_x5) {\n          return _ref7.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"getMultisigRootPublicKey\",\n    value: function getMultisigRootPublicKey() {\n      return this.withApp(\n      /*#__PURE__*/\n      function () {\n        var _ref8 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee8(app) {\n          return regeneratorRuntime.wrap(function _callee8$(_context8) {\n            while (1) {\n              switch (_context8.prev = _context8.next) {\n                case 0:\n                  _context8.next = 2;\n                  return app.getWalletPublicKey();\n\n                case 2:\n                  return _context8.abrupt(\"return\", _context8.sent.publicKey);\n\n                case 3:\n                case \"end\":\n                  return _context8.stop();\n              }\n            }\n          }, _callee8);\n        }));\n\n        return function (_x6) {\n          return _ref8.apply(this, arguments);\n        };\n      }());\n    }\n    /**\n     * See {@link https://github.com/LedgerHQ/ledgerjs/tree/master/packages/hw-app-btc#getwalletpublickey}.\n     *\n     * @returns {object} the HD node object.\n     */\n\n  }, {\n    key: \"run\",\n    value: function run() {\n      var _this4 = this;\n\n      return this.withApp(\n      /*#__PURE__*/\n      function () {\n        var _ref9 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee9(app) {\n          return regeneratorRuntime.wrap(function _callee9$(_context9) {\n            while (1) {\n              switch (_context9.prev = _context9.next) {\n                case 0:\n                  return _context9.abrupt(\"return\", app.getWalletPublicKey(_this4.bip32Path));\n\n                case 1:\n                case \"end\":\n                  return _context9.stop();\n              }\n            }\n          }, _callee9);\n        }));\n\n        return function (_x7) {\n          return _ref9.apply(this, arguments);\n        };\n      }());\n    }\n  }]);\n\n  return LedgerExportHDNode;\n}(LedgerBitcoinInteraction);\n/**\n * Returns the public key at a given BIP32 path.\n *\n * @extends {module:ledger.LedgerExportHDNode}\n * @example\n * import {LedgerExportPublicKey} from \"unchained-wallets\";\n * const interaction = new LedgerExportPublicKey({bip32Path: \"m/48'/0'/0'/2'/0\"});\n * const publicKey = await interaction.run();\n * console.log(publicKey);\n * // \"03...\"\n */\n\n\nvar LedgerExportPublicKey =\n/*#__PURE__*/\nfunction (_LedgerExportHDNode) {\n  _inherits(LedgerExportPublicKey, _LedgerExportHDNode);\n\n  /**\n   * @param {string} bip32Path - the BIP32 path for the HD node\n   * @param {boolean} includeXFP - return xpub with root fingerprint concatenated\n   */\n  function LedgerExportPublicKey(_ref10) {\n    var _this5;\n\n    var bip32Path = _ref10.bip32Path,\n        _ref10$includeXFP = _ref10.includeXFP,\n        includeXFP = _ref10$includeXFP === void 0 ? false : _ref10$includeXFP;\n\n    _classCallCheck(this, LedgerExportPublicKey);\n\n    _this5 = _possibleConstructorReturn(this, _getPrototypeOf(LedgerExportPublicKey).call(this, {\n      bip32Path: bip32Path\n    }));\n    _this5.includeXFP = includeXFP;\n    return _this5;\n  }\n  /**\n   * Parses out and compresses the public key from the response of\n   * `LedgerExportHDNode`.\n   *\n   * @returns {string|Object} (compressed) public key in hex (returns object if asked to include root fingerprint)\n   */\n\n\n  _createClass(LedgerExportPublicKey, [{\n    key: \"run\",\n    value: function () {\n      var _run2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee10() {\n        var result, publicKey, rootFingerprint;\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.prev = 0;\n                _context10.next = 3;\n                return _get(_getPrototypeOf(LedgerExportPublicKey.prototype), \"run\", this).call(this);\n\n              case 3:\n                result = _context10.sent;\n                publicKey = this.parsePublicKey((result || {}).publicKey);\n\n                if (!this.includeXFP) {\n                  _context10.next = 10;\n                  break;\n                }\n\n                _context10.next = 8;\n                return this.getFingerprint(true);\n\n              case 8:\n                rootFingerprint = _context10.sent;\n                return _context10.abrupt(\"return\", {\n                  rootFingerprint: rootFingerprint,\n                  publicKey: publicKey\n                });\n\n              case 10:\n                return _context10.abrupt(\"return\", publicKey);\n\n              case 11:\n                _context10.prev = 11;\n                _context10.next = 14;\n                return _get(_getPrototypeOf(LedgerExportPublicKey.prototype), \"closeTransport\", this).call(this);\n\n              case 14:\n                return _context10.finish(11);\n\n              case 15:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this, [[0,, 11, 15]]);\n      }));\n\n      function run() {\n        return _run2.apply(this, arguments);\n      }\n\n      return run;\n    }()\n    /**\n     * Compress the given public key.\n     *\n     * @param {string} publicKey - the uncompressed public key in hex\n     * @returns {string} - the compressed public key in hex\n     *\n     */\n\n  }, {\n    key: \"parsePublicKey\",\n    value: function parsePublicKey(publicKey) {\n      if (publicKey) {\n        try {\n          return (0, _unchainedBitcoin.compressPublicKey)(publicKey);\n        } catch (e) {\n          console.error(e);\n          throw new Error(\"Unable to compress public key from Ledger device.\");\n        }\n      } else {\n        throw new Error(\"Received no public key from Ledger device.\");\n      }\n    }\n  }]);\n\n  return LedgerExportPublicKey;\n}(LedgerExportHDNode);\n/**\n * Class for wallet extended public key (xpub) interaction at a given BIP32 path.\n * @extends {module:ledger.LedgerExportHDNode}\n */\n\n\nexports.LedgerExportPublicKey = LedgerExportPublicKey;\n\nvar LedgerExportExtendedPublicKey =\n/*#__PURE__*/\nfunction (_LedgerExportHDNode2) {\n  _inherits(LedgerExportExtendedPublicKey, _LedgerExportHDNode2);\n\n  /**\n   * @param {string} bip32Path path\n   * @param {string} network bitcoin network\n   * @param {boolean} includeXFP - return xpub with root fingerprint concatenated\n   */\n  function LedgerExportExtendedPublicKey(_ref11) {\n    var _this6;\n\n    var bip32Path = _ref11.bip32Path,\n        network = _ref11.network,\n        includeXFP = _ref11.includeXFP;\n\n    _classCallCheck(this, LedgerExportExtendedPublicKey);\n\n    _this6 = _possibleConstructorReturn(this, _getPrototypeOf(LedgerExportExtendedPublicKey).call(this, {\n      bip32Path: bip32Path\n    }));\n    _this6.network = network;\n    _this6.includeXFP = includeXFP;\n    return _this6;\n  }\n\n  _createClass(LedgerExportExtendedPublicKey, [{\n    key: \"messages\",\n    value: function messages() {\n      return _get(_getPrototypeOf(LedgerExportExtendedPublicKey.prototype), \"messages\", this).call(this);\n    }\n    /**\n     * Retrieve extended public key (xpub) from Ledger device for a given BIP32 path\n     * @example\n     * import {LedgerExportExtendedPublicKey} from \"unchained-wallets\";\n     * const interaction = new LedgerExportExtendedPublicKey({network, bip32Path});\n     * const xpub = await interaction.run();\n     * console.log(xpub);\n     *\n     * @returns {string|Object} the extended public key (returns object if asked to include root fingerprint)\n     */\n\n  }, {\n    key: \"run\",\n    value: function () {\n      var _run3 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee11() {\n        var walletPublicKey, fingerprint, xpub, rootFingerprint;\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.prev = 0;\n                _context11.next = 3;\n                return _get(_getPrototypeOf(LedgerExportExtendedPublicKey.prototype), \"run\", this).call(this);\n\n              case 3:\n                walletPublicKey = _context11.sent;\n                _context11.next = 6;\n                return this.getFingerprint();\n\n              case 6:\n                fingerprint = _context11.sent;\n                xpub = (0, _unchainedBitcoin.deriveExtendedPublicKey)(this.bip32Path, walletPublicKey.publicKey, walletPublicKey.chainCode, fingerprint, this.network);\n\n                if (!this.includeXFP) {\n                  _context11.next = 13;\n                  break;\n                }\n\n                _context11.next = 11;\n                return this.getFingerprint(true);\n\n              case 11:\n                rootFingerprint = _context11.sent;\n                return _context11.abrupt(\"return\", {\n                  rootFingerprint: rootFingerprint,\n                  xpub: xpub\n                });\n\n              case 13:\n                return _context11.abrupt(\"return\", xpub);\n\n              case 14:\n                _context11.prev = 14;\n                _context11.next = 17;\n                return _get(_getPrototypeOf(LedgerExportExtendedPublicKey.prototype), \"closeTransport\", this).call(this);\n\n              case 17:\n                return _context11.finish(14);\n\n              case 18:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this, [[0,, 14, 18]]);\n      }));\n\n      function run() {\n        return _run3.apply(this, arguments);\n      }\n\n      return run;\n    }()\n  }]);\n\n  return LedgerExportExtendedPublicKey;\n}(LedgerExportHDNode);\n/**\n * Returns a signature for a bitcoin transaction with inputs from one\n * or many multisig addresses.\n *\n * - `inputs` is an array of `UTXO` objects from `unchained-bitcoin`\n * - `outputs` is an array of `TransactionOutput` objects from `unchained-bitcoin`\n * - `bip32Paths` is an array of (`string`) BIP32 paths, one for each input, identifying the path on this device to sign that input with\n *\n * @extends {module:ledger.LedgerBitcoinInteraction}\n * @example\n * import {\n *   generateMultisigFromHex, TESTNET, P2SH,\n * } from \"unchained-bitcoin\";\n * import {LedgerSignMultisigTransaction} from \"unchained-wallets\";\n * const redeemScript = \"5...ae\";\n * const inputs = [\n *   {\n *     txid: \"8d276c76b3550b145e44d35c5833bae175e0351b4a5c57dc1740387e78f57b11\",\n *     index: 1,\n *     multisig: generateMultisigFromHex(TESTNET, P2SH, redeemScript),\n *     amountSats: '1234000'\n *   },\n *   // other inputs...\n * ];\n * const outputs = [\n *   {\n *     amountSats: '1299659',\n *     address: \"2NGHod7V2TAAXC1iUdNmc6R8UUd4TVTuBmp\"\n *   },\n *   // other outputs...\n * ];\n * const interaction = new LedgerSignMultisigTransaction({\n *   network: TESTNET,\n *   inputs,\n *   outputs,\n *   bip32Paths: [\"m/45'/0'/0'/0\", // add more, 1 per input],\n * });\n * const signature = await interaction.run();\n * console.log(signatures);\n * // [\"ababab...\", // 1 per input]\n */\n\n\nexports.LedgerExportExtendedPublicKey = LedgerExportExtendedPublicKey;\n\nvar LedgerSignMultisigTransaction =\n/*#__PURE__*/\nfunction (_LedgerBitcoinInterac2) {\n  _inherits(LedgerSignMultisigTransaction, _LedgerBitcoinInterac2);\n\n  /**\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   * @param {array<object>} options.inputs - inputs for the transaction\n   * @param {array<object>} options.outputs - outputs for the transaction\n   * @param {array<string>} options.bip32Paths - BIP32 paths\n   */\n  function LedgerSignMultisigTransaction(_ref12) {\n    var _this7;\n\n    var network = _ref12.network,\n        inputs = _ref12.inputs,\n        outputs = _ref12.outputs,\n        bip32Paths = _ref12.bip32Paths,\n        psbt = _ref12.psbt;\n\n    _classCallCheck(this, LedgerSignMultisigTransaction);\n\n    _this7 = _possibleConstructorReturn(this, _getPrototypeOf(LedgerSignMultisigTransaction).call(this));\n    _this7.network = network;\n    _this7.psbt = _bitcoinjsLib.Psbt.fromBase64(psbt, {\n      network: (0, _unchainedBitcoin.networkData)(network)\n    });\n    _this7.inputs = _this7.psbt.txInputs.map(function (input, index) {\n      var dataInput = _this7.psbt.data.inputs[index];\n      var fundingTxHex = dataInput.nonWitnessUtxo.toString('hex');\n\n      var fundingTx = _bitcoinjsLib.Transaction.fromHex(fundingTxHex);\n\n      var multisig = (0, _unchainedBitcoin.generateMultisigFromHex)((0, _unchainedBitcoin.networkData)(network), _unchainedBitcoin.P2SH, dataInput.redeemScript.toString('hex'));\n      return {\n        amountSats: fundingTx.outs[input.index].value,\n        index: input.index,\n        transactionHex: fundingTxHex,\n        txid: (0, _bufferutils.reverseBuffer)(input.hash).toString('hex'),\n        multisig: multisig\n      };\n    });\n    _this7.outputs = _this7.psbt.txOutputs.map(function (output) {\n      return {\n        address: output.address,\n        amountSats: output.value\n      };\n    });\n    _this7.bip32Paths = bip32Paths; // console.log(this.psbt);\n    // console.log(this.bip32Paths);\n    // console.log(this.psbt.data.inputs[0].nonWitnessUtxo.toString('hex'));\n    // console.log(this.psbt.data.inputs[0].redeemScript.toString('hex'));\n    // console.log(this.psbt.txInputs[0].hash.toString('hex'));\n    //\n    // console.log(fundingTx.outs);\n    // console.log(fundingTx.outputs);\n    // console.log(fundingTx.outs[0].value);\n    // console.log(this.psbt.txInputs);\n\n    console.log(inputs);\n    console.log(_this7.inputs); // console.log(this.psbt.txOutputs);\n\n    console.log(outputs);\n    console.log(_this7.outputs);\n    return _this7;\n  }\n  /**\n   * Adds messages describing the signing flow.\n   *\n   * @returns {module:interaction.Message[]} messages for this interaction\n   */\n\n\n  _createClass(LedgerSignMultisigTransaction, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(LedgerSignMultisigTransaction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.WARNING,\n        code: \"ledger.sign.delay\",\n        text: \"Your Ledger device may take up to several minutes to process a transaction with many inputs.\",\n        preProcessingTime: this.preProcessingTime(),\n        postProcessingTime: this.postProcessingTime()\n      });\n\n      if (this.anySegwitInputs()) {\n        messages.push({\n          state: _interaction.ACTIVE,\n          level: _interaction.INFO,\n          code: \"ledger.sign\",\n          version: \"<1.6.0\",\n          text: \"Your Ledger will ask you to \\\"Confirm transaction\\\" and display each output amount and address followed by the the fee amount.\",\n          action: LEDGER_RIGHT_BUTTON\n        });\n        messages.push({\n          state: _interaction.ACTIVE,\n          level: _interaction.INFO,\n          code: \"ledger.sign\",\n          version: \">=1.6.0\",\n          text: \"Confirm each output on your Ledger device and approve the transaction.\",\n          messages: [{\n            text: \"Your Ledger will ask you to \\\"Review transaction\\\".\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"For each output, your Ledger device will display the output amount...\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"...followed by the output address in several parts\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will display the transaction fees.\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will ask you to \\\"Accept and send\\\".\",\n            action: LEDGER_BOTH_BUTTONS\n          }]\n        });\n      } else {\n        messages.push({\n          state: _interaction.ACTIVE,\n          level: _interaction.INFO,\n          code: \"ledger.sign\",\n          version: \"<1.6.0\",\n          text: \"Confirm each output on your Ledger device and approve the transaction.\",\n          messages: [{\n            text: \"For each output, your Ledger will display the output amount and address for you to confirm.\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will ask if you want to \\\"Confirm the transaction\\\".  Due to a bug in the Ledger software, your device may display the transaction fee as \\\"UNKNOWN\\\".\",\n            action: LEDGER_RIGHT_BUTTON\n          }]\n        });\n        messages.push({\n          state: _interaction.ACTIVE,\n          level: _interaction.INFO,\n          code: \"ledger.sign\",\n          version: \">=1.6.0\",\n          text: \"Confirm each output on your Ledger device and approve the transaction.\",\n          messages: [{\n            text: \"For each output, your Ledger will ask you to \\\"Review output\\\".\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will display the output amount.\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will display the output address in several parts.\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will ask if you want to \\\"Accept\\\" the output.\",\n            action: LEDGER_BOTH_BUTTONS\n          }, {\n            text: \"Your Ledger will ask if you want to \\\"Confirm the transaction\\\".\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Due to a bug in the Ledger software, your device will display the transaction fee as \\\"UNKNOWN\\\".\",\n            action: LEDGER_RIGHT_BUTTON\n          }, {\n            text: \"Your Ledger will ask you to \\\"Accept and send\\\".\",\n            action: LEDGER_BOTH_BUTTONS\n          }]\n        });\n      }\n\n      return messages;\n    }\n  }, {\n    key: \"preProcessingTime\",\n    value: function preProcessingTime() {\n      // FIXME\n      return 10;\n    }\n  }, {\n    key: \"postProcessingTime\",\n    value: function postProcessingTime() {\n      // FIXME\n      return 10;\n    }\n    /**\n     * See {@link https://github.com/LedgerHQ/ledgerjs/tree/master/packages/hw-app-btc#signp2shtransaction}.\n     *\n     * Input signatures produced will always have a trailing `...01`\n     * {@link https://bitcoin.org/en/glossary/sighash-all SIGHASH_ALL}\n     * byte.\n     *\n     * @returns {string[]} array of input signatures, one per input\n     */\n\n  }, {\n    key: \"run\",\n    value: function run() {\n      var _this8 = this;\n\n      return this.withApp(\n      /*#__PURE__*/\n      function () {\n        var _ref13 = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee12(app, transport) {\n          var transactionSignature;\n          return regeneratorRuntime.wrap(function _callee12$(_context12) {\n            while (1) {\n              switch (_context12.prev = _context12.next) {\n                case 0:\n                  _context12.prev = 0;\n                  // FIXME: Explain the rationale behind this choice.\n                  transport.setExchangeTimeout(20000 * _this8.outputs.length);\n                  _context12.next = 4;\n                  return app.signP2SHTransaction({\n                    inputs: _this8.ledgerInputs(),\n                    associatedKeysets: _this8.ledgerKeysets(),\n                    outputScriptHex: _this8.ledgerOutputScriptHex(),\n                    lockTime: 0,\n                    // locktime, 0 is no locktime\n                    sigHashType: 1,\n                    // sighash type, 1 is SIGHASH_ALL\n                    segwit: _this8.anySegwitInputs(),\n                    transactionVersion: 1 // tx version\n\n                  });\n\n                case 4:\n                  transactionSignature = _context12.sent;\n                  return _context12.abrupt(\"return\", _this8.parse(transactionSignature));\n\n                case 6:\n                  _context12.prev = 6;\n                  transport.close();\n                  return _context12.finish(6);\n\n                case 9:\n                case \"end\":\n                  return _context12.stop();\n              }\n            }\n          }, _callee12, null, [[0,, 6, 9]]);\n        }));\n\n        return function (_x8, _x9) {\n          return _ref13.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(transactionSignature) {\n      // Ledger signatures include the SIGHASH byte (0x01) if signing for P2SH-P2WSH or P2WSH ...\n      // but NOT for P2SH ... This function should always return the signature with SIGHASH byte appended.\n      return (transactionSignature || []).map(function (inputSignature) {\n        return \"\".concat((0, _unchainedBitcoin.signatureNoSighashType)(inputSignature), \"01\");\n      });\n    }\n  }, {\n    key: \"ledgerInputs\",\n    value: function ledgerInputs() {\n      return this.inputs.map(function (input) {\n        var addressType = (0, _unchainedBitcoin.multisigAddressType)(input.multisig);\n        var inputTransaction = (0, _splitTransaction.splitTransaction)(input.transactionHex, true); // FIXME: should the 2nd parameter here always be true?\n\n        var scriptFn = addressType === _unchainedBitcoin.P2SH ? _unchainedBitcoin.multisigRedeemScript : _unchainedBitcoin.multisigWitnessScript;\n        var scriptHex = (0, _unchainedBitcoin.scriptToHex)(scriptFn(input.multisig));\n        return [inputTransaction, input.index, scriptHex]; // can add sequence number for RBF as an additional element\n      });\n    }\n  }, {\n    key: \"ledgerKeysets\",\n    value: function ledgerKeysets() {\n      var _this9 = this;\n\n      return this.bip32Paths.map(function (bip32Path) {\n        return _this9.ledgerBIP32Path(bip32Path);\n      });\n    }\n  }, {\n    key: \"ledgerOutputScriptHex\",\n    value: function ledgerOutputScriptHex() {\n      var txHex = (0, _unchainedBitcoin.unsignedMultisigTransaction)(this.network, this.inputs, this.outputs).toHex();\n      var splitTx = (0, _splitTransaction.splitTransaction)(txHex, this.anySegwitInputs());\n      return (0, _serializeTransaction.serializeTransactionOutputs)(splitTx).toString('hex');\n    }\n  }, {\n    key: \"ledgerBIP32Path\",\n    value: function ledgerBIP32Path(bip32Path) {\n      return bip32Path.split(\"/\").slice(1).join(\"/\");\n    }\n  }, {\n    key: \"anySegwitInputs\",\n    value: function anySegwitInputs() {\n      for (var i = 0; i < this.inputs.length; i++) {\n        var input = this.inputs[i];\n        var addressType = (0, _unchainedBitcoin.multisigAddressType)(input.multisig);\n\n        if (addressType === _unchainedBitcoin.P2SH_P2WSH || addressType === _unchainedBitcoin.P2WSH) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }]);\n\n  return LedgerSignMultisigTransaction;\n}(LedgerBitcoinInteraction);\n\nexports.LedgerSignMultisigTransaction = LedgerSignMultisigTransaction;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.trezorCoin = trezorCoin;\nexports.TrezorConfirmMultisigAddress = exports.TrezorSignMultisigTransaction = exports.TrezorExportExtendedPublicKey = exports.TrezorExportPublicKey = exports.TrezorExportHDNode = exports.TrezorGetMetadata = exports.TrezorInteraction = exports.TREZOR_PUSH_AND_HOLD_BUTTON = exports.TREZOR_BOTH_BUTTONS = exports.TREZOR_RIGHT_BUTTON = exports.TREZOR_LEFT_BUTTON = exports.TREZOR = void 0;\n\nrequire(\"core-js/modules/es6.object.define-properties\");\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"core-js/modules/es6.reflect.get\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.string.repeat\");\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.date.to-string\");\n\nrequire(\"core-js/modules/es6.array.fill\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _bignumber = _interopRequireDefault(require(\"bignumber.js\"));\n\nvar _unchainedBitcoin = require(\"unchained-bitcoin\");\n\nvar _bitcoinjsLib = _interopRequireDefault(require(\"bitcoinjs-lib\"));\n\nvar _interaction = require(\"./interaction\");\n\nvar _index = require(\"./index\");\n\nvar _ADDRESS_SCRIPT_TYPES;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * Constant defining Trezor interactions.\n *\n * @type {string}\n * @default trezor\n */\nvar TREZOR = 'trezor';\nexports.TREZOR = TREZOR;\n\nvar TrezorConnect = require(\"trezor-connect\")[\"default\"];\n\nvar ADDRESS_SCRIPT_TYPES = (_ADDRESS_SCRIPT_TYPES = {}, _defineProperty(_ADDRESS_SCRIPT_TYPES, _unchainedBitcoin.P2SH, 'SPENDMULTISIG'), _defineProperty(_ADDRESS_SCRIPT_TYPES, _unchainedBitcoin.P2SH_P2WSH, 'SPENDP2SHWITNESS'), _defineProperty(_ADDRESS_SCRIPT_TYPES, _unchainedBitcoin.P2WSH, 'SPENDWITNESS'), _ADDRESS_SCRIPT_TYPES);\n/**\n * Constant representing the action of pushing the left button on a\n * Trezor device.\n *\n * @type {string}\n * @default 'trezor_left_button'\n */\n\nvar TREZOR_LEFT_BUTTON = 'trezor_left_button';\n/**\n * Constant representing the action of pushing the right button on a\n * Trezor device.\n *\n * @type {string}\n * @default 'trezor_right_button'\n */\n\nexports.TREZOR_LEFT_BUTTON = TREZOR_LEFT_BUTTON;\nvar TREZOR_RIGHT_BUTTON = 'trezor_right_button';\n/**\n * Constant representing the action of pushing both buttons on a\n * Trezor device.\n *\n * @type {string}\n * @default 'trezor_both_buttons'\n */\n\nexports.TREZOR_RIGHT_BUTTON = TREZOR_RIGHT_BUTTON;\nvar TREZOR_BOTH_BUTTONS = 'trezor_both_buttons';\n/**\n * Constant representing the action of pushing and holding the Confirm\n * button on a Trezor model T device.\n *\n * @type {string}\n * @default 'trezor_push_and_hold_button'\n */\n\nexports.TREZOR_BOTH_BUTTONS = TREZOR_BOTH_BUTTONS;\nvar TREZOR_PUSH_AND_HOLD_BUTTON = 'trezor_push_and_hold_button'; // eslint-disable-next-line no-process-env\n\nexports.TREZOR_PUSH_AND_HOLD_BUTTON = TREZOR_PUSH_AND_HOLD_BUTTON;\nvar TREZOR_DEV = undefined;\n\ntry {\n  if (TREZOR_DEV) TrezorConnect.init({\n    connectSrc: 'https://localhost:8088/',\n    lazyLoad: true,\n    manifest: {\n      email: \"help@unchained-capital.com\",\n      appUrl: \"https://github.com/unchained-capital/unchained-wallets\"\n    }\n  });else TrezorConnect.manifest({\n    email: \"help@unchained-capital.com\",\n    appUrl: \"https://github.com/unchained-capital/unchained-wallets\"\n  });\n} catch (e) {\n  // We hit this if we run this code outside of a browser, for example\n  // during unit testing.\n\n  /* eslint-disable no-process-env */\n  if (undefined !== 'test') {\n    /* eslint-enable */\n    console.error(\"Unable to call TrezorConnect.manifest.\");\n  }\n}\n/**\n * Base class for interactions with Trezor hardware wallets.\n *\n * Assumes we are using TrezorConnect to talk to the device.\n *\n * Subclasses *must* implement a method `this.connectParams` which\n * returns a 2-element array.  The first element of this array should\n * be a `TrezorConnect` method to use (e.g. -\n * `TrezorConnect.getAddress`).  The second element of this array\n * should be the parameters to pass to the given `TrezorConnect`\n * method.\n *\n * Errors thrown when calling TrezorConnect are not caught, so users\n * of this class (and its subclasses) should use `try...catch` as\n * always.\n *\n * Unsuccessful responses (the request succeeded but the Trezor device\n * returned an error message) are intercepted and thrown as errors.\n * This allows upstream `try...catch` blocks to intercept errors &\n * failures uniformly.\n *\n * Subclasses *may* implement the `parse(payload)` method which\n * accepts the response payload object and returns the relevant data.\n *\n * Subclasses will also want to implement a `messages()` method to\n * manipulate the messages returned to the user for each interaction.\n *\n * @extends {module:interaction.DirectKeystoreInteraction}\n * @example\n * import {TrezorInteraction} from \"unchained-wallets\";\n * // Simple subclass\n *\n * class SimpleTrezorInteraction extends TrezorInteraction {\n *\n *   constructor({network, param}) {\n *     super({network});\n *     this.param =  param;\n *   }\n *\n *   connectParams() {\n *     return [\n *       TrezorConnect.doSomething, // Not a real TrezorConnect function...\n *       {\n *         // Many Trezor methods require the `coin` parameter.  The\n *         // value of `this.trezorCoin` is set appropriately based on the\n *         // `network` provided in the constructor.\n *         coin: this.trezorCoin,\n *\n *         // Pass whatever arguments are required\n *         // by the TrezorConnect function being called.\n *         param: this.param,\n *         // ...\n *       }\n *     ];\n *   }\n *\n *   parse(payload) {\n *     return payload.someValue;\n *   }\n *\n * }\n * // usage\n * import {MAINNET} from \"unchained-bitcoin\";\n * const interaction = new SimpleTrezorInteraction({network: MAINNET, param: \"foo\"});\n * const result = await interaction.run();\n * console.log(result); // someValue from payload\n */\n\n\nvar TrezorInteraction =\n/*#__PURE__*/\nfunction (_DirectKeystoreIntera) {\n  _inherits(TrezorInteraction, _DirectKeystoreIntera);\n\n  /**\n   * Trezor interactions require knowing the bitcoin network they are\n   * for.\n   *\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   */\n  function TrezorInteraction(_ref) {\n    var _this;\n\n    var network = _ref.network;\n\n    _classCallCheck(this, TrezorInteraction);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TrezorInteraction).call(this));\n    _this.network = network;\n    _this.trezorCoin = trezorCoin(network);\n    return _this;\n  }\n  /**\n   * Default messages are added asking the user to plug in their\n   * Trezor device (`device.connect`) and about the TrezorConnect\n   * popups (`trezor.connect.generic`).\n   *\n   * Subclasses should override this method and add their own messages\n   * (don't forget to call `super()`).\n   *\n   * @returns {module:interaction.Message[]} messages for this interaction\n   */\n\n\n  _createClass(TrezorInteraction, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(TrezorInteraction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        version: \"One\",\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        text: \"Make sure your Trezor device is plugged in.\",\n        code: \"device.connect\"\n      });\n      messages.push({\n        version: \"T\",\n        state: _interaction.PENDING,\n        level: _interaction.INFO,\n        text: \"Make sure your Trezor device is plugged in and unlocked.\",\n        code: \"device.connect\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        text: \"Your browser should now open a new window to Trezor Connect. Ensure you have enabled popups for this site.\",\n        code: \"trezor.connect.generic\"\n      });\n      return messages;\n    }\n    /**\n     * Awaits the call of `this.method`, passing in the output of\n     * `this.params()`.\n     *\n     * If the call returns but is unsuccessful (`result.success`) is\n     * false, will throw the returned error message.  If some other\n     * error is thrown, it will not be caught.\n     *\n     * Otherwise it returns the result of passing `result.payload` to\n     * `this.parse`.\n     *\n     * @returns {Promise} handles the work of calling TrezorConnect\n     */\n\n  }, {\n    key: \"run\",\n    value: function () {\n      var _run = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this$connectParams, _this$connectParams2, method, params, result;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this$connectParams = this.connectParams(), _this$connectParams2 = _slicedToArray(_this$connectParams, 2), method = _this$connectParams2[0], params = _this$connectParams2[1];\n                _context.next = 3;\n                return method(params);\n\n              case 3:\n                result = _context.sent;\n\n                if (result.success) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new Error(result.payload.error);\n\n              case 6:\n                return _context.abrupt(\"return\", this.parse(result.payload));\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function run() {\n        return _run.apply(this, arguments);\n      }\n\n      return run;\n    }()\n    /**\n     * Override this method in a subclass to return a 2-element array.\n     *\n     * The first element should be a functin to call, typically a\n     * `TrezorConnect` method, e.g. `TrezorConnect.getAddress`.\n     *\n     * The second element should be the parameters to pass to this\n     * function.\n     *\n     * By default, the function passed just throws an error.\n     *\n     * @returns {Array<function,Object>} the TrezorConnect parameters\n     */\n\n  }, {\n    key: \"connectParams\",\n    value: function connectParams() {\n      return [function () {\n        throw new Error(\"Override the `connectParams` method on a subclass of TrezorInteraction.\");\n      }, {}];\n    }\n    /**\n     * Override this method in a subclass to parse the payload of a\n     * successful response from the device.\n     *\n     * By default, the entire payload is returned.\n     *\n     * @param {Object} payload - the raw payload from the device response\n     * @returns {Object} - relevant or formatted data built from the raw payload\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(payload) {\n      return payload;\n    }\n  }]);\n\n  return TrezorInteraction;\n}(_interaction.DirectKeystoreInteraction);\n/**\n * Returns metadata about Trezor device.\n *\n * Includes model name, device label, firmware version, &\n * PIN/passphrase enablement.\n *\n * @extends {module:trezor.TrezorInteraction}\n * @example\n * import {TrezorGetMetadata} from \"unchained-wallets\";\n * const interaction = new TrezorGetMetadata();\n * const result = await interaction.run();\n * console.log(result);\n * {\n *   spec: \"Model 1 v1.8.3 w/PIN\",\n *   model: \"Model 1\",\n *   version: {\n *     major: 1,\n *     minor: 8,\n *     patch: 3,\n *     string: \"1.8.3\",\n *   },\n *   label: \"My Trezor\",\n *   pin: true,\n *   passphrase: false,\n * }\n */\n\n\nexports.TrezorInteraction = TrezorInteraction;\n\nvar TrezorGetMetadata =\n/*#__PURE__*/\nfunction (_TrezorInteraction) {\n  _inherits(TrezorGetMetadata, _TrezorInteraction);\n\n  /**\n   * This class doesn't actually require a `network`.\n   *\n   * @constructor\n   */\n  function TrezorGetMetadata() {\n    _classCallCheck(this, TrezorGetMetadata);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TrezorGetMetadata).call(this, {}));\n  }\n  /**\n   * It is underdocumented, but TrezorConnect does support the\n   * `getFeatures` API call.\n   *\n   * See {@link https://github.com/trezor/connect/blob/v8/src/js/core/methods/GetFeatures.js}.\n   *\n   * @returns {Array<function, Object>} TrezorConnect parameters\n   */\n\n\n  _createClass(TrezorGetMetadata, [{\n    key: \"connectParams\",\n    value: function connectParams() {\n      return [TrezorConnect.getFeatures, {}];\n    }\n    /**\n     * Parses Trezor device featuress into an appropriate metadata\n     * shape.\n     *\n     * @param {Object} payload - the original payload from the device response\n     * @returns {Object} device metadata & features\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(payload) {\n      // Example result:\n      //\n      // {\n      //   bootloader_hash: \"5112...846e9\"\n      //   bootloader_mode: null\n      //   device_id: \"BDF9...F198\"\n      //   firmware_present: null\n      //   flags: 0\n      //   fw_major: null\n      //   fw_minor: null\n      //   fw_patch: null\n      //   fw_vendor: null\n      //   fw_vendor_keys: null\n      //   imported: false\n      //   initialized: true\n      //   label: \"My Trezor\"\n      //   language: null\n      //   major_version: 1\n      //   minor_version: 6\n      //   model: \"1\"\n      //   needs_backup: false\n      //   no_backup: null\n      //   passphrase_cached: false\n      //   passphrase_protection: false\n      //   patch_version: 3\n      //   pin_cached: true\n      //   pin_protection: true\n      //   revision: \"ef8...862d7\"\n      //   unfinished_backup: null\n      //   vendor: \"bitcointrezor.com\"\n      // }\n      var major_version = payload.major_version,\n          minor_version = payload.minor_version,\n          patch_version = payload.patch_version,\n          label = payload.label,\n          model = payload.model,\n          pin_protection = payload.pin_protection,\n          passphrase_protection = payload.passphrase_protection;\n      var spec = \"Model \".concat(model, \" v.\").concat(major_version, \".\").concat(minor_version, \".\").concat(patch_version);\n\n      if (pin_protection) {\n        spec += \" w/PIN\";\n      }\n\n      if (passphrase_protection) {\n        spec += \" w/PASS\";\n      }\n\n      return {\n        spec: spec,\n        model: \"Model \".concat(model),\n        version: {\n          major: major_version,\n          minor: minor_version,\n          patch: patch_version,\n          string: \"\".concat(major_version, \".\").concat(minor_version, \".\").concat(patch_version)\n        },\n        label: label,\n        pin: pin_protection,\n        passphrase: passphrase_protection\n      };\n    }\n  }]);\n\n  return TrezorGetMetadata;\n}(TrezorInteraction);\n/**\n * Base class for interactions exporting information about an HD node\n * at a given BIP32 path.\n *\n * You may want to use `TrezorExportPublicKey` or\n * `TrezorExportExtendedPublicKey` directly.\n *\n * @extends {module:trezor.TrezorInteraction}\n * @example\n * import {MAINNET} from \"unchained-bitcoin\";\n * import {TrezorExportHDNode} from \"unchained-wallets\";\n * const interaction = new TrezorExportHDNode({network: MAINNET, bip32Path: \"m/48'/0'/0'/2'/0\"});\n * const node = await interaction.run();\n * console.log(node); // {publicKey: \"\", xpub: \"\", ...}\n *\n */\n\n\nexports.TrezorGetMetadata = TrezorGetMetadata;\n\nvar TrezorExportHDNode =\n/*#__PURE__*/\nfunction (_TrezorInteraction2) {\n  _inherits(TrezorExportHDNode, _TrezorInteraction2);\n\n  /**\n   * Requires a BIP32 path to the node to export as well as which network.\n   *\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   * @param {string} bip32Path - the BIP32 path for the HD node\n   * @param {boolean} includeXFP - return xpub with root fingerprint concatenated\n   */\n  function TrezorExportHDNode(_ref2) {\n    var _this2;\n\n    var network = _ref2.network,\n        bip32Path = _ref2.bip32Path,\n        includeXFP = _ref2.includeXFP;\n\n    _classCallCheck(this, TrezorExportHDNode);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(TrezorExportHDNode).call(this, {\n      network: network\n    }));\n    _this2.bip32Path = bip32Path;\n    _this2.includeXFP = includeXFP;\n    _this2.bip32ValidationErrorMessage = {};\n    var bip32PathError = (0, _unchainedBitcoin.validateBIP32Path)(bip32Path);\n\n    if (bip32PathError.length) {\n      _this2.bip32ValidationErrorMessage = {\n        text: bip32PathError,\n        code: 'trezor.bip32_path.path_error'\n      };\n    }\n\n    return _this2;\n  }\n  /**\n   * Adds messages related to warnings Trezor devices make depending\n   * on the BIP32 path passed.\n   *\n   * @returns {module:interaction.Message[]} messages for this interaction\n   */\n\n\n  _createClass(TrezorExportHDNode, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(TrezorExportHDNode.prototype), \"messages\", this).call(this);\n\n      var bip32PathSegments = (this.bip32Path || '').split('/');\n\n      if (bip32PathSegments.length < 4) {\n        // m, 45', 0', 0', ...\n        messages.push({\n          state: _interaction.PENDING,\n          level: _interaction.ERROR,\n          text: \"BIP32 path must be at least depth 3.\",\n          code: \"trezor.bip32_path.minimum\"\n        });\n      }\n\n      if (Object.entries(this.bip32ValidationErrorMessage).length) {\n        messages.push({\n          state: _interaction.PENDING,\n          level: _interaction.ERROR,\n          code: this.bip32ValidationErrorMessage.code,\n          text: this.bip32ValidationErrorMessage.text\n        });\n      }\n\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        text: \"Confirm in the Trezor Connect window that you want to 'Export public key'. You may be prompted to enter your PIN.\",\n        code: \"trezor.connect.export_hdnode\"\n      });\n      return messages;\n    }\n  }, {\n    key: \"extractDetailsFromPayload\",\n    value: function extractDetailsFromPayload(_ref3) {\n      var payload = _ref3.payload,\n          pubkey = _ref3.pubkey;\n\n      if (payload.length !== 2) {\n        throw new Error(\"Payload does not have two responses.\");\n      }\n\n      var keyMaterial = '';\n      var rootFingerprint = null;\n\n      for (var i = 0; i < payload.length; i++) {\n        // Find the payload with bip32 = MULTISIG_ROOT to get xfp\n        if (payload[i].serializedPath === _index.MULTISIG_ROOT) {\n          var fp = payload[i].fingerprint;\n          rootFingerprint = (0, _unchainedBitcoin.fingerprintToFixedLengthHex)(fp);\n        } else {\n          keyMaterial = pubkey ? payload[i].publicKey : payload[i].xpub;\n        }\n      }\n\n      return {\n        rootFingerprint: rootFingerprint,\n        keyMaterial: keyMaterial\n      };\n    }\n    /**\n     * See {@link https://github.com/trezor/connect/blob/v8/docs/methods/getPublicKey.md}.\n     *\n     * @returns {Array<function,Object>} TrezorConnect parameters\n     */\n\n  }, {\n    key: \"connectParams\",\n    value: function connectParams() {\n      if (this.includeXFP) {\n        return [TrezorConnect.getPublicKey, {\n          bundle: [{\n            path: this.bip32Path\n          }, {\n            path: _index.MULTISIG_ROOT\n          }],\n          coin: this.trezorCoin,\n          crossChain: true\n        }];\n      }\n\n      return [TrezorConnect.getPublicKey, {\n        path: this.bip32Path,\n        coin: this.trezorCoin,\n        crossChain: true\n      }];\n    }\n  }]);\n\n  return TrezorExportHDNode;\n}(TrezorInteraction);\n/**\n * Returns the public key at a given BIP32 path.\n *\n * @extends {module:trezor.TrezorExportHDNode}\n * @example\n * import {MAINNET} from \"unchained-bitcoin\";\n * import {TrezorExportPublicKey} from \"unchained-wallets\";\n * const interaction = new TrezorExportPublicKey({network: MAINNET, bip32Path: \"m/48'/0'/0'/2'/0\"});\n * const publicKey = await interaction.run();\n * console.log(publicKey);\n * // \"03...\"\n */\n\n\nexports.TrezorExportHDNode = TrezorExportHDNode;\n\nvar TrezorExportPublicKey =\n/*#__PURE__*/\nfunction (_TrezorExportHDNode) {\n  _inherits(TrezorExportPublicKey, _TrezorExportHDNode);\n\n  function TrezorExportPublicKey(_ref4) {\n    var _this3;\n\n    var network = _ref4.network,\n        bip32Path = _ref4.bip32Path,\n        includeXFP = _ref4.includeXFP;\n\n    _classCallCheck(this, TrezorExportPublicKey);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(TrezorExportPublicKey).call(this, {\n      network: network,\n      bip32Path: bip32Path,\n      includeXFP: includeXFP\n    }));\n    _this3.includeXFP = includeXFP;\n    return _this3;\n  }\n  /**\n   * Parses the public key from the HD node response.\n   *\n   * @param {object} payload - the original payload from the device response\n   * @returns {string|Object} the (compressed) public key in hex or Object if root fingerprint requested\n   */\n\n\n  _createClass(TrezorExportPublicKey, [{\n    key: \"parse\",\n    value: function parse(payload) {\n      if (this.includeXFP) {\n        var _this$extractDetailsF = this.extractDetailsFromPayload({\n          payload: payload,\n          pubkey: true\n        }),\n            rootFingerprint = _this$extractDetailsF.rootFingerprint,\n            keyMaterial = _this$extractDetailsF.keyMaterial;\n\n        return {\n          rootFingerprint: rootFingerprint,\n          publicKey: keyMaterial\n        };\n      }\n\n      return payload.publicKey;\n    }\n  }]);\n\n  return TrezorExportPublicKey;\n}(TrezorExportHDNode);\n/**\n * Returns the extended public key at a given BIP32 path.\n *\n * @extends {module:trezor.TrezorExportHDNode}\n * @example\n * import {MAINNET} from \"unchained-bitcoin\";\n * import {TrezorExportExtendedPublicKey} from \"unchained-wallets\";\n * const interaction = new TrezorExportExtendedPublicKey({network: MAINNET, bip32Path: \"m/48'/0'/0'\"});\n * const xpub = await interaction.run();\n * console.log(xpub);\n * // \"xpub...\"\n */\n\n\nexports.TrezorExportPublicKey = TrezorExportPublicKey;\n\nvar TrezorExportExtendedPublicKey =\n/*#__PURE__*/\nfunction (_TrezorExportHDNode2) {\n  _inherits(TrezorExportExtendedPublicKey, _TrezorExportHDNode2);\n\n  function TrezorExportExtendedPublicKey(_ref5) {\n    var _this4;\n\n    var network = _ref5.network,\n        bip32Path = _ref5.bip32Path,\n        includeXFP = _ref5.includeXFP;\n\n    _classCallCheck(this, TrezorExportExtendedPublicKey);\n\n    _this4 = _possibleConstructorReturn(this, _getPrototypeOf(TrezorExportExtendedPublicKey).call(this, {\n      network: network,\n      bip32Path: bip32Path,\n      includeXFP: includeXFP\n    }));\n    _this4.includeXFP = includeXFP;\n    return _this4;\n  }\n  /**\n   * Parses the extended public key from the HD node response.\n   *\n   * If asking for XFP, return object with xpub and the root fingerprint.\n   *\n   * @param {object} payload the original payload from the device response\n   * @returns {string|Object} the extended public key (returns object if asked to include root fingerprint)\n   */\n\n\n  _createClass(TrezorExportExtendedPublicKey, [{\n    key: \"parse\",\n    value: function parse(payload) {\n      if (this.includeXFP) {\n        var _this$extractDetailsF2 = this.extractDetailsFromPayload({\n          payload: payload,\n          pubkey: false\n        }),\n            rootFingerprint = _this$extractDetailsF2.rootFingerprint,\n            keyMaterial = _this$extractDetailsF2.keyMaterial;\n\n        return {\n          rootFingerprint: rootFingerprint,\n          xpub: keyMaterial\n        };\n      }\n\n      return payload.xpub;\n    }\n  }]);\n\n  return TrezorExportExtendedPublicKey;\n}(TrezorExportHDNode);\n/**\n * Returns a signature for a bitcoin transaction with inputs from one\n * or many multisig addresses.\n *\n * - `inputs` is an array of `UTXO` objects from `unchained-bitcoin`\n * - `outputs` is an array of `TransactionOutput` objects from `unchained-bitcoin`\n * - `bip32Paths` is an array of (`string`) BIP32 paths, one for each input, identifying the path on this device to sign that input with\n *\n * @example\n * import {\n *   generateMultisigFromHex, TESTNET, P2SH,\n * } from \"unchained-bitcoin\";\n * import {TrezorSignMultisigTransaction} from \"unchained-wallets\";\n * const redeemScript = \"5...ae\";\n * const inputs = [\n *   {\n *     txid: \"8d276c76b3550b145e44d35c5833bae175e0351b4a5c57dc1740387e78f57b11\",\n *     index: 1,\n *     multisig: generateMultisigFromHex(TESTNET, P2SH, redeemScript),\n *     amountSats: '1234000'\n *   },\n *   // other inputs...\n * ];\n * const outputs = [\n *   {\n *     amountSats: '1299659',\n *     address: \"2NGHod7V2TAAXC1iUdNmc6R8UUd4TVTuBmp\"\n *   },\n *   // other outputs...\n * ];\n * const interaction = new TrezorSignMultisigTransaction({\n *   network: TESTNET,\n *   inputs,\n *   outputs,\n *   bip32Paths: [\"m/45'/0'/0'/0\", // add more, 1 per input],\n * });\n * const signature = await interaction.run();\n * console.log(signatures);\n * // [\"ababab...\", // 1 per input]\n * @extends {module:trezor.TrezorInteraction}\n */\n\n\nexports.TrezorExportExtendedPublicKey = TrezorExportExtendedPublicKey;\n\nvar TrezorSignMultisigTransaction =\n/*#__PURE__*/\nfunction (_TrezorInteraction3) {\n  _inherits(TrezorSignMultisigTransaction, _TrezorInteraction3);\n\n  /**\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   * @param {UTXO[]} options.inputs - inputs for the transaction\n   * @param {TransactionOutput[]} options.outputs - outputs for the transaction\n   * @param {string[]} options.bip32Paths - BIP32 paths on this device to sign with, one per each input\n   */\n  function TrezorSignMultisigTransaction(_ref6) {\n    var _this5;\n\n    var network = _ref6.network,\n        inputs = _ref6.inputs,\n        outputs = _ref6.outputs,\n        bip32Paths = _ref6.bip32Paths;\n\n    _classCallCheck(this, TrezorSignMultisigTransaction);\n\n    _this5 = _possibleConstructorReturn(this, _getPrototypeOf(TrezorSignMultisigTransaction).call(this, {\n      network: network\n    }));\n    _this5.inputs = inputs;\n    _this5.outputs = outputs;\n    _this5.bip32Paths = bip32Paths;\n    return _this5;\n  }\n  /**\n   * Adds messages describing the signing flow.\n   *\n   * @returns {module:interaction.Message[]} messages for this interaction\n   */\n\n\n  _createClass(TrezorSignMultisigTransaction, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(TrezorSignMultisigTransaction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        text: \"Confirm in the Trezor Connect window that you want to 'Sign \".concat(this.network, \" transaction'.  You may be prompted to enter your PIN.\"),\n        code: \"trezor.connect.sign\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        version: \"One\",\n        text: \"Confirm each output on your Trezor device and approve the transaction.\",\n        messages: [{\n          text: \"For each output, your Trezor device will display the output amount and address.\",\n          action: TREZOR_RIGHT_BUTTON\n        }, {\n          text: \"Your Trezor device will display the total output amounts and fee amount.\",\n          action: TREZOR_RIGHT_BUTTON\n        }],\n        code: \"trezor.sign\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        version: \"T\",\n        text: \"Confirm each output on your Trezor device and approve the transaction.\",\n        messages: [{\n          text: \"For each input, your Trezor device will display a \\\"Confirm path\\\" dialogue displaying the input BIP32 path.  It is safe to continue\",\n          action: TREZOR_RIGHT_BUTTON\n        }, {\n          text: \"For each output, your Trezor device will display a \\\"Confirm sending\\\" dialogue displaying the output amount and address.\",\n          action: TREZOR_RIGHT_BUTTON\n        }, {\n          text: \"Your Trezor device will display the \\\"Confirm transaction\\\" dialogue displaying the total output amount and fee amount.\",\n          action: TREZOR_PUSH_AND_HOLD_BUTTON\n        }],\n        code: \"trezor.sign\"\n      });\n      return messages;\n    }\n    /**\n     * See {@link https://github.com/trezor/connect/blob/v8/docs/methods/signTransaction.md}.\n     *\n     * @returns {Array<function, Object>} TrezorConnect parameters\n     */\n\n  }, {\n    key: \"connectParams\",\n    value: function connectParams() {\n      var _this6 = this;\n\n      return [TrezorConnect.signTransaction, {\n        inputs: this.inputs.map(function (input, inputIndex) {\n          return trezorInput(input, _this6.bip32Paths[inputIndex]);\n        }),\n        outputs: this.outputs.map(function (output) {\n          return trezorOutput(output);\n        }),\n        coin: this.trezorCoin\n      }];\n    }\n    /**\n     * Parses the signature out of the response payload.\n     *\n     * Ensures each input's signature hasa a trailing `...01` {@link https://bitcoin.org/en/glossary/sighash-all SIGHASH_ALL} byte.\n     *\n     * @param {Object} payload - the original payload from the device response\n     * @returns {string[]} array of input signatures, one per input\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(payload) {\n      // While we don't anticipate Trezor making firmware changes to include SIGHASH bytes with signatures,\n      // let's go ahead and make sure that we're not double adding the SIGHASH byte in case they do in the future.\n      return (payload.signatures || []).map(function (inputSignature) {\n        return \"\".concat((0, _unchainedBitcoin.signatureNoSighashType)(inputSignature), \"01\");\n      });\n    }\n  }]);\n\n  return TrezorSignMultisigTransaction;\n}(TrezorInteraction);\n/**\n * Shows a multisig address on the device and prompts the user to\n * confirm it.\n * If the optional publicKey parameter is used, the public key at\n * the given BIP32 path is checked, returning an error if they don't match.\n *\n * Without the publicKey parameter, this function simply checks that the\n * public key at the given BIP32 path is in the redeemscript (with\n * validation on-device.\n *\n * @extends {module:trezor.TrezorInteraction}\n * @example\n * import {\n *   generateMultisigFromPublicKeys, MAINNET, P2SH,\n * } from \"unchained-bitcoin\";\n * import {TrezorConfirmMultisigAddress} from \"unchained-wallets\";\n * const multisig = generateMultisigFromPublicKeys(MAINNET, P2SH, 2, \"03a...\", \"03b...\");\n * const interaction = new TrezorConfirmMultisigAddress({network: MAINNET, bip32Path: \"m/45'/0'/0'/0/0\", multisig});\n * await interaction.run();\n */\n\n\nexports.TrezorSignMultisigTransaction = TrezorSignMultisigTransaction;\n\nvar TrezorConfirmMultisigAddress =\n/*#__PURE__*/\nfunction (_TrezorInteraction4) {\n  _inherits(TrezorConfirmMultisigAddress, _TrezorInteraction4);\n\n  /**\n   * Most of the information required to confirm a multisig address\n   * lives in the `Multisig` object from `unchained-bitcoin`.\n   *\n   * @param {object} options - options argument\n   * @param {string} options.network - bitcoin network\n   * @param {string} options.bip32Path - BIP32 path to the public key on this device used in the multisig address\n   * @param {Multisig} options.multisig - multisig object\n   * @param {string} options.publicKey - optional public key to confirm\n   */\n  function TrezorConfirmMultisigAddress(_ref7) {\n    var _this7;\n\n    var network = _ref7.network,\n        bip32Path = _ref7.bip32Path,\n        multisig = _ref7.multisig,\n        publicKey = _ref7.publicKey;\n\n    _classCallCheck(this, TrezorConfirmMultisigAddress);\n\n    _this7 = _possibleConstructorReturn(this, _getPrototypeOf(TrezorConfirmMultisigAddress).call(this, {\n      network: network\n    }));\n    _this7.bip32Path = bip32Path;\n    _this7.multisig = multisig;\n    _this7.publicKey = publicKey;\n    return _this7;\n  }\n  /**\n   * Adds messages about BIP32 path warnings.\n   *\n   * @returns {module:interaction.Message[]} messages for this interaction\n   *\n   */\n\n\n  _createClass(TrezorConfirmMultisigAddress, [{\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(TrezorConfirmMultisigAddress.prototype), \"messages\", this).call(this);\n\n      if (this.publicKey) {\n        messages.push({\n          state: _interaction.ACTIVE,\n          level: _interaction.INFO,\n          text: \"Confirm in the Trezor Connect window that you want to \\u2018Export multiple \".concat(this.trezorCoin, \" addresses\\u2019. You may be prompted to enter your PIN. You may also receive a warning about your selected BIP32 path.\"),\n          code: \"trezor.connect.confirm_address\"\n        });\n      } else {\n        messages.push({\n          state: _interaction.ACTIVE,\n          level: _interaction.INFO,\n          text: \"Confirm in the Trezor Connect window that you want to 'Export \".concat(this.trezorCoin, \" address'.  You may be prompted to enter your PIN.\"),\n          code: \"trezor.connect.confirm_address\"\n        });\n      }\n\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        version: \"One\",\n        text: \"It is safe to continue and confirm the address on your Trezor device.\",\n        messages: [// FIXME this only shows up on P2SH?\n        {\n          text: \"Your Trezor device may display a warning \\\"Wrong address path for selected coin\\\".  It is safe to continue\",\n          action: TREZOR_RIGHT_BUTTON\n        }, {\n          text: \"Your Trezor device will display the multisig address and BIP32 path.\",\n          action: TREZOR_RIGHT_BUTTON\n        }],\n        code: \"trezor.confirm_address\"\n      });\n      messages.push({\n        state: _interaction.ACTIVE,\n        level: _interaction.INFO,\n        version: \"T\",\n        text: \"Confirm the addresss on your Trezor device.\",\n        messages: [{\n          text: \"For each signer in your quorum, your Trezor device will display a \\\"Confirm path\\\" dialogue displaying the signer's BIP32 path.  It is safe to continue\",\n          action: TREZOR_RIGHT_BUTTON\n        }, {\n          text: \"Your Trezor device will display the multisig address.\",\n          action: TREZOR_RIGHT_BUTTON\n        }],\n        code: \"trezor.confirm_address\"\n      });\n      return messages;\n    }\n    /**\n     * See {@link https://github.com/trezor/connect/blob/v8/docs/methods/getAddress.md}.\n     *\n     * @returns {Array<function, Object>} TrezorConnect parameters\n     */\n\n  }, {\n    key: \"connectParams\",\n    value: function connectParams() {\n      if (this.publicKey) {\n        return [TrezorConnect.getAddress, {\n          bundle: [{\n            path: this.bip32Path,\n            showOnTrezor: false,\n            coin: this.trezorCoin,\n            crossChain: true\n          }, {\n            path: this.bip32Path,\n            address: (0, _unchainedBitcoin.multisigAddress)(this.multisig),\n            showOnTrezor: true,\n            coin: this.trezorCoin,\n            crossChain: true,\n            multisig: {\n              m: (0, _unchainedBitcoin.multisigRequiredSigners)(this.multisig),\n              pubkeys: (0, _unchainedBitcoin.multisigPublicKeys)(this.multisig).map(function (publicKey) {\n                return trezorPublicKey(publicKey);\n              })\n            },\n            scriptType: ADDRESS_SCRIPT_TYPES[(0, _unchainedBitcoin.multisigAddressType)(this.multisig)]\n          }]\n        }];\n      } else {\n        return [TrezorConnect.getAddress, {\n          path: this.bip32Path,\n          address: (0, _unchainedBitcoin.multisigAddress)(this.multisig),\n          showOnTrezor: true,\n          coin: this.trezorCoin,\n          crossChain: true,\n          multisig: {\n            m: (0, _unchainedBitcoin.multisigRequiredSigners)(this.multisig),\n            pubkeys: (0, _unchainedBitcoin.multisigPublicKeys)(this.multisig).map(function (publicKey) {\n              return trezorPublicKey(publicKey);\n            })\n          },\n          scriptType: ADDRESS_SCRIPT_TYPES[(0, _unchainedBitcoin.multisigAddressType)(this.multisig)]\n        }];\n      }\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(payload) {\n      if (!this.publicKey) {\n        return payload;\n      }\n\n      var keyPair = _bitcoinjsLib[\"default\"].ECPair.fromPublicKey(Buffer.from(this.publicKey, 'hex'));\n\n      var _bitcoin$payments$p2p = _bitcoinjsLib[\"default\"].payments.p2pkh({\n        pubkey: keyPair.publicKey,\n        network: (0, _unchainedBitcoin.networkData)(this.network)\n      }),\n          address = _bitcoin$payments$p2p.address;\n\n      if (address !== payload[0].address && address !== payload[1].address) {\n        throw new Error(\"Wrong public key specified\");\n      }\n\n      return payload;\n    }\n  }]);\n\n  return TrezorConfirmMultisigAddress;\n}(TrezorInteraction);\n/**\n * Returns the Trezor API version of the given network.\n *\n * @param {string} network - bitcoin network\n * @returns {string} Trezor API spelling for this network\n */\n\n\nexports.TrezorConfirmMultisigAddress = TrezorConfirmMultisigAddress;\n\nfunction trezorCoin(network) {\n  return network === _unchainedBitcoin.MAINNET ? \"Bitcoin\" : \"Testnet\";\n}\n\nfunction trezorInput(input, bip32Path) {\n  var requiredSigners = (0, _unchainedBitcoin.multisigRequiredSigners)(input.multisig);\n  var publicKeys = (0, _unchainedBitcoin.multisigPublicKeys)(input.multisig);\n  var addressType = (0, _unchainedBitcoin.multisigAddressType)(input.multisig);\n  var spendType = ADDRESS_SCRIPT_TYPES[addressType];\n  return _objectSpread({\n    script_type: spendType,\n    multisig: {\n      m: requiredSigners,\n      pubkeys: publicKeys.map(function (publicKey) {\n        return trezorPublicKey(publicKey);\n      }),\n      signatures: Array(publicKeys.length).fill('')\n    },\n    prev_hash: input.txid,\n    prev_index: input.index,\n    address_n: (0, _unchainedBitcoin.bip32PathToSequence)(bip32Path)\n  }, input.amountSats && {\n    amount: (0, _bignumber[\"default\"])(input.amountSats).toString()\n  });\n}\n\nfunction trezorPublicKey(publicKey) {\n  return {\n    address_n: [],\n    node: {\n      // FIXME are all these 0's OK?\n      depth: 0,\n      child_num: 0,\n      fingerprint: 0,\n      chain_code: '0'.repeat(64),\n      public_key: publicKey\n    }\n  };\n}\n\nfunction trezorOutput(output) {\n  return {\n    amount: (0, _bignumber[\"default\"])(output.amountSats).toFixed(0),\n    address: output.address,\n    script_type: 'PAYTOADDRESS'\n  };\n}","module.exports = \"data:image/png;base64,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\"","import BigNumber from \"bignumber.js\";\nimport { satoshisToBitcoins } from \"unchained-bitcoin\";\n\nexport const DUST_IN_SATOSHIS = 546;\nexport const DUST_IN_BTC = satoshisToBitcoins(BigNumber(DUST_IN_SATOSHIS));\nexport const DEFAULT_PREFIX = \"m\";\nexport const CHANGE_INDEX = \"/1\";\nexport const DEFAULT_CHANGE_PREFIX = DEFAULT_PREFIX + CHANGE_INDEX;\n","import React from \"react\";\n\nexport default (url, text) => (\n  <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n    {text}\n  </a>\n);\n","import BigNumber from \"bignumber.js\";\nimport { estimateMultisigTransactionFee } from \"unchained-bitcoin/lib/fees\";\n\nimport { DUST_IN_SATOSHIS } from \"./constants\";\n\nexport { default as externalLink } from \"./ExternalLink\";\nexport { default as wrapText } from \"./WrapText\";\n\nexport function validatePositiveInteger(numberString) {\n  if (\n    numberString === null ||\n    numberString === undefined ||\n    numberString === \"\"\n  ) {\n    return \"Cannot be blank.\";\n  }\n  const number = parseInt(numberString, 10);\n  if (\n    Number.isNaN(number) ||\n    number.toString().length !== numberString.length ||\n    number <= 0\n  ) {\n    return \"Must be a positive whole number.\";\n  }\n\n  return \"\";\n}\n\nexport function downloadFile(body, filename) {\n  const blob = new Blob([body], { type: \"text/plain\" });\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveBlob(blob, filename);\n  } else {\n    const elem = window.document.createElement(\"a\");\n    elem.href = window.URL.createObjectURL(blob);\n    elem.download = filename;\n    document.body.appendChild(elem);\n    elem.click();\n    document.body.removeChild(elem);\n  }\n}\n\n/**\n * @description A utility function to determine if a spend is a valid\n * \"spend all\" transaction,\n * @param {Object} options - set of options used to determine if is spend all\n * @param {Object[]} options.outputs\n * @param {string} options.outputs[].amountSats\n * @param {string} options.walletBalance\n * @param {string} options.feesPerByteInSatoshis\n * @param {number} options.numInputs\n * @param {string} options.addressType\n * @param {number} options.m\n * @param {number} options.n\n * @returns {boolean} whether or not conditions are met to be \"spendAll\"\n */\nexport function isSpendAll(options) {\n  const config = {\n    ...options,\n    numOutputs: options.outputs.length,\n  };\n  const estimatedFees = estimateMultisigTransactionFee(config).toNumber();\n  const outputTotal = config.outputs.reduce((balance, output) => {\n    return balance.plus(output.amountSats);\n  }, new BigNumber(0));\n\n  if (outputTotal.plus(estimatedFees).isGreaterThan(options.walletBalance))\n    throw new Error(\"Wallet balance is insufficient to fund transaction\");\n\n  // if the difference between walletBalance minus fees\n  // and the output total is less than or equal to dust\n  // then this is a spend all.\n  return new BigNumber(options.walletBalance)\n    .minus(estimatedFees)\n    .minus(outputTotal)\n    .isLessThanOrEqualTo(DUST_IN_SATOSHIS);\n}\n\n/**\n * @description a naive coin selection algorithm that goes through available,\n * spendable slices, adding them together to sufficiently fund a tx with a\n * given set of outputs and address/wallet type.\n * **IMPORTANT**: this assumes no change output in the set of outputs given.\n * and it will indicate if the returned set of utxos sufficiently cover the output\n * and fees w/o need of change.\n * @param {Object} options - set of options used to determine if is spend all\n * @param {Object[]} options.outputs\n * @param {string} options.feesPerByteInSatoshis\n * @param {number} options.slices - spendable slices to select utxos from\n * @param {string} options.addressType\n * @param {number} options.m\n * @param {number} options.n\n * @returns {Array.<Object[]|boolean>} a tuple where the first index is the list of\n * inputs and the second index is a bool representing whether a change address is needed\n */\nexport function naiveCoinSelection(options) {\n  const { slices, outputs } = options;\n  const { count: numInputs, balance: walletBalance } = slices.reduce(\n    ({ count, balance }, slice) => {\n      return {\n        count: count + slice.utxos.length,\n        balance: slice.balanceSats.plus(balance),\n      };\n    },\n    {\n      count: 0,\n      balance: new BigNumber(0),\n    }\n  );\n\n  const outputTotal = outputs.reduce(\n    (total, output) => total.plus(output.amountSats),\n    new BigNumber(0)\n  );\n\n  const selectedUtxos = [];\n  let changeRequired;\n  let inputTotal = new BigNumber(0);\n\n  // checking if is a spendall to confirm that change is not required\n  const spendAll = isSpendAll({\n    ...options,\n    walletBalance,\n    numInputs,\n  });\n\n  if (spendAll) changeRequired = false;\n\n  // loop through each slice\n  for (let i = 0; i < slices.length; i += 1) {\n    const slice = slices[i];\n    const { utxos } = slice;\n    // add each utxo from the slice to the inputs array\n    for (let j = 0; j < utxos.length; j += 1) {\n      selectedUtxos.push({\n        ...utxos[j],\n        multisig: slice.multisig,\n        bip32Path: slice.bip32Path,\n        change: slice.change,\n      });\n    }\n    // add slice's balance to the inputs total\n    inputTotal = inputTotal.plus(slice.balanceSats);\n\n    // we can skip the following checks if it is a spend all tx\n    if (!spendAll) {\n      // calculate fees with a change address and without\n      // to evaluate if we need to keep going or not\n      const feesWithoutChange = estimateMultisigTransactionFee({\n        ...options,\n        numInputs: selectedUtxos.length,\n        numOutputs: outputs.length,\n      });\n      const feesWithChange = estimateMultisigTransactionFee({\n        ...options,\n        numInputs: selectedUtxos.length,\n        numOutputs: outputs.length + 1,\n      });\n\n      const inputOutputDiff = inputTotal.minus(outputTotal);\n      if (\n        inputOutputDiff\n          .minus(feesWithoutChange)\n          .isLessThanOrEqualTo(DUST_IN_SATOSHIS) &&\n        inputOutputDiff.minus(feesWithoutChange).isGreaterThanOrEqualTo(0)\n      ) {\n        // if value of inputs covers outputs and fees w/o change output and\n        // has only dust left over, then no change is required and we're done\n        changeRequired = false;\n        break;\n      } else if (inputOutputDiff.isGreaterThan(feesWithChange)) {\n        // value of current inputs covers outputs and fees w/ change output\n        // so our tx is funded but needs change.\n        changeRequired = true;\n        break;\n      }\n      // if inputs don't cover outputs plus change output and fees,\n      // then the loop will continue to add more inputs\n    }\n  }\n  return [selectedUtxos, changeRequired];\n}\n","import React from \"react\";\n\n// Components\nimport { Card, CardHeader, CardContent } from \"@material-ui/core\";\n\nconst Disclaimer = () => (\n  <Card>\n    <CardHeader title=\"Disclaimer\" />\n    <CardContent>\n      <small>\n        This application is in “alpha” state and is presented for evaluation and\n        testing only. It is provided “as is,” and any express or implied\n        warranties, including but not limited to the implied warranties of\n        merchantability and fitness for a particular purpose, are disclaimed. By\n        using this application, you accept all risks of such use, including full\n        responsibility for any direct or indirect loss of any kind resulting\n        from the use of this application, which may involve complete loss of any\n        Bitcoin or other coins associated with addresses used with this\n        application. In no event shall Unchained Capital, Inc., its employees\n        and affiliates, or developers of this application be liable for any\n        direct, indirect, incidental, special, exemplary, or consequential\n        damages (including, but not limited to, procurement of substitute goods\n        or services; loss of use, data, or profits; or business interruption)\n        however caused and on any theory of liability, whether in contract,\n        strict liability, or tort (including negligence or otherwise) arising in\n        any way out of the use of this application, even if advised of the\n        possibility of such damage.\n      </small>\n    </CardContent>\n  </Card>\n);\n\nexport default Disclaimer;\n","import React from \"react\";\n\n// Components\nimport {\n  Box,\n  Typography,\n  CardHeader,\n  CardContent,\n  Grid,\n  Card,\n  Button,\n  List,\n  ListItem,\n  ListItemText,\n  ListItemIcon,\n  CardActions,\n} from \"@material-ui/core\";\nimport {\n  Description,\n  GitHub,\n  YouTube,\n  BugReport,\n  Speed,\n  AccountBalanceWallet,\n  SportsVolleyball,\n} from \"@material-ui/icons\";\nimport { externalLink } from \"../utils\";\nimport Disclaimer from \"./Disclaimer\";\n\nconst Help = () => (\n  <div>\n    <Box mt={4} mb={2}>\n      <Typography variant=\"h2\">Welcome to Caravan!</Typography>\n    </Box>\n\n    <Grid container spacing={3}>\n      <Grid container item md={8} spacing={2} direction=\"column\">\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Get Started\" />\n            <CardContent>\n              <Box mb={3}>\n                <Typography>\n                  Start using caravan by choosing to either make a multisig\n                  wallet or fully stateless address.\n                </Typography>\n              </Box>\n              <Grid container alignItems=\"center\" justify=\"center\" spacing={3}>\n                <Grid item xs={10} md={4}>\n                  <Button\n                    variant=\"contained\"\n                    data-cy=\"setup-wallet-button\"\n                    size=\"large\"\n                    color=\"primary\"\n                    href=\"#/wallet\"\n                    startIcon={<AccountBalanceWallet />}\n                  >\n                    Wallet\n                  </Button>\n                </Grid>\n                <Grid item xs={10} md={4}>\n                  <Button\n                    variant=\"contained\"\n                    data-cy=\"setup-address-button\"\n                    size=\"large\"\n                    color=\"default\"\n                    href=\"#/address\"\n                    startIcon={<SportsVolleyball />}\n                  >\n                    Address\n                  </Button>\n                </Grid>\n              </Grid>\n            </CardContent>\n          </Card>\n        </Grid>\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Stateless Multisig Coordinator\" />\n\n            <CardContent>\n              <p>\n                Caravan makes bitcoin multisig custody easier and safer through\n                transparency and standards.\n              </p>\n\n              <p>\n                Caravan is a <strong>coordination software</strong> for multisig\n                addresses and wallets. Caravan can be used to build a multisig\n                wallet derived from xpubs, or individual multisig addresses\n                derived from pubkeys. In both cases, in order to transact from\n                the wallet or address, you must also have your private keys and\n                BIP32 paths.\n              </p>\n\n              <p>\n                Caravan is <strong>stateless</strong>. It does not itself store\n                any data outside your current browser session. You must safekeep\n                the wallet details (xpubs, BIP32 paths) and addresses (redeem\n                scripts, BIP32 paths) that you create.\n              </p>\n            </CardContent>\n          </Card>\n        </Grid>\n\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Keys\" />\n            <CardContent>\n              <p>All bitcoin is ultimately protected by private keys.</p>\n\n              <p>\n                Your private key may live on a piece of paper, a hardware\n                wallet, some software on a laptop, or even just in your mind.\n                Caravan, being stateless, does not store or ask for your private\n                key but it can talk to hardware devices or software applications\n                which do.\n              </p>\n\n              <p>\n                Caravan supports entering public keys and signatures via text,\n                so any wallet which can export such data can be made compatible\n                with Caravan.\n              </p>\n            </CardContent>\n          </Card>\n        </Grid>\n\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Consensus\" />\n            <CardContent>\n              <p>\n                In order to look up wallet addresses and their balances, and\n                broadcast transactions, Caravan requires knowledge of the\n                constantly changing bitcoin network.\n              </p>\n\n              <p>\n                Running a full bitcoin node is the most private way to determine\n                the current state of the bitcoin network. Caravan can be easily\n                configured to use your own node for consensus information and\n                broadcasting transactions.\n              </p>\n\n              <p>\n                If you don&apos;t want to or cannot run your own full node,\n                Caravan defaults to using the freely available API at\n                <code> blockstream.info</code>.\n              </p>\n            </CardContent>\n          </Card>\n        </Grid>\n      </Grid>\n\n      <Grid container item md={4} spacing={4} direction=\"column\">\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Learn More\" />\n            <CardContent>\n              <List>\n                <ListItem>\n                  <ListItemIcon>\n                    <Description />\n                  </ListItemIcon>\n                  <ListItemText>\n                    {externalLink(\n                      \"https://unchained-capital.com/blog/gearing-up-the-caravan/\",\n                      \"Blog Post\"\n                    )}\n                  </ListItemText>\n                </ListItem>\n\n                <ListItem>\n                  <ListItemIcon>\n                    <YouTube />\n                  </ListItemIcon>\n                  <ListItemText>\n                    {externalLink(\n                      \"https://www.youtube.com/playlist?list=PLUM8mrUjWoPRsVGEZ1gTntqPd4xrQZoiH\",\n                      \"Video Tutorials\"\n                    )}\n                  </ListItemText>\n                </ListItem>\n\n                <ListItem>\n                  <ListItemIcon>\n                    <GitHub />\n                  </ListItemIcon>\n                  <ListItemText>\n                    {externalLink(\n                      \"https://github.com/unchained-capital/caravan\",\n                      \"Source Code\"\n                    )}\n                  </ListItemText>\n                </ListItem>\n              </List>\n            </CardContent>\n          </Card>\n        </Grid>\n\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Supported Devices\" />\n            <CardContent>\n              Caravan has been <a href=\"#/test\">tested</a> with the following\n              hardware wallets:\n              <ul>\n                <li>\n                  {externalLink(\n                    \"https://shop.trezor.io/product/trezor-one-white\",\n                    \"Trezor One\"\n                  )}\n                </li>\n                <li>\n                  {externalLink(\n                    \"https://shop.trezor.io/product/trezor-model-t\",\n                    \"Trezor Model T\"\n                  )}\n                </li>\n                <li>\n                  {externalLink(\n                    \"https://www.ledger.com/products/ledger-nano-s\",\n                    \"Ledger Nano S\"\n                  )}\n                </li>\n                <li>\n                  {externalLink(\n                    \"https://www.ledger.com/products/ledger-nano-x\",\n                    \"Ledger Nano X\"\n                  )}\n                </li>\n                <li>\n                  {externalLink(\n                    \"https://coldcardwallet.com\",\n                    \"Coldcard Mk2 & Mk3\"\n                  )}\n                </li>\n              </ul>\n              And web browsers:\n              <ul>\n                <li>\n                  {externalLink(\"https://www.google.com/chrome/\", \"Chrome\")}\n                </li>\n                <li>\n                  {externalLink(\n                    \"https://www.mozilla.org/en-US/firefox/new/\",\n                    \"Firefox\"\n                  )}\n                </li>\n              </ul>\n              Seeing a bug or need a feature?\n            </CardContent>\n            <CardActions>\n              <Button href=\"https://github.com/unchained-capital/caravan/issues\">\n                <BugReport /> &nbsp; Report Issue\n              </Button>\n              <Button data-cy=\"run-tests-button\" href=\"#/test\">\n                <Speed /> &nbsp; Run Tests\n              </Button>\n            </CardActions>\n          </Card>\n        </Grid>\n      </Grid>\n    </Grid>\n\n    <Box mt={2}>\n      <Disclaimer />\n    </Box>\n  </div>\n);\n\nexport default Help;\n","import axios from \"axios\";\nimport BigNumber from \"bignumber.js\";\nimport { satoshisToBitcoins, blockExplorerAPIURL } from \"unchained-bitcoin\";\n\n/**\n * Fetch information for signing transactions from block explorer API\n * @param {string} address - The address from which to obtain the information\n * @param {string} network - The network for the transaction to sign (mainnet|testnet)\n * @returns {multisig.UTXO} object for signing transaction inputs\n */\nexport async function blockExplorerGetAddresesUTXOs(address, network) {\n  try {\n    const utxosResult = await axios.get(\n      blockExplorerAPIURL(`/address/${address}/utxo`, network)\n    );\n    const utxos = utxosResult.data;\n    return await Promise.all(\n      utxos.map(async (utxo) => {\n        // FIXME: inefficient, need to cache here by utxo.txid\n        const transactionResult = await axios.get(\n          blockExplorerAPIURL(`/tx/${utxo.txid}/hex`, network)\n        );\n        const transactionHex = transactionResult.data;\n        const amount = new BigNumber(utxo.value);\n        return {\n          confirmed: utxo.status.confirmed,\n          txid: utxo.txid,\n          index: utxo.vout,\n          amount: satoshisToBitcoins(amount).toFixed(8),\n          amountSats: amount,\n          transactionHex,\n          time: utxo.status.block_time,\n        };\n      })\n    );\n  } catch (e) {\n    throw (e.response && e.response.data) || e;\n  }\n}\n\nexport async function blockExplorerGetAddressStatus(address, network) {\n  try {\n    const addressesult = await axios.get(\n      blockExplorerAPIURL(`/address/${address}`, network)\n    );\n    const addressData = addressesult.data;\n    return {\n      used:\n        addressData.chain_stats.funded_txo_count > 0 ||\n        addressData.mempool_stats.funded_txo_count > 0,\n    };\n  } catch (e) {\n    throw (e.response && e.response.data) || e;\n  }\n}\n\nexport async function blockExplorerGetFeeEstimate(network) {\n  try {\n    const feeEstimatesResult = await axios.get(\n      blockExplorerAPIURL(\"/fee-estimates\", network)\n    );\n    const feeEstimates = feeEstimatesResult.data;\n    return Math.ceil(feeEstimates[2]);\n  } catch (e) {\n    throw (e.response && e.response.data) || e;\n  }\n}\n\nexport async function blockExplorerBroadcastTransaction(\n  transactionHex,\n  network\n) {\n  try {\n    const broadcastResult = await axios.post(\n      blockExplorerAPIURL(\"/tx\", network),\n      transactionHex\n    );\n    return broadcastResult.data;\n  } catch (e) {\n    throw (e.response && e.response.data) || e;\n  }\n}\n\n/**\n * @module block_explorer\n */\n","import axios from \"axios\";\nimport BigNumber from \"bignumber.js\";\nimport { bitcoinsToSatoshis } from \"unchained-bitcoin\";\n\nasync function callBitcoind(url, auth, method, params = []) {\n  // FIXME\n  // eslint-disable-next-line no-async-promise-executor\n  return new Promise(async (resolve, reject) => {\n    axios(url, {\n      method: \"post\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      },\n      auth,\n      data: {\n        jsonrpc: \"2.0\",\n        id: 0,\n        method: `${method}`,\n        params,\n      },\n    })\n      .then((resp) => resolve(resp.data))\n      .catch(reject);\n  });\n}\n\n/**\n * check if error from bitcoind is address not found in wallet\n * this allows client side interpretation of the error\n * @param {Error} e - the error object to check\n * @returns {boolean} true if the desired error\n */\nexport function isWalletAddressNotFoundError(e) {\n  return (\n    e.response &&\n    e.response.data &&\n    e.response.data.error &&\n    e.response.data.error.code === -4\n  );\n}\n\nexport function bitcoindParams(client) {\n  const { url, username, password } = client;\n  const auth = { username, password };\n  return { url, auth };\n}\n\n/**\n * Fetch unspent outputs for a single or set of addresses\n * @param {Object} options - what is needed to communicate with the RPC\n * @param {string} options.url - where to connect\n * @param {AxiosBasicCredentials} options.auth - username and password\n * @param {string} options.address - The address from which to obtain the information\n * @returns {UTXO} object for signing transaction inputs\n */\nexport async function bitcoindListUnspent({ url, auth, address, addresses }) {\n  try {\n    const addressParam = addresses || [address];\n    const resp = await callBitcoind(url, auth, \"listunspent\", [\n      0,\n      9999999,\n      addressParam,\n    ]);\n    const promises = [];\n    resp.result.forEach((utxo) => {\n      promises.push(callBitcoind(url, auth, \"gettransaction\", [utxo.txid]));\n    });\n    const previousTransactions = await Promise.all(promises);\n    return resp.result.map((utxo, mapindex) => {\n      const amount = new BigNumber(utxo.amount);\n      return {\n        confirmed: (utxo.confirmations || 0) > 0,\n        txid: utxo.txid,\n        index: utxo.vout,\n        amount: amount.toFixed(8),\n        amountSats: bitcoinsToSatoshis(amount),\n        transactionHex: previousTransactions[mapindex].result.hex,\n        time: previousTransactions[mapindex].result.blocktime,\n      };\n    });\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(\"There was a problem:\", e.message);\n    throw e;\n  }\n}\n\nexport async function bitcoindGetAddressStatus({ url, auth, address }) {\n  try {\n    const resp = await callBitcoind(url, auth, \"getreceivedbyaddress\", [\n      address,\n    ]);\n    if (typeof resp.result === \"undefined\") {\n      throw new Error(`Error: invalid response from ${url}`);\n    }\n    return {\n      used: resp.result > 0,\n    };\n  } catch (e) {\n    if (isWalletAddressNotFoundError(e))\n      // eslint-disable-next-line no-console\n      console.warn(\n        `Address ${address} not found in bitcoind's wallet. Query failed.`\n      );\n    else console.error(e.message); // eslint-disable-line no-console\n    return e;\n  }\n}\n\nexport async function bitcoindEstimateSmartFee({ url, auth, numBlocks = 2 }) {\n  const resp = await callBitcoind(url, auth, \"estimatesmartfee\", [numBlocks]);\n  const feeRate = resp.result.feerate;\n  return Math.ceil(feeRate * 100000);\n}\n\nexport async function bitcoindSendRawTransaction({ url, auth, hex }) {\n  try {\n    const resp = await callBitcoind(url, auth, \"sendrawtransaction\", [hex]);\n    return resp.result;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(\"send tx error\", e);\n    throw (e.response && e.response.data.error.message) || e;\n  }\n}\n\nexport function bitcoindImportMulti({ url, auth, addresses, label, rescan }) {\n  const imports = addresses.map((address) => {\n    return {\n      scriptPubKey: {\n        address,\n      },\n      label,\n      timestamp: 0, // TODO: better option to ensure address history is picked up?\n    };\n  });\n  const params = [url, auth, \"importmulti\", [imports, { rescan }]];\n  if (rescan) {\n    callBitcoind(...params); // TODO: what to do on catch?\n    return new Promise((resolve) => resolve({ result: [] }));\n  }\n  return callBitcoind(...params);\n}\n","import { sortInputs } from \"unchained-bitcoin\";\nimport BigNumber from \"bignumber.js\";\nimport {\n  blockExplorerGetAddresesUTXOs,\n  blockExplorerGetFeeEstimate,\n  blockExplorerBroadcastTransaction,\n  blockExplorerGetAddressStatus,\n} from \"./block_explorer\";\nimport {\n  bitcoindListUnspent,\n  bitcoindEstimateSmartFee,\n  bitcoindSendRawTransaction,\n  bitcoindParams,\n  bitcoindGetAddressStatus,\n  isWalletAddressNotFoundError,\n} from \"./bitcoind\";\n\nexport const BLOCK_EXPLORER = \"public\";\nexport const BITCOIND = \"private\";\n\nfunction fetchAddressUTXOsUnsorted(address, network, client) {\n  if (client.type === BLOCK_EXPLORER) {\n    return blockExplorerGetAddresesUTXOs(address, network);\n  }\n  return bitcoindListUnspent({\n    ...bitcoindParams(client),\n    ...{ address },\n  });\n}\n\n/**\n * Fetch utxos for an address, calculate total balances\n * and return an object describing the addresses state\n * @param {string} address\n * @param {string} network\n * @param {object} client\n * @returns {object} slice object with information gathered for that address\n */\nexport async function fetchAddressUTXOs(address, network, client) {\n  let unsortedUTXOs;\n\n  let updates = {\n    utxos: [],\n    balanceSats: BigNumber(0),\n    fetchedUTXOs: false,\n    fetchUTXOsError: \"\",\n  };\n  try {\n    unsortedUTXOs = await fetchAddressUTXOsUnsorted(address, network, client);\n  } catch (e) {\n    if (client.type === \"private\" && isWalletAddressNotFoundError(e)) {\n      updates = {\n        utxos: [],\n        balanceSats: BigNumber(0),\n        addressKnown: false,\n        fetchedUTXOs: true,\n        fetchUTXOsError: \"\",\n      };\n    } else {\n      updates = { fetchUTXOsError: e.toString() };\n    }\n  }\n\n  // if no utxos then return updates object as is\n  if (!unsortedUTXOs) return updates;\n\n  // sort utxos\n  const utxos = sortInputs(unsortedUTXOs);\n\n  // calculate the total balance from all utxos\n  const balanceSats = utxos\n    .map((utxo) => utxo.amountSats)\n    .reduce(\n      (accumulator, currentValue) => accumulator.plus(currentValue),\n      new BigNumber(0)\n    );\n\n  return {\n    ...updates,\n    balanceSats,\n    utxos,\n    fetchedUTXOs: true,\n    fetchUTXOsError: \"\",\n  };\n}\n\nexport function getAddressStatus(address, network, client) {\n  if (client.type === BLOCK_EXPLORER) {\n    return blockExplorerGetAddressStatus(address, network);\n  }\n  return bitcoindGetAddressStatus({\n    ...bitcoindParams(client),\n    ...{ address },\n  });\n}\n\nexport function fetchFeeEstimate(network, client) {\n  if (client.type === BLOCK_EXPLORER) {\n    return blockExplorerGetFeeEstimate(network);\n  }\n  return bitcoindEstimateSmartFee({\n    ...bitcoindParams(client),\n    ...{ numBlocks: 1 },\n  });\n}\n\nexport function broadcastTransaction(transactionHex, network, client) {\n  if (client.type === BLOCK_EXPLORER) {\n    return blockExplorerBroadcastTransaction(transactionHex, network);\n  }\n  return bitcoindSendRawTransaction({\n    ...bitcoindParams(client),\n    ...{ hex: transactionHex },\n  });\n}\n","import { DEFAULT_CHANGE_PREFIX, CHANGE_INDEX } from \"./constants\";\n\nconst initSortDir = (order) => (order === \"asc\" ? -1 : 1);\n\n/**\n * Function to compare two slices and determine sort\n * order by BIP32 path\n * @param {object} a - slice a for comparison\n * @param {object} b - slice b for comparison\n * @param {string} [orderDir = \"asc\"] - direction for ordering (desc or asc)\n */\nexport function compareSlicesByPath(a, b, orderDir = \"asc\") {\n  if (!a.bip32Path && !b.bip32Path)\n    throw new Error(\"Mising BIP32 path for comparing slices.\");\n\n  const direction = initSortDir(orderDir);\n\n  if (a.change && !b.change) return direction;\n  if (!a.change && b.change) return -direction;\n  const aint = parseInt(a.bip32Path.split(\"/\").reverse()[0], 10);\n  const bint = parseInt(b.bip32Path.split(\"/\").reverse()[0], 10);\n  return aint > bint ? direction : -direction;\n}\n\n/**\n * Function to compare two slices and determine sort\n * order by balance\n * @param {object} a - slice a for comparison\n * @param {object} b - slice b for comparison\n * @param {string} [orderDir = \"asc\"] - direction for ordering (desc or asc)\n */\nexport function compareSlicesByBalance(a, b, orderDir = \"asc\") {\n  if (!a.balanceSats && !b.balanceSats)\n    throw new Error(\"Missing balance for comparing slices\");\n\n  const direction = initSortDir(orderDir);\n\n  if (a.balanceSats.isEqualTo(b.balanceSats)) return 0;\n  return a.balanceSats.isGreaterThan(b.balanceSats) ? direction : -direction;\n}\n\n/**\n * Function to compare two slices and determine sort\n * order by total UTXO count\n * @param {object} a - slice a for comparison\n * @param {object} b - slice b for comparison\n * @param {string} [orderDir = \"asc\"] - direction for ordering (desc or asc)\n */\nexport function compareSlicesByUTXOCount(a, b, orderDir = \"asc\") {\n  if (!a.utxos && !b.utxos)\n    throw new Error(\"Missing utxo array for comparing slices\");\n  const direction = initSortDir(orderDir);\n  if (a.utxos.length === b.utxos.length) return 0;\n  return a.utxos.length > b.utxos.length ? direction : -direction;\n}\n\n/**\n * Function to compare two slices and determine sort\n * order by lastUsed time\n * @param {object} a - slice a for comparison\n * @param {object} b - slice b for comparison\n * @param {string} [orderDir = \"asc\"] - direction for ordering (desc or asc)\n * @returns {number}\n */\nexport function compareSlicesByTime(a, b, orderDir = \"asc\") {\n  const direction = initSortDir(orderDir);\n  if (!a.utxos && !b.utxos && !a.lastUsed && !b.lastUsed) return 0;\n\n  // when ascending, spent is after unused but before used and unspent\n  if (a.lastUsed === \"Spent\")\n    return b.lastUsed && b.lastUsed !== \"Spent\" ? -direction : direction;\n  if (b.lastUsed === \"Spent\")\n    return a.lastUsed && a.lastUsed !== \"Spent\" ? direction : -direction;\n\n  // if there is a lastUsedTime param then we should be able to compare those\n  if (a.lastUsedTime && b.lastUsedTime) {\n    if (a.lastUsedTime === b.lastUsedTime) return 0;\n    return a.lastUsedTime >= b.lastUsedTime ? direction : -direction;\n  }\n\n  if (a.lastUsedTime && (!b.lastUsedTime || b.utxos.length === 0)) {\n    return direction;\n  }\n\n  if (b.lastUsedTime && (!a.lastUsedTime || a.utxos.length === 0)) {\n    return -direction;\n  }\n\n  if (a.utxos.length === 0) {\n    return b.utxos.length === 0 ? 0 : direction;\n  }\n  if (b.utxos.length === 0) {\n    return a.utxos.length === 0 ? 0 : -direction;\n  }\n  const amax = Math.max(...a.utxos.map((utxo) => utxo.time));\n  const bmax = Math.max(...b.utxos.map((utxo) => utxo.time));\n\n  if (Number.isNaN(amax) && Number.Number.isNaN(bmax)) return 0;\n  if (Number.isNaN(amax)) return direction;\n  if (Number.isNaN(bmax)) return -direction;\n  return amax > bmax ? direction : -direction;\n}\n\nexport function isChange(path) {\n  // if the prefix matches the change prefix\n  // and there is only 1 more index after, then it is change\n  const prefixLength = DEFAULT_CHANGE_PREFIX.length;\n  if (\n    path.slice(0, prefixLength) === DEFAULT_CHANGE_PREFIX &&\n    // this checks that the only thing after the change prefix is an index\n    path.slice(prefixLength).match(/^([0-9]+)$/g)\n  )\n    return true;\n\n  // if the last two indexes are not hardened and the second to last\n  // index in the path is the change index, then it is change\n  const pathIndexMatcher = /\\/([0-9]+('?))/g;\n  const indexes = path.match(pathIndexMatcher).slice(-2);\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const index of indexes) {\n    // neither of the final two indexes should be hardened\n    // if it is change\n    if (index.includes(\"'\")) return false;\n  }\n\n  // if two matching indexes found and first is change, e.g. /1/0\n  // then it is change\n  if (indexes[0] === CHANGE_INDEX && indexes.length === 2) return true;\n  return false;\n}\n","import { createSelector } from \"reselect\";\n\n// convert slice objects to array of slice values\n// only care about inbound to deposit account, not change\nconst getDepositSlices = (state) => Object.values(state.wallet.deposits.nodes);\nconst getWalletSlices = (state) => [\n  ...Object.values(state.wallet.deposits.nodes),\n  ...Object.values(state.wallet.change.nodes),\n];\n\nconst getAddressType = (state) => state.settings.addressType;\nconst getNetwork = (state) => state.settings.network;\nconst getTotalSigners = (state) => state.settings.totalSigners;\nconst getRequiredSigners = (state) => state.settings.requiredSigners;\nconst getStartingAddressIndex = (state) => state.settings.startingAddressIndex;\nconst getWalletName = (state) => state.wallet.common.walletName;\nconst getClientDetails = (state) => {\n  if (state.client.type === \"private\") {\n    return `{\n    \"type\": \"private\",\n    \"url\": \"${state.client.url}\",\n    \"username\": \"${state.client.username}\"\n  }`;\n  }\n  return `{\n    \"type\": \"public\"\n  }`;\n};\n\nconst extendedPublicKeyImporterBIP32Path = (state, number) => {\n  const { extendedPublicKeyImporters } = state.quorum;\n  const extendedPublicKeyImporter = extendedPublicKeyImporters[number];\n  const bip32Path =\n    extendedPublicKeyImporter.method === \"text\"\n      ? \"Unknown (make sure you have written this down previously!)\"\n      : extendedPublicKeyImporter.bip32Path;\n  const rootFingerprint =\n    extendedPublicKeyImporter.rootXfp === \"Unknown\"\n      ? \"00000000\"\n      : extendedPublicKeyImporter.rootXfp;\n  return extendedPublicKeyImporter.method === \"unknown\"\n    ? `    {\n        \"name\": \"${extendedPublicKeyImporter.name}\",\n        \"bip32Path\": \"${bip32Path}\",\n        \"xpub\": \"${extendedPublicKeyImporter.extendedPublicKey}\",\n        \"xfp\" : \"${rootFingerprint}\"\n        }`\n    : `    {\n        \"name\": \"${extendedPublicKeyImporter.name}\",\n        \"bip32Path\": \"${bip32Path}\",\n        \"xpub\": \"${extendedPublicKeyImporter.extendedPublicKey}\",\n        \"xfp\" : \"${rootFingerprint}\",\n        \"method\": \"${extendedPublicKeyImporter.method}\"\n      }`;\n};\n\nconst getExtendedPublicKeysBIP32Paths = (state) => {\n  const totalSigners = getTotalSigners(state);\n  const extendedPublicKeyImporterBIP32Paths = [];\n  for (let i = 1; i <= totalSigners; i += 1) {\n    extendedPublicKeyImporterBIP32Paths.push(\n      `${extendedPublicKeyImporterBIP32Path(state, i)}${\n        i < totalSigners ? \",\" : \"\"\n      }`\n    );\n  }\n  return extendedPublicKeyImporterBIP32Paths.join(\"\\n\");\n};\n\n/**\n * @description cycle through all slices to calculate total balance of all utxos\n * from all slices including pending.\n */\nexport const getTotalBalance = createSelector(getWalletSlices, (slices) => {\n  return slices.reduce((balance, slice) => {\n    const sliceTotal = slice.utxos.reduce((total, utxo) => {\n      return total + parseInt(utxo.amountSats, 10);\n    }, 0);\n    return balance + sliceTotal;\n  }, 0);\n});\n\nexport const getPendingBalance = createSelector(\n  getDepositSlices,\n  // iterate through all slices to add up the pending balance\n  (slices) => {\n    // reduce slices to calculate unconfirmed utxos from each slice\n    return slices.reduce((balance, currentSlice) => {\n      // if the current slice has no UTXOs, then continue\n      if (!currentSlice.utxos.length) return balance;\n      // otherwise, loop through available utxos and add balance of those\n      // that are unconfirmed\n      const sliceBalance = currentSlice.utxos.reduce((total, utxo) => {\n        if (!utxo.confirmed) return total + parseInt(utxo.amountSats, 10);\n        return total;\n      }, 0);\n\n      // add slice's pending balance to aggregated balance\n      return sliceBalance + balance;\n    }, 0);\n  }\n);\n\n/**\n * @description selector that subtracts pending balance (calculated with\n * other selector) from total balance of each braid which is stored in the state\n */\nexport const getConfirmedBalance = createSelector(\n  [getTotalBalance, getPendingBalance],\n  (totalBalance, pendingBalance) => totalBalance - pendingBalance\n);\n\n/**\n * @description Returns a selector with all slices from both deposit and change braids\n * also adds a \"lastUsed\" property for each slice\n */\nexport const getSlicesWithLastUsed = createSelector(\n  getWalletSlices,\n  (slices) => {\n    return slices.map((slice) => {\n      if (!slice.utxos.length && slice.addressUsed)\n        return { ...slice, lastUsed: \"Spent\" };\n\n      // if no utxos and no recorded balanceSats then just return the slice unchanged\n      if (!slice.utxos.length && slice.balanceSats.isEqualTo(0)) return slice;\n\n      // find the last UTXO time for the last used time for that slice\n      const maxtime = Math.max(...slice.utxos.map((utxo) => utxo.time));\n\n      // if no max was able to be found, but we still have a balanceSats\n      // then we can can assume the utxo is pending\n      if (\n        Number.isNaN(maxtime) ||\n        (slice.balanceSats.isGreaterThan(0) && !slice.utxos.length)\n      )\n        return { ...slice, lastUsed: \"Pending\" };\n      return {\n        ...slice,\n        lastUsed: new Date(1000 * maxtime).toLocaleDateString(),\n        lastUsedTime: maxtime,\n      };\n    });\n  }\n);\n\n/**\n * Gets the set of spendable slices, i.e. ones that don't have a\n * pending utxo and are not spent\n */\nexport const getSpendableSlices = createSelector(\n  getSlicesWithLastUsed,\n  (slices) => {\n    return slices.filter(\n      (slice) =>\n        // pending change is considered spendable\n        (slice.lastUsed !== \"Pending\" || slice.change) &&\n        slice.lastUsed !== \"Spent\" &&\n        slice.utxos.length\n    );\n  }\n);\n\n/**\n * @description Returns a selector that provides all spent slices, i.e.\n * All slices that have been used but have no balance left.\n */\nexport const getSpentSlices = createSelector(getSlicesWithLastUsed, (slices) =>\n  slices.filter((slice) => slice.addressUsed && slice.balanceSats.isEqualTo(0))\n);\n\n/**\n * @description Returns a selector that provides all slices with an active balance\n */\nexport const getSlicesWithBalance = createSelector(\n  getSlicesWithLastUsed,\n  (slices) => slices.filter((slice) => slice.balanceSats.isGreaterThan(0))\n);\n\n/**\n * @description Returns a selector that provides all unused slices,\n * i.e. where the balance is zero and the address has not been used\n */\nexport const getZeroBalanceSlices = createSelector(\n  getSlicesWithLastUsed,\n  (slices) =>\n    slices.filter(\n      (slice) => slice.balanceSats.isEqualTo(0) && !slice.addressUsed\n    )\n);\n\n/**\n * @description Returns a selector of all wallet slices\n * where the status of that slice is not known.\n */\nexport const getUnknownAddressSlices = createSelector(\n  getWalletSlices,\n  (slices) => slices.filter((slice) => !slice.addressKnown)\n);\n\n/**\n * @description returns an array of all addresses of slices\n * where the state of that slice is not known\n */\nexport const getUnknownAddresses = createSelector(\n  [getWalletSlices, getUnknownAddressSlices],\n  (slices) => slices.map((slice) => slice.multisig.address)\n);\n\n/**\n * @description Returns a selector of all slices from the _deposit_ braid\n * where the address hasn't been used yet.\n */\nexport const getDepositableSlices = createSelector(getDepositSlices, (slices) =>\n  slices.filter((slice) => slice.balanceSats.isEqualTo(0) && !slice.addressUsed)\n);\n\n/**\n * @description Returns a selector of the text needed to construct a wallet\n * details file.\n */\nexport const getWalletDetailsText = createSelector(\n  [\n    getWalletName,\n    getAddressType,\n    getNetwork,\n    getClientDetails,\n    getRequiredSigners,\n    getTotalSigners,\n    getExtendedPublicKeysBIP32Paths,\n    getStartingAddressIndex,\n  ],\n  (\n    walletName,\n    addressType,\n    network,\n    clientDetails,\n    requiredSigners,\n    totalSigners,\n    extendedPublicKeys,\n    startingAddressIndex\n  ) => {\n    return `{\n  \"name\": \"${walletName}\",\n  \"addressType\": \"${addressType}\",\n  \"network\": \"${network}\",\n  \"client\":  ${clientDetails},\n  \"quorum\": {\n    \"requiredSigners\": ${requiredSigners},\n    \"totalSigners\": ${totalSigners}\n  },\n  \"extendedPublicKeys\": [\n    ${extendedPublicKeys}\n  ],\n  \"startingAddressIndex\": ${startingAddressIndex}\n}`;\n  }\n);\n","import BigNumber from \"bignumber.js\";\nimport {\n  estimateMultisigTransactionFee,\n  satoshisToBitcoins,\n} from \"unchained-bitcoin\";\nimport { getSpendableSlices, getConfirmedBalance } from \"../selectors/wallet\";\nimport { DUST_IN_BTC } from \"../utils/constants\";\n\nexport const CHOOSE_PERFORM_SPEND = \"CHOOSE_PERFORM_SPEND\";\n\nexport const SET_REQUIRED_SIGNERS = \"SET_REQUIRED_SIGNERS\";\nexport const SET_TOTAL_SIGNERS = \"SET_TOTAL_SIGNERS\";\n\nexport const SET_INPUTS = \"SET_INPUTS\";\n\nexport const ADD_OUTPUT = \"ADD_OUTPUT\";\nexport const SET_OUTPUT_ADDRESS = \"SET_OUTPUT_ADDRESS\";\nexport const SET_OUTPUT_AMOUNT = \"SET_OUTPUT_AMOUNT\";\nexport const DELETE_OUTPUT = \"DELETE_OUTPUT\";\n\nexport const SET_FEE_RATE = \"SET_FEE_RATE\";\nexport const SET_FEE = \"SET_FEE\";\n\nexport const FINALIZE_OUTPUTS = \"FINALIZE_OUTPUTS\";\nexport const RESET_OUTPUTS = \"RESET_OUTPUTS\";\n\nexport const SET_TXID = \"SET_TXID\";\nexport const RESET_TRANSACTION = \"RESET_TRANSACTION\";\nexport const SET_IS_WALLET = \"SET_IS_WALLET\";\nexport const SET_CHANGE_OUTPUT_INDEX = \"SET_CHANGE_OUTPUT_INDEX\";\nexport const SET_CHANGE_OUTPUT_MULTISIG = \"SET_CHANGE_OUTPUT_MULTISIG\";\nexport const UPDATE_AUTO_SPEND = \"UPDATE_AUTO_SPEND\";\nexport const SET_CHANGE_ADDRESS = \"SET_CHANGE_ADDRESS\";\nexport const SET_SIGNING_KEY = \"SET_SIGNING_KEY\";\nexport const SET_SPEND_STEP = \"SET_SPEND_STEP\";\nexport const SET_BALANCE_ERROR = \"SET_BALANCE_ERROR\";\nexport const SPEND_STEP_CREATE = 0;\nexport const SPEND_STEP_PREVIEW = 1;\nexport const SPEND_STEP_SIGN = 2;\n\nexport function choosePerformSpend() {\n  return {\n    type: CHOOSE_PERFORM_SPEND,\n  };\n}\n\nexport function setRequiredSigners(number) {\n  return {\n    type: SET_REQUIRED_SIGNERS,\n    value: number,\n  };\n}\n\nexport function setTotalSigners(number) {\n  return {\n    type: SET_TOTAL_SIGNERS,\n    value: number,\n  };\n}\n\nexport function setInputs(inputs) {\n  return {\n    type: SET_INPUTS,\n    value: inputs,\n  };\n}\n\nexport function addOutput() {\n  return {\n    type: ADD_OUTPUT,\n  };\n}\n\nexport function setChangeOutputIndex(number) {\n  return {\n    type: SET_CHANGE_OUTPUT_INDEX,\n    value: number,\n  };\n}\n\nexport function setChangeOutputMultisig(number, multisig) {\n  return {\n    type: SET_CHANGE_OUTPUT_MULTISIG,\n    number,\n    value: multisig,\n  };\n}\n\nexport function setOutputAddress(number, address) {\n  return {\n    type: SET_OUTPUT_ADDRESS,\n    number,\n    value: address,\n  };\n}\n\nexport function setOutputAmount(number, amountString) {\n  return {\n    type: SET_OUTPUT_AMOUNT,\n    number,\n    value: amountString,\n  };\n}\n\nexport function setChangeAddressAction(value) {\n  return {\n    type: SET_CHANGE_ADDRESS,\n    value,\n  };\n}\n\nexport function setChangeOutput({ value, address }) {\n  return (dispatch, getState) => {\n    const {\n      spend: {\n        transaction: { outputs, changeOutputIndex },\n      },\n    } = getState();\n    // add output for change if there's none set (or it's set to zero)\n    // if there's a change index then we use that\n    // otherwise put it at the end of the outputs\n    if (!changeOutputIndex) dispatch(addOutput());\n\n    // output/change indexes are not zero-indexed\n    const index = changeOutputIndex || outputs.length + 1;\n    dispatch(setChangeOutputIndex(index));\n    dispatch(setChangeAddressAction(address));\n    dispatch(setOutputAddress(index, address));\n    dispatch(setOutputAmount(index, value));\n  };\n}\n\nexport function deleteOutput(number) {\n  return {\n    type: DELETE_OUTPUT,\n    number,\n  };\n}\n\nexport function deleteChangeOutput() {\n  return (dispatch, getState) => {\n    const { changeOutputIndex } = getState().spend.transaction;\n    if (!changeOutputIndex) return;\n\n    dispatch(deleteOutput(changeOutputIndex));\n  };\n}\n\nexport function setFeeRate(valueString) {\n  return {\n    type: SET_FEE_RATE,\n    value: valueString,\n  };\n}\n\nexport function setFee(valueString) {\n  return {\n    type: SET_FEE,\n    value: valueString,\n  };\n}\n\nexport function finalizeOutputs(finalized) {\n  return {\n    type: FINALIZE_OUTPUTS,\n    value: finalized,\n  };\n}\n\nexport function resetOutputs() {\n  return {\n    type: RESET_OUTPUTS,\n  };\n}\n\nexport function setBalanceError(message) {\n  return {\n    type: SET_BALANCE_ERROR,\n    value: message,\n  };\n}\n\nexport function resetTransaction() {\n  return {\n    type: RESET_TRANSACTION,\n  };\n}\n\nexport function setTXID(txid) {\n  return {\n    type: SET_TXID,\n    value: txid,\n  };\n}\n\nexport function setIsWallet() {\n  return {\n    type: SET_IS_WALLET,\n  };\n}\n\nexport function updateAutoSpendAction(value) {\n  return {\n    type: UPDATE_AUTO_SPEND,\n    value,\n  };\n}\n\nexport function setSigningKey(number, extendedPublicKeyImporterIndex) {\n  return {\n    type: SET_SIGNING_KEY,\n    number,\n    value: extendedPublicKeyImporterIndex,\n  };\n}\n\nexport function setSpendStep(value) {\n  return {\n    type: SET_SPEND_STEP,\n    value,\n  };\n}\n\n/**\n * @description Given an output index and the current state of the transaction,\n * calculate an estimated fee for a tx with all spendable utxos as inputs,\n * and then use that to determine value of an output that spends all spendable funds\n * minus fee. Dispatches an action to add that value to the given output.\n * @param {Number} outputIndex - 1-indexed location of the output\n * to add all remaining spendable funds to\n */\nexport function setMaxSpendOnOutput(outputIndex) {\n  return (dispatch, getState) => {\n    const spendableSlices = getSpendableSlices(getState());\n    const confirmedBalance = getConfirmedBalance(getState());\n    const {\n      settings: { addressType, requiredSigners, totalSigners },\n      spend: {\n        transaction: { outputs, feeRate },\n      },\n    } = getState();\n    const numInputs = spendableSlices.reduce(\n      (count, slice) => count + slice.utxos.length,\n      0\n    );\n    const estimatedFee = estimateMultisigTransactionFee({\n      addressType,\n      numInputs,\n      numOutputs: outputs.length,\n      m: requiredSigners,\n      n: totalSigners,\n      feesPerByteInSatoshis: feeRate,\n    });\n\n    const totalOutputValue = outputs.reduce(\n      (total, output) =>\n        total.plus(output.amount.length ? output.amountSats : 0),\n      new BigNumber(0)\n    );\n\n    const spendAllAmount = satoshisToBitcoins(\n      new BigNumber(confirmedBalance)\n        .minus(outputs.length > 1 ? totalOutputValue : 0)\n        .minus(estimatedFee)\n    );\n\n    if (\n      (spendAllAmount.isLessThanOrEqualTo(satoshisToBitcoins(estimatedFee)) &&\n        outputs.length > 1) ||\n      spendAllAmount.isLessThan(DUST_IN_BTC)\n    )\n      return dispatch(\n        setBalanceError(\n          \"Not enough available funds for max spend. Clear other outputs or wait for incoming deposits to confirm.\"\n        )\n      );\n    return dispatch(setOutputAmount(outputIndex, spendAllAmount.toFixed()));\n  };\n}\n","export const SET_ERROR_NOTIFICATION = \"SET_ERROR_NOTIFICATION\";\nexport const CLEAR_ERROR_NOTIFICATION = \"CLEAR_ERROR_NOTIFICATION\";\n\nexport function setErrorNotification(message) {\n  return {\n    type: SET_ERROR_NOTIFICATION,\n    value: message,\n  };\n}\n\nexport function clearErrorNotification() {\n  return {\n    type: CLEAR_ERROR_NOTIFICATION,\n  };\n}\n","import {\n  estimateMultisigTransactionFee,\n  satoshisToBitcoins,\n} from \"unchained-bitcoin\";\n\nimport BigNumber from \"bignumber.js\";\nimport { fetchAddressUTXOs } from \"../blockchain\";\nimport { isChange } from \"../utils/slices\";\nimport { naiveCoinSelection } from \"../utils\";\nimport {\n  setBalanceError,\n  setChangeOutput,\n  setInputs,\n  setFee,\n  finalizeOutputs,\n} from \"./transactionActions\";\nimport { setErrorNotification } from \"./errorNotificationActions\";\nimport { getSpendableSlices } from \"../selectors/wallet\";\n\nexport const UPDATE_DEPOSIT_SLICE = \"UPDATE_DEPOSIT_SLICE\";\nexport const UPDATE_CHANGE_SLICE = \"UPDATE_CHANGE_SLICE\";\nexport const RESET_NODES_SPEND = \"RESET_NODES_SPEND\";\nexport const UPDATE_WALLET_NAME = \"UPDATE_WALLET_NAME\";\nexport const UPDATE_WALLET_MODE = \"UPDATE_WALLET_MODE\";\nexport const RESET_WALLET_VIEW = \"RESET_WALLET_VIEW\";\nexport const RESET_WALLET = \"RESET_WALLET\";\nexport const SPEND_SLICES = \"SPEND_SLICES\";\nexport const INITIAL_LOAD_COMPLETE = \"INITIAL_LOAD_COMPLETE\";\nexport const RESET_NODES_FETCH_ERRORS = \"RESET_NODES_FETCH_ERRORS\";\n\nexport const WALLET_MODES = {\n  VIEW: 0,\n  DEPOSIT: 1,\n  SPEND: 2,\n};\n\nexport function updateDepositSliceAction(value) {\n  return {\n    type: UPDATE_DEPOSIT_SLICE,\n    value: {\n      ...value,\n      ...{ change: false },\n    },\n  };\n}\n\nexport function updateChangeSliceAction(value) {\n  return {\n    type: UPDATE_CHANGE_SLICE,\n    value: {\n      ...value,\n      ...{ change: true },\n    },\n  };\n}\n\nexport function resetNodesSpend() {\n  return {\n    type: RESET_NODES_SPEND,\n  };\n}\n\n/**\n * @description This dispatcher goes through the necessary steps and dispatching\n * related actions for the process of selecting coins for a transaction.\n * 1. Get all spendable slices that can be used for inputs\n * 2. Select the utxos needed to fund the tx and determine if change is needed\n * 3. Set a change output if necessary\n * 4. Determine and set fee\n * 5. Mark all slices being spent so the store is aware that they've been selected\n */\nexport function autoSelectCoins() {\n  // eslint-disable-next-line consistent-return\n  return (dispatch, getState) => {\n    const {\n      settings,\n      spend: { transaction },\n      wallet: {\n        change: {\n          nextNode: {\n            multisig: { address: changeAddress },\n          },\n        },\n      },\n    } = getState();\n    const { totalSigners: n, requiredSigners: m, addressType } = settings;\n    const { outputs, feeRate: feesPerByteInSatoshis } = transaction;\n    const spendableSlices = getSpendableSlices(getState());\n\n    let selectedUtxos;\n    let changeRequired;\n\n    // select coins and catch error if any occurs during selection\n    try {\n      [selectedUtxos, changeRequired] = naiveCoinSelection({\n        outputs,\n        feesPerByteInSatoshis,\n        m,\n        n,\n        addressType,\n        slices: spendableSlices,\n      });\n    } catch (e) {\n      return dispatch(setBalanceError(e.message));\n    }\n\n    // determine fee based on rate, selected utxos and\n    // if change output is required\n    let fee;\n    const options = {\n      addressType,\n      numInputs: selectedUtxos.length,\n      m,\n      n,\n      feesPerByteInSatoshis,\n    };\n\n    // add change output if necessary and make fee calculation\n    if (changeRequired) {\n      // calculate output, input, and fee totals to determine change amount\n      const outputsTotal = outputs.reduce(\n        (total, output) => total.plus(output.amountSats),\n        new BigNumber(0)\n      );\n      const inputsTotalSats = selectedUtxos.reduce(\n        (total, utxo) => total.plus(utxo.amountSats),\n        new BigNumber(0)\n      );\n      fee = estimateMultisigTransactionFee({\n        ...options,\n        numOutputs: outputs.length + 1,\n      });\n\n      const changeAmount = inputsTotalSats\n        .minus(fee)\n        .minus(outputsTotal)\n        .toFixed(8);\n\n      dispatch(\n        setChangeOutput({\n          address: changeAddress,\n          value: satoshisToBitcoins(changeAmount).toFixed(),\n        })\n      );\n    } else {\n      fee = estimateMultisigTransactionFee({\n        ...options,\n        numOutputs: outputs.length,\n      });\n    }\n\n    dispatch(setFee(satoshisToBitcoins(fee).toFixed()));\n    // set chosen selectedUtxos in the transaction store\n    dispatch(setInputs(selectedUtxos));\n    dispatch(finalizeOutputs(true));\n  };\n}\n\n/**\n * @description Given the state of the transaction store, check status of\n * the slices being used in the spend tx and update them once changed state is confirmed.\n * @param {Object} changeSlice - the slice that was chosen as the change output\n * @param {number} retries - number of retries\n * @param {Set} skipAddresses - set of addresses to skip\n */\nexport function updateTxSlices(\n  changeSlice,\n  retries = 10,\n  skipAddresses = new Set()\n) {\n  // eslint-disable-next-line consistent-return\n  return async (dispatch, getState) => {\n    const {\n      settings: { network },\n      client,\n      spend: {\n        transaction: { changeAddress, inputs, txid },\n      },\n      wallet: {\n        deposits: { nextNode: nextDepositSlice, nodes: depositSlices },\n        change: { nodes: changeSlices },\n      },\n    } = getState();\n\n    // utility function for getting utxo set of an address\n    // and formatting the result in a way we can use\n    const fetchSliceStatus = async (address, bip32Path) => {\n      const utxos = await fetchAddressUTXOs(address, network, client);\n      return {\n        addressUsed: true,\n        change: isChange(bip32Path),\n        address,\n        bip32Path,\n        ...utxos,\n      };\n    };\n\n    // array of slices we want to query\n    const slices = [...inputs];\n\n    // if there is a change address in the transaction\n    // then we want to query the state of that slice as well\n    if (changeSlice && changeSlice.multisig.address === changeAddress) {\n      slices.push(changeSlice);\n    }\n\n    // array to store results from queries for each slice\n    const sliceUpdates = [];\n\n    // track which slices are already being queried since\n    // the fetch command will get all utxos for an address\n    // and some inputs might be for the same address\n    const addressSet = new Set();\n\n    // go through each slice and see if it needs to be queried\n    slices.forEach((slice) => {\n      const { address } = slice.multisig;\n      // if address isn't already being queried and isn't in the\n      // set of addresses to skip (which means it's already been\n      // successfully updated), then fetchSliceStatus\n      if (!addressSet.has(address) && !skipAddresses.has(address)) {\n        addressSet.add(address);\n        // setting up async network calls to await all of them\n        sliceUpdates.push(fetchSliceStatus(address, slice.bip32Path));\n      }\n    });\n\n    let queriedSlices;\n    try {\n      queriedSlices = await Promise.all(sliceUpdates);\n    } catch (e) {\n      return dispatch(\n        setErrorNotification(\n          `There was a problem updating wallet state. Try a refresh. Error: ${e.message}`\n        )\n      );\n    }\n\n    // once all queries have completed we can confirm which have been updated\n    // and dispatch the changes to the store\n    for (let i = 0; i < queriedSlices.length; i += 1) {\n      const slice = queriedSlices[i];\n      const utxoCount = slice.change\n        ? changeSlices[slice.bip32Path].utxos.length\n        : depositSlices[slice.bip32Path].utxos.length;\n\n      // if the utxo count is not the same then we can reliably update\n      // this slice and can skip in any future calls\n      if (slice && slice.utxos && slice.utxos.length !== utxoCount) {\n        dispatch({\n          type: slice.change ? UPDATE_CHANGE_SLICE : UPDATE_DEPOSIT_SLICE,\n          value: slice,\n        });\n        skipAddresses.add(slice.address);\n      }\n    }\n\n    // if not all slices queried were successful, then we want to recursively call\n    // updateTxSlices, counting down retries and with the full set of successful queries\n    // ALL input slices must return a different utxo set otherwise something went wrong\n    if (skipAddresses.size !== queriedSlices.length && retries)\n      return setTimeout(\n        () => dispatch(updateTxSlices(changeSlice, retries - 1, skipAddresses)),\n        750\n      );\n\n    // if we're out of retries and counts are still the same\n    // then we're done trying and should show an error\n    if (!retries) {\n      let message = `There was a problem updating the wallet balance.\n      It is recommended you refresh the wallet to make sure UTXO current set is up to date.`;\n      if (txid && txid.length) message += ` Transaction ID: ${txid}`;\n      return dispatch(setErrorNotification(message));\n    }\n\n    // Check the next deposit slice just in case a spend is to own wallet.\n    // This doesn't catch all self-spend cases but should catch the majority\n    // to avoid any confusion for less technical users.\n    const updatedSlice = await fetchSliceStatus(\n      nextDepositSlice.multisig.address,\n      nextDepositSlice.bip32Path\n    );\n\n    // if its status has changed and the utxo set for the next\n    // deposit slice is different, then update it as well\n    if (\n      updatedSlice.utxos.length !==\n      depositSlices[updatedSlice.bip32Path].utxos.length\n    )\n      return dispatch({ type: UPDATE_DEPOSIT_SLICE, value: updatedSlice });\n  };\n}\n\nexport function setWalletModeAction(value) {\n  return {\n    type: UPDATE_WALLET_MODE,\n    value,\n  };\n}\n\nexport function updateWalletNameAction(number, value) {\n  return {\n    type: UPDATE_WALLET_NAME,\n    value,\n  };\n}\n\nexport function resetWalletView() {\n  return {\n    type: RESET_WALLET_VIEW,\n  };\n}\n\nexport function resetWallet() {\n  return {\n    type: RESET_WALLET,\n  };\n}\n\nexport function initialLoadComplete() {\n  return {\n    type: INITIAL_LOAD_COMPLETE,\n  };\n}\n\nexport function resetNodesFetchErrors() {\n  return {\n    type: RESET_NODES_FETCH_ERRORS,\n  };\n}\n","import {\n  updateDepositSliceAction,\n  updateChangeSliceAction,\n} from \"./walletActions\";\nimport { fetchAddressUTXOs, getAddressStatus } from \"../blockchain\";\nimport { setErrorNotification } from \"./errorNotificationActions\";\n\nexport const UPDATE_BRAID_SLICE = \"UPDATE_BRAID_SLICE\";\n\n/**\n * Given an array of slices from one or more braids,\n * query the utxos for that slice (i.e. at that address) and\n * check if the address is \"used\". Will then dispatch actions\n * to update the data for each slice\n * @param {array<object>} slices - array of slices from one or more braids\n */\nexport const fetchSliceData = async (slices) => {\n  return async (dispatch, getState) => {\n    const { network } = getState().settings;\n    const { client } = getState();\n\n    try {\n      // Create a list of the async calls for updating the slice data.\n      // This lets us run these requests in parallel with a Promise.all\n      const sliceDataPromises = slices.map((slice) => {\n        const { address } = slice.multisig;\n        // creating a tuple of async calls that will need to be resolved\n        // for each slice we're querying for\n        return Promise.all([\n          fetchAddressUTXOs(address, network, client),\n          getAddressStatus(address, network, client),\n        ]);\n      });\n\n      // wait until we've gotten the updates for each slice\n      const queriedSlices = await Promise.all(sliceDataPromises);\n\n      // each slice had two queries and should be in a tuple\n      queriedSlices.forEach(([addressData, addressStatus], index) => {\n        // reference to the original slice object passed into action creator\n        const slice = slices[index];\n\n        // for each queried slice, we need to check if there are utxos\n        // skip if no updates\n        if (!addressData || !addressData.utxos.length) return;\n\n        const updater = slice.change\n          ? updateChangeSliceAction\n          : updateDepositSliceAction;\n        const updatedSlice = {\n          bip32Path: slice.bip32Path,\n          addressKnown: true,\n          ...addressData,\n          addressStatus,\n        };\n        dispatch(updater(updatedSlice));\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(\n        \"There was a problem getting updated braid data:\",\n        e.message\n      );\n      dispatch(setErrorNotification(e.message));\n    }\n  };\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { SvgIcon } from \"@material-ui/core\";\nimport { MAINNET } from \"unchained-bitcoin\";\n\nconst BitcoinIcon = ({ network }) => (\n  <SvgIcon\n    data-cy=\"bitcoin-icon\"\n    htmlColor={network === MAINNET ? \"orange\" : \"grey\"}\n  >\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-prefix=\"fab\"\n      data-icon=\"bitcoin\"\n      className=\"svg-inline--fa fa-bitcoin fa-w-16\"\n      role=\"img\"\n      viewBox=\"0 0 512 512\"\n    >\n      <path\n        fill=\"currentColor\"\n        d=\"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zm-141.651-35.33c4.937-32.999-20.191-50.739-54.55-62.573l11.146-44.702-27.213-6.781-10.851 43.524c-7.154-1.783-14.502-3.464-21.803-5.13l10.929-43.81-27.198-6.781-11.153 44.686c-5.922-1.349-11.735-2.682-17.377-4.084l.031-.14-37.53-9.37-7.239 29.062s20.191 4.627 19.765 4.913c11.022 2.751 13.014 10.044 12.68 15.825l-12.696 50.925c.76.194 1.744.473 2.829.907-.907-.225-1.876-.473-2.876-.713l-17.796 71.338c-1.349 3.348-4.767 8.37-12.471 6.464.271.395-19.78-4.937-19.78-4.937l-13.51 31.147 35.414 8.827c6.588 1.651 13.045 3.379 19.4 5.006l-11.262 45.213 27.182 6.781 11.153-44.733a1038.209 1038.209 0 0 0 21.687 5.627l-11.115 44.523 27.213 6.781 11.262-45.128c46.404 8.781 81.299 5.239 95.986-36.727 11.836-33.79-.589-53.281-25.004-65.991 17.78-4.098 31.174-15.792 34.747-39.949zm-62.177 87.179c-8.41 33.79-65.308 15.523-83.755 10.943l14.944-59.899c18.446 4.603 77.6 13.717 68.811 48.956zm8.417-87.667c-7.673 30.736-55.031 15.12-70.393 11.292l13.548-54.327c15.363 3.828 64.836 10.973 56.845 43.035z\"\n      />\n    </svg>\n  </SvgIcon>\n);\n\nBitcoinIcon.propTypes = {\n  network: PropTypes.string,\n};\n\nBitcoinIcon.defaultProps = {\n  network: MAINNET,\n};\n\nexport default BitcoinIcon;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Grid, IconButton, TextField } from \"@material-ui/core\";\nimport { Check, Clear, Edit } from \"@material-ui/icons\";\n\nclass EditableName extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editing: false,\n      newName: \"\",\n      error: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    const { name } = this.props;\n    this.setState({ newName: name });\n  };\n\n  render = () => {\n    const { name } = this.props;\n    const { editing, newName, error } = this.state;\n    if (editing) {\n      // <Form onSubmit={this.submit} inline>\n      return (\n        <Grid container alignItems=\"center\">\n          <Grid item>\n            <TextField\n              autoFocus\n              label=\"Name\"\n              value={newName}\n              onChange={this.handleChange}\n              onFocus={(event) => {\n                setTimeout(event.target.select.bind(event.target), 20);\n              }}\n              onKeyDown={(e) => (e.key === \"Enter\" ? this.submit() : null)}\n              error={this.hasError()}\n              helperText={error}\n            />\n          </Grid>\n\n          <Grid item>\n            <IconButton\n              data-cy=\"save-button\"\n              size=\"small\"\n              onClick={this.submit}\n              disabled={this.hasError()}\n            >\n              <Check />\n            </IconButton>\n          </Grid>\n\n          <Grid item>\n            <IconButton\n              data-cy=\"cancel-button\"\n              color=\"secondary\"\n              size=\"small\"\n              onClick={this.cancel}\n            >\n              <Clear />\n            </IconButton>\n          </Grid>\n        </Grid>\n      );\n    }\n    return (\n      <span>\n        <IconButton\n          data-cy=\"edit-button\"\n          size=\"small\"\n          onClick={this.startEditing}\n        >\n          <Edit />\n        </IconButton>\n        &nbsp;\n        {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n        <span\n          data-cy=\"editable-name-value\"\n          style={{ cursor: \"pointer\" }}\n          onClick={this.startEditing}\n        >\n          {name}\n        </span>\n      </span>\n    );\n  };\n\n  hasError = () => {\n    const { error } = this.state;\n    return error !== \"\";\n  };\n\n  startEditing = (event) => {\n    const { name } = this.props;\n    event.preventDefault();\n    this.setState({ editing: true, newName: name });\n  };\n\n  handleChange = (event) => {\n    const newName = event.target.value;\n    let error = \"\";\n    if (newName === null || newName === undefined || newName === \"\") {\n      error = \"Name cannot be blank.\";\n    }\n    this.setState({ newName, error });\n  };\n\n  submit = () => {\n    const { setName, number } = this.props;\n    const { newName } = this.state;\n    setName(number, newName);\n    this.setState({ editing: false });\n  };\n\n  cancel = () => {\n    const { name } = this.props;\n    this.setState({ error: \"\", newName: name, editing: false });\n  };\n}\n\nEditableName.propTypes = {\n  number: PropTypes.number.isRequired,\n  name: PropTypes.string.isRequired,\n  setName: PropTypes.func.isRequired,\n};\n\nexport default EditableName;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { NETWORKS } from \"unchained-bitcoin\";\n\n// Components\nimport {\n  Card,\n  CardContent,\n  Typography,\n  makeStyles,\n  Grid,\n} from \"@material-ui/core\";\nimport BitcoinIcon from \"../BitcoinIcon\";\nimport EditableName from \"../EditableName\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    height: \"100%\",\n  },\n  title: {\n    fontSize: \"2rem\",\n    color: \"#212529\",\n  },\n  balance: {\n    fontSize: \"1.2rem\",\n  },\n  gutter: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1),\n    paddingTop: theme.spacing(2),\n  },\n}));\n\nconst WalletInfoCard = ({\n  walletName,\n  setName,\n  balance = 0,\n  pendingBalance,\n  editable,\n  network,\n}) => {\n  const classes = useStyles();\n  return (\n    <Card data-cy=\"wallet-info-card\" className={classes.root}>\n      <CardContent>\n        <Grid container direction=\"row\" alignItems=\"center\">\n          {editable ? (\n            <Grid item>\n              <Typography variant=\"h1\" className={classes.title}>\n                <EditableName number={0} name={walletName} setName={setName} />\n              </Typography>\n            </Grid>\n          ) : (\n            <>\n              <Grid container alignItems=\"center\" className={classes.gutter}>\n                <Grid item xs={1}>\n                  <BitcoinIcon network={network} />\n                </Grid>\n                <Grid item>\n                  <Typography variant=\"h1\" className={classes.title}>\n                    {walletName}\n                  </Typography>\n                </Grid>\n              </Grid>\n              <Grid container className={classes.gutter}>\n                <Grid item xs={12} mt={5}>\n                  <Typography\n                    data-cy=\"balance\"\n                    variant=\"subtitle1\"\n                    className={classes.balance}\n                  >\n                    {balance} BTC\n                  </Typography>\n                </Grid>\n                <Grid item>\n                  <Typography data-cy=\"pending-balance\" variant=\"caption\">\n                    {pendingBalance !== 0 ? (\n                      <>\n                        <span\n                          style={{\n                            color: pendingBalance > 0 ? \"green\" : \"red\",\n                            fontWeight: \"bold\",\n                          }}\n                        >\n                          {pendingBalance > 0 ? \"+\" : \"\"}\n                          {pendingBalance} BTC\n                        </span>{\" \"}\n                        (unconfirmed)\n                      </>\n                    ) : (\n                      \"\"\n                    )}\n                  </Typography>\n                </Grid>\n              </Grid>\n            </>\n          )}\n        </Grid>\n      </CardContent>\n    </Card>\n  );\n};\n\nWalletInfoCard.propTypes = {\n  walletName: PropTypes.string.isRequired,\n  network: PropTypes.string,\n  balance: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  pendingBalance: PropTypes.number,\n  editable: PropTypes.bool.isRequired,\n  setName: PropTypes.func.isRequired,\n};\n\nWalletInfoCard.defaultProps = {\n  network: NETWORKS.TESTNET,\n  balance: 0,\n  pendingBalance: 0,\n};\n\nexport default WalletInfoCard;\n","export const SET_NETWORK = \"SET_NETWORK\";\nexport const SET_TOTAL_SIGNERS = \"SET_TOTAL_SIGNERS\";\nexport const SET_REQUIRED_SIGNERS = \"SET_REQUIRED_SIGNERS\";\nexport const SET_STARTING_ADDRESS_INDEX = \"SET_STARTING_ADDRESS_INDEX\";\nexport const SET_ADDRESS_TYPE = \"SET_ADDRESS_TYPE\";\nexport const SET_FROZEN = \"SET_FROZEN\";\n\nexport function setNetwork(value) {\n  return {\n    type: SET_NETWORK,\n    value,\n  };\n}\n\nexport function setTotalSigners(number) {\n  return {\n    type: SET_TOTAL_SIGNERS,\n    value: number,\n  };\n}\n\nexport function setRequiredSigners(number) {\n  return {\n    type: SET_REQUIRED_SIGNERS,\n    value: number,\n  };\n}\n\nexport function setStartingAddressIndex(number) {\n  return {\n    type: SET_STARTING_ADDRESS_INDEX,\n    value: number,\n  };\n}\n\nexport function setAddressType(value) {\n  return {\n    type: SET_ADDRESS_TYPE,\n    value,\n  };\n}\n\nexport function setFrozen(value) {\n  return {\n    type: SET_FROZEN,\n    value,\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { TESTNET, MAINNET } from \"unchained-bitcoin\";\n\n// Components\n\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  FormControl,\n  RadioGroup,\n  FormControlLabel,\n  Radio,\n  FormHelperText,\n} from \"@material-ui/core\";\n\n// Actions\nimport { setNetwork as setNetworkAction } from \"../actions/settingsActions\";\n\nclass NetworkPicker extends React.Component {\n  handleNetworkChange = (event) => {\n    const { setNetwork } = this.props;\n    setNetwork(event.target.value);\n  };\n\n  render() {\n    const { network, frozen } = this.props;\n    return (\n      <Card>\n        <CardHeader title=\"Network\" />\n        <CardContent>\n          <FormControl component=\"fieldset\">\n            <RadioGroup>\n              <FormControlLabel\n                id=\"mainnet\"\n                control={<Radio color=\"primary\" />}\n                name=\"network\"\n                value=\"mainnet\"\n                label={<strong>Mainnet</strong>}\n                onChange={this.handleNetworkChange}\n                checked={network === MAINNET}\n                disabled={frozen}\n              />\n              <FormControlLabel\n                id=\"testnet\"\n                control={<Radio color=\"primary\" />}\n                name=\"network\"\n                value=\"testnet\"\n                label=\"Testnet\"\n                onChange={this.handleNetworkChange}\n                checked={network === TESTNET}\n                disabled={frozen}\n              />\n            </RadioGroup>\n            <FormHelperText>\n              <small>\n                Choose &apos;Mainnet&apos; if you don&apos;t understand the\n                difference.\n              </small>\n            </FormHelperText>\n          </FormControl>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nNetworkPicker.propTypes = {\n  network: PropTypes.string.isRequired,\n  frozen: PropTypes.bool.isRequired,\n  setNetwork: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    network: state.settings.network,\n    frozen: state.settings.frozen,\n  };\n}\n\nconst mapDispatchToProps = {\n  setNetwork: setNetworkAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NetworkPicker);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\n// Actions\n\n// Components\nimport {\n  Typography,\n  Grid,\n  IconButton,\n  Card,\n  CardHeader,\n  CardContent,\n  Box,\n} from \"@material-ui/core\";\nimport { AddCircle, RemoveCircle } from \"@material-ui/icons\";\nimport {\n  setTotalSigners as setTotalSignersAction,\n  setRequiredSigners as setRequiredSignersAction,\n} from \"../actions/settingsActions\";\nimport \"./styles.css\";\n\nconst MAX_TOTAL_SIGNERS = 7;\n\nclass QuorumPicker extends React.Component {\n  renderIncrementRequiredSigners = () => {\n    const { requiredSigners, totalSigners, frozen } = this.props;\n    const disabled = requiredSigners === totalSigners || frozen;\n    return (\n      <IconButton\n        color=\"primary\"\n        onClick={this.handleIncrementRequiredSigners}\n        disabled={disabled}\n      >\n        <AddCircle />\n      </IconButton>\n    );\n  };\n\n  renderDecrementRequiredSigners = () => {\n    const { requiredSigners, frozen } = this.props;\n    const disabled = requiredSigners === 1 || frozen;\n    return (\n      <IconButton\n        color=\"secondary\"\n        onClick={this.handleDecrementRequiredSigners}\n        disabled={disabled}\n      >\n        <RemoveCircle />\n      </IconButton>\n    );\n  };\n\n  renderIncrementTotalSigners = () => {\n    const { totalSigners, frozen } = this.props;\n    const disabled = totalSigners === MAX_TOTAL_SIGNERS || frozen;\n    return (\n      <IconButton\n        color=\"primary\"\n        onClick={this.handleIncrementTotalSigners}\n        disabled={disabled}\n      >\n        <AddCircle />\n      </IconButton>\n    );\n  };\n\n  renderDecrementTotalSigners = () => {\n    const { requiredSigners, totalSigners, frozen } = this.props;\n    const disabled =\n      totalSigners === requiredSigners || totalSigners === 2 || frozen;\n    return (\n      <IconButton\n        color=\"secondary\"\n        onClick={this.handleDecrementTotalSigners}\n        disabled={disabled}\n      >\n        <RemoveCircle />\n      </IconButton>\n    );\n  };\n\n  handleIncrementRequiredSigners = (event) => {\n    const { requiredSigners, setRequiredSigners } = this.props;\n    setRequiredSigners(requiredSigners + 1);\n    event.preventDefault();\n  };\n\n  handleDecrementRequiredSigners = (event) => {\n    const { requiredSigners, setRequiredSigners } = this.props;\n    setRequiredSigners(requiredSigners - 1);\n    event.preventDefault();\n  };\n\n  handleIncrementTotalSigners = (event) => {\n    const { totalSigners, setTotalSigners } = this.props;\n    setTotalSigners(totalSigners + 1);\n    event.preventDefault();\n  };\n\n  handleDecrementTotalSigners = (event) => {\n    const { totalSigners, setTotalSigners } = this.props;\n    setTotalSigners(totalSigners - 1);\n    event.preventDefault();\n  };\n\n  render() {\n    const { requiredSigners, totalSigners } = this.props;\n\n    return (\n      <Card>\n        <CardHeader title=\"Quorum\" />\n        <CardContent>\n          <Box>\n            <Grid container justify=\"center\">\n              <Grid container item xs={2} direction=\"column\">\n                &nbsp;\n              </Grid>\n\n              <Grid\n                container\n                item\n                xs={3}\n                direction=\"column\"\n                alignItems=\"center\"\n              >\n                <Grid item>{this.renderIncrementRequiredSigners()}</Grid>\n\n                <Grid item>\n                  <Typography variant=\"h2\">{requiredSigners}</Typography>\n                </Grid>\n\n                <Grid item>\n                  <small>\n                    <p>Required</p>\n                  </small>\n                </Grid>\n\n                <Grid item>{this.renderDecrementRequiredSigners()}</Grid>\n              </Grid>\n\n              <Grid\n                container\n                item\n                xs={2}\n                direction=\"column\"\n                alignItems=\"center\"\n                justify=\"center\"\n              >\n                <Grid item>\n                  <Typography variant=\"h6\">of</Typography>\n                </Grid>\n              </Grid>\n\n              <Grid\n                item\n                container\n                xs={3}\n                direction=\"column\"\n                alignItems=\"center\"\n              >\n                <Grid item>{this.renderIncrementTotalSigners()}</Grid>\n\n                <Grid item>\n                  <Typography variant=\"h2\">{totalSigners}</Typography>\n                </Grid>\n\n                <Grid item>\n                  <small>\n                    <p>Total</p>\n                  </small>\n                </Grid>\n\n                <Grid item>{this.renderDecrementTotalSigners()}</Grid>\n              </Grid>\n              <Grid container item xs={2} direction=\"column\">\n                &nbsp;\n              </Grid>\n            </Grid>\n          </Box>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nQuorumPicker.propTypes = {\n  totalSigners: PropTypes.number.isRequired,\n  requiredSigners: PropTypes.number.isRequired,\n  frozen: PropTypes.bool.isRequired,\n  setTotalSigners: PropTypes.func.isRequired,\n  setRequiredSigners: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return state.settings;\n}\n\nconst mapDispatchToProps = {\n  setTotalSigners: setTotalSignersAction,\n  setRequiredSigners: setRequiredSignersAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(QuorumPicker);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { P2SH, P2SH_P2WSH, P2WSH } from \"unchained-bitcoin\";\n\n// Components\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  FormControl,\n  RadioGroup,\n  FormControlLabel,\n  Radio,\n  FormHelperText,\n} from \"@material-ui/core\";\n// Actions\nimport { setAddressType } from \"../actions/settingsActions\";\n\nclass AddressTypePicker extends React.Component {\n  handleTypeChange = (event) => {\n    const { setType } = this.props;\n    setType(event.target.value);\n  };\n\n  render() {\n    const { addressType, frozen } = this.props;\n    return (\n      <Card>\n        <CardHeader title=\"Address Type\" />\n        <CardContent>\n          <FormControl component=\"fieldset\">\n            <RadioGroup>\n              <FormControlLabel\n                id={P2SH}\n                control={<Radio color=\"primary\" />}\n                name=\"type\"\n                value={P2SH}\n                label={P2SH}\n                onChange={this.handleTypeChange}\n                checked={addressType === P2SH}\n                disabled={frozen}\n              />\n              <FormControlLabel\n                id={P2SH_P2WSH}\n                control={<Radio color=\"primary\" />}\n                name=\"type\"\n                value={P2SH_P2WSH}\n                label={P2SH_P2WSH}\n                onChange={this.handleTypeChange}\n                checked={addressType === P2SH_P2WSH}\n                disabled={frozen}\n              />\n              <FormControlLabel\n                id={P2WSH}\n                control={<Radio color=\"primary\" />}\n                name=\"type\"\n                value={P2WSH}\n                label={P2WSH}\n                onChange={this.handleTypeChange}\n                checked={addressType === P2WSH}\n                disabled={frozen}\n              />\n            </RadioGroup>\n            <FormHelperText>\n              <small>\n                Choose &apos;\n                {P2WSH}\n                &apos; for best practices, &apos;\n                {P2SH}\n                &apos; for greatest compatibility.\n              </small>\n            </FormHelperText>\n          </FormControl>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nAddressTypePicker.propTypes = {\n  addressType: PropTypes.string.isRequired,\n  frozen: PropTypes.bool.isRequired,\n  setType: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return state.settings;\n}\n\nconst mapDispatchToProps = {\n  setType: setAddressType,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddressTypePicker);\n","function actionWrapper(type) {\n  return (value) => {\n    return { type, value };\n  };\n}\n\nexport function wrappedActions(mapping) {\n  const wrappedMapping = {};\n  const actionFunctionNames = Object.keys(mapping);\n  let actionIndex;\n  for (\n    actionIndex = 0;\n    actionIndex < actionFunctionNames.length;\n    actionIndex += 1\n  ) {\n    const actionFunctionName = actionFunctionNames[actionIndex];\n    const actionType = mapping[actionFunctionName];\n    wrappedMapping[actionFunctionName] = actionWrapper(actionType);\n  }\n  return wrappedMapping;\n}\n\nfunction numberedActionWrapper(type) {\n  return (number, value) => {\n    return { type, number, value };\n  };\n}\n\nexport function wrappedNumberedActions(mapping) {\n  const wrappedMapping = {};\n  const actionFunctionNames = Object.keys(mapping);\n  let actionIndex;\n  for (\n    actionIndex = 0;\n    actionIndex < actionFunctionNames.length;\n    actionIndex += 1\n  ) {\n    const actionFunctionName = actionFunctionNames[actionIndex];\n    const actionType = mapping[actionFunctionName];\n    wrappedMapping[actionFunctionName] = numberedActionWrapper(actionType);\n  }\n  return wrappedMapping;\n}\n","export const SET_CLIENT_TYPE = \"SET_CLIENT_TYPE\";\nexport const SET_CLIENT_URL = \"SET_CLIENT_URL\";\nexport const SET_CLIENT_USERNAME = \"SET_CLIENT_USERNAME\";\nexport const SET_CLIENT_PASSWORD = \"SET_CLIENT_PASSWORD\";\n\nexport const SET_CLIENT_URL_ERROR = \"SET_CLIENT_URL_ERROR\";\nexport const SET_CLIENT_USERNAME_ERROR = \"SET_CLIENT_USERNAME_ERROR\";\nexport const SET_CLIENT_PASSWORD_ERROR = \"SET_CLIENT_PASSWORD_ERROR\";\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\n// Components\nimport {\n  Grid,\n  TextField,\n  Button,\n  FormHelperText,\n  Box,\n} from \"@material-ui/core\";\n\nimport { externalLink } from \"../../utils\";\n\nconst PrivateClientSettings = ({\n  handleUrlChange,\n  handleUsernameChange,\n  handlePasswordChange,\n  client,\n  urlError,\n  usernameError,\n  passwordError,\n  privateNotes,\n  connectSuccess,\n  connectError,\n  testConnection,\n}) => (\n  <div>\n    <p>\n      A <code>bitcoind</code>\n      -compatible client is required to query UTXO data, estimate fees, and\n      broadcast transactions.\n    </p>\n    <p>\n      <small>\n        {\n          \"Due to CORS requirements, you must use a proxy around the node. Instructions are available \"\n        }\n        {externalLink(\n          \"https://github.com/unchained-capital/caravan#adding-cors-headers\",\n          \"here\"\n        )}\n        {\".\"}\n      </small>\n    </p>\n    <form>\n      <Grid container direction=\"column\" spacing={1}>\n        <Grid item>\n          <TextField\n            fullWidth\n            label=\"URL\"\n            value={client.url}\n            onChange={handleUrlChange}\n            error={urlError !== \"\"}\n            helperText={urlError}\n          />\n        </Grid>\n\n        <Grid item>\n          <TextField\n            id=\"bitcoind-username\"\n            fullWidth\n            label=\"Username\"\n            value={client.username}\n            onChange={handleUsernameChange}\n            error={usernameError !== \"\"}\n            helperText={usernameError}\n          />\n        </Grid>\n\n        <Grid item>\n          <TextField\n            id=\"bitcoind-password\"\n            fullWidth\n            type=\"password\"\n            label=\"Password\"\n            value={client.password}\n            onChange={handlePasswordChange}\n            error={passwordError !== \"\"}\n            helperText={passwordError}\n          />\n        </Grid>\n        <Grid item>\n          <Box mt={1}>\n            <Button variant=\"contained\" onClick={testConnection}>\n              Test Connection\n            </Button>\n          </Box>\n          <Box mt={2}>\n            {connectSuccess && (\n              <FormHelperText>Connection Success!</FormHelperText>\n            )}\n            {connectError !== \"\" && (\n              <FormHelperText error>{connectError}</FormHelperText>\n            )}\n          </Box>\n        </Grid>\n      </Grid>\n    </form>\n    {privateNotes}\n  </div>\n);\n\nPrivateClientSettings.propTypes = {\n  client: PropTypes.shape({\n    url: PropTypes.string.isRequired,\n    username: PropTypes.string.isRequired,\n    password: PropTypes.string.isRequired,\n  }).isRequired,\n  handleUrlChange: PropTypes.func.isRequired,\n  handleUsernameChange: PropTypes.func.isRequired,\n  handlePasswordChange: PropTypes.func.isRequired,\n  testConnection: PropTypes.func.isRequired,\n  urlError: PropTypes.string,\n  usernameError: PropTypes.string,\n  passwordError: PropTypes.string,\n  privateNotes: PropTypes.node,\n  connectSuccess: PropTypes.bool.isRequired,\n  connectError: PropTypes.string.isRequired,\n};\n\nPrivateClientSettings.defaultProps = {\n  urlError: \"\",\n  usernameError: \"\",\n  passwordError: \"\",\n  privateNotes: React.createElement(\"span\"),\n};\n\nexport default PrivateClientSettings;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  Grid,\n  Card,\n  CardHeader,\n  CardContent,\n  FormControlLabel,\n  FormControl,\n  Radio,\n  RadioGroup,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport { fetchFeeEstimate } from \"../../blockchain\";\n\n// Components\n\n// Actions\nimport { wrappedActions } from \"../../actions/utils\";\nimport {\n  SET_CLIENT_TYPE,\n  SET_CLIENT_URL,\n  SET_CLIENT_USERNAME,\n  SET_CLIENT_PASSWORD,\n  SET_CLIENT_URL_ERROR,\n  SET_CLIENT_USERNAME_ERROR,\n  SET_CLIENT_PASSWORD_ERROR,\n} from \"../../actions/clientActions\";\n\nimport PrivateClientSettings from \"./PrivateClientSettings\";\n\nclass ClientPicker extends React.Component {\n  static validatePassword() {\n    return \"\";\n  }\n\n  static validateUsername() {\n    return \"\";\n  }\n\n  static validateUrl(host) {\n    const validhost = /^http(s)?:\\/\\/[^\\s]+$/.exec(host);\n    if (!validhost) return \"Must be a valid URL.\";\n    return \"\";\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      urlEdited: false,\n      connectError: \"\",\n      connectSuccess: false,\n    };\n  }\n\n  handleTypeChange = (event) => {\n    const { setType, network, setUrl } = this.props;\n    const { urlEdited } = this.state;\n\n    const type = event.target.value;\n    if (type === \"private\" && !urlEdited) {\n      setUrl(`http://localhost:${network === \"mainnet\" ? 8332 : 18332}`);\n    }\n    setType(type);\n  };\n\n  handleUrlChange = (event) => {\n    const { setUrl, setUrlError } = this.props;\n    const { urlEdited } = this.state;\n    const url = event.target.value;\n    const error = ClientPicker.validateUrl(url);\n    if (!urlEdited && !error) this.setState({ urlEdited: true });\n    setUrl(url);\n    setUrlError(error);\n  };\n\n  handleUsernameChange = (event) => {\n    const { setUsername, setUsernameError } = this.props;\n    const username = event.target.value;\n    const error = ClientPicker.validateUsername(username);\n    setUsername(username);\n    setUsernameError(error);\n  };\n\n  handlePasswordChange = (event) => {\n    const { setPassword, setPasswordError } = this.props;\n    const password = event.target.value;\n    const error = ClientPicker.validatePassword(password);\n    setPassword(password);\n    setPasswordError(error);\n  };\n\n  testConnection = async () => {\n    const { network, client, onSuccess } = this.props;\n    this.setState({ connectError: \"\", connectSuccess: false });\n    try {\n      await fetchFeeEstimate(network, client);\n      if (onSuccess) {\n        onSuccess();\n      }\n      this.setState({ connectSuccess: true });\n    } catch (e) {\n      this.setState({ connectError: e.message });\n    }\n  };\n\n  render() {\n    const {\n      client,\n      urlError,\n      usernameError,\n      passwordError,\n      privateNotes,\n    } = this.props;\n    const { connectSuccess, connectError } = this.state;\n    return (\n      <Card>\n        <Grid container justify=\"space-between\">\n          <CardHeader title=\"Bitcoin Client\" />\n        </Grid>\n        <CardContent>\n          <Grid item>\n            <FormControl component=\"fieldset\">\n              <RadioGroup>\n                <FormControlLabel\n                  id=\"public\"\n                  control={<Radio color=\"primary\" />}\n                  name=\"clientType\"\n                  value=\"public\"\n                  label={<strong>Public</strong>}\n                  onChange={this.handleTypeChange}\n                  checked={client.type === \"public\"}\n                />\n                <FormControlLabel\n                  id=\"private\"\n                  control={<Radio color=\"primary\" />}\n                  name=\"clientType\"\n                  value=\"private\"\n                  label=\"Private\"\n                  onChange={this.handleTypeChange}\n                  checked={client.type === \"private\"}\n                />\n              </RadioGroup>\n              {client.type === \"public\" && (\n                <FormHelperText>\n                  {\"'Public' uses the \"}\n                  <code>blockstream.info</code>\n                  {\" API. Switch to private to use a \"}\n                  <code>bitcoind</code>\n                  {\" node.\"}\n                </FormHelperText>\n              )}\n              {client.type === \"private\" && (\n                <PrivateClientSettings\n                  handleUrlChange={(event) => this.handleUrlChange(event)}\n                  handleUsernameChange={(event) =>\n                    this.handleUsernameChange(event)\n                  }\n                  handlePasswordChange={(event) =>\n                    this.handlePasswordChange(event)\n                  }\n                  client={client}\n                  urlError={urlError}\n                  usernameError={usernameError}\n                  passwordError={passwordError}\n                  privateNotes={privateNotes}\n                  connectSuccess={connectSuccess}\n                  connectError={connectError}\n                  testConnection={() => this.testConnection()}\n                />\n              )}\n            </FormControl>\n          </Grid>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nClientPicker.propTypes = {\n  client: PropTypes.shape({\n    type: PropTypes.string.isRequired,\n  }).isRequired,\n  network: PropTypes.string.isRequired,\n  privateNotes: PropTypes.shape({}),\n  setUrl: PropTypes.func.isRequired,\n  urlError: PropTypes.string,\n  onSuccess: PropTypes.func,\n  setUrlError: PropTypes.func.isRequired,\n  setPassword: PropTypes.func.isRequired,\n  passwordError: PropTypes.string,\n  setPasswordError: PropTypes.func.isRequired,\n  setType: PropTypes.func.isRequired,\n  usernameError: PropTypes.string,\n  setUsername: PropTypes.func.isRequired,\n  setUsernameError: PropTypes.func.isRequired,\n};\n\nClientPicker.defaultProps = {\n  urlError: \"\",\n  usernameError: \"\",\n  onSuccess: null,\n  passwordError: \"\",\n  privateNotes: React.createElement(\"span\"),\n};\n\nfunction mapStateToProps(state) {\n  return {\n    network: state.settings.network,\n    client: state.client,\n    urlError: state.client.urlError,\n    url: state.client.url,\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  wrappedActions({\n    setType: SET_CLIENT_TYPE,\n    setUrl: SET_CLIENT_URL,\n    setUsername: SET_CLIENT_USERNAME,\n    setPassword: SET_CLIENT_PASSWORD,\n    setUrlError: SET_CLIENT_URL_ERROR,\n    setUsernameError: SET_CLIENT_USERNAME_ERROR,\n    setPasswordError: SET_CLIENT_PASSWORD_ERROR,\n  })\n)(ClientPicker);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { validateBIP32Index } from \"unchained-bitcoin\";\nimport {\n  Grid,\n  Card,\n  CardHeader,\n  CardContent,\n  FormControlLabel,\n  FormControl,\n  FormHelperText,\n  Radio,\n  RadioGroup,\n  TextField,\n  Tooltip,\n} from \"@material-ui/core\";\n\nimport { wrappedActions } from \"../actions/utils\";\nimport { SET_STARTING_ADDRESS_INDEX } from \"../actions/settingsActions\";\n\nclass StartingAddressIndexPicker extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      customIndex: props.startingAddressIndex !== 0,\n      startingAddressIndexField: props.startingAddressIndex,\n    };\n  }\n\n  handleIndexChange = (event) => {\n    const { setStartingAddressIndex } = this.props;\n    const index = event.target.value;\n    const error = validateBIP32Index(index, { mode: \"unhardened\" }).replace(\n      \"BIP32\",\n      \"Starting Address\"\n    );\n    if (!error && index) {\n      setStartingAddressIndex(parseInt(index, 10));\n    }\n    this.setState({\n      startingAddressIndexField: index,\n      startingAddressIndexError: error,\n    });\n  };\n\n  handleCustomIndexChange = (event) => {\n    const customIndex = event.target.value === \"true\";\n    this.setState({ customIndex });\n  };\n\n  render() {\n    const {\n      customIndex,\n      startingAddressIndexField,\n      startingAddressIndexError,\n    } = this.state;\n    return (\n      <Card>\n        <Grid container justify=\"space-between\">\n          <CardHeader title=\"Starting Address Index\" />\n        </Grid>\n        <CardContent>\n          <Grid item>\n            <FormControl component=\"fieldset\">\n              <RadioGroup>\n                <FormControlLabel\n                  id=\"default\"\n                  control={<Radio color=\"primary\" />}\n                  name=\"customIndex\"\n                  value=\"false\"\n                  label={<strong>Default (0)</strong>}\n                  onChange={this.handleCustomIndexChange}\n                  checked={!customIndex}\n                />\n                <Tooltip\n                  title=\"The starting address index allows you to skip\n                    forward in a wallet. Addresses with indices less than the\n                    starting address are ignored.\"\n                >\n                  <FormControlLabel\n                    id=\"custom\"\n                    control={<Radio color=\"primary\" />}\n                    name=\"customIndex\"\n                    value=\"true\"\n                    label=\"Custom\"\n                    onChange={this.handleCustomIndexChange}\n                    checked={customIndex}\n                  />\n                </Tooltip>\n                <FormHelperText>\n                  Use the default value if you do not understand how to use\n                  starting address index.\n                </FormHelperText>\n              </RadioGroup>\n              {customIndex && (\n                <TextField\n                  fullWidth\n                  value={startingAddressIndexField}\n                  type=\"text\"\n                  name=\"startingAddressIndex\"\n                  onChange={this.handleIndexChange}\n                  error={Boolean(startingAddressIndexError)}\n                  helperText={startingAddressIndexError}\n                />\n              )}\n            </FormControl>\n          </Grid>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nStartingAddressIndexPicker.propTypes = {\n  startingAddressIndex: PropTypes.number.isRequired,\n  setStartingAddressIndex: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    startingAddressIndex: state.settings.startingAddressIndex,\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  wrappedActions({\n    setStartingAddressIndex: SET_STARTING_ADDRESS_INDEX,\n  })\n)(StartingAddressIndexPicker);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n  Box,\n} from \"@material-ui/core\";\nimport { Alert } from \"@material-ui/lab\";\n\nclass WalletConfirmation extends React.Component {\n  render = () => {\n    const { startingAddressIndex } = this.props;\n    return (\n      <Box>\n        {startingAddressIndex > 0 && (\n          <Alert severity=\"info\">\n            Starting Address Index set to {startingAddressIndex}\n          </Alert>\n        )}\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableCell>Name</TableCell>\n              <TableCell>BIP32 Path</TableCell>\n              <TableCell>Extended Public Key</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>{this.renderConfirmationInfo()}</TableBody>\n        </Table>\n      </Box>\n    );\n  };\n\n  renderConfirmationInfo = () => {\n    const { extendedPublicKeyImporters } = this.props;\n    return Object.values(extendedPublicKeyImporters).map((importer) => (\n      <TableRow key={importer.extendedPublicKey}>\n        <TableCell>{importer.name}</TableCell>\n        <TableCell>\n          {importer.method === \"text\" ? \"N/A\" : importer.bip32Path}\n        </TableCell>\n        <TableCell>{importer.extendedPublicKey}</TableCell>\n      </TableRow>\n    ));\n  };\n}\n\nWalletConfirmation.propTypes = {\n  startingAddressIndex: PropTypes.number.isRequired,\n  extendedPublicKeyImporters: PropTypes.shape({}).isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    startingAddressIndex: state.settings.startingAddressIndex,\n    extendedPublicKeyImporters: state.quorum.extendedPublicKeyImporters,\n  };\n}\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WalletConfirmation);\n","import PropTypes from \"prop-types\";\n\nexport const bigNumberPropTypes = {\n  c: PropTypes.arrayOf(PropTypes.number).isRequired,\n  e: PropTypes.number.isRequired,\n  s: PropTypes.number.isRequired,\n};\n\nexport default {\n  bigNumberPropTypes,\n};\n","import PropTypes from \"prop-types\";\nimport { bigNumberPropTypes } from \"./utils\";\n\nconst slicePropTypes = {\n  present: PropTypes.bool,\n  bip32Path: PropTypes.string,\n  publicKeys: PropTypes.array,\n  multisig: PropTypes.shape({}),\n  address: PropTypes.string.isRequired,\n  balanceSats: PropTypes.shape(bigNumberPropTypes),\n  utxos: PropTypes.array,\n  change: PropTypes.bool.isRequired,\n  spend: PropTypes.bool.isRequired,\n  fetchUtxos: PropTypes.bool,\n  fetchUTXOsError: PropTypes.string.isRequired,\n  addressUsed: PropTypes.bool,\n  addressKnown: PropTypes.bool.isRequired,\n  lastUsed: PropTypes.string,\n};\n\nexport default slicePropTypes;\n","import PropTypes from \"prop-types\";\n\nconst clientPropTypes = {\n  type: PropTypes.string.isRequired,\n  url: PropTypes.string,\n  username: PropTypes.string,\n  password: PropTypes.string,\n  urlError: PropTypes.string,\n  usernameError: PropTypes.string,\n  passwordError: PropTypes.string,\n  status: PropTypes.string,\n};\n\nexport default clientPropTypes;\n","import PropTypes from \"prop-types\";\n\nconst settingsPropTypes = {\n  network: PropTypes.string,\n  totalSigners: PropTypes.number,\n  requiredSigners: PropTypes.number,\n  addressType: PropTypes.string,\n  frozen: PropTypes.bool,\n};\n\nexport default settingsPropTypes;\n","import PropTypes from \"prop-types\";\nimport React, { useState, useEffect } from \"react\";\n\n// Components\nimport CopyToClipboard from \"react-copy-to-clipboard\";\nimport { FileCopy } from \"@material-ui/icons\";\nimport { IconButton, makeStyles } from \"@material-ui/core\";\nimport { useSnackbar } from \"notistack\";\n\nconst useStyles = makeStyles(() => ({\n  copyText: {\n    \"&:hover\": { cursor: \"pointer\" },\n  },\n  code: {\n    fontSize: \"1rem\",\n  },\n}));\n\nconst Copyable = ({\n  newline,\n  text,\n  children,\n  showIcon,\n  showText,\n  code,\n  ...otherProps\n}) => {\n  const [copied, setCopied] = useState(false);\n  const [timer, setTimer] = useState(null);\n  const { enqueueSnackbar } = useSnackbar();\n\n  useEffect(() => {\n    if (timer) clearTimeout(timer);\n    // eslint-disable-next-line\n  }, []);\n\n  const classes = useStyles();\n\n  const showSnackbarMessage = () => {\n    const MAX_LENGTH = 25;\n    const shortenedText =\n      text.length > MAX_LENGTH ? `${text.substring(0, MAX_LENGTH)}...` : text;\n\n    enqueueSnackbar(`Copied ${shortenedText} to clipboard`, {\n      preventDuplicate: true,\n    });\n  };\n\n  const onCopy = () => {\n    const timerTimeout = setTimeout(() => {\n      setCopied(false);\n      setTimer(null);\n    }, 1000);\n\n    setCopied(true);\n    setTimer(timerTimeout);\n\n    showSnackbarMessage();\n  };\n\n  const TextComponent = () => {\n    if (code) return <code className={classes.code}>{text}</code>;\n    return <span>{text}</span>;\n  };\n\n  return (\n    // eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions\n    <span onClick={(e) => e.stopPropagation()} {...otherProps}>\n      <CopyToClipboard\n        text={text}\n        onCopy={onCopy}\n        options={{ format: \"text/plain\" }}\n      >\n        <span\n          style={{\n            fontStyle: copied ? \"italic\" : \"inherit\",\n            overflowWrap: \"break-word\",\n          }}\n          className={`copyable ${classes.copyText}`}\n        >\n          {children}\n          {showText && <TextComponent />}\n          {newline && <br />}\n          {showIcon && (\n            <IconButton>\n              <FileCopy\n                fontSize=\"small\"\n                color={copied ? \"primary\" : \"action\"}\n              />\n            </IconButton>\n          )}\n        </span>\n      </CopyToClipboard>\n    </span>\n  );\n};\n\nCopyable.propTypes = {\n  // defaults\n  newline: PropTypes.bool,\n  // parent\n  text: PropTypes.string.isRequired,\n  children: PropTypes.node,\n  showIcon: PropTypes.bool,\n  showText: PropTypes.bool,\n  code: PropTypes.bool,\n};\n\nCopyable.defaultProps = {\n  newline: false,\n  showIcon: false,\n  children: React.createElement(\"span\"),\n  showText: true,\n  code: false,\n};\nexport default Copyable;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  blockExplorerTransactionURL,\n  satoshisToBitcoins,\n} from \"unchained-bitcoin\";\nimport {\n  Table,\n  TableHead,\n  TableBody,\n  TableFooter,\n  TableRow,\n  TableCell,\n  Typography,\n  Checkbox,\n} from \"@material-ui/core\";\nimport { OpenInNew } from \"@material-ui/icons\";\nimport BigNumber from \"bignumber.js\";\nimport { externalLink } from \"../../utils\";\nimport Copyable from \"../Copyable\";\n\n// Actions\nimport { setInputs as setInputsAction } from \"../../actions/transactionActions\";\n\n// Assets\nimport \"react-table/react-table.css\";\nimport styles from \"./styles.module.scss\";\n\nclass UTXOSet extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      inputsSatsSelected: props.inputsTotalSats,\n      localInputs: props.inputs.map((input) => {\n        return {\n          ...input,\n          checked: props.selectAll,\n        };\n      }),\n      toggleAll: true,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    // This function exists because we need to respond to the parent node having\n    // its select/spend checkbox clicked (toggling select-all or select-none).\n    // None of this needs to happen on the redeem script interface.\n    const { multisig } = this.props;\n    if (multisig) {\n      const { node, existingTransactionInputs } = this.props;\n      const { localInputs } = this.state;\n      const prevMyInputsBeingSpent = this.filterInputs(\n        localInputs,\n        prevProps.existingTransactionInputs,\n        true\n      ).length;\n      const myInputsBeingSpent = this.filterInputs(\n        localInputs,\n        existingTransactionInputs,\n        true\n      ).length;\n\n      const isFullSpend = myInputsBeingSpent === localInputs.length;\n\n      // If the spend bool on the node changes, toggleAll the checks.\n      // but that's not quite enough because if a single UTXO is selected\n      // then it is also marked from not spend -> spend ... so don't want\n      // to toggleAll in that case. Furthermore, if you have 5 UTXOs and\n      // 2 selected and *then* click select all ... we also need to toggelAll.\n      if (\n        (prevProps.node.spend !== node.spend ||\n          myInputsBeingSpent !== prevMyInputsBeingSpent) &&\n        isFullSpend\n      ) {\n        this.toggleAll(node.spend);\n      }\n    }\n  }\n\n  filterInputs = (localInputs, transactionStoreInputs, filterToMyInputs) => {\n    return localInputs.filter((input) => {\n      const included = transactionStoreInputs.filter((utxo) => {\n        return utxo.txid === input.txid && utxo.index === input.index;\n      });\n      return filterToMyInputs ? included.length > 0 : included.length === 0;\n    });\n  };\n\n  toggleInput = (inputIndex) => {\n    const { localInputs } = this.state;\n    this.setState({ toggleAll: false });\n\n    localInputs[inputIndex].checked = !localInputs[inputIndex].checked;\n\n    this.setInputsAndUpdateDisplay(localInputs);\n  };\n\n  toggleAll = (setTo = null) => {\n    const { localInputs, toggleAll } = this.state;\n    const toggled = !toggleAll;\n\n    localInputs.forEach((input) => {\n      const i = input;\n      i.checked = setTo === null ? toggled : setTo;\n      return i;\n    });\n\n    this.setInputsAndUpdateDisplay(localInputs);\n    this.setState({ toggleAll: toggled });\n  };\n\n  setInputsAndUpdateDisplay = (incomingInputs) => {\n    const {\n      setInputs,\n      multisig,\n      bip32Path,\n      existingTransactionInputs,\n      setSpendCheckbox,\n    } = this.props;\n    const { localInputs } = this.state;\n    let inputsToSpend = incomingInputs.filter((input) => input.checked);\n    if (multisig) {\n      inputsToSpend = inputsToSpend.map((utxo) => {\n        return { ...utxo, multisig, bip32Path };\n      });\n    }\n    const satsSelected = inputsToSpend.reduce(\n      (accumulator, input) => accumulator.plus(input.amountSats),\n      new BigNumber(0)\n    );\n    this.setState({\n      inputsSatsSelected: satsSelected,\n    });\n    let totalInputsToSpend = inputsToSpend;\n\n    // The following is only relevant on the wallet interface\n    if (multisig) {\n      // There are 3 total sets of inputs to care about:\n      // 1. localInputs - all inputs from this node/address\n      // 2. inputsToSpend - equal to or subset of those from #1 (inputs marked checked==true)\n      // 3. existingTransactionInputs - all inputs from all nodes/addresses\n\n      // Check if #3 contains any inputs not associated with this component\n      const notMyInputs = this.filterInputs(\n        existingTransactionInputs,\n        localInputs,\n        false\n      );\n\n      if (notMyInputs.length > 0) {\n        totalInputsToSpend = inputsToSpend.concat(notMyInputs);\n      }\n\n      // Now we push a change up to the top level node so it can update its checkbox\n      const numLocalInputsToSpend = inputsToSpend.length;\n      if (numLocalInputsToSpend === 0) {\n        setSpendCheckbox(false);\n      } else if (numLocalInputsToSpend < localInputs.length) {\n        setSpendCheckbox(\"indeterminate\");\n      } else {\n        setSpendCheckbox(true);\n      }\n    }\n\n    if (totalInputsToSpend.length > 0) {\n      setInputs(totalInputsToSpend);\n    } else if (multisig) {\n      // If we do this on redeem script interface, the panel will disappear\n      setInputs([]);\n    }\n  };\n\n  renderInputs = () => {\n    const { network, showSelection, finalizedOutputs } = this.props;\n    const { localInputs } = this.state;\n    return localInputs.map((input, inputIndex) => {\n      const confirmedStyle = `${styles.utxoTxid}${\n        input.confirmed ? \"\" : ` ${styles.unconfirmed}`\n      }`;\n      const confirmedTitle = input.confirmed ? \"confirmed\" : \"unconfirmed\";\n      return (\n        <TableRow hover key={input.txid}>\n          {showSelection && (\n            <TableCell>\n              <Checkbox\n                data-testid={`utxo-checkbox-${inputIndex}`}\n                checked={input.checked}\n                onClick={() => this.toggleInput(inputIndex)}\n                color=\"primary\"\n                disabled={finalizedOutputs}\n              />\n            </TableCell>\n          )}\n          <TableCell>{inputIndex + 1}</TableCell>\n          <TableCell className={confirmedStyle}>\n            <Copyable text={input.txid} showIcon showText={false}>\n              <code title={confirmedTitle}>{input.txid}</code>\n            </Copyable>\n          </TableCell>\n          <TableCell>\n            <Copyable text={input.index.toString()} />\n          </TableCell>\n          <TableCell>\n            <Copyable text={satoshisToBitcoins(input.amountSats).toString()} />\n          </TableCell>\n          <TableCell>\n            {externalLink(\n              blockExplorerTransactionURL(input.txid, network),\n              <OpenInNew />\n            )}\n          </TableCell>\n        </TableRow>\n      );\n    });\n  };\n\n  render() {\n    const {\n      inputsTotalSats,\n      showSelection = true,\n      hideSelectAllInHeader,\n      finalizedOutputs,\n    } = this.props;\n    const { inputsSatsSelected, toggleAll, localInputs } = this.state;\n    return (\n      <>\n        <Typography variant=\"h5\">\n          {`Available Inputs (${localInputs.length})`}{\" \"}\n        </Typography>\n        <p>The following UTXOs will be spent as inputs in a new transaction.</p>\n        <Table>\n          <TableHead>\n            <TableRow hover>\n              {showSelection && !hideSelectAllInHeader && (\n                <TableCell>\n                  <Checkbox\n                    data-testid=\"utxo-check-all\"\n                    checked={toggleAll}\n                    onClick={() => this.toggleAll()}\n                    color=\"primary\"\n                    disabled={finalizedOutputs}\n                  />\n                </TableCell>\n              )}\n              {hideSelectAllInHeader && <TableCell />}\n              <TableCell>Number</TableCell>\n              <TableCell>TXID</TableCell>\n              <TableCell>Index</TableCell>\n              <TableCell>Amount (BTC)</TableCell>\n              <TableCell>View</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>{this.renderInputs()}</TableBody>\n          <TableFooter>\n            <TableRow hover>\n              <TableCell colSpan={3}>TOTAL:</TableCell>\n              <TableCell colSpan={2}>\n                {inputsSatsSelected\n                  ? satoshisToBitcoins(inputsSatsSelected).toString()\n                  : satoshisToBitcoins(inputsTotalSats).toString()}\n              </TableCell>\n            </TableRow>\n          </TableFooter>\n        </Table>\n      </>\n    );\n  }\n}\n\nUTXOSet.propTypes = {\n  network: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  inputsTotalSats: PropTypes.shape({}).isRequired,\n  setInputs: PropTypes.func.isRequired,\n  multisig: PropTypes.oneOfType([PropTypes.shape({}), PropTypes.bool]),\n  bip32Path: PropTypes.string,\n  showSelection: PropTypes.bool,\n  hideSelectAllInHeader: PropTypes.bool,\n  selectAll: PropTypes.bool,\n  finalizedOutputs: PropTypes.bool.isRequired,\n  node: PropTypes.shape({\n    spend: PropTypes.bool,\n  }),\n  existingTransactionInputs: PropTypes.arrayOf(PropTypes.shape({})),\n  setSpendCheckbox: PropTypes.func,\n};\n\nUTXOSet.defaultProps = {\n  multisig: false,\n  bip32Path: \"\",\n  showSelection: true,\n  hideSelectAllInHeader: false,\n  selectAll: true,\n  node: {},\n  existingTransactionInputs: [],\n  setSpendCheckbox: () => {},\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.settings,\n    finalizedOutputs: state.spend.transaction.finalizedOutputs,\n    existingTransactionInputs: state.spend.transaction.inputs,\n  };\n}\n\nconst mapDispatchToProps = {\n  setInputs: setInputsAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UTXOSet);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  scriptToOps,\n  scriptToHex,\n  networkLabel,\n  multisigAddressType,\n  multisigRedeemScript,\n  multisigWitnessScript,\n  multisigRequiredSigners,\n  multisigTotalSigners,\n  blockExplorerAddressURL,\n} from \"unchained-bitcoin\";\nimport { Typography, Grid, Box, Chip } from \"@material-ui/core\";\nimport { OpenInNew } from \"@material-ui/icons\";\nimport { externalLink } from \"../utils\";\n\n// Components\nimport Copyable from \"./Copyable\";\n\nclass MultisigDetails extends React.Component {\n  renderScript = (name, script) => {\n    const hex = scriptToHex(script);\n    const ops = scriptToOps(script);\n    return (\n      <Box mt={2}>\n        <Typography variant=\"h6\">{name}</Typography>\n        <Grid container spacing={2}>\n          <Grid item sm={6}>\n            <Copyable text={hex} showIcon code />\n          </Grid>\n          <Grid item sm={6}>\n            <Copyable text={ops} showIcon code />\n          </Grid>\n        </Grid>\n      </Box>\n    );\n  };\n\n  render() {\n    const { network, multisig, showAddress } = this.props;\n    const { address } = multisig;\n    const redeemScript = multisigRedeemScript(multisig);\n    const witnessScript = multisigWitnessScript(multisig);\n    return (\n      <Box mt={2} style={{ maxWidth: \"1080px\" }}>\n        {showAddress && <Typography variant=\"h6\">Address</Typography>}\n\n        <Typography align=\"center\" variant=\"h5\">\n          <Grid container direction=\"column\" spacing={2}>\n            {showAddress && (\n              <Grid item>\n                <Copyable text={address} showIcon code />\n                &nbsp;\n                {externalLink(\n                  blockExplorerAddressURL(address, network),\n                  <OpenInNew />\n                )}\n              </Grid>\n            )}\n\n            <Grid item justify=\"center\" container spacing={3}>\n              <Grid item>\n                <Chip label=\"BTC\" />\n              </Grid>\n\n              <Grid item>\n                <Chip label={networkLabel(network)} />\n              </Grid>\n\n              <Grid item>\n                <Chip\n                  label={`${multisigRequiredSigners(\n                    multisig\n                  )}-of-${multisigTotalSigners(multisig)}`}\n                />\n              </Grid>\n\n              <Grid item>\n                <Chip label={multisigAddressType(multisig)} />\n              </Grid>\n            </Grid>\n          </Grid>\n        </Typography>\n\n        {this.renderScript(\"Script\", multisig)}\n        {redeemScript && this.renderScript(\"Redeem Script\", redeemScript)}\n        {witnessScript && this.renderScript(\"Witness Script\", witnessScript)}\n      </Box>\n    );\n  }\n}\n\nMultisigDetails.propTypes = {\n  multisig: PropTypes.shape({\n    address: PropTypes.string,\n  }).isRequired,\n  network: PropTypes.string.isRequired,\n  showAddress: PropTypes.bool,\n};\n\nMultisigDetails.defaultProps = {\n  showAddress: true,\n};\n\nfunction mapStateToProps(state) {\n  return state.settings;\n}\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MultisigDetails);\n","import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\n\n// Components\nimport {\n  FormHelperText,\n  Button,\n  Box,\n  Switch,\n  FormControlLabel,\n  Tooltip,\n  makeStyles,\n  Grid,\n} from \"@material-ui/core\";\nimport InfoIcon from \"@material-ui/icons/Info\";\nimport {\n  bitcoindImportMulti,\n  bitcoindGetAddressStatus,\n  bitcoindParams,\n} from \"../bitcoind\";\nimport { clientPropTypes } from \"../proptypes\";\n\nconst useStyles = makeStyles(() => ({\n  tooltip: {\n    fontSize: \".8rem\",\n  },\n}));\n/**\n * @description A button for importing a set of given addresses. Includes a switch\n * to optionally choose to rescan the blockchain for balances.\n */\nfunction ImportAddressesButton({ addresses = [], client, importCallback }) {\n  const [imported, setImported] = useState(false);\n  const [importError, setImportError] = useState(\"\");\n  const [rescan, setRescanPreference] = useState(false);\n  const [addressesError, setAddressesError] = useState(\"\");\n  const [enableImport, setEnableImport] = useState(false);\n\n  const classes = useStyles();\n  // when addresses prop has changed, we want to check its status\n  // Address management currently isn't optimized and so they are added to the store\n  // one at at time. This effect is run each time that updates. Eventually,\n  // this should be optimized to happen all at once. For now though, once we find\n  // a single address that can be imported then enable the import button and\n  // we won't run this anymore. This is mostly for wallet view, not script entry\n  useEffect(() => {\n    const checkAddress = async () => {\n      // reset in case we can't import\n      setEnableImport(false);\n      const address = addresses[addresses.length - 1]; // TODO: loop, or maybe just check one\n      if (!address) return;\n      try {\n        const status = await bitcoindGetAddressStatus({\n          // TODO: use this to warn if spent\n          ...bitcoindParams(client),\n          address,\n        });\n        // if there is a problem querying the address, then enable the button\n        // once enabled, we won't run checkAddress effect anymore\n        if (!status || typeof status.used === \"undefined\") {\n          setEnableImport(true);\n        } else {\n          setEnableImport(false);\n        }\n        setAddressesError(\"\");\n      } catch (e) {\n        // e.status 401 e.statusText\n        // e.status 500 e.data.error.message\n        const status = (e.response && e.response.status) || \"unknown\";\n        const errorMessage =\n          // eslint-disable-next-line no-nested-ternary\n          status === 401\n            ? e.response.statusText\n            : status === 500\n            ? e.response.data.error.message\n            : e.message || \"An unknown address error occured\";\n\n        setAddressesError(errorMessage);\n      }\n    };\n\n    // check address if the button is disabled OR\n    // there's been an update to the address array and there's only one\n    // this typically is the case for the script interactions when dealing\n    // with a single address\n    if (\n      client.type === \"private\" &&\n      (!enableImport || addresses.length === 1)\n    ) {\n      checkAddress();\n    }\n    // eslint-disable-next-line\n  }, [addresses, client]);\n\n  // return \"addresses\" or \"address\"\n  const pluralOrSingularAddress = (capitalize = false) =>\n    `${capitalize ? \"A\" : \"a\"}ddress${\n      addresses && addresses.length > 1 ? \"es\" : \"\"\n    }`;\n\n  async function importAddresses() {\n    const label = \"\"; // TODO: do we want to allow to set? or set to \"caravan\"?\n\n    try {\n      const response = await bitcoindImportMulti({\n        ...bitcoindParams(client),\n        ...{ addresses, label, rescan },\n      });\n\n      const responseError = response.result.reduce((e, c) => {\n        return (c.error && c.error.message) || e;\n      }, \"\");\n\n      setImportError(responseError);\n      setImported(!responseError.length);\n\n      if (importCallback) {\n        // provide succesfully imported addreses to callback\n        const successes = response.result.filter((addr) => addr.success);\n        await importCallback(successes, rescan);\n      }\n    } catch (e) {\n      setImportError(\"Unable to import, check your settings and try again\");\n      setImported(false);\n    }\n  }\n\n  const rescanTooltip = `To get accurate information from your node, your ${pluralOrSingularAddress()}\nwill need to be imported to your node. Importing will give you accurate balance information\nhowever to know if an address has been used prior to import, a rescan needs to take place.`;\n\n  return (\n    <Grid className={classes.container}>\n      <Box component=\"span\" ml={2}>\n        <Button\n          variant=\"contained\"\n          disabled={(!enableImport && !rescan) || !addresses.length}\n          onClick={importAddresses}\n        >\n          Import {pluralOrSingularAddress(true)}\n        </Button>\n      </Box>\n      <Box component=\"span\" ml={2}>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={rescan}\n              onChange={(e) => setRescanPreference(e.target.checked)}\n              color=\"secondary\"\n            />\n          }\n          label=\"Rescan\"\n        />\n        <Tooltip title={rescanTooltip} classes={{ tooltip: classes.tooltip }}>\n          <InfoIcon fontSize=\"small\" color=\"disabled\" />\n        </Tooltip>\n      </Box>\n      <Box>\n        {addressesError.length > 0 && (\n          <FormHelperText error>{addressesError}</FormHelperText>\n        )}\n        {importError.length > 0 && (\n          <FormHelperText error>{importError}</FormHelperText>\n        )}\n        {imported && rescan && (\n          <FormHelperText>\n            {pluralOrSingularAddress(true)} imported, rescan of your node may\n            take some time.\n          </FormHelperText>\n        )}\n        {imported && !rescan && (\n          <FormHelperText>\n            {pluralOrSingularAddress(true)} imported.\n          </FormHelperText>\n        )}\n      </Box>\n    </Grid>\n  );\n}\n\nImportAddressesButton.propTypes = {\n  addresses: PropTypes.arrayOf(PropTypes.string),\n  importCallback: PropTypes.func,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n};\n\nImportAddressesButton.defaultProps = {\n  addresses: [],\n  importCallback() {},\n};\n\nexport default ImportAddressesButton;\n","import { wrappedNumberedActions } from \"./utils\";\n\nexport const SET_SIGNATURE_IMPORTER_NAME = \"SET_SIGNATURE_IMPORTER_NAME\";\nexport const SET_SIGNATURE_IMPORTER_METHOD = \"SET_SIGNATURE_IMPORTER_METHOD\";\nexport const SET_SIGNATURE_IMPORTER_BIP32_PATH =\n  \"SET_SIGNATURE_IMPORTER_BIP32_PATH\";\nexport const SET_SIGNATURE_IMPORTER_PUBLIC_KEYS =\n  \"SET_SIGNATURE_IMPORTER_PUBLIC_KEYS\";\nexport const SET_SIGNATURE_IMPORTER_SIGNATURE =\n  \"SET_SIGNATURE_IMPORTER_SIGNATURE\";\nexport const SET_SIGNATURE_IMPORTER_FINALIZED =\n  \"SET_SIGNATURE_IMPORTER_FINALIZED\";\nexport const SET_SIGNATURE_IMPORTER_COMPLETE =\n  \"SET_SIGNATURE_IMPORTER_COMPLETE\";\n\nexport const {\n  setSignatureImporterName,\n  setSignatureImporterMethod,\n  setSignatureImporterBIP32Path,\n  setSignatureImporterPublicKeys,\n  setSignatureImporterSignature,\n  setSignatureImporterFinalized,\n  setSignatureImporterComplete,\n} = wrappedNumberedActions({\n  setSignatureImporterName: SET_SIGNATURE_IMPORTER_NAME,\n  setSignatureImporterMethod: SET_SIGNATURE_IMPORTER_METHOD,\n  setSignatureImporterBIP32Path: SET_SIGNATURE_IMPORTER_BIP32_PATH,\n  setSignatureImporterPublicKeys: SET_SIGNATURE_IMPORTER_PUBLIC_KEYS,\n  setSignatureImporterSignature: SET_SIGNATURE_IMPORTER_SIGNATURE,\n  setSignatureImporterFinalized: SET_SIGNATURE_IMPORTER_FINALIZED,\n  setSignatureImporterComplete: SET_SIGNATURE_IMPORTER_COMPLETE,\n});\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Box, TextField, Button } from \"@material-ui/core\";\n\nclass TextSignatureImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      signatureJSON: \"\",\n      error: \"\",\n    };\n  }\n\n  render = () => {\n    const { signatureJSON, error } = this.state;\n    return (\n      <Box mt={2}>\n        <TextField\n          fullWidth\n          multiline\n          variant=\"outlined\"\n          name=\"signature\"\n          label=\"Signature\"\n          rows={5}\n          value={signatureJSON}\n          onChange={this.handleChange}\n          error={this.hasError()}\n          helperText={error}\n        />\n\n        <Box mt={2}>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            size=\"large\"\n            onClick={this.finalize}\n            disabled={signatureJSON === \"\"}\n          >\n            Add Signature\n          </Button>\n        </Box>\n      </Box>\n    );\n  };\n\n  hasError = () => {\n    const { error } = this.state;\n    return error !== \"\";\n  };\n\n  setError = (value) => {\n    this.setState({ error: value });\n  };\n\n  handleChange = (event) => {\n    const signatureJSON = event.target.value;\n    let error = \"\";\n    try {\n      JSON.parse(signatureJSON);\n    } catch (parseError) {\n      error = \"Invalid JSON.\";\n    }\n    this.setState({ signatureJSON, error });\n  };\n\n  finalize = () => {\n    const { validateAndSetSignature } = this.props;\n    const { signatureJSON } = this.state;\n    try {\n      const sig = JSON.parse(signatureJSON);\n      validateAndSetSignature(sig, this.setError);\n    } catch (e) {\n      this.setError(e.message);\n    }\n  };\n}\n\nTextSignatureImporter.propTypes = {\n  signatureImporter: PropTypes.shape({}).isRequired,\n  validateAndSetSignature: PropTypes.func.isRequired,\n};\n\nexport default TextSignatureImporter;\n","// FIXME\n/* eslint-disable max-classes-per-file */\n\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { INFO, WARNING, ERROR } from \"unchained-wallets\";\nimport {\n  Box,\n  Typography,\n  Tabs,\n  Tab,\n  Paper,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n} from \"@material-ui/core\";\nimport { Info, Warning, Error } from \"@material-ui/icons\";\n\nimport \"./InteractionMessages.css\";\n\nclass MessagesList extends React.Component {\n  render = () => {\n    const { messages } = this.props;\n    return (\n      <List style={{ maxHeight: \"400px\", overflow: \"auto\" }} dense>\n        {messages.map(this.renderMessage)}\n      </List>\n    );\n  };\n\n  renderMessage = (message, key) => {\n    return (\n      <ListItem key={key}>\n        {message.level && (\n          <ListItemIcon>{this.messageIcon(message)}</ListItemIcon>\n        )}\n        <ListItemText>\n          {this.renderMessageBodyAndSubmessages(message)}\n        </ListItemText>\n      </ListItem>\n    );\n  };\n\n  renderMessageBodyAndSubmessages = (message) => {\n    return (\n      <Box>\n        {this.renderMessageBody(message)}\n        {message.messages && (\n          <List dense>{message.messages.map(this.renderMessage)}</List>\n        )}\n      </Box>\n    );\n  };\n\n  renderMessageBody = (message) => {\n    return (\n      <Box>\n        {message.image && (\n          <Box align=\"center\">\n            <img\n              className=\"InteractionMessages-image\"\n              src={`data:${message.image.mimeType};base64, ${message.image.data}`}\n              alt={message.image.label}\n            />\n          </Box>\n        )}\n        <p>{message.text}</p>\n      </Box>\n    );\n  };\n\n  messageIcon = (message) => {\n    switch (message.level) {\n      case INFO:\n        return <Info />;\n      case WARNING:\n        return <Warning />;\n      case ERROR:\n        return <Error />;\n      default:\n        return null;\n    }\n  };\n}\n\nMessagesList.propTypes = {\n  messages: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n};\n\nclass VersionTabPanel extends React.Component {\n  render = () => {\n    const { version, currentVersion } = this.props;\n    return (\n      <Box\n        role=\"tabpanel\"\n        hidden={version !== currentVersion}\n        id={`interactionMessages-tabpanel-${version}`}\n        aria-labelledby={`interactionMessages-tab-${version}`}\n      >\n        {version === currentVersion && (\n          <MessagesList messages={this.filteredMessages()} />\n        )}\n      </Box>\n    );\n  };\n\n  filteredMessages = () => {\n    const { messages, version } = this.props;\n    return messages.filter((message) => {\n      if (message.version) {\n        return message.version === version;\n      }\n      return true;\n    });\n  };\n}\n\nVersionTabPanel.propTypes = {\n  messages: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  version: PropTypes.string.isRequired,\n  currentVersion: PropTypes.string.isRequired,\n};\n\nclass InteractionMessages extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentVersion: \"\",\n    };\n  }\n\n  render = () => {\n    const { messages, versions } = this.filteredMessages();\n    const currentVersion = this.currentVersion(versions);\n    if (versions.length < 2) {\n      return <MessagesList messages={messages} />;\n    }\n    return (\n      <Box>\n        <Typography variant=\"h6\">Model</Typography>\n        <Paper square>\n          <Tabs\n            value={currentVersion}\n            onChange={this.handleChange}\n            aria-label=\"interactionMessages-version\"\n          >\n            {versions.map((version) => (\n              <Tab\n                key={version}\n                value={version}\n                label={version}\n                id={`interactionMessages-tab-${version}`}\n                aria-controls={`interactionMessages-tabpanel-${version}`}\n              />\n            ))}\n          </Tabs>\n        </Paper>\n        {versions.map((version) => (\n          <VersionTabPanel\n            key={version}\n            version={version}\n            currentVersion={currentVersion}\n            messages={messages}\n          />\n        ))}\n      </Box>\n    );\n  };\n\n  currentVersion = (versions) => {\n    const { currentVersion } = this.state;\n    if (currentVersion) {\n      return currentVersion;\n    }\n    return versions[versions.length - 1];\n  };\n\n  handleChange = (event, newValue) => {\n    this.setState({ currentVersion: newValue });\n  };\n\n  filteredMessages = () => {\n    const { messages, excludeCodes } = this.props;\n    const filteredMessages = [];\n    const versions = [];\n    messages.forEach((message) => {\n      for (let i = 0; i < excludeCodes.length; i += 1) {\n        const excludeCode = excludeCodes[i];\n        if ((message.code || \"\").includes(excludeCode)) {\n          return;\n        }\n      }\n      filteredMessages.push(message);\n      if (message.version && !versions.includes(message.version)) {\n        versions.push(message.version);\n      }\n    });\n    return { versions, messages: filteredMessages };\n  };\n}\n\nInteractionMessages.propTypes = {\n  messages: PropTypes.arrayOf(PropTypes.shape({})),\n  excludeCodes: PropTypes.arrayOf(PropTypes.string),\n};\n\nInteractionMessages.defaultProps = {\n  messages: [],\n  excludeCodes: [],\n};\n\nexport default InteractionMessages;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { satoshisToBitcoins } from \"unchained-bitcoin\";\nimport {\n  PENDING,\n  UNSUPPORTED,\n  ACTIVE,\n  ERROR,\n  SignMultisigTransaction,\n} from \"unchained-wallets\";\nimport {\n  Button,\n  TextField,\n  FormHelperText,\n  Box,\n  Grid,\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n} from \"@material-ui/core\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nclass DirectSignatureImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      signatureError: \"\",\n      bip32PathError: \"\",\n      status: this.interaction().isSupported() ? PENDING : UNSUPPORTED,\n    };\n  }\n\n  componentDidMount = () => {\n    this.resetBIP32Path();\n  };\n\n  interaction = () => {\n    const { signatureImporter, network, inputs, outputs } = this.props;\n    const keystore = signatureImporter.method;\n    const bip32Paths = inputs.map((input) => {\n      if (typeof input.bip32Path === \"undefined\")\n        return signatureImporter.bip32Path; // pubkey path\n      return `${signatureImporter.bip32Path}${input.bip32Path.slice(1)}`; // xpub/pubkey slice away the m, keep /\n    });\n    return SignMultisigTransaction({\n      network,\n      keystore,\n      inputs,\n      outputs,\n      bip32Paths,\n    });\n  };\n\n  render = () => {\n    const {\n      signatureImporter,\n      extendedPublicKeyImporter,\n      isWallet,\n    } = this.props;\n    const { status } = this.state;\n    const interaction = this.interaction();\n    if (status === UNSUPPORTED) {\n      return (\n        <FormHelperText error>\n          {interaction.messageTextFor({ state: status })}\n        </FormHelperText>\n      );\n    }\n    return (\n      <Box mt={2}>\n        {(!isWallet ||\n          extendedPublicKeyImporter === null ||\n          typeof extendedPublicKeyImporter === \"undefined\" ||\n          extendedPublicKeyImporter.method === \"text\") && (\n          <>\n            <Grid container>\n              <Grid item md={10}>\n                <TextField\n                  fullWidth\n                  name=\"bip32Path\"\n                  label=\"BIP32 Path\"\n                  type=\"text\"\n                  value={signatureImporter.bip32Path}\n                  onChange={this.handleBIP32PathChange}\n                  disabled={status !== PENDING}\n                  error={this.hasBIP32PathError()}\n                  helperText={this.bip32PathError()}\n                />\n              </Grid>\n              <Grid item md={2}>\n                {!this.bip32PathIsDefault() && (\n                  <Button\n                    type=\"button\"\n                    variant=\"contained\"\n                    size=\"small\"\n                    onClick={this.resetBIP32Path}\n                    disabled={status !== PENDING}\n                  >\n                    Default\n                  </Button>\n                )}\n              </Grid>\n            </Grid>\n            <FormHelperText>\n              Use the default value if you don&rsquo;t understand BIP32 paths.\n            </FormHelperText>\n          </>\n        )}\n        <Box mt={2}>{this.renderAction()}</Box>\n        {this.renderDeviceConfirmInfo()}\n        <InteractionMessages\n          messages={interaction.messagesFor({ state: status })}\n          excludeCodes={[\"bip32\"]}\n        />\n      </Box>\n    );\n  };\n\n  renderDeviceConfirmInfo = () => {\n    const { fee, inputsTotalSats } = this.props;\n    const { status } = this.state;\n\n    if (status === ACTIVE) {\n      return (\n        <Box>\n          <p>Your device will ask you to verify the following information:</p>\n          <Table>\n            <TableHead>\n              <TableRow hover>\n                <TableCell />\n                <TableCell>Amount (BTC)</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {this.renderTargets()}\n              <TableRow hover>\n                <TableCell>Fee</TableCell>\n                <TableCell>{fee}</TableCell>\n              </TableRow>\n              <TableRow hover>\n                <TableCell>Total</TableCell>\n                <TableCell>\n                  {satoshisToBitcoins(inputsTotalSats).toString()}\n                </TableCell>\n              </TableRow>\n            </TableBody>\n          </Table>\n        </Box>\n      );\n    }\n    return \"\";\n  };\n\n  renderTargets = () => {\n    const { outputs } = this.props;\n    return outputs.map((output) => {\n      return (\n        <TableRow hover key={output.address}>\n          <TableCell>\n            Address <code>{output.address}</code>\n          </TableCell>\n          <TableCell>{output.amount}</TableCell>\n        </TableRow>\n      );\n    });\n  };\n\n  renderAction = () => {\n    const { signatureError, status } = this.state;\n    return (\n      <Grid container alignItems=\"center\">\n        <Grid item md={3}>\n          <Button\n            variant=\"contained\"\n            size=\"large\"\n            color=\"primary\"\n            onClick={this.sign}\n            disabled={status !== PENDING}\n          >\n            Sign\n          </Button>\n        </Grid>\n        <Grid item md={9}>\n          <FormHelperText error>{signatureError}</FormHelperText>\n        </Grid>\n      </Grid>\n    );\n  };\n\n  //\n  // BIP32 Path\n  //\n\n  hasBIP32PathError = () => {\n    const { bip32PathError, status } = this.state;\n    return (\n      bip32PathError !== \"\" ||\n      this.interaction().hasMessagesFor({\n        state: status,\n        level: ERROR,\n        code: \"bip32\",\n      })\n    );\n  };\n\n  bip32PathError = () => {\n    const { bip32PathError, status } = this.state;\n    if (bip32PathError !== \"\") {\n      return bip32PathError;\n    }\n    return this.interaction().messageTextFor({\n      state: status,\n      level: ERROR,\n      code: \"bip32\",\n    });\n  };\n\n  setBIP32PathError = (value) => {\n    this.setState({ bip32PathError: value });\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(bip32Path, () => {}, this.setBIP32PathError);\n  };\n\n  bip32PathIsDefault = () => {\n    const { signatureImporter, defaultBIP32Path } = this.props;\n    return signatureImporter.bip32Path === defaultBIP32Path;\n  };\n\n  resetBIP32Path = () => {\n    const { resetBIP32Path } = this.props;\n    this.setBIP32PathError(\"\");\n    resetBIP32Path();\n  };\n\n  //\n  // Sign\n  //\n\n  sign = async () => {\n    const {\n      disableChangeMethod,\n      validateAndSetSignature,\n      enableChangeMethod,\n    } = this.props;\n    disableChangeMethod();\n    this.setState({ signatureError: \"\", status: ACTIVE });\n\n    try {\n      const signature = await this.interaction().run();\n      validateAndSetSignature(signature, (signatureError) => {\n        const stateUpdate = { signatureError };\n        if (signatureError !== \"\") stateUpdate.status = PENDING;\n        this.setState(stateUpdate);\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      this.setState({ signatureError: e.message, status: PENDING });\n    }\n    enableChangeMethod();\n  };\n}\n\nDirectSignatureImporter.propTypes = {\n  defaultBIP32Path: PropTypes.string.isRequired,\n  disableChangeMethod: PropTypes.func.isRequired,\n  enableChangeMethod: PropTypes.func.isRequired,\n  extendedPublicKeyImporter: PropTypes.shape({\n    method: PropTypes.string,\n  }).isRequired,\n  fee: PropTypes.string.isRequired,\n  inputsTotalSats: PropTypes.shape({}).isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  isWallet: PropTypes.bool.isRequired,\n  network: PropTypes.string.isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  signatureImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    method: PropTypes.string,\n  }).isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetSignature: PropTypes.func.isRequired,\n};\n\nexport default DirectSignatureImporter;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { PENDING, ACTIVE } from \"unchained-wallets\";\nimport QrReader from \"react-qr-reader\";\nimport { Grid, Button, Box, FormHelperText } from \"@material-ui/core\";\nimport Copyable from \"../Copyable\";\n\nconst QR_CODE_READER_DELAY = 300; // ms?\n\nclass HermitReader extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: PENDING,\n      error: \"\",\n    };\n  }\n\n  render = () => {\n    const { status, error } = this.state;\n    const { interaction, width, startText } = this.props;\n\n    if (status === PENDING) {\n      const commandMessage = interaction.messageFor({\n        state: status,\n        code: \"hermit.command\",\n      });\n      return (\n        <div>\n          <p>{commandMessage.instructions}</p>\n          <Grid container justify=\"center\" className=\"mb-2\">\n            <Copyable text={commandMessage.command} showText={false}>\n              <code>\n                <strong>{commandMessage.mode}&gt;</strong>{\" \"}\n                {commandMessage.command}\n              </code>\n            </Copyable>\n          </Grid>\n          <p>When you are ready, scan the QR code produced by Hermit:</p>\n          <Box mt={2}>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              className=\"mt-2\"\n              size=\"large\"\n              onClick={this.handleStart}\n            >\n              {startText}\n            </Button>\n          </Box>\n        </div>\n      );\n    }\n\n    if (status === ACTIVE) {\n      return (\n        <Grid container direction=\"column\">\n          <Grid item>\n            <QrReader\n              delay={QR_CODE_READER_DELAY}\n              onError={this.handleError}\n              onScan={this.handleScan}\n              style={{ width }}\n              facingMode=\"user\"\n            />\n          </Grid>\n          <Grid item>\n            <Button\n              variant=\"contained\"\n              color=\"secondary\"\n              size=\"small\"\n              onClick={this.handleStop}\n            >\n              Cancel\n            </Button>\n          </Grid>\n        </Grid>\n      );\n    }\n\n    if (status === \"error\" || status === \"success\") {\n      return (\n        <div>\n          <FormHelperText error>{error}</FormHelperText>\n          <Button\n            variant=\"contained\"\n            color=\"secondary\"\n            size=\"small\"\n            onClick={this.handleStop}\n          >\n            Reset\n          </Button>\n        </div>\n      );\n    }\n\n    return null;\n  };\n\n  handleStart = () => {\n    const { onStart } = this.props;\n    this.setState({ status: ACTIVE, error: \"\" });\n    if (onStart) {\n      onStart();\n    }\n  };\n\n  handleError = (error) => {\n    const { onClear } = this.props;\n    this.setState({ status: \"error\", error: error.message });\n    if (onClear) {\n      onClear();\n    }\n  };\n\n  handleScan = (data) => {\n    const { onSuccess, interaction } = this.props;\n    if (data) {\n      try {\n        const result = interaction.parse(data);\n        onSuccess(result);\n        this.setState({ status: \"success\" });\n      } catch (e) {\n        this.handleError(e);\n      }\n    }\n  };\n\n  handleStop = () => {\n    const { onClear } = this.props;\n    this.setState({\n      status: PENDING,\n      error: \"\",\n    });\n    if (onClear) {\n      onClear();\n    }\n  };\n}\n\nHermitReader.propTypes = {\n  onStart: PropTypes.func.isRequired,\n  onSuccess: PropTypes.func.isRequired,\n  onClear: PropTypes.func.isRequired,\n  width: PropTypes.string,\n  startText: PropTypes.string,\n  interaction: PropTypes.shape({\n    messageFor: PropTypes.func,\n    parse: PropTypes.func,\n  }).isRequired,\n};\n\nHermitReader.defaultProps = {\n  width: \"256px\",\n  startText: \"Scan\",\n};\n\nexport default HermitReader;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport QRCode from \"qrcode.react\";\nimport Copyable from \"../Copyable\";\n\nconst HermitDisplayer = (props) => {\n  const { width, string } = props;\n  return (\n    <Copyable text={string} newline showText={false}>\n      <QRCode size={width} value={string} level=\"L\" />\n    </Copyable>\n  );\n};\n\nHermitDisplayer.propTypes = {\n  string: PropTypes.string,\n  width: PropTypes.number,\n};\n\nHermitDisplayer.defaultProps = {\n  string: \"\",\n  width: 120,\n};\n\nexport default HermitDisplayer;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  HERMIT,\n  PENDING,\n  UNSUPPORTED,\n  SignMultisigTransaction,\n} from \"unchained-wallets\";\nimport {\n  Grid,\n  Box,\n  TextField,\n  Button,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport HermitReader from \"./HermitReader\";\nimport HermitDisplayer from \"./HermitDisplayer\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nclass HermitSignatureImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      bip32PathError: \"\",\n      signatureError: \"\",\n      status: this.interaction(true).isSupported() ? PENDING : UNSUPPORTED,\n    };\n  }\n\n  interaction = () => {\n    const { signatureImporter, network, inputs, outputs } = this.props;\n    const bip32Paths = inputs.map((input) => {\n      if (typeof input.bip32Path === \"undefined\")\n        return signatureImporter.bip32Path; // pubkey path\n      return `${signatureImporter.bip32Path}${input.bip32Path.slice(1)}`; // xpub/pubkey slice away the m, keep /\n    });\n\n    return SignMultisigTransaction({\n      keystore: HERMIT,\n      network,\n      inputs,\n      outputs,\n      bip32Paths,\n    });\n  };\n\n  render = () => {\n    const {\n      signatureImporter,\n      disableChangeMethod,\n      resetBIP32Path,\n    } = this.props;\n    const { bip32PathError, signatureError, status } = this.state;\n    const interaction = this.interaction();\n    if (status === UNSUPPORTED) {\n      return (\n        <InteractionMessages\n          messages={interaction.messagesFor({ state: status })}\n          excludeCodes={[\"hermit.signature_request\", \"hermit.command\"]}\n        />\n      );\n    }\n    return (\n      <Box mt={2}>\n        <Grid container>\n          <Grid item md={10}>\n            <TextField\n              name=\"bip32Path\"\n              value={signatureImporter.bip32Path}\n              onChange={this.handleBIP32PathChange}\n              disabled={status !== PENDING}\n              error={this.hasBIP32PathError()}\n              helperText={bip32PathError}\n            />\n          </Grid>\n\n          <Grid item md={2}>\n            {!this.bip32PathIsDefault() && (\n              <Button\n                type=\"button\"\n                variant=\"contained\"\n                size=\"small\"\n                onClick={resetBIP32Path}\n                disabled={status !== PENDING}\n              >\n                Default\n              </Button>\n            )}\n          </Grid>\n        </Grid>\n\n        <FormHelperText>\n          Use the default value if you don&rsquo;t understand BIP32 paths.\n        </FormHelperText>\n\n        <Box mt={2}>\n          <Grid container justify=\"center\">\n            <Grid item>\n              <HermitDisplayer width={400} string={interaction.request()} />\n            </Grid>\n          </Grid>\n\n          <HermitReader\n            startText=\"Scan Signature QR Code\"\n            interaction={interaction}\n            onStart={disableChangeMethod}\n            onSuccess={this.import}\n            onClear={this.clear}\n          />\n\n          <InteractionMessages\n            messages={interaction.messagesFor({ state: status })}\n            excludeCodes={[\"hermit.signature_request\", \"hermit.command\"]}\n          />\n\n          <FormHelperText error>{signatureError}</FormHelperText>\n        </Box>\n      </Box>\n    );\n  };\n\n  import = (signature) => {\n    const { validateAndSetSignature, enableChangeMethod } = this.props;\n    this.setState({ signatureError: \"\" });\n    enableChangeMethod();\n    validateAndSetSignature(signature, (signatureError) => {\n      this.setState({ signatureError });\n    });\n  };\n\n  clear = () => {\n    const { resetBIP32Path, enableChangeMethod } = this.props;\n    resetBIP32Path();\n    this.setState({ signatureError: \"\" });\n    enableChangeMethod();\n  };\n\n  hasBIP32PathError = () => {\n    const { bip32PathError } = this.state;\n    return bip32PathError !== \"\";\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(\n      bip32Path,\n      () => {},\n      (bip32PathError) => {\n        this.setState({ bip32PathError });\n      }\n    );\n  };\n\n  bip32PathIsDefault = () => {\n    const { signatureImporter, defaultBIP32Path } = this.props;\n    return signatureImporter.bip32Path === defaultBIP32Path;\n  };\n}\n\nHermitSignatureImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  signatureImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetSignature: PropTypes.func.isRequired,\n  enableChangeMethod: PropTypes.func.isRequired,\n  disableChangeMethod: PropTypes.func.isRequired,\n};\n\nexport default HermitSignatureImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  PENDING,\n  UNSUPPORTED,\n  SignMultisigTransaction,\n  ACTIVE,\n} from \"unchained-wallets\";\nimport {\n  Box,\n  FormHelperText,\n  Table,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n  FormGroup,\n} from \"@material-ui/core\";\nimport { satoshisToBitcoins } from \"unchained-bitcoin\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nclass IndirectSignatureImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      bip32PathError: \"\",\n      signatureError: \"\",\n      status: this.interaction().isSupported() ? PENDING : UNSUPPORTED,\n    };\n  }\n\n  interaction = () => {\n    const { signatureImporter, network, inputs, outputs } = this.props;\n    const keystore = signatureImporter.method;\n    const bip32Paths = inputs.map((input) => {\n      if (typeof input.bip32Path === \"undefined\")\n        return signatureImporter.bip32Path; // pubkey path\n      return `${signatureImporter.bip32Path}${input.bip32Path.slice(1)}`; // xpub/pubkey slice away the m, keep /\n    });\n\n    return SignMultisigTransaction({\n      keystore,\n      network,\n      inputs,\n      outputs,\n      bip32Paths,\n    });\n  };\n\n  renderDeviceConfirmInfo = () => {\n    const { fee, inputsTotalSats } = this.props;\n    return (\n      <Box>\n        <p>Your device will ask you to verify the following information:</p>\n        <Table>\n          <TableHead>\n            <TableRow hover>\n              <TableCell />\n              <TableCell>Amount (BTC)</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {this.renderTargets()}\n            <TableRow hover>\n              <TableCell>Fee</TableCell>\n              <TableCell>{fee}</TableCell>\n            </TableRow>\n            <TableRow hover>\n              <TableCell>Total</TableCell>\n              <TableCell>\n                {satoshisToBitcoins(inputsTotalSats).toString()}\n              </TableCell>\n            </TableRow>\n          </TableBody>\n        </Table>\n      </Box>\n    );\n  };\n\n  renderTargets = () => {\n    const { outputs } = this.props;\n    return outputs.map((output) => {\n      return (\n        <TableRow hover key={output.address}>\n          <TableCell>\n            Address <code>{output.address}</code>\n          </TableCell>\n          <TableCell>{output.amount}</TableCell>\n        </TableRow>\n      );\n    });\n  };\n\n  render = () => {\n    const {\n      disableChangeMethod,\n      extendedPublicKeyImporter,\n      Signer,\n    } = this.props;\n    const { signatureError, status } = this.state;\n    const interaction = this.interaction();\n    if (status === UNSUPPORTED) {\n      return (\n        <InteractionMessages\n          messages={interaction.messagesFor({ state: status })}\n          excludeCodes={[\"hermit.signature_request\", \"hermit.command\"]}\n        />\n      );\n    }\n    return (\n      <Box mt={2}>\n        <Box mt={2}>\n          {this.renderDeviceConfirmInfo()}\n          <FormGroup>\n            <Signer\n              setError={this.setError}\n              hasError={this.hasBIP32PathError()}\n              onReceive={this.onReceive}\n              onReceivePSBT={this.onReceivePSBT}\n              interaction={this.interaction()}\n              setActive={this.setActive}\n              disableChangeMethod={disableChangeMethod}\n              extendedPublicKeyImporter={extendedPublicKeyImporter}\n            />\n\n            <FormHelperText error>{signatureError}</FormHelperText>\n\n            <InteractionMessages\n              messages={interaction.messagesFor({ state: status })}\n            />\n          </FormGroup>\n        </Box>\n      </Box>\n    );\n  };\n\n  setActive = () => {\n    this.setState({ status: ACTIVE });\n  };\n\n  onReceive = (signature) => {\n    const { validateAndSetSignature, enableChangeMethod } = this.props;\n    this.setState({ signatureError: \"\" });\n    if (enableChangeMethod) {\n      enableChangeMethod();\n    }\n    validateAndSetSignature(signature, (signatureError) => {\n      this.setState({ signatureError });\n    });\n  };\n\n  onReceivePSBT = (data) => {\n    const { validateAndSetSignature } = this.props;\n    try {\n      // signatureData is one or more sets of signatures that are keyed\n      // based on which pubkey the signatures are signing.\n      const signatureData = this.interaction().parse(data);\n      const signatureSetsKeys = Object.keys(signatureData);\n      const signatures = [];\n\n      // We have a slight issue for the n-ly signed PSBT case\n      // because there is no order to the pubkey: [signature(s)] mapping\n      // returned from `unchained-bitcoin`. it's ok, we have valid signatures, etc.\n      // but truncating information can cause problems down the line in keeping\n      // the validation straightforward.\n\n      // e.g. have a doubly-signed psbt with 3 inputs on the same 2-of-3 multisig address,\n      // so 6 signatures total are returned in signatureData back for 2 pubkeys (3 signatures from each pubkey).\n      // here adding a pubkey set matches that signature array.\n      // [siga1, siga2, siga3, sigb1, sigb2, sigb3]\n      // In the case of multiple 2-of-3 multisig addresses, the pubkeys can get jumbled and there's no longer\n      // a clear break between signature sets based purely on pubkey. need xfp information as well.\n\n      // For now, shove all of the signatures into the same array and return that.\n      signatureSetsKeys.forEach((pubkey) => {\n        signatures.push(...signatureData[pubkey]);\n      });\n\n      this.setState({ signatureError: \"\" });\n      validateAndSetSignature(signatures, (signatureError) => {\n        this.setState({ signatureError });\n      });\n    } catch (e) {\n      e.errorType = \"Coldcard Signing Error\";\n      this.setState({ signatureError: e.message });\n    }\n  };\n\n  setError = (value) => {\n    this.setState({ signatureError: value });\n  };\n\n  clear = () => {\n    const { resetBIP32Path, enableChangeMethod } = this.props;\n    resetBIP32Path();\n    this.setState({ signatureError: \"\" });\n    enableChangeMethod();\n  };\n\n  hasBIP32PathError = () => {\n    const { bip32PathError } = this.state;\n    return bip32PathError !== \"\";\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(\n      bip32Path,\n      () => {},\n      (bip32PathError) => {\n        this.setState({ bip32PathError });\n      }\n    );\n  };\n\n  bip32PathIsDefault = () => {\n    const { signatureImporter, defaultBIP32Path } = this.props;\n    return signatureImporter.bip32Path === defaultBIP32Path;\n  };\n}\n\nIndirectSignatureImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  signatureImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    method: PropTypes.string,\n  }).isRequired,\n  resetBIP32Path: PropTypes.func,\n  defaultBIP32Path: PropTypes.string,\n  validateAndSetBIP32Path: PropTypes.func,\n  validateAndSetSignature: PropTypes.func.isRequired,\n  enableChangeMethod: PropTypes.func,\n  disableChangeMethod: PropTypes.func,\n  extendedPublicKeyImporter: PropTypes.shape({\n    method: PropTypes.string,\n  }),\n  Signer: PropTypes.shape({}).isRequired,\n  fee: PropTypes.string,\n  inputsTotalSats: PropTypes.shape({}),\n};\n\nIndirectSignatureImporter.defaultProps = {\n  resetBIP32Path: null,\n  defaultBIP32Path: \"\",\n  validateAndSetBIP32Path: null,\n  enableChangeMethod: null,\n  disableChangeMethod: null,\n  extendedPublicKeyImporter: {},\n  fee: \"\",\n  inputsTotalSats: {},\n};\n\nexport default IndirectSignatureImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Button } from \"@material-ui/core\";\n\nconst ColdcardSigningButtons = (props) => {\n  const { handlePSBTDownloadClick, handleWalletConfigDownloadClick } = props;\n  return (\n    <>\n      <Button\n        type=\"button\"\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={handlePSBTDownloadClick}\n      >\n        Download PSBT\n      </Button>\n      <Button\n        type=\"button\"\n        variant=\"contained\"\n        onClick={handleWalletConfigDownloadClick}\n      >\n        Download Coldcard Config\n      </Button>\n    </>\n  );\n};\n\nColdcardSigningButtons.propTypes = {\n  handlePSBTDownloadClick: PropTypes.func.isRequired,\n  handleWalletConfigDownloadClick: PropTypes.func.isRequired,\n};\n\nexport default ColdcardSigningButtons;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport moment from \"moment\";\nimport { COLDCARD, ConfigAdapter } from \"unchained-wallets\";\nimport { connect } from \"react-redux\";\nimport { ColdcardSigningButtons } from \".\";\nimport { ColdcardPSBTReader } from \"./ColdcardFileReader\";\nimport { downloadFile } from \"../../utils\";\nimport { getWalletDetailsText } from \"../../selectors/wallet\";\n\nclass ColdcardSigner extends Component {\n  handlePSBTDownloadClick = () => {\n    const { walletName, interaction, setActive } = this.props;\n    const body = interaction.request().toBase64();\n    const timestamp = moment().format(\"HHmm\");\n    const filename = `${timestamp}-${walletName}.psbt`;\n    downloadFile(body, filename);\n    setActive();\n  };\n\n  handleWalletConfigDownloadClick = () => {\n    const { walletDetailsText } = this.props;\n    this.reshapeConfig(walletDetailsText);\n  };\n\n  // This tries to reshape it to a Coldcard Wallet Config via unchained-wallets\n  reshapeConfig = (walletDetails) => {\n    const walletConfig = JSON.parse(walletDetails);\n    const { startingAddressIndex } = walletConfig;\n    // If this is a config that's been rekeyed, note that in the name.\n    walletConfig.name =\n      startingAddressIndex === 0\n        ? walletConfig.name\n        : `${walletConfig.name}_${startingAddressIndex.toString()}`;\n\n    // At the moment (2020-Dec), Coldcard has just released a new firmware version\n    // which addresses the following problem:  that they inverted the ordering\n    // for p2sh-p2wsh as p2wsh-p2sh but we need to support the older firmware.\n    walletConfig.addressType = walletConfig.addressType.includes(\"-\")\n      ? \"P2WSH-P2SH\"\n      : walletConfig.addressType;\n\n    const interaction = ConfigAdapter({\n      KEYSTORE: COLDCARD,\n      jsonConfig: walletConfig,\n    });\n    const body = interaction.adapt();\n    const filename = `wc-${walletConfig.name}.txt`;\n    downloadFile(body, filename);\n  };\n\n  render = () => {\n    const { onReceivePSBT, setError } = this.props;\n    return (\n      <div>\n        <ColdcardSigningButtons\n          handlePSBTDownloadClick={this.handlePSBTDownloadClick}\n          handleWalletConfigDownloadClick={this.handleWalletConfigDownloadClick}\n        />\n        <ColdcardPSBTReader onReceivePSBT={onReceivePSBT} setError={setError} />\n      </div>\n    );\n  };\n}\n\nColdcardSigner.propTypes = {\n  walletName: PropTypes.string.isRequired,\n  interaction: PropTypes.shape({\n    request: PropTypes.func,\n  }).isRequired,\n  setActive: PropTypes.func.isRequired,\n  walletDetailsText: PropTypes.string.isRequired,\n  onReceivePSBT: PropTypes.func.isRequired,\n  setError: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    walletName: state.wallet.common.walletName,\n    walletDetailsText: getWalletDetailsText(state),\n  };\n}\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColdcardSigner);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport IndirectSignatureImporter from \"../ScriptExplorer/IndirectSignatureImporter\";\nimport ColdcardSigner from \"./ColdcardSigner\";\n\nconst ColdcardSignatureImporter = (props) => {\n  const {\n    signatureImporter,\n    extendedPublicKeyImporter,\n    inputs,\n    outputs,\n    inputsTotalSats,\n    fee,\n    validateAndSetSignature,\n    network,\n  } = props;\n  return (\n    <IndirectSignatureImporter\n      network={network}\n      signatureImporter={signatureImporter}\n      inputs={inputs}\n      outputs={outputs}\n      inputsTotalSats={inputsTotalSats}\n      fee={fee}\n      extendedPublicKeyImporter={extendedPublicKeyImporter}\n      validateAndSetSignature={validateAndSetSignature}\n      Signer={ColdcardSigner}\n    />\n  );\n};\n\nColdcardSignatureImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  signatureImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  validateAndSetSignature: PropTypes.func.isRequired,\n  extendedPublicKeyImporter: PropTypes.shape({}).isRequired,\n  inputsTotalSats: PropTypes.shape({}).isRequired,\n  fee: PropTypes.string.isRequired,\n};\n\nexport default ColdcardSignatureImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  validateHex,\n  validateMultisigSignature,\n  multisigBIP32Path,\n  multisigBIP32Root,\n  validateBIP32Path,\n} from \"unchained-bitcoin\";\nimport { TREZOR, LEDGER, HERMIT, COLDCARD } from \"unchained-wallets\";\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  Select,\n  MenuItem,\n  InputLabel,\n  Button,\n  Box,\n  FormControl,\n} from \"@material-ui/core\";\nimport Copyable from \"../Copyable\";\nimport TextSignatureImporter from \"./TextSignatureImporter\";\nimport DirectSignatureImporter from \"./DirectSignatureImporter\";\nimport HermitSignatureImporter from \"../Hermit/HermitSignatureImporter\";\nimport ColdcardSignatureImporter from \"../Coldcard/ColdcardSignatureImporter\";\nimport EditableName from \"../EditableName\";\nimport {\n  setSignatureImporterName,\n  setSignatureImporterMethod,\n  setSignatureImporterBIP32Path,\n  setSignatureImporterPublicKeys,\n  setSignatureImporterSignature,\n  setSignatureImporterFinalized,\n  setSignatureImporterComplete,\n} from \"../../actions/signatureImporterActions\";\nimport \"react-table/react-table.css\";\nimport { setSigningKey as setSigningKeyAction } from \"../../actions/transactionActions\";\n\nconst TEXT = \"text\";\nconst UNKNOWN = \"unknown\";\n\nclass SignatureImporter extends React.Component {\n  titleRef = React.createRef();\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      disableChangeMethod: false,\n    };\n  }\n\n  componentDidMount = () => {\n    this.resetBIP32Path();\n    this.scrollToTitle();\n  };\n\n  componentDidUpdate = () => {\n    this.scrollToTitle();\n  };\n\n  getCurrent() {\n    const { signatureImporters } = this.props;\n    return Object.keys(signatureImporters).reduce((o, k) => {\n      return o + (signatureImporters[k].finalized ? 1 : 0);\n    }, 1);\n  }\n\n  title = () => {\n    const { number, signatureImporter, setName } = this.props;\n    return (\n      <EditableName\n        number={number}\n        name={signatureImporter.name}\n        setName={setName}\n      />\n    );\n  };\n\n  scrollToTitle = () => {\n    const { number } = this.props;\n    if (number === this.getCurrent()) {\n      this.titleRef.current.scrollIntoView({ behavior: \"smooth\" });\n    }\n  };\n\n  renderImport = () => {\n    const { signatureImporter, number, isWallet } = this.props;\n    const currentNumber = this.getCurrent();\n    const notMyTurn = number > currentNumber;\n    const { disableChangeMethod } = this.state;\n    const labelId = `signature-${number}-importer-select-label`;\n    if (notMyTurn) {\n      return (\n        <p>\n          Once you have imported the signature above, you will be able to import\n          another signature here.\n        </p>\n      );\n    }\n\n    return (\n      <form>\n        <FormControl fullWidth>\n          <InputLabel id={labelId}>Select Method</InputLabel>\n\n          <Select\n            labelId={labelId}\n            id={`signature-${number}-importer-select`}\n            disabled={disableChangeMethod}\n            value={signatureImporter.method}\n            onChange={this.handleMethodChange}\n          >\n            <MenuItem value={UNKNOWN}>{\"< Select method >\"}</MenuItem>\n            <MenuItem value={TREZOR}>Trezor</MenuItem>\n            <MenuItem value={LEDGER}>Ledger</MenuItem>\n            <MenuItem value={COLDCARD} disabled={!isWallet}>\n              Coldcard\n            </MenuItem>\n            <MenuItem value={HERMIT}>Hermit</MenuItem>\n            <MenuItem value={TEXT}>Enter as text</MenuItem>\n          </Select>\n        </FormControl>\n\n        {this.renderImportByMethod()}\n      </form>\n    );\n  };\n\n  renderImportByMethod = () => {\n    const {\n      network,\n      signatureImporter,\n      signatureImporters,\n      inputs,\n      inputsTotalSats,\n      outputs,\n      fee,\n      isWallet,\n      extendedPublicKeyImporter,\n    } = this.props;\n    const { method } = signatureImporter;\n\n    if (method === TREZOR || method === LEDGER) {\n      return (\n        <DirectSignatureImporter\n          network={network}\n          signatureImporter={signatureImporter}\n          signatureImporters={signatureImporters}\n          inputs={inputs}\n          outputs={outputs}\n          inputsTotalSats={inputsTotalSats}\n          fee={fee}\n          isWallet={isWallet}\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          resetBIP32Path={this.resetBIP32Path}\n          defaultBIP32Path={this.defaultBIP32Path()}\n          validateAndSetSignature={this.validateAndSetSignature}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n        />\n      );\n    }\n    if (method === HERMIT) {\n      return (\n        <HermitSignatureImporter\n          network={network}\n          signatureImporter={signatureImporter}\n          inputs={inputs}\n          outputs={outputs}\n          inputsTotalSats={inputsTotalSats}\n          fee={fee}\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          resetBIP32Path={this.resetBIP32Path}\n          defaultBIP32Path={this.defaultBIP32Path()}\n          validateAndSetSignature={this.validateAndSetSignature}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n        />\n      );\n    }\n    if (method === COLDCARD) {\n      return (\n        <ColdcardSignatureImporter\n          network={network}\n          signatureImporter={signatureImporter}\n          inputs={inputs}\n          outputs={outputs}\n          inputsTotalSats={inputsTotalSats}\n          fee={fee}\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetSignature={this.validateAndSetSignature}\n        />\n      );\n    }\n    if (method === TEXT) {\n      return (\n        <TextSignatureImporter\n          signatureImporter={signatureImporter}\n          validateAndSetSignature={this.validateAndSetSignature}\n        />\n      );\n    }\n    return null;\n  };\n\n  //\n  // Method\n  //\n\n  handleMethodChange = (event) => {\n    const { number, setMethod } = this.props;\n    setMethod(number, event.target.value);\n    this.reset();\n  };\n\n  disableChangeMethod = () => {\n    this.setState({ disableChangeMethod: true });\n  };\n\n  enableChangeMethod = () => {\n    this.setState({ disableChangeMethod: false });\n  };\n\n  //\n  // State\n  //\n\n  reset = () => {\n    const { number, setSignature, setPublicKeys, setFinalized } = this.props;\n    setSignature(number, \"\");\n    setPublicKeys(number, []);\n    setFinalized(number, false);\n  };\n\n  //\n  // BIP32 Path\n  //\n\n  defaultBIP32Path = () => {\n    const { addressType, network, isWallet } = this.props;\n    return isWallet\n      ? multisigBIP32Root(addressType, network)\n      : multisigBIP32Path(addressType, network);\n  };\n\n  resetBIP32Path = () => {\n    const { number, setBIP32Path, isWallet } = this.props;\n    if (isWallet) {\n      const { extendedPublicKeyImporter } = this.props;\n      if (\n        extendedPublicKeyImporter &&\n        extendedPublicKeyImporter.method !== \"text\"\n      )\n        return;\n    }\n    setBIP32Path(number, this.defaultBIP32Path());\n  };\n\n  validateAndSetBIP32Path = (bip32Path, callback, errback, options) => {\n    const { number, setBIP32Path } = this.props;\n    const error = validateBIP32Path(bip32Path, options);\n    setBIP32Path(number, bip32Path);\n    if (error) {\n      errback(error);\n    } else {\n      errback(\"\");\n      callback();\n    }\n  };\n\n  //\n  // Signature\n  //\n\n  renderSignature = () => {\n    const { signatureImporter, txid } = this.props;\n    const signatureJSON = JSON.stringify(signatureImporter.signature);\n    return (\n      <div>\n        <p>The following signature was imported:</p>\n        <Box>\n          <Copyable text={signatureJSON} showIcon code />\n        </Box>\n        <Box mt={2}>\n          <Button\n            variant=\"contained\"\n            color=\"secondary\"\n            disabled={txid !== \"\"}\n            size=\"small\"\n            onClick={this.reset}\n          >\n            Remove Signature\n          </Button>\n        </Box>\n      </div>\n    );\n  };\n\n  validateAndSetSignature = (inputsSignatures, errback) => {\n    const {\n      number,\n      inputs,\n      signatureImporters,\n      setComplete,\n      network,\n      outputs,\n      setSigningKey,\n    } = this.props;\n    if (!Array.isArray(inputsSignatures)) {\n      errback(\"Signature is not an array of strings.\");\n      return;\n    }\n\n    if (inputsSignatures.length < inputs.length) {\n      errback(\n        \"Not enough signatures (must be at least one signature for each input).\"\n      );\n      return;\n    }\n\n    if (inputsSignatures.length % inputs.length !== 0) {\n      errback(\"Number of signatures must be a multiple of number of inputs.\");\n      return;\n    }\n\n    const numSignatureSets = inputsSignatures.length / inputs.length;\n\n    if (numSignatureSets > Object.values(signatureImporters).length) {\n      errback(\n        \"Too many signatures. Max one set of signatures per required signer.\"\n      );\n      return;\n    }\n    const publicKeys = [];\n    if (numSignatureSets === 1) {\n      const finalizedSignatureImporters = Object.values(\n        signatureImporters\n      ).filter((signatureImporter) => signatureImporter.finalized);\n      for (\n        let inputIndex = 0;\n        inputIndex < inputsSignatures.length;\n        inputIndex += 1\n      ) {\n        const inputNumber = inputIndex + 1;\n        const inputSignature = inputsSignatures[inputIndex];\n        if (validateHex(inputSignature) !== \"\") {\n          errback(`Signature for input ${inputNumber} is not valid hex.`);\n          return;\n        }\n\n        let publicKey;\n        try {\n          publicKey = validateMultisigSignature(\n            network,\n            inputs,\n            outputs,\n            inputIndex,\n            inputSignature\n          );\n        } catch (e) {\n          errback(`Signature for input ${inputNumber} is invalid.`);\n          return;\n        }\n        if (publicKey) {\n          for (\n            let finalizedSignatureImporterNum = 0;\n            finalizedSignatureImporterNum < finalizedSignatureImporters.length;\n            finalizedSignatureImporterNum += 1\n          ) {\n            const finalizedSignatureImporter =\n              finalizedSignatureImporters[finalizedSignatureImporterNum];\n\n            if (\n              finalizedSignatureImporter.signature[inputIndex] ===\n                inputSignature ||\n              finalizedSignatureImporter.publicKeys[inputIndex] === publicKey\n            ) {\n              errback(\n                `Signature for input ${inputNumber} is a duplicate of a previously provided signature.`\n              );\n              return;\n            }\n          }\n          publicKeys.push(publicKey);\n        } else {\n          errback(`Signature for input ${inputNumber} is invalid.`);\n          return;\n        }\n      }\n      setComplete(number, {\n        signature: inputsSignatures,\n        publicKeys,\n        finalized: true,\n      });\n    } else {\n      // We land here if a PSBT has been uploaded with multiple signature sets.\n      // In case we already have some signatures saved, e.g. first a singly-signed\n      // PSBT was uploaded, and now a doubly-signed PSBT was uploaded, filter out\n      // the known signatures.\n      let signaturesToCheck = this.filterKnownSignatures(inputsSignatures);\n      let signatureSetNumber = number; // so we can iterate, number is a const from props.\n\n      while (\n        signatureSetNumber <= Object.keys(signatureImporters).length &&\n        signaturesToCheck.length > 0\n      ) {\n        setSigningKey(signatureSetNumber, signatureSetNumber - 1);\n        const signatureSet = [];\n        const publicKeySet = [];\n\n        // Loop over inputs and check the sigs array to see if you can find a public key or not.\n        // NOTE - signaturesToCheck.length could be much larger than inputs.length!\n        // This is *not* efficient, but it will work as a temporary solution until we refactor\n        // the signatures data structure returned from unchained-bitcoin or change how caravan\n        // validates signatures.\n\n        // The \"sets\" of signatures that come out of this process are not all connected /  tied to the same root xpub\n        // because we've truncated a little information in the psbt parsing => signature return process\n        // We can re-generate that information later but for now this should work. There are\n        // bugs in edge cases that need to be handled better.\n        for (let inputIndex = 0; inputIndex < inputs.length; inputIndex += 1) {\n          let publicKey;\n\n          // THIS NEEDS TO BE MORE OPINIONATED ABOUT *WHICH* SIGNING DEVICE ARE THESE PUBKEYS COMING FROM\n          // e.g. after the first round of this loop if you successfully find a public key -- that public key\n          // is derived from some root xpub with a particular fingerprint, as you move along this loop to the\n          // next input, you want to *keep* searching until you find a public key that's from the same root fingerprint.\n          // Meaning a member of the same signatureSet. All of the remaining publicKey solutions in this round of\n          // signature validation should be derived from the *same* xpub.\n          //\n          // This assumption is not held if you're just blindly searching for *any* (or the first) valid public key\n          // within the list of signatures. E.g. there are multiple *valid* publicKeys for every input if we're at\n          // this point in the code. But if you don't pay attention to the root xpub as you assign public keys to\n          // a signatureSet, you will get a row of public keys that *may not* all be associated with any particular\n          // ExtendedPublicKey. Obviously that's not quite right. But if uploaded PSBT is fully signed, then this\n          // should not matter and the transaction should validate, build, and be able to be broadcast.\n          for (let i = 0; i < signaturesToCheck.length; i += 1) {\n            const inputSignature = signaturesToCheck[i];\n            if (validateHex(inputSignature) !== \"\") {\n              errback(\n                `Signature for input at index ${inputIndex} is not valid hex.`\n              );\n              return;\n            }\n            try {\n              // This returns false if it completes with no error\n              publicKey = validateMultisigSignature(\n                network,\n                inputs,\n                outputs,\n                inputIndex,\n                inputSignature\n              );\n            } catch (e) {\n              // eslint-disable-next-line no-console\n              console.error(e);\n            }\n            // FIXME `&& publicKey is member of a particular root xpub/fingerprint` should be added here!\n            if (publicKey) {\n              // We know inputSignature is a signature for publicKey but we aren't keeping root xpub/xfp info around\n              publicKeySet.push(publicKey);\n              signatureSet.push(inputSignature);\n              break;\n            }\n          }\n          if (!publicKey) {\n            errback(`No valid signature for input ${inputIndex} found.`);\n            return;\n          }\n        }\n        if (\n          publicKeySet.length !== inputs.length ||\n          signatureSet.length !== inputs.length\n        ) {\n          errback(`There was an error in validating the transaction.`);\n          return;\n        }\n        // Set the signatureSetNumber we're currently on to complete and include publicKeySet/signatureSet\n        setComplete(signatureSetNumber, {\n          signature: signatureSet,\n          publicKeySet,\n          finalized: true,\n        });\n        // Send signatures to this method again, since now some of them are marked\n        // as finalized, and they will be filtered out.\n        signaturesToCheck = this.filterKnownSignatures(inputsSignatures);\n        // increment which signature number we're working on next.\n        signatureSetNumber += 1;\n      }\n    }\n  };\n\n  filterKnownSignatures = (inputsSignatures) => {\n    const { inputs, signatureImporters } = this.props;\n    const finalizedSignatureImporters = Object.values(\n      signatureImporters\n    ).filter((signatureImporter) => signatureImporter.finalized);\n    const knownSignatures = [];\n    for (let inputIndex = 0; inputIndex < inputs.length; inputIndex += 1) {\n      for (\n        let finalizedSignatureImporterNum = 0;\n        finalizedSignatureImporterNum < finalizedSignatureImporters.length;\n        finalizedSignatureImporterNum += 1\n      ) {\n        const finalizedSignatureImporter =\n          finalizedSignatureImporters[finalizedSignatureImporterNum];\n\n        knownSignatures.push(finalizedSignatureImporter.signature[inputIndex]);\n      }\n    }\n    // diff out any signature we've seen before\n    return inputsSignatures.filter((x) => !knownSignatures.includes(x));\n  };\n\n  render() {\n    const { signatureImporter } = this.props;\n    return (\n      <Card>\n        <CardHeader title={this.title()} ref={this.titleRef} />\n        <CardContent>\n          {signatureImporter.finalized\n            ? this.renderSignature()\n            : this.renderImport()}\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nSignatureImporter.propTypes = {\n  addressType: PropTypes.string.isRequired,\n  extendedPublicKeyImporter: PropTypes.shape({\n    method: PropTypes.string,\n  }),\n  fee: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  inputsTotalSats: PropTypes.shape({}).isRequired,\n  isWallet: PropTypes.bool.isRequired,\n  network: PropTypes.string.isRequired,\n  number: PropTypes.number.isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  setName: PropTypes.func.isRequired,\n  setMethod: PropTypes.func.isRequired,\n  setBIP32Path: PropTypes.func.isRequired,\n  setSignature: PropTypes.func.isRequired,\n  setPublicKeys: PropTypes.func.isRequired,\n  setFinalized: PropTypes.func.isRequired,\n  setComplete: PropTypes.func.isRequired,\n  signatureImporter: PropTypes.shape({\n    finalized: PropTypes.bool,\n    name: PropTypes.string,\n    method: PropTypes.string,\n    signature: PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.arrayOf(PropTypes.string),\n    ]),\n  }).isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n  txid: PropTypes.string.isRequired,\n  unsignedTransaction: PropTypes.shape({}).isRequired,\n  setSigningKey: PropTypes.func.isRequired,\n};\n\nSignatureImporter.defaultProps = {\n  extendedPublicKeyImporter: {},\n};\n\nfunction mapStateToProps(state, ownProps) {\n  return {\n    ...{\n      signatureImporters: state.spend.signatureImporters,\n      signatureImporter: state.spend.signatureImporters[ownProps.number],\n      fee: state.spend.transaction.fee,\n      txid: state.spend.transaction.txid,\n    },\n    ...state.spend.transaction,\n  };\n}\n\nconst mapDispatchToProps = {\n  setName: setSignatureImporterName,\n  setMethod: setSignatureImporterMethod,\n  setBIP32Path: setSignatureImporterBIP32Path,\n  setPublicKeys: setSignatureImporterPublicKeys,\n  setSignature: setSignatureImporterSignature,\n  setFinalized: setSignatureImporterFinalized,\n  setComplete: setSignatureImporterComplete,\n  setSigningKey: setSigningKeyAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SignatureImporter);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\n// Actions\nimport { deriveChildPublicKey } from \"unchained-bitcoin\";\nimport {\n  Box,\n  FormControl,\n  Select,\n  MenuItem,\n  InputLabel,\n} from \"@material-ui/core\";\nimport {\n  setSignatureImporterBIP32Path,\n  setSignatureImporterMethod,\n} from \"../../actions/signatureImporterActions\";\n\nimport { setSigningKey as setSigningKeyAction } from \"../../actions/transactionActions\";\n\n// Components\nimport SignatureImporter from \"../ScriptExplorer/SignatureImporter\";\n\nclass ExtendedPublicKeySelector extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      selection: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    const { signingKeys, number } = this.props;\n    if (signingKeys[number - 1] > 0)\n      this.updateKeySelection(signingKeys[number - 1]);\n  };\n\n  // There can be a situation where a signatureImporter is in the finalized\n  // state, but it was never actually selected as a key. This can\n  // happen when a signed PSBT is uploaded that has more than one set of\n  // signatures, given all of the assumptions around transaction signing flow\n  // and signature validation\n  render = () => {\n    const { selection } = this.state;\n    const { number, signatureImporter } = this.props;\n    return (\n      <div>\n        {this.renderKeySelectorMenu()}\n        {((selection > 0 && number > 0) ||\n          (signatureImporter && signatureImporter.finalized)) &&\n          this.renderSignatureImporter()}\n      </div>\n    );\n  };\n\n  renderSignatureImporter = () => {\n    const { number } = this.props;\n    const extendedPublicKeyImporter = this.getAssociatedExtendedPublicKeyImporter();\n    return (\n      <Box mt={2}>\n        <SignatureImporter\n          number={number}\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n        />\n      </Box>\n    );\n  };\n\n  getAssociatedExtendedPublicKeyImporter = () => {\n    const { extendedPublicKeyImporters } = this.props;\n    const { selection } = this.state;\n    let associatedExtendedPublicKeyImporter = null;\n\n    if (selection) {\n      associatedExtendedPublicKeyImporter =\n        extendedPublicKeyImporters[selection];\n    }\n\n    return associatedExtendedPublicKeyImporter;\n  };\n\n  renderKeySelectorMenu = () => {\n    const { number, signatureImporters, setBIP32Path } = this.props;\n    const { selection } = this.state;\n    const labelId = `keySelector${number}`;\n\n    const extendedPublicKeyImporter = this.getAssociatedExtendedPublicKeyImporter();\n    if (extendedPublicKeyImporter !== null && number > 0) {\n      const signatureImporter = signatureImporters[number];\n      if (signatureImporter.signature.length > 0) return \"\";\n\n      if (\n        extendedPublicKeyImporter.bip32Path !== signatureImporter.bip32Path &&\n        extendedPublicKeyImporter.method !== \"text\"\n      ) {\n        setTimeout(() => {\n          setBIP32Path(number, extendedPublicKeyImporter.bip32Path);\n        }, 0);\n      }\n    }\n\n    return (\n      <form>\n        <FormControl fullWidth>\n          <InputLabel id={labelId}>Select Key</InputLabel>\n\n          <Select\n            labelId={labelId}\n            id={`signature-${number}-key-select`}\n            value={selection}\n            onChange={this.handleKeyChange}\n          >\n            <MenuItem value=\"\">{\"< Select Extended Public Key >\"}</MenuItem>\n            {this.renderKeySelectorMenuItems()}\n          </Select>\n        </FormControl>\n      </form>\n    );\n  };\n\n  extendedPublicKeyImporterNotUsed = (extendedPublicKeyImporter) => {\n    const { inputs, network, signatureImporters, number } = this.props;\n    if (number === 0) return true;\n\n    for (let inputIndex = 0; inputIndex < inputs.length; inputIndex += 1) {\n      const input = inputs[inputIndex];\n      const derivedKey = deriveChildPublicKey(\n        extendedPublicKeyImporter.extendedPublicKey,\n        input.bip32Path,\n        network\n      );\n      for (\n        let importerIndex = 1;\n        importerIndex <= Object.keys(signatureImporters).length;\n        importerIndex += 1\n      ) {\n        const importer = signatureImporters[importerIndex];\n        for (\n          let publicKeyIndex = 0;\n          publicKeyIndex < importer.publicKeys.length;\n          publicKeyIndex += 1\n        ) {\n          const publicKey = importer.publicKeys[publicKeyIndex];\n          if (publicKey === derivedKey) return false;\n        }\n      }\n    }\n    return true;\n  };\n\n  renderKeySelectorMenuItems = () => {\n    const { extendedPublicKeyImporters, totalSigners } = this.props;\n    const extendedPublicKeys = [];\n    for (\n      let extendedPublicKeyImporterNum = 1;\n      extendedPublicKeyImporterNum <= totalSigners;\n      extendedPublicKeyImporterNum += 1\n    ) {\n      const extendedPublicKeyImporter =\n        extendedPublicKeyImporters[extendedPublicKeyImporterNum];\n      if (this.extendedPublicKeyImporterNotUsed(extendedPublicKeyImporter)) {\n        extendedPublicKeys.push(\n          <MenuItem\n            value={extendedPublicKeyImporterNum}\n            key={extendedPublicKeyImporterNum}\n          >\n            {extendedPublicKeyImporter.name}\n          </MenuItem>\n        );\n      }\n    }\n    return extendedPublicKeys;\n  };\n\n  handleKeyChange = (event) => {\n    const { onChange } = this.props;\n    this.updateKeySelection(event.target.value);\n\n    if (onChange) {\n      const { extendedPublicKeyImporters } = this.props;\n\n      const importer = extendedPublicKeyImporters[event.target.value];\n      onChange(event, importer);\n    }\n  };\n\n  updateKeySelection(value) {\n    this.setState({ selection: value });\n    if (value === \"\") return;\n\n    const {\n      extendedPublicKeyImporters,\n      setMethod,\n      number,\n      setSigningKey,\n    } = this.props;\n    const extendedPublicKeyImporter = extendedPublicKeyImporters[value];\n    const importMethod = extendedPublicKeyImporter.method;\n    if (importMethod === \"text\") {\n      setMethod(number, \"\"); // user picks\n    } else {\n      setMethod(number, importMethod);\n    }\n    if (number > 0) setSigningKey(number, value);\n  }\n}\n\nExtendedPublicKeySelector.propTypes = {\n  extendedPublicKeyImporters: PropTypes.shape({}).isRequired,\n  inputs: PropTypes.arrayOf(\n    PropTypes.shape({\n      bip32Path: PropTypes.string,\n    })\n  ).isRequired,\n  onChange: PropTypes.func,\n  network: PropTypes.string.isRequired,\n  number: PropTypes.number.isRequired,\n  setBIP32Path: PropTypes.func.isRequired,\n  setMethod: PropTypes.func.isRequired,\n  setSigningKey: PropTypes.func.isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n  signatureImporter: PropTypes.shape({\n    finalized: PropTypes.bool,\n  }),\n  signingKeys: PropTypes.arrayOf(PropTypes.number).isRequired,\n  totalSigners: PropTypes.number.isRequired,\n};\n\nExtendedPublicKeySelector.defaultProps = {\n  onChange: null,\n  signatureImporter: null,\n};\n\nfunction mapStateToProps(state, ownProps) {\n  return {\n    ...state.quorum,\n    totalSigners: state.spend.transaction.totalSigners,\n    inputs: state.spend.transaction.inputs,\n    network: state.settings.network,\n    signatureImporters: state.spend.signatureImporters,\n    signatureImporter: state.spend.signatureImporters[ownProps.number],\n    signingKeys: state.spend.transaction.signingKeys,\n  };\n}\n\nconst mapDispatchToProps = {\n  setBIP32Path: setSignatureImporterBIP32Path,\n  setMethod: setSignatureImporterMethod,\n  setSigningKey: setSigningKeyAction,\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(ExtendedPublicKeySelector);\n","import React, { useReducer, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  Grid,\n  Box,\n  Typography,\n  Button,\n  FormControl,\n  Select,\n  Table,\n  TableBody,\n  TableRow,\n  TableCell,\n  MenuItem,\n  InputLabel,\n} from \"@material-ui/core\";\nimport { ThumbUp as SuccessIcon, Error as ErrorIcon } from \"@material-ui/icons\";\nimport {\n  multisigAddressType,\n  multisigRequiredSigners,\n  multisigTotalSigners,\n} from \"unchained-bitcoin\";\nimport {\n  TREZOR,\n  LEDGER,\n  COLDCARD,\n  HERMIT,\n  ACTIVE,\n  PENDING,\n  ConfirmMultisigAddress,\n} from \"unchained-wallets\";\n\nimport ExtendedPublicKeySelector from \"../Wallet/ExtendedPublicKeySelector\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nimport { slicePropTypes } from \"../../proptypes\";\n\nconst TEXT = \"text\";\n\nconst initialInteractionState = {\n  keySelected: false,\n  deviceType: \"unknown\",\n  bip32Path: \"\",\n  hasInteraction: false,\n  interactionState: PENDING,\n  interactionError: \"\",\n  interactionMessage: \"\",\n};\n\nconst interactionReducer = (state, action) => {\n  switch (action.type) {\n    case \"RESET\":\n      return {\n        ...state,\n        interactionError: \"\",\n        interactionMessage: \"\",\n        interactionState: PENDING,\n      };\n    case \"SET_KEY_SELECTED\":\n      return { ...state, keySelected: true };\n    case \"SET_KEY_UNSELECTED\":\n      return { ...state, keySelected: false };\n    case \"SET_DEVICE_TYPE\":\n      return { ...state, deviceType: action.value };\n    case \"SET_BIP32_PATH\":\n      return { ...state, bip32Path: action.value };\n    case \"SET_ACTIVE\":\n      return { ...state, interactionState: ACTIVE };\n    case \"HAS_INTERACTION\":\n      return { ...state, hasInteraction: action.value };\n    case \"SET_MESSAGE\":\n      return {\n        ...state,\n        interactionMessage: action.value,\n        interactionError: \"\",\n      };\n    case \"SET_ERROR\":\n      return {\n        ...state,\n        interactionError: action.value,\n        interactionMessage: \"\",\n      };\n    default:\n      return state;\n  }\n};\n\nconst ConfirmAddress = ({ slice, network }) => {\n  const [state, dispatch] = useReducer(\n    interactionReducer,\n    initialInteractionState\n  );\n  const [interaction, setInteraction] = useState(null);\n\n  const addressType = multisigAddressType(slice.multisig);\n  const requiredSigners = multisigRequiredSigners(slice.multisig);\n  const totalSigners = multisigTotalSigners(slice.multisig);\n\n  // Sets device interaction for component based on xpub selected\n  function handleKeySelected(_event, extendedPublicKeyImporter) {\n    const { multisig, bip32Path } = slice;\n    if (extendedPublicKeyImporter) {\n      dispatch({ type: \"SET_KEY_SELECTED\" });\n      dispatch({\n        type: \"SET_DEVICE_TYPE\",\n        value: extendedPublicKeyImporter.method,\n      });\n      const fullBip32Path = `${\n        extendedPublicKeyImporter.bip32Path\n      }${bip32Path.slice(1)}`;\n      if (extendedPublicKeyImporter.bip32Path !== \"Unknown\") {\n        dispatch({\n          type: \"SET_BIP32_PATH\",\n          value: fullBip32Path,\n        });\n      } else {\n        dispatch({\n          type: \"SET_BIP32_PATH\",\n          value: \"\",\n        });\n      }\n      // FIXME - hardcoded to just show up for trezor\n      if (extendedPublicKeyImporter.method === \"trezor\") {\n        setInteraction(\n          ConfirmMultisigAddress({\n            keystore: extendedPublicKeyImporter.method,\n            network,\n            bip32Path: fullBip32Path,\n            multisig,\n          })\n        );\n        dispatch({ type: \"HAS_INTERACTION\", value: true });\n        dispatch({ type: \"RESET\" });\n      } else {\n        setInteraction(null);\n        dispatch({ type: \"HAS_INTERACTION\", value: false });\n        dispatch({ type: \"RESET\" });\n      }\n    } else {\n      setInteraction(null);\n      dispatch({ type: \"HAS_INTERACTION\", value: false });\n      dispatch({ type: \"RESET\" });\n      dispatch({ type: \"SET_KEY_UNSELECTED\" });\n    }\n  }\n\n  // Sets device interaction for component based on xpub selected\n  function handleMethodChange(event) {\n    if (event.target.value !== \"\") {\n      dispatch({\n        type: \"SET_DEVICE_TYPE\",\n        value: event.target.value,\n      });\n      const { multisig } = slice;\n      setInteraction(\n        ConfirmMultisigAddress({\n          keystore: event.target.value,\n          network,\n          bip32Path: state.bip32Path,\n          multisig,\n        })\n      );\n      dispatch({ type: \"HAS_INTERACTION\", value: true });\n      dispatch({ type: \"RESET\" });\n    }\n  }\n\n  // run interaction and see if address confirms\n  async function confirmOnDevice() {\n    dispatch({ type: \"SET_ACTIVE\" });\n    const { multisig } = slice;\n\n    try {\n      const confirmed = await interaction.run();\n      if (\n        confirmed.address === multisig.address &&\n        confirmed.serializedPath === interaction.bip32Path\n      ) {\n        dispatch({ type: \"SET_MESSAGE\", value: \"Success\" });\n      } else {\n        dispatch({ type: \"SET_ERROR\", value: \"An unknown error occured\" });\n      }\n    } catch (error) {\n      dispatch({ type: \"SET_ERROR\", value: error.message });\n    }\n  }\n\n  return (\n    <Grid item md={12}>\n      <ExtendedPublicKeySelector number={0} onChange={handleKeySelected} />\n      {state.keySelected && (\n        <form>\n          <FormControl fullWidth>\n            <InputLabel>Select Method</InputLabel>\n\n            <Select\n              id=\"confirm-importer-select\"\n              value=\"\"\n              onChange={handleMethodChange}\n            >\n              <MenuItem value=\"\">{\"< Select method >\"}</MenuItem>\n              <MenuItem value={TREZOR}>Trezor</MenuItem>\n              <MenuItem value={COLDCARD} disabled>\n                Coldcard\n              </MenuItem>\n              <MenuItem value={LEDGER} disabled>\n                Ledger\n              </MenuItem>\n              <MenuItem value={HERMIT} disabled>\n                Hermit\n              </MenuItem>\n              <MenuItem value={TEXT} disabled>\n                Enter as text\n              </MenuItem>\n            </Select>\n          </FormControl>\n        </form>\n      )}\n      {state.hasInteraction && (\n        <>\n          <Box>\n            <p>\n              Confirm the following {network.length ? network : \"\"}{\" \"}\n              {addressType} {requiredSigners} -of-\n              {totalSigners} multisig address on your device:\n            </p>\n            <Table>\n              <TableBody>\n                <TableRow>\n                  <TableCell>Address:</TableCell>\n                  <TableCell>\n                    <code>{slice.multisig.address}</code>\n                  </TableCell>\n                </TableRow>\n\n                <TableRow>\n                  <TableCell>BIP32 Path:</TableCell>\n                  <TableCell>\n                    <code>{state.bip32Path}</code>\n                  </TableCell>\n                </TableRow>\n              </TableBody>\n            </Table>\n          </Box>\n          {state.interactionMessage !== \"\" && (\n            <Box mt={2} align=\"center\">\n              <Typography variant=\"h5\" style={{ color: \"green\" }}>\n                <SuccessIcon />\n                &nbsp; {state.interactionMessage}\n              </Typography>\n            </Box>\n          )}\n          {state.interactionError !== \"\" && (\n            <Box mt={2} align=\"center\" style={{ color: \"red\" }}>\n              <Typography variant=\"h5\">\n                <ErrorIcon />\n                &nbsp; Confirmation Error\n              </Typography>\n              <Typography variant=\"caption\">\n                {state.interactionError}\n              </Typography>\n            </Box>\n          )}\n          {state.interactionMessage === \"\" && state.interactionError === \"\" && (\n            <InteractionMessages\n              messages={interaction.messagesFor({\n                state: state.interactionState,\n              })}\n            />\n          )}\n          <Button\n            variant=\"contained\"\n            size=\"large\"\n            onClick={confirmOnDevice}\n            disabled={state.interactionState === ACTIVE || !state.bip32Path}\n          >\n            Confirm\n          </Button>\n          {(state.interactionMessage !== \"\" ||\n            state.interactionError !== \"\") && (\n            <Button size=\"large\" onClick={() => dispatch({ type: \"RESET\" })}>\n              Reset\n            </Button>\n          )}\n        </>\n      )}\n    </Grid>\n  );\n};\n\nConfirmAddress.propTypes = {\n  slice: PropTypes.shape(slicePropTypes).isRequired,\n  network: PropTypes.string,\n};\n\nConfirmAddress.defaultProps = {\n  network: \"\",\n};\n\nexport default ConfirmAddress;\n","/* eslint-disable react/no-array-index-key */\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  Typography,\n  Grid,\n  Tabs,\n  Tab,\n  Box,\n  Tooltip,\n  AppBar,\n  makeStyles,\n} from \"@material-ui/core\";\n\nimport UTXOSet from \"../ScriptExplorer/UTXOSet\";\nimport MultisigDetails from \"../MultisigDetails\";\nimport ImportAddressesButton from \"../ImportAddressesButton\";\nimport ConfirmAddress from \"./ConfirmAddress\";\n\nimport { slicePropTypes, clientPropTypes } from \"../../proptypes\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n  },\n}));\n\nfunction a11yProps(index) {\n  return {\n    id: `scrollable-auto-tab-${index}`,\n    \"aria-controls\": `scrollable-auto-tabpanel-${index}`,\n  };\n}\n\nconst createTab = ({ tab }, index) => {\n  const tooltipTab = (\n    <Tab value={index.toString()} key={index} {...a11yProps(index)} {...tab} />\n  );\n  if (tab.disabled)\n    return (\n      <Tooltip title=\"Not available for this address\" key={index} arrow>\n        <div>{tooltipTab}</div>\n      </Tooltip>\n    );\n  return tooltipTab;\n};\n\nfunction TabPanel({ children, value, index, ...other }) {\n  return (\n    <Grid\n      container\n      justify=\"center\"\n      style={{ display: value === index ? \"inherit\" : \"none\" }}\n      {...other}\n    >\n      <Grid item md={11}>\n        <Box>{children}</Box>\n      </Grid>\n    </Grid>\n  );\n}\n\nTabPanel.propTypes = {\n  children: PropTypes.node,\n  value: PropTypes.string.isRequired,\n  index: PropTypes.string.isRequired,\n};\n\nTabPanel.defaultProps = {\n  children: React.createElement(\"span\"),\n};\n\nconst SliceDetails = ({ slice, client, network }) => {\n  const [tabIndex, setTabIndex] = React.useState(\"0\");\n  const classes = useStyles();\n\n  const handleChange = (_e, newIndex) => setTabIndex(newIndex);\n  const tabs = [\n    {\n      tab: {\n        label: \"Redeem Script\",\n      },\n      panel: <MultisigDetails multisig={slice.multisig} showAddress={false} />,\n    },\n    {\n      tab: {\n        label: \"Confirm on Device\",\n      },\n      panel: (\n        <div>\n          <Typography variant=\"h6\">\n            Verify Address with Quorum Participants\n          </Typography>\n          <Typography variant=\"caption\">\n            (not all device variants supported)\n          </Typography>\n          <ConfirmAddress slice={slice} network={network} />\n        </div>\n      ),\n    },\n    {\n      tab: {\n        label: \"UTXOs\",\n        disabled: !slice.balanceSats.isGreaterThan(0),\n      },\n      panel: (\n        <UTXOSet\n          inputs={slice.utxos}\n          inputsTotalSats={slice.balanceSats}\n          showSelection={false}\n        />\n      ),\n    },\n    {\n      tab: {\n        label: \"Watch Address\",\n        disabled: client.type !== \"private\",\n      },\n      panel: (\n        <div>\n          <Typography variant=\"h6\">Import Watch-Only Address</Typography>\n          <Typography variant=\"caption\">\n            Address must be imported to get accurate balance data. If this\n            address has previous history, a rescan may be required.\n          </Typography>\n          <Box my={3}>\n            <ImportAddressesButton\n              addresses={[slice.multisig.address]}\n              client={client}\n            />\n          </Box>\n        </div>\n      ),\n    },\n  ];\n\n  return (\n    <Grid container className={classes.root}>\n      <AppBar position=\"static\" color=\"default\" variant=\"outlined\">\n        <Tabs\n          value={tabIndex}\n          onChange={handleChange}\n          aria-label=\"Slice Details View\"\n          centered\n        >\n          {tabs.map(createTab)}\n        </Tabs>\n      </AppBar>\n      {tabs.map(({ panel }, index) => (\n        <TabPanel value={tabIndex} index={index.toString()} key={index}>\n          <Box my={3}>{panel}</Box>\n        </TabPanel>\n      ))}\n    </Grid>\n  );\n};\n\nSliceDetails.propTypes = {\n  slice: PropTypes.shape(slicePropTypes).isRequired,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n  network: PropTypes.string.isRequired,\n};\n\nexport default SliceDetails;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport MaterialTable from \"material-table\";\nimport { Typography, Box, makeStyles } from \"@material-ui/core\";\nimport { satoshisToBitcoins } from \"unchained-bitcoin\";\n\nimport {\n  compareSlicesByPath,\n  compareSlicesByBalance,\n  compareSlicesByUTXOCount,\n  compareSlicesByTime,\n} from \"../../utils/slices\";\n\n// Components\nimport Copyable from \"../Copyable\";\nimport { slicePropTypes, clientPropTypes } from \"../../proptypes\";\nimport SliceDetails from \"./SliceDetails\";\n\nconst useStyles = makeStyles((theme) => ({\n  panel: {\n    boxShadow: `inset 0px 0px 4px 1px ${theme.palette.grey[500]}`,\n  },\n  spent: {\n    textDecoration: \"line-through\",\n  },\n}));\n\nconst SlicesTable = ({\n  slices,\n  search,\n  paging,\n  title,\n  client,\n  network,\n  disabled,\n}) => {\n  const classes = useStyles();\n\n  const options = {\n    search,\n    paging,\n    detailPanelType: \"single\",\n    showTitle: (title && title.length) || false,\n    emptyRowsWhenPaging: false,\n    pageSize: 10,\n    pageSizeOptions: [10, 20, 50],\n  };\n  options.toolbar = options.showTitle && options.search;\n  let columns = [\n    {\n      title: \"Path Suffix\",\n      field: \"bip32Path\",\n      render: (rowData) => (\n        <Typography>{rowData.bip32Path.replace(\"m\", \"*\")}</Typography>\n      ),\n      type: \"string\",\n      defaultSort: \"asc\",\n      customSort: compareSlicesByPath,\n    },\n    {\n      title: \"UTXOs\",\n      field: \"utxos\",\n      width: \"50px\",\n      render: (rowData) => <Typography>{rowData.utxos.length}</Typography>,\n      customSort: compareSlicesByUTXOCount,\n    },\n    {\n      title: \"Balance\",\n      field: \"balanceSats\",\n      render: (rowData) => (\n        <Typography>\n          {satoshisToBitcoins(rowData.balanceSats).toString()}\n        </Typography>\n      ),\n      customSort: compareSlicesByBalance,\n    },\n    {\n      title: \"Last Used\",\n      field: \"lastUsed\",\n      render: (rowData) => <Typography>{rowData.lastUsed || \"\"}</Typography>,\n      customSort: compareSlicesByTime,\n    },\n    {\n      title: \"Address\",\n      field: \"address\",\n      sorting: false,\n      render: (rowData) => (\n        <Copyable\n          text={rowData.multisig.address}\n          showIcon\n          showText\n          code\n          className={\n            rowData.addressUsed && rowData.balanceSats.isEqualTo(0)\n              ? classes.spent\n              : \"\"\n          }\n        />\n      ),\n    },\n  ];\n\n  // filter out any columns that should be disabled\n  columns = columns.filter((column) => !disabled.includes(column.field));\n  return (\n    <MaterialTable\n      options={options}\n      columns={columns}\n      data={slices}\n      detailPanel={[\n        {\n          tooltip: \"Address Details\",\n          render: (rowData) => (\n            <Box p={1} className={classes.panel}>\n              <SliceDetails client={client} slice={rowData} network={network} />\n            </Box>\n          ),\n        },\n      ]}\n    />\n  );\n};\n\nSlicesTable.propTypes = {\n  slices: PropTypes.arrayOf(PropTypes.shape(slicePropTypes)).isRequired,\n  search: PropTypes.bool,\n  paging: PropTypes.bool,\n  title: PropTypes.string,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n  network: PropTypes.string.isRequired,\n  disabled: PropTypes.arrayOf(PropTypes.string),\n};\n\nSlicesTable.defaultProps = {\n  search: false,\n  paging: false,\n  title: \"\",\n  disabled: [],\n};\n\nexport default SlicesTable;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport QRCode from \"qrcode.react\";\nimport {\n  Button,\n  Box,\n  Card,\n  CardContent,\n  Grid,\n  InputAdornment,\n  Typography,\n  TextField,\n} from \"@material-ui/core\";\nimport { withSnackbar } from \"notistack\";\n\nimport { fetchAddressUTXOs } from \"../../blockchain\";\nimport {\n  updateDepositSliceAction,\n  resetWalletView as resetWalletViewAction,\n} from \"../../actions/walletActions\";\nimport { getDepositableSlices } from \"../../selectors/wallet\";\nimport { slicePropTypes } from \"../../proptypes\";\n\n// Components\nimport Copyable from \"../Copyable\";\nimport BitcoinIcon from \"../BitcoinIcon\";\nimport SlicesTable from \"../Slices/SlicesTable\";\n\nlet depositTimer;\n\nclass WalletDeposit extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      address: \"\",\n      amount: 0,\n      amountError: \"\",\n      depositIndex: 0,\n      slice: null,\n    };\n  }\n\n  componentDidMount() {\n    this.getDepositAddress();\n  }\n\n  componentWillUnmount() {\n    clearInterval(depositTimer);\n  }\n\n  getNextDepositAddress = () => {\n    const { depositIndex } = this.state;\n    this.setState({ depositIndex: depositIndex + 1 });\n    setTimeout(this.getDepositAddress, 0);\n  };\n\n  getDepositAddress = () => {\n    const {\n      network,\n      client,\n      updateDepositSlice,\n      depositableSlices,\n      enqueueSnackbar,\n    } = this.props;\n    const { depositIndex } = this.state;\n\n    if (depositIndex < depositableSlices.length)\n      this.setState({\n        slice: depositableSlices[depositIndex],\n        address: depositableSlices[depositIndex].multisig.address,\n      });\n\n    clearInterval(depositTimer);\n    depositTimer = setInterval(async () => {\n      let updates;\n      try {\n        const { address, slice } = this.state;\n        updates = await fetchAddressUTXOs(address, network, client);\n        if (updates && updates.utxos && updates.utxos.length) {\n          clearInterval(depositTimer);\n          updateDepositSlice({ ...updates, bip32Path: slice.bip32Path });\n          enqueueSnackbar(\n            \"Deposit received. A new address should now be available for deposit.\"\n          );\n          this.resetDepositAddressIndex();\n          setTimeout(this.getDepositAddress, 2000);\n        }\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.error(e);\n      }\n    }, 2000);\n  };\n\n  handleAmountChange = (event) => {\n    const amount = event.target.value;\n    let error = \"\";\n\n    if (amount.length && !amount.match(/^[0-9.]+$/)) {\n      error = \"Amount must be numeric\";\n    }\n    const decimal = amount.split(\".\");\n    if (decimal.length > 2) {\n      error = \"Amount must be numeric\";\n    } else if (decimal.length === 2 && decimal[1].length > 8) {\n      error = \"Amount must have maximum precision of 8 decimal places\";\n    }\n\n    this.setState({ amount: event.target.value, amountError: error });\n  };\n\n  qrString = () => {\n    const { address, amount } = this.state;\n    return `bitcoin:${address}${amount ? `?amount=${amount}` : \"\"}`;\n  };\n\n  resetDepositAddressIndex = () => {\n    const { depositableSlices } = this.props;\n    this.setState({\n      slice: depositableSlices[0],\n      address: depositableSlices[0].multisig.address,\n      depositIndex: 0,\n    });\n  };\n\n  render() {\n    const { client, network, depositableSlices } = this.props;\n    const { address, amount, amountError, depositIndex, slice } = this.state;\n\n    return (\n      <div>\n        <Card>\n          <CardContent>\n            <Grid\n              container\n              justify=\"center\"\n              direction=\"column\"\n              alignItems=\"center\"\n            >\n              <Grid item md={6}>\n                <Copyable text={address} newline showText={false}>\n                  <QRCode size={300} value={this.qrString()} level=\"L\" />\n                </Copyable>\n              </Grid>\n              <Grid item>\n                <Typography align=\"center\" variant=\"subtitle1\">\n                  Scan QR code or click to copy address to clipboard.\n                </Typography>\n              </Grid>\n              <Grid item md={6}>\n                <Box my={3}>\n                  <TextField\n                    fullWidth\n                    label=\"Amount BTC\"\n                    name=\"depositAmount\"\n                    onChange={this.handleAmountChange}\n                    value={amount}\n                    error={amountError !== \"\"}\n                    helperText={amountError}\n                    InputProps={{\n                      endAdornment: (\n                        <InputAdornment position=\"end\">\n                          <BitcoinIcon network={network} />\n                        </InputAdornment>\n                      ),\n                    }}\n                  />\n                </Box>\n              </Grid>\n            </Grid>\n            {slice ? (\n              <SlicesTable\n                slices={[slice]}\n                client={client}\n                network={network}\n                disabled={[\"lastUsed\"]}\n              />\n            ) : (\n              \"\"\n            )}\n            <Box mt={2}>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={this.getNextDepositAddress}\n                disabled={depositIndex >= depositableSlices.length - 1}\n              >\n                Next Address\n              </Button>\n            </Box>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n}\n\nWalletDeposit.propTypes = {\n  client: PropTypes.shape({}).isRequired,\n  depositableSlices: PropTypes.arrayOf(PropTypes.shape(slicePropTypes))\n    .isRequired,\n  enqueueSnackbar: PropTypes.func.isRequired,\n  network: PropTypes.string.isRequired,\n  updateDepositSlice: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.settings,\n    depositableSlices: getDepositableSlices(state),\n    client: state.client,\n  };\n}\n\nconst mapDispatchToProps = {\n  updateDepositSlice: updateDepositSliceAction,\n  resetWalletView: resetWalletViewAction,\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withSnackbar(WalletDeposit));\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\n// Components\nimport {\n  Grid,\n  Menu,\n  MenuItem,\n  Button,\n  ExpansionPanel,\n  ExpansionPanelDetails,\n  ExpansionPanelSummary,\n  Box,\n  Table,\n  TableBody,\n  TableRow,\n  TableCell,\n  Typography,\n} from \"@material-ui/core\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport { ThumbUp as SuccessIcon, Error as ErrorIcon } from \"@material-ui/icons\";\nimport {\n  blockExplorerAddressURL,\n  multisigAddressType,\n  NETWORKS,\n} from \"unchained-bitcoin\";\nimport { PENDING, ACTIVE, ConfirmMultisigAddress } from \"unchained-wallets\";\nimport LaunchIcon from \"@material-ui/icons/Launch\";\nimport UTXOSet from \"../ScriptExplorer/UTXOSet\";\nimport MultisigDetails from \"../MultisigDetails\";\nimport ImportAddressesButton from \"../ImportAddressesButton\";\nimport Copyable from \"../Copyable\";\nimport InteractionMessages from \"../InteractionMessages\";\nimport ExtendedPublicKeySelector from \"./ExtendedPublicKeySelector\";\n\nimport styles from \"../ScriptExplorer/styles.module.scss\";\n\nimport { externalLink } from \"../../utils\";\n\nconst MODE_UTXO = 0;\nconst MODE_REDEEM = 1;\nconst MODE_CONFIRM = 2;\nconst MODE_WATCH = 3;\nlet anchor;\n\nclass AddressExpander extends React.Component {\n  interaction = null;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      expandMode: null,\n      showMenu: false,\n      showMenuIcon: false,\n      hasInteraction: false,\n      interactionState: PENDING,\n      interactionError: \"\",\n      interactionMessage: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    this.defaultMode();\n  };\n\n  addressContent = () => {\n    const { node, network, client } = this.props;\n    const { multisig, addressUsed, balanceSats } = node;\n    const { expandMode, showMenu, showMenuIcon } = this.state;\n\n    return (\n      <div style={{ width: \"100%\" }}>\n        <Typography>\n          <Copyable text={multisig.address} showIcon showText={false}>\n            <code\n              className={\n                addressUsed && balanceSats.isEqualTo(0) ? styles.spent : \"\"\n              }\n            >\n              {multisig.address}\n            </code>\n            &nbsp;\n          </Copyable>\n          {externalLink(\n            blockExplorerAddressURL(multisig.address, network),\n            <LaunchIcon onClick={(e) => e.stopPropagation()} />\n          )}\n        </Typography>\n        <MoreVertIcon\n          onClick={this.handleMenu}\n          style={{\n            float: \"right\",\n            display:\n              showMenuIcon && this.hasAdditionalOptions() ? \"block\" : \"none\",\n          }}\n          aria-controls=\"address-menu\"\n          aria-haspopup=\"true\"\n        />\n        <Menu\n          id=\"address-menu\"\n          anchorEl={anchor}\n          keepMounted\n          open={showMenu}\n          onClose={this.handleClose}\n        >\n          {balanceSats.isGreaterThan(0) && (\n            <MenuItem\n              selected={expandMode === MODE_UTXO}\n              onClick={(e) => {\n                this.setState({ expandMode: MODE_UTXO });\n                this.handleClose(e);\n              }}\n            >\n              UTXOs\n            </MenuItem>\n          )}\n          <MenuItem\n            selected={expandMode === MODE_REDEEM}\n            onClick={(e) => {\n              this.setState({ expandMode: MODE_REDEEM });\n              this.handleClose(e);\n            }}\n          >\n            Scripts\n          </MenuItem>\n          {this.canConfirm() && (\n            <MenuItem\n              selected={expandMode === MODE_CONFIRM}\n              onClick={(e) => {\n                this.setState({ expandMode: MODE_CONFIRM });\n                this.handleClose(e);\n              }}\n            >\n              Confirm on Device\n            </MenuItem>\n          )}\n          {client.type === \"private\" && (\n            <MenuItem\n              selected={expandMode === MODE_WATCH}\n              onClick={(e) => {\n                this.setState({ expandMode: MODE_WATCH });\n                this.handleClose(e);\n              }}\n            >\n              Watch with bitcoind Node\n            </MenuItem>\n          )}\n        </Menu>\n      </div>\n    );\n  };\n\n  canConfirm = () => {\n    const { extendedPublicKeyImporters } = this.props;\n    return (\n      Object.values(extendedPublicKeyImporters).filter(\n        (importer) => importer.method === \"trezor\"\n      ).length > 0\n    );\n  };\n\n  hasAdditionalOptions = () => {\n    const { client, node } = this.props;\n    const { balanceSats } = node;\n\n    return (\n      balanceSats.isGreaterThan(0) ||\n      client.type === \"private\" ||\n      this.canConfirm()\n    );\n  };\n\n  handleClose = (event) => {\n    event.stopPropagation();\n    this.setState({ showMenu: false });\n  };\n\n  handleMenu = (event) => {\n    event.stopPropagation();\n    anchor = event.target;\n    this.setState({ showMenu: true });\n  };\n\n  panelExpand = (event, expanded) => {\n    this.setState({ showMenuIcon: expanded });\n  };\n\n  render = () => {\n    const { node } = this.props;\n    const { bip32Path } = node;\n    return (\n      <ExpansionPanel onChange={this.panelExpand}>\n        <ExpansionPanelSummary\n          expandIcon={<ExpandMoreIcon />}\n          aria-controls=\"panel1a-content\"\n          id={`address-header${bip32Path}`}\n        >\n          {this.addressContent()}\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails>\n          <Grid container>{this.expandContent()}</Grid>\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n    );\n  };\n\n  defaultMode = () => {\n    const { node } = this.props;\n    const { balanceSats } = node;\n\n    this.setState({\n      expandMode: balanceSats.isGreaterThan(0) ? MODE_UTXO : MODE_REDEEM,\n    });\n  };\n\n  expandContent = () => {\n    const { client, node, setSpendCheckbox } = this.props;\n    const { utxos, balanceSats, multisig, bip32Path, spend } = node;\n    const { expandMode } = this.state;\n\n    if (client.type === \"public\" && expandMode === MODE_WATCH)\n      this.defaultMode();\n    if (balanceSats.isEqualTo(0) && expandMode === MODE_UTXO)\n      this.defaultMode();\n\n    switch (expandMode) {\n      case MODE_UTXO:\n        return (\n          <Grid item md={12}>\n            <UTXOSet\n              inputs={utxos}\n              inputsTotalSats={balanceSats}\n              multisig={multisig}\n              bip32Path={bip32Path}\n              hideSelectAllInHeader\n              selectAll={spend}\n              node={node}\n              setSpendCheckbox={setSpendCheckbox}\n            />\n          </Grid>\n        );\n      case MODE_REDEEM:\n        return (\n          <Grid item md={12}>\n            <MultisigDetails multisig={multisig} showAddress={false} />\n          </Grid>\n        );\n      case MODE_CONFIRM:\n        return this.renderAddressConfirmation();\n      case MODE_WATCH:\n        return (\n          <Grid item md={12}>\n            <ImportAddressesButton addresses={[multisig.address]} />\n          </Grid>\n        );\n      default:\n        return \"\";\n    }\n  };\n\n  renderAddressConfirmation = () => {\n    const {\n      interactionState,\n      interactionMessage,\n      interactionError,\n      hasInteraction,\n    } = this.state;\n    return (\n      <Grid item md={12}>\n        <ExtendedPublicKeySelector number={0} onChange={this.keySelected} />\n        {hasInteraction && (\n          <>\n            {this.confirmAddressDescription()}\n            {interactionMessage !== \"\" && (\n              <Box mt={2} align=\"center\">\n                <Typography variant=\"h5\" style={{ color: \"green\" }}>\n                  <SuccessIcon />\n                  &nbsp; {interactionMessage}\n                </Typography>\n              </Box>\n            )}\n            {interactionError !== \"\" && (\n              <Box mt={2} align=\"center\" style={{ color: \"red\" }}>\n                <Typography variant=\"h5\">\n                  <ErrorIcon />\n                  &nbsp; Confirmation Error\n                </Typography>\n                <Typography variant=\"caption\">{interactionError}</Typography>\n              </Box>\n            )}\n            {interactionMessage === \"\" && interactionError === \"\" && (\n              <InteractionMessages\n                messages={this.interaction.messagesFor({\n                  state: interactionState,\n                })}\n              />\n            )}\n            <Button\n              variant=\"contained\"\n              size=\"large\"\n              onClick={this.confirmOnDevice}\n              disabled={interactionState === ACTIVE}\n            >\n              Confirm\n            </Button>\n            {(interactionMessage !== \"\" || interactionError !== \"\") && (\n              <Button size=\"large\" onClick={this.resetInteractionState}>\n                Reset\n              </Button>\n            )}\n          </>\n        )}\n      </Grid>\n    );\n  };\n\n  resetInteractionState = () => {\n    this.setState({\n      interactionError: \"\",\n      interactionMessage: \"\",\n      interactionState: PENDING,\n    });\n  };\n\n  confirmOnDevice = async () => {\n    this.setState({ interactionState: ACTIVE });\n    const { node } = this.props;\n    const { multisig } = node;\n    try {\n      const confirmed = await this.interaction.run();\n      if (\n        confirmed.address === multisig.address &&\n        confirmed.serializedPath === this.interaction.bip32Path\n      ) {\n        this.setState({\n          interactionState: ACTIVE,\n          interactionMessage: \"Success\",\n          interactionError: \"\",\n        });\n      } else {\n        this.setState({\n          interactionState: ACTIVE,\n          interactionError: \"An unknow error occured\",\n          interactionMessage: \"\",\n        });\n      }\n    } catch (error) {\n      this.setState({\n        interactionState: ACTIVE,\n        interactionError: error.message,\n        interactionMessage: \"\",\n      });\n    }\n  };\n\n  keySelected = (event, extendedPublicKeyImporter) => {\n    const { network, node } = this.props;\n    const { multisig, bip32Path } = node;\n\n    this.interaction = ConfirmMultisigAddress({\n      keystore: extendedPublicKeyImporter.method,\n      network,\n      bip32Path: `${extendedPublicKeyImporter.bip32Path}${bip32Path.slice(1)}`,\n      multisig,\n    });\n    this.setState({ hasInteraction: true });\n    this.resetInteractionState();\n  };\n\n  // TODO: DRY out with test\n  confirmAddressDescription() {\n    const { network, node, requiredSigners, totalSigners } = this.props;\n    const { multisig } = node;\n    const addressType = multisigAddressType(multisig);\n\n    return (\n      <Box>\n        <p>\n          Confirm the following {network} {addressType} {requiredSigners}\n          -of-\n          {totalSigners} multisig address on your device:\n        </p>\n\n        <Table>\n          <TableBody>\n            <TableRow>\n              <TableCell>Address:</TableCell>\n              <TableCell>\n                <code>{multisig.address}</code>\n              </TableCell>\n            </TableRow>\n\n            <TableRow>\n              <TableCell>BIP32 Path:</TableCell>\n              <TableCell>\n                <code>{this.interaction.bip32Path}</code>\n              </TableCell>\n            </TableRow>\n          </TableBody>\n        </Table>\n      </Box>\n    );\n  }\n}\n\nAddressExpander.propTypes = {\n  client: PropTypes.shape({\n    type: PropTypes.string,\n  }).isRequired,\n  extendedPublicKeyImporters: PropTypes.shape({}).isRequired,\n  node: PropTypes.shape({\n    addressUsed: PropTypes.bool,\n    balanceSats: PropTypes.shape({\n      isEqualTo: PropTypes.func,\n      isGreaterThan: PropTypes.func,\n    }),\n    bip32Path: PropTypes.string,\n    multisig: PropTypes.shape({\n      address: PropTypes.string,\n    }),\n    spend: PropTypes.bool,\n    utxos: PropTypes.arrayOf(PropTypes.shape({})),\n  }).isRequired,\n  network: PropTypes.string,\n  requiredSigners: PropTypes.number.isRequired,\n  totalSigners: PropTypes.number.isRequired,\n  setSpendCheckbox: PropTypes.func,\n};\n\nAddressExpander.defaultProps = {\n  network: NETWORKS.TESTNET,\n  setSpendCheckbox: () => {},\n};\n\nfunction mapStateToProps(state) {\n  return {\n    network: state.settings.network,\n    requiredSigners: state.settings.requiredSigners,\n    totalSigners: state.settings.totalSigners,\n    client: state.client,\n    extendedPublicKeyImporters: state.quorum.extendedPublicKeyImporters,\n    transaction: state.spend.transaction,\n  };\n}\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddressExpander);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { satoshisToBitcoins } from \"unchained-bitcoin\";\n\n// Components\nimport { TableRow, TableCell, Checkbox } from \"@material-ui/core\";\nimport AddressExpander from \"./AddressExpander\";\n\n// Actions\nimport {\n  setInputs as setInputsAction,\n  setFeeRate as setFeeRateAction,\n  updateAutoSpendAction as updateAutoSpendActionImport,\n} from \"../../actions/transactionActions\";\nimport { WALLET_MODES } from \"../../actions/walletActions\";\n\nclass Node extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      indeterminate: false,\n      checked: false,\n    };\n  }\n\n  componentDidMount = () => {\n    this.generate();\n  };\n\n  // Passing this fn down to the UTXOSet so we can get updates here, from there.\n  setSpendCheckbox = (value) => {\n    const { spend } = this.props;\n    if (value === \"indeterminate\") {\n      this.setState({ indeterminate: true, checked: false });\n      this.markSpending(true);\n    } else if (value === spend) {\n      // handles select/de-select all as well as have selected some and click select all\n      this.setState({ indeterminate: false, checked: value });\n      this.markSpending(value);\n    } else {\n      // handles the case of de-selecting one-by-one until there's nothing left selected\n      this.setState({ indeterminate: false, checked: value });\n      this.markSpending(false);\n    }\n  };\n\n  markSpending = (value) => {\n    const { change, bip32Path, updateNode } = this.props;\n    updateNode(change, { spend: value, bip32Path });\n  };\n\n  render = () => {\n    const {\n      bip32Path,\n      spend,\n      fetchedUTXOs,\n      balanceSats,\n      multisig,\n      utxos,\n      walletMode,\n      addressKnown,\n    } = this.props;\n    const { indeterminate, checked } = this.state;\n    const spending = walletMode === WALLET_MODES.SPEND;\n    return (\n      <TableRow key={bip32Path}>\n        {spending && (\n          <TableCell>\n            <Checkbox\n              id={bip32Path}\n              name=\"spend\"\n              onChange={this.handleSpend}\n              checked={checked || spend}\n              disabled={!fetchedUTXOs || balanceSats.isEqualTo(0)}\n              indeterminate={indeterminate}\n            />\n          </TableCell>\n        )}\n        <TableCell>\n          <code>{bip32Path.replace(\"m\", \"*\")}</code>\n        </TableCell>\n        <TableCell>{utxos.length}</TableCell>\n        <TableCell>\n          {fetchedUTXOs && addressKnown\n            ? satoshisToBitcoins(balanceSats).toFixed()\n            : \"\"}\n        </TableCell>\n        <TableCell>{this.maxUtxoDate()}</TableCell>\n\n        <TableCell>{multisig ? this.renderAddress() : \"...\"}</TableCell>\n      </TableRow>\n    );\n  };\n\n  maxUtxoDate = () => {\n    const { utxos } = this.props;\n    if (!utxos.length) return \"\";\n    const maxtime = Math.max(...utxos.map((utxo) => utxo.time));\n    if (Number.isNaN(maxtime)) return \"Pending\";\n    return new Date(1000 * maxtime).toLocaleDateString();\n  };\n\n  renderAddress = () => {\n    const { braidNode } = this.props;\n    return (\n      <AddressExpander\n        node={braidNode}\n        setSpendCheckbox={this.setSpendCheckbox}\n      />\n    );\n  };\n\n  generate = () => {\n    const { present, change, bip32Path, addNode } = this.props;\n    if (!present) {\n      addNode(change, bip32Path);\n    }\n  };\n\n  handleSpend = (e) => {\n    const {\n      change,\n      bip32Path,\n      updateNode,\n      inputs,\n      utxos,\n      multisig,\n      setInputs,\n      updateAutoSpend,\n      setFeeRate,\n      feeRate,\n    } = this.props;\n    let newInputs;\n\n    if (e.target.getAttribute(\"data-indeterminate\")) {\n      // remove any inputs that are ours\n      newInputs = inputs.filter((input) => {\n        const newUtxos = utxos.filter((utxo) => {\n          return utxo.txid === input.txid && utxo.index === input.index;\n        });\n        return newUtxos.length === 0;\n      });\n      // then add all ours back\n      newInputs = newInputs.concat(\n        utxos.map((utxo) => ({ ...utxo, multisig, bip32Path }))\n      );\n      this.setState({ indeterminate: false, checked: true });\n    } else if (e.target.checked) {\n      newInputs = inputs.concat(\n        utxos.map((utxo) => ({ ...utxo, multisig, bip32Path }))\n      );\n    } else {\n      newInputs = inputs.filter((input) => {\n        const newUtxos = utxos.filter((utxo) => {\n          return utxo.txid === input.txid && utxo.index === input.index;\n        });\n        return newUtxos.length === 0;\n      });\n    }\n    setInputs(newInputs);\n    updateNode(change, { spend: e.target.checked, bip32Path });\n    updateAutoSpend(false);\n    setFeeRate(feeRate);\n  };\n}\n\nNode.propTypes = {\n  addNode: PropTypes.func.isRequired,\n  addressKnown: PropTypes.bool.isRequired,\n  balanceSats: PropTypes.shape({\n    isEqualTo: PropTypes.func,\n  }).isRequired,\n  bip32Path: PropTypes.string.isRequired,\n  braidNode: PropTypes.shape({}).isRequired,\n  change: PropTypes.bool.isRequired,\n  feeRate: PropTypes.string.isRequired,\n  fetchedUTXOs: PropTypes.bool.isRequired,\n  inputs: PropTypes.arrayOf(\n    PropTypes.shape({\n      index: PropTypes.number,\n      txid: PropTypes.string,\n    })\n  ).isRequired,\n  multisig: PropTypes.shape({}),\n  present: PropTypes.bool,\n  setFeeRate: PropTypes.func.isRequired,\n  setInputs: PropTypes.func.isRequired,\n  spend: PropTypes.bool.isRequired,\n  updateAutoSpend: PropTypes.func.isRequired,\n  updateNode: PropTypes.func.isRequired,\n  utxos: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  walletMode: PropTypes.number.isRequired,\n};\n\nNode.defaultProps = {\n  multisig: {},\n  present: false,\n};\n\nfunction mapStateToProps(state, ownProps) {\n  const change = (ownProps.bip32Path || \"\").split(\"/\")[1] === \"1\"; // // m, 0, 1\n  const braid = state.wallet[change ? \"change\" : \"deposits\"];\n  return {\n    ...state.settings,\n    ...{ change },\n    ...braid.nodes[ownProps.bip32Path],\n    ...state.spend.transaction,\n    walletMode: state.wallet.common.walletMode,\n    braidNode: braid.nodes[ownProps.bip32Path],\n  };\n}\n\nconst mapDispatchToProps = {\n  setInputs: setInputsAction,\n  setFeeRate: setFeeRateAction,\n  updateAutoSpend: updateAutoSpendActionImport,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Node);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\n// Components\nimport {\n  FormGroup,\n  FormControlLabel,\n  Checkbox,\n  FormLabel,\n  Grid,\n  Box,\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n  TablePagination,\n  TableSortLabel,\n} from \"@material-ui/core\";\nimport Node from \"./Node\";\nimport { WALLET_MODES } from \"../../actions/walletActions\";\n\nclass NodeSet extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      page: 0,\n      nodesPerPage: 10,\n      select: false,\n      filterIncludeSpent: false,\n      filterIncludeZeroBalance: false,\n      orderBy: \"bip32Path\",\n      orderDir: \"asc\",\n    };\n  }\n\n  sortAddresses = (key) => {\n    const { orderBy, orderDir } = this.state;\n    if (key === orderBy) {\n      this.setState({ page: 0, orderDir: orderDir === \"asc\" ? \"desc\" : \"asc\" });\n    } else {\n      this.setState({ page: 0, orderBy: key });\n    }\n  };\n\n  renderFilters = () => {\n    const { filterIncludeSpent, filterIncludeZeroBalance } = this.state;\n    return (\n      <FormGroup row>\n        <FormLabel component=\"h2\">\n          <Box mr={3}>Show Additional</Box>\n        </FormLabel>\n        <FormControlLabel\n          control={\n            <Checkbox\n              checked={filterIncludeSpent}\n              value=\"filterIncludeSpent\"\n              onChange={this.filterAddresses}\n            />\n          }\n          label=\"Spent Addresses\"\n        />\n        <FormControlLabel\n          control={\n            <Checkbox\n              checked={filterIncludeZeroBalance}\n              value=\"filterIncludeZeroBalance\"\n              onChange={this.filterAddresses}\n            />\n          }\n          label=\"Zero Balance\"\n        />\n      </FormGroup>\n    );\n  };\n\n  filterAddresses = (event, checked) => {\n    this.setState({ [event.target.value]: checked, page: 0 });\n  };\n\n  getNodeSet = () => {\n    const { changeNodes, depositNodes } = this.props;\n    const {\n      filterIncludeSpent,\n      filterIncludeZeroBalance,\n      orderBy,\n      orderDir,\n    } = this.state;\n    const nodes = Object.values(depositNodes)\n      .concat(Object.values(changeNodes))\n      .reduce((result, node) => {\n        const returnValue = result;\n        returnValue[node.bip32Path] = node;\n        return returnValue;\n      }, {});\n\n    let nodeSet = [];\n    Object.values(nodes).forEach((node) => {\n      if (node.balanceSats.isGreaterThan(0)) {\n        nodeSet.push(node);\n      } else if (\n        filterIncludeZeroBalance &&\n        node.balanceSats.isEqualTo(0) &&\n        !node.addressUsed\n      ) {\n        nodeSet.push(node);\n      } else if (filterIncludeSpent && node.addressUsed) {\n        nodeSet.push(node);\n      }\n    });\n\n    nodeSet = nodeSet.sort((a, b) => {\n      const direction = orderDir === \"asc\" ? 1 : -1;\n      if (orderBy === \"bip32Path\") {\n        if (a.change && !b.change) return direction;\n        if (!a.change && b.change) return -direction;\n        const aint = parseInt(a.bip32Path.split(\"/\").reverse()[0], 10);\n        const bint = parseInt(b.bip32Path.split(\"/\").reverse()[0], 10);\n        return aint > bint ? direction : -direction;\n      }\n      if (orderBy === \"balanceSats\") {\n        if (a.balanceSats.isEqualTo(b.balanceSats)) return 0;\n        return a.balanceSats.isGreaterThan(b.balanceSats)\n          ? direction\n          : -direction;\n      }\n      if (orderBy === \"utxos\") {\n        if (a.utxos.length === b.utxos.length) return 0;\n        return a.utxos.length > b.utxos.length ? direction : -direction;\n      }\n      if (orderBy === \"time\") {\n        if (a.utxos.length === 0) {\n          return b.utxos.length === 0 ? 0 : direction;\n        }\n        if (b.utxos.length === 0) {\n          return a.utxos.length === 0 ? 0 : -direction;\n        }\n        const amin = Math.min(...a.utxos.map((utxo) => utxo.time));\n        const bmin = Math.min(...b.utxos.map((utxo) => utxo.time));\n        if (Number.isNaN(amin) && Number.Number.isNaN(bmin)) return 0;\n        if (Number.isNaN(amin)) return direction;\n        if (Number.isNaN(bmin)) return -direction;\n        return amin > bmin ? direction : -direction;\n      }\n      return 0;\n    });\n\n    nodeSet = nodeSet.reduce((nodesObject, currentNode) => {\n      const returnValue = nodesObject;\n      returnValue[currentNode.bip32Path] = currentNode;\n      return returnValue;\n    }, {});\n\n    return nodeSet;\n  };\n\n  renderNodes = () => {\n    const { page, nodesPerPage, select } = this.state;\n    const { addNode, updateNode } = this.props;\n    const startingIndex = page * nodesPerPage;\n    const nodesRows = [];\n    const nodeSet = this.getNodeSet();\n    for (let index = 0; index < nodesPerPage; index += 1) {\n      const whichOne = startingIndex + index;\n      if (whichOne > Object.keys(nodeSet).length - 1) break;\n      const bip32Path = Object.values(nodeSet)[whichOne].bip32Path; // eslint-disable-line prefer-destructuring\n      const change = Object.values(nodeSet)[whichOne].change; // eslint-disable-line prefer-destructuring\n      const nodeRow = (\n        <Node\n          key={bip32Path}\n          bip32Path={bip32Path}\n          addNode={addNode}\n          updateNode={updateNode}\n          change={change}\n          select={select}\n        />\n      );\n      nodesRows.push(nodeRow);\n    }\n    return nodesRows;\n  };\n\n  handlePageChange = (e, selected) => {\n    const page = selected; // + 1;\n    this.setState({ page });\n  };\n\n  handleChangeRowsPerPage = (e) => {\n    this.setState({ nodesPerPage: e.target.value, page: 0 });\n  };\n\n  pageCount = () => {\n    const { nodesPerPage } = this.state;\n    return Math.ceil(this.rowCount() / nodesPerPage);\n  };\n\n  rowCount = () => {\n    const nodeSet = this.getNodeSet();\n    return Object.keys(nodeSet).length;\n  };\n\n  render() {\n    const { page, nodesPerPage, orderBy, orderDir } = this.state;\n    const { walletMode } = this.props;\n    const spending = walletMode === WALLET_MODES.SPEND;\n    return (\n      <Grid item md={12}>\n        <Table style={{ tableLayout: \"fixed\" }}>\n          <TableHead>\n            <TableRow>\n              {spending && <TableCell width={62}>Select</TableCell>}\n              <TableCell width={106}>\n                <TableSortLabel\n                  active={orderBy === \"bip32Path\"}\n                  direction={orderDir}\n                  onClick={() => this.sortAddresses(\"bip32Path\")}\n                >\n                  BIP32 Path\n                </TableSortLabel>\n              </TableCell>\n              <TableCell width={78}>\n                <TableSortLabel\n                  active={orderBy === \"utxos\"}\n                  direction={orderDir}\n                  onClick={() => this.sortAddresses(\"utxos\")}\n                >\n                  UTXOs\n                </TableSortLabel>\n              </TableCell>\n              <TableCell width={82}>\n                <TableSortLabel\n                  active={orderBy === \"balanceSats\"}\n                  direction={orderDir}\n                  onClick={() => this.sortAddresses(\"balanceSats\")}\n                >\n                  Balance\n                </TableSortLabel>\n              </TableCell>\n              <TableCell width={98}>\n                <TableSortLabel\n                  active={orderBy === \"time\"}\n                  direction={orderDir}\n                  onClick={() => this.sortAddresses(\"time\")}\n                >\n                  Last Used\n                </TableSortLabel>\n              </TableCell>\n              <TableCell>Address</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>{this.renderNodes()}</TableBody>\n        </Table>\n        <Grid container>\n          <Grid item md={6}>\n            <TablePagination\n              component=\"div\"\n              count={this.rowCount()}\n              rowsPerPage={nodesPerPage}\n              page={page}\n              backIconButtonProps={{\n                \"aria-label\": \"previous page\",\n              }}\n              nextIconButtonProps={{\n                \"aria-label\": \"next page\",\n              }}\n              onChangePage={this.handlePageChange}\n              onChangeRowsPerPage={this.handleChangeRowsPerPage}\n            />\n          </Grid>\n        </Grid>\n        {!spending && this.renderFilters()}\n      </Grid>\n    );\n  }\n}\n\nNodeSet.propTypes = {\n  depositNodes: PropTypes.shape({}).isRequired,\n  changeNodes: PropTypes.shape({}).isRequired,\n  addNode: PropTypes.func.isRequired,\n  updateNode: PropTypes.func.isRequired,\n  walletMode: PropTypes.number.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    changeNodes: state.wallet.change.nodes,\n    depositNodes: state.wallet.deposits.nodes,\n    walletMode: state.wallet.common.walletMode,\n    client: state.client,\n    ...state.settings,\n  };\n}\n\nconst mapDispatchToProps = {};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeSet);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  satoshisToBitcoins,\n  bitcoinsToSatoshis,\n  validateOutputAmount,\n} from \"unchained-bitcoin\";\nimport BigNumber from \"bignumber.js\";\nimport {\n  Grid,\n  Tooltip,\n  TextField,\n  IconButton,\n  InputAdornment,\n  FormHelperText,\n  Typography,\n} from \"@material-ui/core\";\nimport AccountBalanceWalletOutlinedIcon from \"@material-ui/icons/AccountBalanceWallet\";\nimport { Delete, AddCircle, RemoveCircle } from \"@material-ui/icons\";\nimport {\n  setOutputAddress,\n  setOutputAmount,\n  deleteOutput,\n  setChangeOutputIndex,\n  setMaxSpendOnOutput,\n} from \"../../actions/transactionActions\";\nimport styles from \"./styles.module.scss\";\n\nclass OutputEntry extends React.Component {\n  displayBalanceAction = () => {\n    const { isWallet, finalizedOutputs, autoSpend } = this.props;\n    if (isWallet) {\n      return (\n        !autoSpend &&\n        !finalizedOutputs &&\n        this.hasBalanceError() &&\n        this.isBalanceable()\n      );\n    }\n    return !finalizedOutputs && this.hasBalanceError() && this.isBalanceable();\n  };\n\n  //\n  // Address\n  //\n\n  addChangeAddress = () => {\n    const { changeNode, number, setAddress, setChangeOutput } = this.props;\n    setAddress(number, changeNode.multisig.address);\n    setChangeOutput(number);\n  };\n\n  renderChangeAdornment = () => {\n    const {\n      changeNode,\n      number,\n      changeOutputIndex,\n      address,\n      isWallet,\n      autoSpend,\n    } = this.props;\n    if (isWallet && autoSpend) return {};\n    if (changeNode !== null) {\n      let title;\n      let disable = false;\n      if (changeOutputIndex === 0 && address === \"\") {\n        title = \"Set to wallet change address\";\n      } else if (number === changeOutputIndex) {\n        title = \"Your change will go here.\";\n        disable = true;\n      } else return {};\n      return {\n        /* min: \"0\", */\n        /* max: \"1000\", */\n        /* step: \"any\", */\n        endAdornment: (\n          <InputAdornment position=\"end\">\n            <Tooltip placement=\"top\" title={title}>\n              <small>\n                <IconButton onClick={this.addChangeAddress} disabled={disable}>\n                  <AccountBalanceWalletOutlinedIcon />\n                </IconButton>\n              </small>\n            </Tooltip>\n          </InputAdornment>\n        ),\n      };\n    }\n    return {};\n  };\n\n  handleAddressChange = (event) => {\n    const { number, setAddress } = this.props;\n    setAddress(number, event.target.value);\n  };\n\n  hasAddressError = () => {\n    const { addressError } = this.props;\n    return addressError !== \"\";\n  };\n\n  //\n  // Amount\n  //\n\n  handleAmountChange = (event) => {\n    const { number, setAmount } = this.props;\n    setAmount(number, event.target.value);\n  };\n\n  hasAmountError = () => {\n    const { amountError } = this.props;\n    return amountError !== \"\";\n  };\n\n  //\n  // Balance\n  //\n\n  isNotBalanceable = () => {\n    const {\n      number,\n      outputs,\n      feeError,\n      amountError,\n      amount,\n      inputsTotalSats,\n    } = this.props;\n    if (feeError !== \"\") {\n      return true;\n    }\n    for (let i = 0; i < outputs.length; i += 1) {\n      if (i !== number - 1) {\n        if (outputs[i].amountError !== \"\" || outputs[i].amount === \"\") {\n          return true;\n        }\n      }\n    }\n    const newAmount = this.autoBalancedAmount();\n    if (\n      validateOutputAmount(bitcoinsToSatoshis(newAmount), inputsTotalSats) !==\n      \"\"\n    ) {\n      return true;\n    }\n    return amountError === \"\" && newAmount === new BigNumber(amount);\n  };\n\n  isBalanceable = () => !this.isNotBalanceable();\n\n  hasBalanceError = () => {\n    const { balanceError } = this.props;\n    return balanceError !== \"\";\n  };\n\n  autoBalancedAmount = () => {\n    const { number, fee, inputsTotalSats, outputs } = this.props;\n    const outputTotalSats = outputs\n      .filter((output, i) => i !== number - 1)\n      .map((output) => output.amountSats)\n      .reduce(\n        (accumulator, currentValue) => accumulator.plus(currentValue),\n        new BigNumber(0)\n      );\n    const feeSats = bitcoinsToSatoshis(new BigNumber(fee));\n    return satoshisToBitcoins(\n      inputsTotalSats.minus(outputTotalSats.plus(feeSats))\n    );\n  };\n\n  balanceAction = () => {\n    const { balanceError } = this.props;\n    if (!this.hasBalanceError() || this.isNotBalanceable()) {\n      return null;\n    }\n    return balanceError.split(\" \")[0];\n  };\n\n  handleBalance = () => {\n    const { number, setAmount } = this.props;\n    setAmount(number, this.autoBalancedAmount().toString());\n  };\n\n  //\n  // State\n  //\n\n  hasError = () => {\n    return this.hasAddressError() || this.hasAmountError();\n  };\n\n  handleDelete = () => {\n    const { number, remove } = this.props;\n    remove(number);\n  };\n\n  handleMaxSpend = (e) => {\n    e.preventDefault();\n    const { number, setMaxSpend } = this.props;\n    setMaxSpend(number);\n  };\n\n  render() {\n    const {\n      outputs,\n      finalizedOutputs,\n      address,\n      amount,\n      addressError,\n      amountError,\n      changeOutputIndex,\n      autoSpend,\n      isWallet,\n      number,\n    } = this.props;\n\n    const gridSpacing = isWallet ? 10 : 1;\n\n    return (\n      <Grid container spacing={gridSpacing}>\n        <Grid item xs={7}>\n          <TextField\n            fullWidth\n            placeholder=\"Address\"\n            name=\"destination\"\n            className={styles.outputsFormInput}\n            disabled={finalizedOutputs}\n            onChange={this.handleAddressChange}\n            value={address}\n            error={this.hasAddressError()}\n            helperText={addressError}\n            InputProps={this.renderChangeAdornment()}\n          />\n        </Grid>\n\n        <Grid item xs={3}>\n          <TextField\n            fullWidth\n            placeholder=\"Amount\"\n            className={styles.outputsFormInput}\n            name=\"amount\"\n            disabled={finalizedOutputs}\n            onChange={this.handleAmountChange}\n            value={amount}\n            error={this.hasAmountError()}\n            helperText={amountError}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  {isWallet &&\n                    autoSpend &&\n                    number === outputs.length &&\n                    number !== changeOutputIndex && (\n                      <Typography\n                        onClick={this.handleMaxSpend}\n                        className={styles.maxSpend}\n                        style={{ fontSize: \".7rem\" }}\n                      >\n                        MAX\n                      </Typography>\n                    )}\n                </InputAdornment>\n              ),\n              endAdornment: (\n                <InputAdornment position=\"end\">\n                  <FormHelperText>BTC</FormHelperText>\n                </InputAdornment>\n              ),\n            }}\n          />\n        </Grid>\n        {this.displayBalanceAction() && (\n          <Grid item xs={1}>\n            <Tooltip\n              title={`${this.balanceAction()} to ${this.autoBalancedAmount().toString()}`}\n              placement=\"top\"\n            >\n              <small>\n                <IconButton onClick={this.handleBalance}>\n                  {this.balanceAction() === \"Increase\" ? (\n                    <AddCircle />\n                  ) : (\n                    <RemoveCircle />\n                  )}\n                </IconButton>\n              </small>\n            </Tooltip>\n          </Grid>\n        )}\n\n        {!finalizedOutputs &&\n          outputs.length > (changeOutputIndex > 0 && autoSpend ? 2 : 1) && (\n            <Grid item xs={1}>\n              <Tooltip title=\"Remove Output\" placement=\"top\">\n                <IconButton onClick={this.handleDelete}>\n                  <Delete />\n                </IconButton>\n              </Tooltip>\n            </Grid>\n          )}\n      </Grid>\n    );\n  }\n}\n\nOutputEntry.propTypes = {\n  address: PropTypes.string.isRequired,\n  addressError: PropTypes.string.isRequired,\n  amount: PropTypes.string.isRequired,\n  amountError: PropTypes.string.isRequired,\n  autoSpend: PropTypes.bool.isRequired,\n  balanceError: PropTypes.string.isRequired,\n  changeNode: PropTypes.shape({\n    multisig: PropTypes.shape({\n      address: PropTypes.string,\n    }),\n  }),\n  changeOutputIndex: PropTypes.number.isRequired,\n  fee: PropTypes.string.isRequired,\n  feeError: PropTypes.string.isRequired,\n  finalizedOutputs: PropTypes.bool.isRequired,\n  inputsTotalSats: PropTypes.shape({\n    minus: PropTypes.func,\n  }).isRequired,\n  isWallet: PropTypes.bool.isRequired,\n  number: PropTypes.number.isRequired,\n  outputs: PropTypes.arrayOf(\n    PropTypes.shape({\n      amount: PropTypes.string,\n      amountError: PropTypes.string.isRequired,\n    })\n  ).isRequired,\n  remove: PropTypes.func.isRequired,\n  setAddress: PropTypes.func.isRequired,\n  setAmount: PropTypes.func.isRequired,\n  setMaxSpend: PropTypes.func.isRequired,\n  setChangeOutput: PropTypes.func.isRequired,\n};\n\nOutputEntry.defaultProps = {\n  changeNode: {},\n};\n\nfunction mapStateToProps(state, ownProps) {\n  return {\n    ...state.spend.transaction,\n    ...state.spend.transaction.outputs[ownProps.number - 1],\n    changeNode: state.wallet.change.nextNode,\n  };\n}\n\nconst mapDispatchToProps = {\n  setAddress: setOutputAddress,\n  setAmount: setOutputAmount,\n  remove: deleteOutput,\n  setChangeOutput: setChangeOutputIndex,\n  setMaxSpend: setMaxSpendOnOutput,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OutputEntry);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { map } from \"lodash\";\nimport BigNumber from \"bignumber.js\";\nimport { bitcoinsToSatoshis, satoshisToBitcoins } from \"unchained-bitcoin\";\nimport {\n  Grid,\n  Button,\n  Tooltip,\n  TextField,\n  Box,\n  IconButton,\n  InputAdornment,\n  Typography,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport { Speed } from \"@material-ui/icons\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport {\n  addOutput as addOutputAction,\n  setOutputAmount as setOutputAmountAction,\n  setFeeRate as setFeeRateAction,\n  setFee as setFeeAction,\n  finalizeOutputs as finalizeOutputsAction,\n  resetOutputs as resetOutputsAction,\n} from \"../../actions/transactionActions\";\nimport { fetchFeeEstimate } from \"../../blockchain\";\nimport { MIN_SATS_PER_BYTE_FEE } from \"../Wallet/constants\";\nimport OutputEntry from \"./OutputEntry\";\nimport styles from \"./styles.module.scss\";\n\nclass OutputsForm extends React.Component {\n  static unitLabel(label, options) {\n    let inputProps = {\n      endAdornment: (\n        <InputAdornment position=\"end\">\n          <FormHelperText>{label}</FormHelperText>\n        </InputAdornment>\n      ),\n    };\n    if (options) {\n      inputProps = {\n        ...inputProps,\n        ...options,\n      };\n    }\n    return inputProps;\n  }\n\n  titleRef = React.createRef();\n\n  outputsTotal = 0;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      feeRateFetchError: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    this.initialOutputState();\n    this.scrollToTitle();\n  };\n\n  scrollToTitle = () => {\n    const { signatureImporters, isWallet } = this.props;\n    const finalizedCount = Object.keys(signatureImporters).reduce(\n      (o, k) => o + signatureImporters[k].finalized,\n      0\n    );\n    if (finalizedCount === 0 && !isWallet)\n      this.titleRef.current.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  renderOutputs = () => {\n    const { outputs, changeOutputIndex, autoSpend } = this.props;\n    return map(outputs).map((output, i) => (\n      <Box\n        key={i} // eslint-disable-line react/no-array-index-key\n        display={autoSpend && changeOutputIndex === i + 1 ? \"none\" : \"block\"}\n      >\n        <Grid container>\n          <OutputEntry number={i + 1} />\n        </Grid>\n      </Box>\n    ));\n  };\n\n  inputsTotal = () => {\n    const { inputsTotalSats } = this.props;\n    return satoshisToBitcoins(inputsTotalSats);\n  };\n\n  outputsAndFeeTotal = () => {\n    const { outputs, fee, updatesComplete, inputs } = this.props;\n    let total = outputs\n      .map((output) => {\n        let { amount } = output;\n        if (!amount || !amount.length || Number.isNaN(amount)) amount = 0;\n        return new BigNumber(amount);\n      })\n      .reduce(\n        (accumulator, currentValue) => accumulator.plus(currentValue),\n        new BigNumber(0)\n      );\n\n    // only care to add fee if we have inputs\n    // which we won't have in auto-spend wallet output form\n    if (fee && inputs.length) total = total.plus(fee);\n\n    if (updatesComplete) {\n      this.outputsTotal = total;\n      return total.toFixed(8);\n    }\n    return \"0.00000000\";\n  };\n\n  hasFeeRateFetchError = () => {\n    const { feeRateFetchError } = this.state;\n    return feeRateFetchError !== \"\";\n  };\n\n  hasFeeRateError = () => {\n    const { feeRateError } = this.props;\n    return feeRateError !== \"\";\n  };\n\n  hasFeeError = () => {\n    const { feeError } = this.props;\n    return feeError !== \"\";\n  };\n\n  hasBalanceError = () => {\n    const { balanceError } = this.props;\n    return balanceError !== \"\";\n  };\n\n  hasError = () => {\n    return (\n      this.hasFeeRateFetchError() ||\n      this.hasFeeRateError() ||\n      this.hasFeeError() ||\n      this.hasBalanceError()\n    );\n  };\n\n  handleAddOutput = () => {\n    const { addOutput } = this.props;\n    addOutput();\n  };\n\n  handleFeeRateChange = (event) => {\n    const { setFeeRate } = this.props;\n    let rate = event.target.value;\n\n    if (\n      rate === \"\" ||\n      Number.isNaN(parseFloat(rate, 10)) ||\n      parseFloat(rate, 10) < 1\n    )\n      rate = \"0\";\n    setFeeRate(rate);\n  };\n\n  handleFeeChange = (event) => {\n    const { setFee } = this.props;\n    setFee(event.target.value);\n  };\n\n  handleFinalize = () => {\n    const { finalizeOutputs } = this.props;\n    finalizeOutputs(true);\n  };\n\n  handleReset = () => {\n    const { resetOutputs, isWallet } = this.props;\n    resetOutputs();\n    if (!isWallet) setTimeout(() => this.initialOutputState(), 0);\n  };\n\n  getFeeEstimate = async () => {\n    const { client, network, setFeeRate } = this.props;\n    let feeEstimate;\n    let feeRateFetchError = \"\";\n    try {\n      feeEstimate = await fetchFeeEstimate(network, client);\n    } catch (e) {\n      feeRateFetchError = \"There was an error fetching the fee rate.\";\n    } finally {\n      setFeeRate(\n        !Number.isNaN(feeEstimate)\n          ? feeEstimate.toString()\n          : MIN_SATS_PER_BYTE_FEE.toString()\n      );\n      this.setState({ feeRateFetchError });\n    }\n  };\n\n  gatherSignaturesDisabled = () => {\n    const { finalizedOutputs, outputs, inputs } = this.props;\n    if (inputs.length === 0) return true;\n    if (finalizedOutputs || this.hasError()) {\n      return true;\n    }\n    for (let i = 0; i < outputs.length; i += 1) {\n      const output = outputs[i];\n      if (\n        output.address === \"\" ||\n        output.amount === \"\" ||\n        output.addressError !== \"\" ||\n        output.amountError !== \"\"\n      ) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  async initialOutputState() {\n    const { inputs, outputs } = this.props;\n    await this.getFeeEstimate();\n    const { inputsTotalSats, fee, setOutputAmount } = this.props;\n    const feeSats = bitcoinsToSatoshis(new BigNumber(fee));\n    const outputAmount = satoshisToBitcoins(inputsTotalSats.minus(feeSats));\n    // only initialize once so we don't lose state\n    if (inputs.length && outputs[0].amount === \"\")\n      setOutputAmount(1, outputAmount.toFixed(8));\n  }\n\n  render() {\n    const {\n      feeRate,\n      fee,\n      finalizedOutputs,\n      feeRateError,\n      feeError,\n      balanceError,\n      inputs,\n      isWallet,\n      autoSpend,\n    } = this.props;\n    const { feeRateFetchError } = this.state;\n    const feeDisplay = inputs && inputs.length > 0 ? fee : \"0.0000\";\n    const feeMt = 3;\n    const totalMt = 7;\n    const actionMt = 7;\n    const gridSpacing = isWallet ? 10 : 1;\n    return (\n      <>\n        <Box ref={this.titleRef}>\n          <Grid container spacing={gridSpacing}>\n            <Grid item xs={4}>\n              <Typography variant=\"caption\" className={styles.outputsFormLabel}>\n                To\n              </Typography>\n            </Grid>\n            <Grid item xs={3}>\n              &nbsp;\n            </Grid>\n            <Grid item xs={3}>\n              <Typography variant=\"caption\" className={styles.outputsFormLabel}>\n                Amount\n              </Typography>\n            </Grid>\n          </Grid>\n\n          <Grid>{this.renderOutputs()}</Grid>\n\n          <Grid item container spacing={gridSpacing}>\n            <Grid item xs={12}>\n              <Button\n                color=\"primary\"\n                disabled={finalizedOutputs}\n                onClick={this.handleAddOutput}\n              >\n                <AddIcon /> Add output\n              </Button>\n            </Grid>\n          </Grid>\n          <Grid item container spacing={gridSpacing}>\n            <Grid item xs={3}>\n              <Box mt={feeMt}>\n                <Typography\n                  variant=\"caption\"\n                  className={styles.outputsFormLabel}\n                >\n                  Fee Rate\n                </Typography>\n                <TextField\n                  fullWidth\n                  value={feeRate}\n                  type=\"number\"\n                  minimum={0}\n                  step={1}\n                  name=\"fee_rate\"\n                  disabled={finalizedOutputs}\n                  onChange={this.handleFeeRateChange}\n                  error={this.hasFeeRateError()}\n                  helperText={feeRateFetchError || feeRateError}\n                  InputProps={{\n                    endAdornment: (\n                      <InputAdornment position=\"end\">\n                        <Tooltip placement=\"top\" title=\"Estimate best rate\">\n                          <small>\n                            <IconButton\n                              onClick={this.getFeeEstimate}\n                              disabled={finalizedOutputs}\n                            >\n                              <Speed />\n                            </IconButton>\n                          </small>\n                        </Tooltip>\n                        <FormHelperText>Sats/byte</FormHelperText>\n                      </InputAdornment>\n                    ),\n                  }}\n                />\n              </Box>\n            </Grid>\n\n            <Grid item xs={4}>\n              <Box mt={feeMt}>&nbsp;</Box>\n            </Grid>\n            {!isWallet || (isWallet && !autoSpend) ? (\n              <Grid item xs={3}>\n                <Box mt={feeMt}>\n                  <Typography\n                    variant=\"caption\"\n                    className={styles.outputsFormLabel}\n                  >\n                    Estimated Fees\n                  </Typography>\n                  <TextField\n                    fullWidth\n                    name=\"fee_total\"\n                    disabled={finalizedOutputs}\n                    value={feeDisplay}\n                    onChange={this.handleFeeChange}\n                    error={this.hasFeeError()}\n                    helperText={feeError}\n                    InputProps={OutputsForm.unitLabel(\"BTC\", {\n                      readOnly: true,\n                      disableUnderline: true,\n                      style: { color: \"gray\" },\n                    })}\n                  />\n                </Box>\n              </Grid>\n            ) : (\n              \"\"\n            )}\n\n            <Grid item xs={2} />\n          </Grid>\n\n          <Grid item container spacing={gridSpacing}>\n            <Grid item xs={4}>\n              <Box mt={totalMt}>\n                <Typography variant=\"h6\">\n                  {!isWallet || (isWallet && !autoSpend)\n                    ? \"Totals\"\n                    : \"Output Total\"}\n                </Typography>\n              </Box>\n            </Grid>\n            <Grid item xs={3}>\n              <Box\n                display={\n                  !isWallet || (isWallet && !autoSpend) ? \"block\" : \"none\"\n                }\n                mt={totalMt}\n              >\n                <TextField\n                  fullWidth\n                  label=\"Inputs Total\"\n                  readOnly\n                  value={this.inputsTotal().toFixed(8)}\n                  disabled={finalizedOutputs}\n                  InputProps={OutputsForm.unitLabel(\"BTC\", { readOnly: true })}\n                />\n              </Box>\n            </Grid>\n            <Grid item xs={3}>\n              <Box mt={totalMt}>\n                <TextField\n                  fullWidth\n                  label={\n                    !isWallet || (isWallet && !autoSpend)\n                      ? \"Outputs & Fee Total\"\n                      : \"\"\n                  }\n                  value={this.outputsAndFeeTotal()}\n                  error={this.hasBalanceError()}\n                  disabled={finalizedOutputs}\n                  helperText={balanceError}\n                  InputProps={OutputsForm.unitLabel(\"BTC\", {\n                    readOnly: true,\n                    disableUnderline: true,\n                  })}\n                />\n              </Box>\n            </Grid>\n            <Grid item xs={2} />\n          </Grid>\n        </Box>\n\n        {!isWallet && (\n          <Box mt={actionMt}>\n            <Grid container spacing={3} justify=\"center\">\n              <Grid item>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  disabled={this.gatherSignaturesDisabled()}\n                  onClick={this.handleFinalize}\n                >\n                  Gather Signatures\n                </Button>\n              </Grid>\n\n              <Grid item>\n                <Button\n                  variant=\"contained\"\n                  color=\"secondary\"\n                  disabled={finalizedOutputs}\n                  onClick={this.handleReset}\n                >\n                  Reset Outputs\n                </Button>\n              </Grid>\n            </Grid>\n          </Box>\n        )}\n      </>\n    );\n  }\n}\n\nOutputsForm.propTypes = {\n  addOutput: PropTypes.func.isRequired,\n  autoSpend: PropTypes.bool.isRequired,\n  balanceError: PropTypes.string.isRequired,\n  change: PropTypes.shape({\n    nextNode: PropTypes.shape({\n      multisig: PropTypes.shape({\n        address: PropTypes.string,\n      }),\n    }),\n  }).isRequired,\n  changeOutputIndex: PropTypes.number.isRequired,\n  client: PropTypes.shape({}).isRequired,\n  fee: PropTypes.string.isRequired,\n  feeError: PropTypes.string.isRequired,\n  feeRateError: PropTypes.string.isRequired,\n  finalizeOutputs: PropTypes.func.isRequired,\n  feeRate: PropTypes.string.isRequired,\n  finalizedOutputs: PropTypes.bool.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  inputsTotalSats: PropTypes.shape({\n    minus: PropTypes.func,\n  }).isRequired,\n  isWallet: PropTypes.bool.isRequired,\n  network: PropTypes.string.isRequired,\n  outputs: PropTypes.arrayOf(\n    PropTypes.shape({\n      address: PropTypes.string,\n      addressError: PropTypes.string,\n      amount: PropTypes.string,\n      amountError: PropTypes.string,\n    })\n  ).isRequired,\n  resetOutputs: PropTypes.func.isRequired,\n  setFeeRate: PropTypes.func.isRequired,\n  setFee: PropTypes.func.isRequired,\n  setOutputAmount: PropTypes.func.isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n  updatesComplete: PropTypes.bool,\n};\n\nOutputsForm.defaultProps = {\n  updatesComplete: false,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...{\n      network: state.settings.network,\n      client: state.client,\n    },\n    ...state.spend.transaction,\n    ...state.client,\n    signatureImporters: state.spend.signatureImporters,\n    change: state.wallet.change,\n  };\n}\n\nconst mapDispatchToProps = {\n  addOutput: addOutputAction,\n  setOutputAmount: setOutputAmountAction,\n  setFeeRate: setFeeRateAction,\n  setFee: setFeeAction,\n  finalizeOutputs: finalizeOutputsAction,\n  resetOutputs: resetOutputsAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OutputsForm);\n","export const CARAVAN_CONFIG = \"caravan_config\";\nexport const MAX_TRAILING_EMPTY_NODES = 2;\nexport const MAX_FETCH_UTXOS_ERRORS = 5;\nexport const MIN_SATS_PER_BYTE_FEE = 1;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  signedMultisigTransaction,\n  blockExplorerTransactionURL,\n} from \"unchained-bitcoin\";\n\nimport {\n  Typography,\n  Box,\n  FormHelperText,\n  Button,\n  Card,\n  CardHeader,\n  CardContent,\n} from \"@material-ui/core\";\nimport { OpenInNew } from \"@material-ui/icons\";\nimport { broadcastTransaction } from \"../../blockchain\";\nimport Copyable from \"../Copyable\";\nimport { externalLink } from \"../../utils\";\nimport { setTXID } from \"../../actions/transactionActions\";\n\nclass Transaction extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: \"\",\n      broadcasting: false,\n      txid: \"\",\n    };\n  }\n\n  buildSignedTransaction = () => {\n    const { network, inputs, outputs, signatureImporters } = this.props;\n    return signedMultisigTransaction(\n      network,\n      inputs,\n      outputs,\n      Object.values(signatureImporters).map(\n        (signatureImporter) => signatureImporter.signature\n      )\n    );\n  };\n\n  handleBroadcast = async () => {\n    const { client, network, setTxid } = this.props;\n    const signedTransaction = this.buildSignedTransaction();\n    let error = \"\";\n    let txid = \"\";\n    this.setState({ broadcasting: true });\n    try {\n      txid = await broadcastTransaction(\n        signedTransaction.toHex(),\n        network,\n        client\n      );\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      error = `There was an error broadcasting the transaction.: ${e}`;\n    } finally {\n      this.setState({ txid, error, broadcasting: false });\n      setTxid(txid);\n    }\n  };\n\n  transactionURL = () => {\n    const { network } = this.props;\n    const { txid } = this.state;\n    return blockExplorerTransactionURL(txid, network);\n  };\n\n  render() {\n    const { error, broadcasting, txid } = this.state;\n    const signedTransaction = this.buildSignedTransaction();\n    const signedTransactionHex = signedTransaction.toHex();\n    return (\n      <Card>\n        <CardHeader title=\"Broadcast\" />\n        <CardContent>\n          <form>\n            {signedTransaction && (\n              <Box mt={4}>\n                <Typography variant=\"h6\">Signed Transaction</Typography>\n                <Copyable text={signedTransactionHex} code showIcon />\n              </Box>\n            )}\n            {txid === \"\" ? (\n              <Box mt={2}>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  disabled={!signedTransaction || broadcasting}\n                  onClick={this.handleBroadcast}\n                >\n                  Broadcast Transaction\n                </Button>\n                <FormHelperText error>{error}</FormHelperText>\n                <small>\n                  <FormHelperText>\n                    Warning: Broadcasting this transaction cannot be undone.\n                  </FormHelperText>\n                </small>\n              </Box>\n            ) : (\n              <Box mt={2}>\n                <Typography variant=\"h5\">\n                  <Copyable text={txid} code showIcon />\n                  &nbsp;\n                  {externalLink(this.transactionURL(), <OpenInNew />)}\n                </Typography>\n                <p>Transaction successfully broadcast.</p>\n              </Box>\n            )}\n          </form>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nTransaction.propTypes = {\n  client: PropTypes.shape({}).isRequired,\n  network: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  setTxid: PropTypes.func.isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    network: state.settings.network,\n    client: state.client,\n    ...state.client,\n    signatureImporters: state.spend.signatureImporters,\n    inputs: state.spend.transaction.inputs,\n    outputs: state.spend.transaction.outputs,\n  };\n}\n\nconst mapDispatchToProps = {\n  setTxid: setTXID,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Transaction);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { Button } from \"@material-ui/core\";\nimport Copyable from \"./Copyable\";\n\nclass UnsignedTransaction extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showUnsignedTransaction: false,\n    };\n  }\n\n  render = () => {\n    const { showUnsignedTransaction } = this.state;\n    const { unsignedTransaction } = this.props;\n    if (showUnsignedTransaction) {\n      const hex = unsignedTransaction.toHex();\n      return (\n        <div>\n          <small>\n            <Button size=\"small\" onClick={this.handleHideUnsignedTransaction}>\n              Hide Unsigned Transaction\n            </Button>\n          </small>\n          <p>\n            <Copyable text={hex} showIcon />\n          </p>\n        </div>\n      );\n    }\n    return (\n      <small>\n        <Button size=\"small\" onClick={this.handleShowUnsignedTransaction}>\n          Show Unsigned Transaction\n        </Button>\n      </small>\n    );\n  };\n\n  handleShowUnsignedTransaction = () => {\n    this.setState({ showUnsignedTransaction: true });\n  };\n\n  handleHideUnsignedTransaction = () => {\n    this.setState({ showUnsignedTransaction: false });\n  };\n}\n\nUnsignedTransaction.propTypes = {\n  unsignedTransaction: PropTypes.shape({\n    toHex: PropTypes.func,\n  }).isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    unsignedTransaction: state.spend.transaction.unsignedTransaction,\n  };\n}\n\nconst mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UnsignedTransaction);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\n// Components\nimport { Box, Button } from \"@material-ui/core\";\nimport Transaction from \"../ScriptExplorer/Transaction\";\nimport ExtendedPublicKeySelector from \"./ExtendedPublicKeySelector\";\n\n// Actions\nimport {\n  finalizeOutputs as finalizeOutputsAction,\n  setRequiredSigners as setRequiredSignersAction,\n  resetTransaction as resetTransactionAction,\n  setSpendStep as setSpendStepAction,\n  SPEND_STEP_CREATE,\n} from \"../../actions/transactionActions\";\nimport {\n  updateTxSlices as updateTxSlicesAction,\n  resetWalletView as resetWalletViewAction,\n} from \"../../actions/walletActions\";\nimport UnsignedTransaction from \"../UnsignedTransaction\";\n\nclass WalletSign extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      spent: false,\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const { txid, changeSlice, updateTxSlices } = props;\n    if (txid.length && !state.spent) {\n      updateTxSlices(changeSlice);\n      return {\n        spent: true,\n      };\n    }\n    return null;\n  }\n\n  componentWillUnmount() {\n    const { resetTransaction } = this.props;\n    const { spent } = this.state;\n\n    // reset the transaction when we leave the view if tx is spent\n    if (spent) {\n      resetTransaction();\n    }\n  }\n\n  renderKeySelectors = () => {\n    const { requiredSigners } = this.props;\n    const keySelectors = [];\n    for (\n      let keySelectorNum = 1;\n      keySelectorNum <= requiredSigners;\n      keySelectorNum += 1\n    ) {\n      keySelectors.push(\n        <Box key={keySelectorNum} mt={2}>\n          <ExtendedPublicKeySelector number={keySelectorNum} />\n        </Box>\n      );\n    }\n    return keySelectors;\n  };\n\n  signaturesFinalized = () => {\n    const { signatureImporters } = this.props;\n    return (\n      Object.values(signatureImporters).length > 0 &&\n      Object.values(signatureImporters).every(\n        (signatureImporter) => signatureImporter.finalized\n      )\n    );\n  };\n\n  handleReturn = () => {\n    const { resetTransaction, resetWalletView } = this.props;\n    resetTransaction();\n    resetWalletView();\n  };\n\n  handleCancel = (event) => {\n    const {\n      finalizeOutputs,\n      requiredSigners,\n      setRequiredSigners,\n      setSpendStep,\n    } = this.props;\n    event.preventDefault();\n    setRequiredSigners(requiredSigners); // this will generate signature importers\n    finalizeOutputs(false);\n    setSpendStep(SPEND_STEP_CREATE);\n  };\n\n  render = () => {\n    const { spent } = this.state;\n    return (\n      <Box>\n        <Button href=\"#\" onClick={this.handleCancel}>\n          Edit Transaction\n        </Button>\n        <Box mt={2}>\n          <UnsignedTransaction />\n        </Box>\n        {this.renderKeySelectors()}\n\n        <Box mt={2}>\n          <Button\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              this.handleReturn();\n            }}\n          >\n            Abandon Transaction\n          </Button>\n        </Box>\n\n        {this.signaturesFinalized() && (\n          <Box mt={2}>\n            <Transaction />\n          </Box>\n        )}\n\n        {spent && (\n          <Box mt={2}>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={this.handleReturn}\n            >\n              Return\n            </Button>\n          </Box>\n        )}\n      </Box>\n    );\n  };\n}\n\nWalletSign.propTypes = {\n  changeSlice: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    multisig: PropTypes.shape({\n      address: PropTypes.string,\n    }),\n  }).isRequired,\n  finalizeOutputs: PropTypes.func.isRequired,\n  requiredSigners: PropTypes.number.isRequired,\n  resetTransaction: PropTypes.func.isRequired,\n  resetWalletView: PropTypes.func.isRequired,\n  setRequiredSigners: PropTypes.func.isRequired,\n  setSpendStep: PropTypes.func.isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n  updateTxSlices: PropTypes.func.isRequired,\n  txid: PropTypes.string.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.wallet,\n    ...state.spend,\n    ...state.quorum,\n    txid: state.spend.transaction.txid,\n    requiredSigners: state.spend.transaction.requiredSigners,\n    totalSigners: state.spend.transaction.totalSigners,\n    changeSlice: state.wallet.change.nextNode,\n  };\n}\n\nconst mapDispatchToProps = {\n  finalizeOutputs: finalizeOutputsAction,\n  setRequiredSigners: setRequiredSignersAction,\n  updateTxSlices: updateTxSlicesAction,\n  resetTransaction: resetTransactionAction,\n  resetWalletView: resetWalletViewAction,\n  setSpendStep: setSpendStepAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WalletSign);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport BigNumber from \"bignumber.js\";\nimport { satoshisToBitcoins } from \"unchained-bitcoin\";\nimport {\n  Button,\n  Box,\n  Table,\n  TableHead,\n  TableBody,\n  TableFooter,\n  TableRow,\n  TableCell,\n  Grid,\n} from \"@material-ui/core\";\nimport UnsignedTransaction from \"../UnsignedTransaction\";\nimport { setChangeOutputMultisig as setChangeOutputMultisigAction } from \"../../actions/transactionActions\";\n\nclass TransactionPreview extends React.Component {\n  componentDidMount() {\n    const {\n      outputs,\n      changeAddress,\n      changeOutputIndex,\n      changeNode,\n      setChangeOutputMultisig,\n    } = this.props;\n    outputs.forEach((output) => {\n      if (output.address === changeAddress) {\n        setChangeOutputMultisig(changeOutputIndex, changeNode.multisig);\n      }\n    });\n  }\n\n  renderAddresses = () => {\n    const addressWithUtxos = this.mapAddresses();\n    return Object.keys(addressWithUtxos).map((address) => {\n      return (\n        <TableRow key={address}>\n          <TableCell>\n            <code>{address}</code>\n          </TableCell>\n          <TableCell>{addressWithUtxos[address].utxos.length}</TableCell>\n          <TableCell>\n            <code>{addressWithUtxos[address].amount.toFixed(8)}</code>\n          </TableCell>\n        </TableRow>\n      );\n    });\n  };\n\n  renderOutputAddresses = () => {\n    const { changeAddress, outputs } = this.props;\n\n    return outputs.map((output) => {\n      return (\n        <TableRow key={output.address}>\n          <TableCell>\n            <code>{output.address}</code>\n            {output.address === changeAddress ? (\n              <small>&nbsp;(change)</small>\n            ) : (\n              \"\"\n            )}\n          </TableCell>\n          <TableCell>\n            <code>{BigNumber(output.amount).toFixed(8)}</code>\n          </TableCell>\n        </TableRow>\n      );\n    });\n  };\n\n  renderOutputs = () => {\n    return (\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell>Address</TableCell>\n            <TableCell>Amount (BTC)</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>{this.renderOutputAddresses()}</TableBody>\n        <TableFooter>\n          <TableRow>\n            <TableCell>TOTAL:</TableCell>\n            <TableCell>{this.outputsTotal()}</TableCell>\n          </TableRow>\n        </TableFooter>\n      </Table>\n    );\n  };\n\n  renderInputs = () => {\n    const { inputsTotalSats } = this.props;\n\n    return (\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell>Address</TableCell>\n            <TableCell>UTXO count</TableCell>\n            <TableCell>Amount (BTC)</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>{this.renderAddresses()}</TableBody>\n        <TableFooter>\n          <TableRow>\n            <TableCell colSpan={2}>TOTAL:</TableCell>\n            <TableCell>\n              {satoshisToBitcoins(inputsTotalSats).toString()}\n            </TableCell>\n          </TableRow>\n        </TableFooter>\n      </Table>\n    );\n  };\n\n  mapAddresses = () => {\n    const { inputs } = this.props;\n    return inputs.reduce((mapped, input) => {\n      const mappedAddresses = mapped;\n      const { confirmed, txid, index, amount } = input;\n\n      mappedAddresses[input.multisig.address] = mapped[\n        input.multisig.address\n      ] || {\n        amount: BigNumber(0),\n        utxos: [],\n      };\n      mappedAddresses[input.multisig.address].utxos.push({\n        confirmed,\n        txid,\n        index,\n        amount,\n      });\n      mappedAddresses[input.multisig.address].amount = mapped[\n        input.multisig.address\n      ].amount.plus(BigNumber(input.amount));\n      return mappedAddresses;\n    }, {});\n  };\n\n  outputsTotal = () => {\n    const { outputs } = this.props;\n    return satoshisToBitcoins(\n      outputs.reduce(\n        (total, output) => total.plus(BigNumber(output.amountSats || 0)),\n        BigNumber(0)\n      )\n    ).toString();\n  };\n\n  render = () => {\n    const {\n      feeRate,\n      fee,\n      inputsTotalSats,\n      editTransaction,\n      handleSignTransaction,\n    } = this.props;\n\n    return (\n      <Box>\n        <h2>Transaction Preview</h2>\n        <UnsignedTransaction />\n        <h3>Inputs</h3>\n        {this.renderInputs()}\n        <h3>Outputs</h3>\n        {this.renderOutputs()}\n        <Grid container>\n          <Grid item xs={4}>\n            <h3>Fee</h3>\n            <div>{BigNumber(fee).toFixed(8)} BTC </div>\n          </Grid>\n          <Grid item xs={4}>\n            <h3>Fee Rate</h3>\n            <div>{feeRate} sats/byte</div>\n          </Grid>\n          <Grid item xs={4}>\n            <h3>Total</h3>\n            <div>\n              {satoshisToBitcoins(BigNumber(inputsTotalSats || 0)).toFixed(8)}{\" \"}\n              BTC\n            </div>\n          </Grid>\n        </Grid>\n        <Box mt={2}>\n          <Grid container spacing={2}>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  editTransaction();\n                }}\n              >\n                Edit Transaction\n              </Button>\n            </Grid>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={handleSignTransaction}\n              >\n                Sign Transaction\n              </Button>\n            </Grid>\n          </Grid>\n        </Box>\n      </Box>\n    );\n  };\n}\n\nTransactionPreview.propTypes = {\n  changeAddress: PropTypes.string.isRequired,\n  changeNode: PropTypes.shape({\n    multisig: PropTypes.shape({}),\n  }).isRequired,\n  changeOutputIndex: PropTypes.number.isRequired,\n  editTransaction: PropTypes.func.isRequired,\n  fee: PropTypes.string.isRequired,\n  feeRate: PropTypes.string.isRequired,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  inputsTotalSats: PropTypes.shape({}).isRequired,\n  outputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  handleSignTransaction: PropTypes.func.isRequired,\n  setChangeOutputMultisig: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    changeOutputIndex: state.spend.transaction.changeOutputIndex,\n  };\n}\n\nconst mapDispatchToProps = {\n  setChangeOutputMultisig: setChangeOutputMultisigAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TransactionPreview);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport BigNumber from \"bignumber.js\";\nimport {\n  Box,\n  Card,\n  CardContent,\n  Grid,\n  Switch,\n  FormControlLabel,\n  Button,\n} from \"@material-ui/core\";\nimport {\n  updateDepositSliceAction,\n  updateChangeSliceAction,\n  resetNodesSpend as resetNodesSpendAction,\n  autoSelectCoins as autoSelectCoinsAction,\n} from \"../../actions/walletActions\";\nimport {\n  setInputs as setInputsAction,\n  setFeeRate as setFeeRateAction,\n  addOutput,\n  setOutputAddress,\n  updateAutoSpendAction,\n  setChangeAddressAction,\n  finalizeOutputs as finalizeOutputsAction,\n  SPEND_STEP_CREATE,\n  SPEND_STEP_PREVIEW,\n  SPEND_STEP_SIGN,\n  setSpendStep as setSpendStepAction,\n  deleteChangeOutput as deleteChangeOutputAction,\n} from \"../../actions/transactionActions\";\nimport { naiveCoinSelection } from \"../../utils\";\nimport NodeSet from \"./NodeSet\";\nimport OutputsForm from \"../ScriptExplorer/OutputsForm\";\nimport WalletSign from \"./WalletSign\";\nimport TransactionPreview from \"./TransactionPreview\";\nimport { bigNumberPropTypes } from \"../../proptypes/utils\";\n\nclass WalletSpend extends React.Component {\n  outputsAmount = new BigNumber(0);\n\n  coinSelection = naiveCoinSelection;\n\n  feeAmount = new BigNumber(0);\n\n  componentDidUpdate = (prevProps) => {\n    const { finalizedOutputs } = this.props;\n    if (finalizedOutputs && !prevProps.finalizedOutputs) {\n      this.showPreview();\n    }\n  };\n\n  previewDisabled = () => {\n    const {\n      finalizedOutputs,\n      outputs,\n      feeRateError,\n      feeError,\n      inputs,\n      balanceError,\n      autoSpend,\n    } = this.props;\n\n    if (inputs.length === 0 && !autoSpend) return true;\n    if (finalizedOutputs || feeRateError || feeError || balanceError) {\n      return true;\n    }\n    for (let i = 0; i < outputs.length; i += 1) {\n      const output = outputs[i];\n      if (\n        output.address === \"\" ||\n        output.amount === \"\" ||\n        output.addressError !== \"\" ||\n        output.amountError !== \"\"\n      ) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  showSignTransaction = () => {\n    const { setSpendStep } = this.props;\n    setSpendStep(SPEND_STEP_SIGN);\n  };\n\n  handleShowPreview = () => {\n    const { autoSelectCoins, autoSpend, finalizeOutputs } = this.props;\n    if (autoSpend) autoSelectCoins();\n    else finalizeOutputs(true);\n  };\n\n  showPreview = () => {\n    const { setSpendStep } = this.props;\n    setSpendStep(SPEND_STEP_PREVIEW);\n  };\n\n  showCreate = () => {\n    const {\n      finalizeOutputs,\n      setSpendStep,\n      resetNodesSpend,\n      autoSpend,\n      deleteChangeOutput,\n    } = this.props;\n    setSpendStep(SPEND_STEP_CREATE);\n    finalizeOutputs(false);\n\n    // for auto spend view, user doesn't have direct knowledge of\n    // input nodes and change. So when going back to edit a transaction\n    // we want to clear these from the state, since these are added automatically\n    // when going from output form to transaction preview\n    if (autoSpend) {\n      resetNodesSpend();\n      deleteChangeOutput();\n    }\n  };\n\n  handleSpendMode = (event) => {\n    const { updateAutoSpend, resetNodesSpend, deleteChangeOutput } = this.props;\n    updateAutoSpend(!event.target.checked);\n    resetNodesSpend();\n    deleteChangeOutput();\n  };\n\n  render() {\n    const {\n      autoSpend,\n      changeAddress,\n      changeNode,\n      updateNode,\n      addNode,\n      spendingStep,\n      fee,\n      feeRate,\n      inputs,\n      inputsTotalSats,\n      outputs,\n    } = this.props;\n\n    return (\n      <Card>\n        <CardContent>\n          <Grid container>\n            {spendingStep === SPEND_STEP_SIGN && (\n              <Grid item md={12}>\n                <Box>\n                  <WalletSign />\n                </Box>\n              </Grid>\n            )}\n            {spendingStep === SPEND_STEP_CREATE && (\n              <Grid item md={12}>\n                <Grid container direction=\"row-reverse\">\n                  <Box display=\"flex-end\">\n                    <Box p={1}>\n                      <FormControlLabel\n                        control={\n                          <Switch\n                            checked={!autoSpend}\n                            onChange={this.handleSpendMode}\n                          />\n                        }\n                        label=\"Manual\"\n                      />\n                    </Box>\n                  </Box>\n                </Grid>\n                <Box component=\"div\" display={autoSpend ? \"none\" : \"block\"}>\n                  <NodeSet addNode={addNode} updateNode={updateNode} />\n                </Box>\n                <OutputsForm />\n                <Box mt={2}>\n                  <Button\n                    onClick={this.handleShowPreview}\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disabled={this.previewDisabled()}\n                  >\n                    Preview Transaction\n                  </Button>\n                </Box>\n              </Grid>\n            )}\n            {spendingStep === SPEND_STEP_PREVIEW && (\n              <Grid item md={12}>\n                <Box mt={3}>\n                  <TransactionPreview\n                    changeAddress={changeAddress}\n                    changeNode={changeNode}\n                    editTransaction={this.showCreate}\n                    fee={fee}\n                    feeRate={feeRate}\n                    inputs={inputs}\n                    inputsTotalSats={inputsTotalSats}\n                    outputs={outputs}\n                    handleSignTransaction={() => this.showSignTransaction()}\n                  />\n                </Box>\n              </Grid>\n            )}\n          </Grid>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nWalletSpend.propTypes = {\n  addNode: PropTypes.func.isRequired,\n  autoSpend: PropTypes.bool,\n  autoSelectCoins: PropTypes.func.isRequired,\n  balanceError: PropTypes.string,\n  changeNode: PropTypes.shape({\n    multisig: PropTypes.shape({\n      address: PropTypes.string,\n    }),\n  }).isRequired,\n  changeNodes: PropTypes.shape({}),\n  changeAddress: PropTypes.string.isRequired,\n  deleteChangeOutput: PropTypes.func.isRequired,\n  depositNodes: PropTypes.shape({}),\n  fee: PropTypes.string.isRequired,\n  feeError: PropTypes.string,\n  feeRate: PropTypes.string.isRequired,\n  feeRateError: PropTypes.string,\n  finalizeOutputs: PropTypes.func.isRequired,\n  finalizedOutputs: PropTypes.bool,\n  inputs: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n  inputsTotalSats: PropTypes.shape(bigNumberPropTypes).isRequired,\n  outputs: PropTypes.arrayOf(\n    PropTypes.shape({\n      address: PropTypes.string,\n      amount: PropTypes.string,\n      addressError: PropTypes.string,\n      amountError: PropTypes.string,\n    })\n  ).isRequired,\n  resetNodesSpend: PropTypes.func.isRequired,\n  setSpendStep: PropTypes.func.isRequired,\n  spendingStep: PropTypes.number,\n  updateAutoSpend: PropTypes.func.isRequired,\n  updateNode: PropTypes.func.isRequired,\n};\n\nWalletSpend.defaultProps = {\n  autoSpend: false,\n  balanceError: null,\n  changeNodes: {},\n  depositNodes: {},\n  finalizedOutputs: false,\n  feeError: null,\n  feeRateError: null,\n  spendingStep: 0,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.spend.transaction,\n    changeNodes: state.wallet.change.nodes,\n    changeNode: state.wallet.change.nextNode,\n    depositNodes: state.wallet.deposits.nodes,\n    autoSpend: state.spend.transaction.autoSpend,\n  };\n}\n\nconst mapDispatchToProps = {\n  autoSelectCoins: autoSelectCoinsAction,\n  deleteChangeOutput: deleteChangeOutputAction,\n  updateAutoSpend: updateAutoSpendAction,\n  setInputs: setInputsAction,\n  updateChangeSlice: updateChangeSliceAction,\n  updateDepositSlice: updateDepositSliceAction,\n  setAddress: setOutputAddress,\n  resetNodesSpend: resetNodesSpendAction,\n  setFeeRate: setFeeRateAction,\n  addOutput,\n  finalizeOutputs: finalizeOutputsAction,\n  setChangeAddress: setChangeAddressAction,\n  setSpendStep: setSpendStepAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WalletSpend);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport {\n  Box,\n  Card,\n  CardContent,\n  Checkbox,\n  FormControlLabel,\n  FormGroup,\n  FormLabel,\n  Grid,\n} from \"@material-ui/core\";\nimport {\n  getSlicesWithBalance,\n  getZeroBalanceSlices,\n  getSpentSlices,\n} from \"../../selectors/wallet\";\nimport { slicePropTypes, clientPropTypes } from \"../../proptypes\";\n\n// Components\nimport SlicesTable from \"./SlicesTable\";\n\nclass SlicesTableContainer extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      filterIncludeSpent: false,\n      filterIncludeZeroBalance: false,\n      displaySlices: props.slicesWithBalance.length\n        ? [...props.slicesWithBalance]\n        : [],\n    };\n  }\n\n  componentDidUpdate(newProps) {\n    const { slicesWithBalance } = this.props;\n    if (newProps.slicesWithBalance.length !== slicesWithBalance.length) {\n      this.setDisplaySlices();\n    }\n  }\n\n  setDisplaySlices() {\n    const { slicesWithBalance, zeroBalanceSlices, spentSlices } = this.props;\n    const { filterIncludeSpent, filterIncludeZeroBalance } = this.state;\n    const newDisplaySlices = [...slicesWithBalance];\n    if (filterIncludeSpent) {\n      newDisplaySlices.push(...spentSlices);\n    }\n    if (filterIncludeZeroBalance) {\n      newDisplaySlices.push(...zeroBalanceSlices);\n    }\n    this.setState({ displaySlices: newDisplaySlices });\n  }\n\n  filterAddresses = (event, checked) => {\n    this.setState({ [event.target.value]: checked }, () =>\n      this.setDisplaySlices()\n    );\n  };\n\n  render() {\n    const {\n      filterIncludeSpent,\n      filterIncludeZeroBalance,\n      displaySlices,\n    } = this.state;\n    const { client, network } = this.props;\n\n    return (\n      <Card>\n        <CardContent>\n          <Grid container direction=\"column\">\n            <Grid item>\n              <SlicesTable\n                slices={displaySlices}\n                client={client}\n                network={network}\n                paging\n              />\n            </Grid>\n            <Grid item>\n              <FormGroup row>\n                <FormLabel component=\"h2\">\n                  <Box mr={3}>Show Additional</Box>\n                </FormLabel>\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      checked={filterIncludeSpent}\n                      value=\"filterIncludeSpent\"\n                      onChange={this.filterAddresses}\n                    />\n                  }\n                  label=\"Spent Addresses\"\n                />\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      checked={filterIncludeZeroBalance}\n                      value=\"filterIncludeZeroBalance\"\n                      onChange={this.filterAddresses}\n                    />\n                  }\n                  label=\"Zero Balance\"\n                />\n              </FormGroup>\n            </Grid>\n          </Grid>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nSlicesTableContainer.propTypes = {\n  slicesWithBalance: PropTypes.arrayOf(PropTypes.shape(slicePropTypes))\n    .isRequired,\n  zeroBalanceSlices: PropTypes.arrayOf(PropTypes.shape(slicePropTypes))\n    .isRequired,\n  spentSlices: PropTypes.arrayOf(PropTypes.shape(slicePropTypes)).isRequired,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n  network: PropTypes.string.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    slicesWithBalance: getSlicesWithBalance(state),\n    zeroBalanceSlices: getZeroBalanceSlices(state),\n    spentSlices: getSpentSlices(state),\n    walletMode: state.wallet.common.walletMode,\n    client: state.client,\n    network: state.settings.network,\n  };\n}\n\nexport default connect(mapStateToProps)(SlicesTableContainer);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  Tabs,\n  Tab,\n  Box,\n  LinearProgress,\n  CircularProgress,\n} from \"@material-ui/core\";\nimport {\n  setWalletModeAction as setWalletModeActionImport,\n  WALLET_MODES,\n} from \"../../actions/walletActions\";\nimport { setRequiredSigners as setRequiredSignersAction } from \"../../actions/transactionActions\";\nimport { MAX_FETCH_UTXOS_ERRORS, MAX_TRAILING_EMPTY_NODES } from \"./constants\";\nimport WalletDeposit from \"./WalletDeposit\";\nimport WalletSpend from \"./WalletSpend\";\nimport { SlicesTableContainer } from \"../Slices\";\n\nclass WalletControl extends React.Component {\n  scrollRef = React.createRef();\n\n  componentDidMount = () => {\n    this.scrollRef.current.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  render = () => {\n    const { walletMode } = this.props;\n    return (\n      <div>\n        <Tabs\n          ref={this.scrollRef}\n          value={walletMode}\n          onChange={this.handleModeChange}\n          indicatorColor=\"primary\"\n          textColor=\"primary\"\n          variant=\"fullWidth\"\n        >\n          {this.addressesAreLoaded() && [\n            <Tab label=\"Addresses\" value={WALLET_MODES.VIEW} key={0} />,\n            <Tab label=\"Receive\" value={WALLET_MODES.DEPOSIT} key={1} />,\n            <Tab label=\"Send\" value={WALLET_MODES.SPEND} key={2} />,\n          ]}\n        </Tabs>\n        <Box mt={2}>{this.renderModeComponent()}</Box>\n      </div>\n    );\n  };\n\n  renderModeComponent = () => {\n    const { walletMode, addNode, updateNode } = this.props;\n    if (this.addressesAreLoaded()) {\n      if (walletMode === WALLET_MODES.DEPOSIT) return <WalletDeposit />;\n      if (walletMode === WALLET_MODES.SPEND)\n        return <WalletSpend addNode={addNode} updateNode={updateNode} />;\n      if (walletMode === WALLET_MODES.VIEW) return <SlicesTableContainer />;\n    }\n    const progress = this.progress();\n    return [\n      <div style={{ textAlign: \"center\", marginBottom: \"5em\" }} key={0}>\n        <CircularProgress variant=\"indeterminate\" />\n      </div>,\n      <LinearProgress variant=\"determinate\" value={progress} key={1} />,\n    ];\n  };\n\n  progress = () => {\n    const { change, deposits } = this.props;\n    return (\n      (100 * (deposits.trailingEmptyNodes + change.trailingEmptyNodes)) /\n      (2 * MAX_TRAILING_EMPTY_NODES)\n    );\n  };\n\n  addressesAreLoaded = () => {\n    const { change, deposits, nodesLoaded } = this.props;\n    if (nodesLoaded) return true;\n    return (\n      (deposits.trailingEmptyNodes >= MAX_TRAILING_EMPTY_NODES ||\n        deposits.fetchUTXOsErrors >= MAX_FETCH_UTXOS_ERRORS) &&\n      (change.trailingEmptyNodes >= MAX_TRAILING_EMPTY_NODES ||\n        change.fetchUTXOsErrors >= MAX_FETCH_UTXOS_ERRORS)\n    );\n  };\n\n  handleModeChange = (_event, mode) => {\n    const {\n      setMode,\n      requiredSigners,\n      setRequiredSigners,\n      signatureImporters,\n    } = this.props;\n    if (\n      mode === WALLET_MODES.SPEND &&\n      Object.keys(signatureImporters).length !== requiredSigners\n    ) {\n      setRequiredSigners(requiredSigners); // this will generate signature importers\n    }\n    setMode(mode);\n  };\n}\n\nWalletControl.propTypes = {\n  addNode: PropTypes.func.isRequired,\n  change: PropTypes.shape({\n    trailingEmptyNodes: PropTypes.number,\n    fetchUTXOsErrors: PropTypes.number,\n  }).isRequired,\n  deposits: PropTypes.shape({\n    trailingEmptyNodes: PropTypes.number,\n    fetchUTXOsErrors: PropTypes.number,\n  }).isRequired,\n  nodesLoaded: PropTypes.bool.isRequired,\n  requiredSigners: PropTypes.number.isRequired,\n  setMode: PropTypes.func.isRequired,\n  setRequiredSigners: PropTypes.func.isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n  updateNode: PropTypes.func.isRequired,\n  walletMode: PropTypes.number.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.wallet,\n    ...state.wallet.common,\n    requiredSigners: state.spend.transaction.requiredSigners,\n    signatureImporters: state.spend.signatureImporters,\n  };\n}\n\nconst mapDispatchToProps = {\n  setMode: setWalletModeActionImport,\n  setRequiredSigners: setRequiredSignersAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WalletControl);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Button, Grid } from \"@material-ui/core\";\nimport { CARAVAN_CONFIG } from \"./constants\";\n\nconst WalletConfigInteractionButtons = ({ onClearFn, onDownloadFn }) => {\n  const handleClearClick = (e) => {\n    e.preventDefault();\n    if (sessionStorage) sessionStorage.removeItem(CARAVAN_CONFIG);\n    onClearFn(e);\n  };\n\n  return (\n    <Grid container spacing={2}>\n      <Grid item>\n        <Button variant=\"contained\" color=\"primary\" onClick={onDownloadFn}>\n          Download Wallet Details\n        </Button>\n      </Grid>\n      <Grid item>\n        <Button\n          onClick={(e) => handleClearClick(e)}\n          variant=\"contained\"\n          color=\"secondary\"\n        >\n          Clear Wallet\n        </Button>\n      </Grid>\n    </Grid>\n  );\n};\n\nWalletConfigInteractionButtons.propTypes = {\n  onClearFn: PropTypes.func.isRequired,\n  onDownloadFn: PropTypes.func.isRequired,\n};\n\nexport default WalletConfigInteractionButtons;\n","import { wrappedNumberedActions } from \"./utils\";\n\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_NAME =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_NAME\";\nexport const RESET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH =\n  \"RESET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH\";\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH\";\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_METHOD =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_METHOD\";\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY\";\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY_ROOT_FINGERPRINT =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY_ROOT_FINGERPRINT\";\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_FINALIZED =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_FINALIZED\";\nexport const SET_EXTENDED_PUBLIC_KEY_IMPORTER_VISIBLE =\n  \"SET_EXTENDED_PUBLIC_KEY_IMPORTER_VISIBLE\";\n\nexport const {\n  setExtendedPublicKeyImporterName,\n  setExtendedPublicKeyImporterBIP32Path,\n  resetExtendedPublicKeyImporterBIP32Path,\n  setExtendedPublicKeyImporterMethod,\n  setExtendedPublicKeyImporterExtendedPublicKey,\n  setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint,\n  setExtendedPublicKeyImporterFinalized,\n} = wrappedNumberedActions({\n  setExtendedPublicKeyImporterName: SET_EXTENDED_PUBLIC_KEY_IMPORTER_NAME,\n  resetExtendedPublicKeyImporterBIP32Path: RESET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  setExtendedPublicKeyImporterBIP32Path: SET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  setExtendedPublicKeyImporterMethod: SET_EXTENDED_PUBLIC_KEY_IMPORTER_METHOD,\n  setExtendedPublicKeyImporterExtendedPublicKey: SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY,\n  setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint: SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY_ROOT_FINGERPRINT,\n  setExtendedPublicKeyImporterFinalized: SET_EXTENDED_PUBLIC_KEY_IMPORTER_FINALIZED,\n});\n\nexport function setExtendedPublicKeyImporterVisible(value) {\n  return {\n    type: SET_EXTENDED_PUBLIC_KEY_IMPORTER_VISIBLE,\n    value,\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { debounce } from \"lodash\";\nimport {\n  deriveMultisigByPath,\n  ExtendedPublicKey,\n  generateBraid,\n} from \"unchained-bitcoin\";\nimport {\n  Button,\n  Card,\n  CardHeader,\n  CardContent,\n  InputAdornment,\n  Grid,\n  TextField,\n  FormHelperText,\n  Typography,\n  Box,\n} from \"@material-ui/core\";\nimport AccountCircleIcon from \"@material-ui/icons/AccountCircle\";\nimport {\n  fetchAddressUTXOs,\n  getAddressStatus,\n  fetchFeeEstimate,\n} from \"../../blockchain\";\nimport ClientPicker from \"../ClientPicker\";\nimport ConfirmWallet from \"./ConfirmWallet\";\nimport WalletControl from \"./WalletControl\";\nimport WalletConfigInteractionButtons from \"./WalletConfigInteractionButtons\";\nimport { setFrozen } from \"../../actions/settingsActions\";\nimport {\n  updateDepositSliceAction,\n  updateChangeSliceAction,\n  resetNodesFetchErrors as resetNodesFetchErrorsAction,\n  resetWallet as resetWalletAction,\n  initialLoadComplete as initialLoadCompleteAction,\n} from \"../../actions/walletActions\";\nimport { fetchSliceData as fetchSliceDataAction } from \"../../actions/braidActions\";\nimport { setExtendedPublicKeyImporterVisible } from \"../../actions/extendedPublicKeyImporterActions\";\nimport { setIsWallet as setIsWalletAction } from \"../../actions/transactionActions\";\nimport { wrappedActions } from \"../../actions/utils\";\nimport {\n  SET_CLIENT_PASSWORD,\n  SET_CLIENT_PASSWORD_ERROR,\n} from \"../../actions/clientActions\";\nimport { MAX_FETCH_UTXOS_ERRORS, MAX_TRAILING_EMPTY_NODES } from \"./constants\";\n\n// const bitcoin = require('bitcoinjs-lib');\n\nclass WalletGenerator extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      connectSuccess: false,\n      unknownClient: false,\n    };\n  }\n\n  componentDidMount() {\n    const {\n      refreshNodes,\n      common: { nodesLoaded },\n      setGenerating,\n    } = this.props;\n    this.debouncedTestConnection = debounce(\n      (args) => this.testConnection(args),\n      500,\n      { trailing: true, leading: false }\n    );\n    refreshNodes(this.refreshNodes);\n    if (nodesLoaded) setGenerating(true);\n  }\n\n  async componentDidUpdate(prevProps) {\n    const prevPassword = prevProps.client.password;\n    const {\n      setPasswordError,\n      network,\n      client,\n      common: { nodesLoaded },\n      setIsWallet,\n      configuring,\n    } = this.props;\n    const { unknownClient } = this.state;\n    if (client.type === \"unknown\" && prevProps.client.type === \"public\") {\n      this.setState({ unknownClient: true }); // eslint-disable-line react/no-did-update-set-state\n    } else if (configuring && client.type !== \"unknown\" && unknownClient) {\n      // re-initializes the state if we're in the configuring stage.\n      // catches situation where wallet is cleared and new one is added\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({ unknownClient: false });\n    }\n    // if the password was updated\n    if (prevPassword !== client.password && client.password.length) {\n      // test the connection using the set password\n      // but only if the password field hasn't been changed for 500ms\n      this.debouncedTestConnection({ network, client, setPasswordError });\n    }\n\n    // make sure the spend view knows it's a wallet view once nodes\n    // are loaded\n    if (!prevProps.common.nodesLoaded && nodesLoaded) setIsWallet();\n  }\n\n  title = () => {\n    const { totalSigners, requiredSigners, addressType } = this.props;\n    return (\n      <span className=\"justify-content-between d-flex\">\n        Your {requiredSigners}\n        -of-\n        {totalSigners} {addressType} Multisig Wallet\n        <small className=\"text-muted\">{` Extended Public Keys: ${this.extendedPublicKeyCount()}/${totalSigners}`}</small>\n      </span>\n    );\n  };\n\n  testConnection = async ({ network, client, setPasswordError }, cb) => {\n    try {\n      await fetchFeeEstimate(network, client);\n      setPasswordError(\"\");\n      this.setState({ connectSuccess: true }, () => {\n        // if testConnection was passed a callback\n        // we call that after a successful test, which\n        // in this case generates the wallet\n        if (cb) setTimeout(cb, 750);\n      });\n    } catch (e) {\n      this.setState({ connectSuccess: false });\n      if (e.response && e.response.status === 401)\n        setPasswordError(\n          \"Unauthorized: Incorrect username and password combination\"\n        );\n      else setPasswordError(e.message);\n    }\n  };\n\n  extendedPublicKeyCount = () => {\n    const { extendedPublicKeyImporters } = this.props;\n    return Object.values(extendedPublicKeyImporters).filter(\n      (extendedPublicKeyImporter) => extendedPublicKeyImporter.finalized\n    ).length;\n  };\n\n  toggleImporters = (event, clear) => {\n    event.preventDefault();\n    const {\n      setImportersVisible,\n      configuring,\n      resetWallet,\n      initialLoadComplete,\n      setGenerating,\n    } = this.props;\n\n    if (!configuring) {\n      setGenerating(false);\n      if (clear) resetWallet();\n      if (!clear) initialLoadComplete();\n    }\n\n    setImportersVisible(!configuring);\n  };\n\n  generate = () => {\n    const {\n      setImportersVisible,\n      freeze,\n      setGenerating,\n      startingAddressIndex,\n    } = this.props;\n    const startingDepositBIP32Suffix = `m/0/${startingAddressIndex}`;\n    const startingChangeBIP32Suffix = `m/1/${startingAddressIndex}`;\n    freeze(true);\n    setImportersVisible(false);\n    setGenerating(true);\n    this.setState({ connectSuccess: false }, () => {\n      this.addNode(false, startingDepositBIP32Suffix, true);\n      this.addNode(true, startingChangeBIP32Suffix, true);\n    });\n  };\n\n  updateNode = (isChange, update) => {\n    const { updateChangeSlice, updateDepositSlice } = this.props;\n    const updater = isChange ? updateChangeSlice : updateDepositSlice;\n    updater(update);\n  };\n\n  addNode = async (isChange, bip32Path, attemptToKeepGenerating) => {\n    const multisigUpdates = await this.generateMultisig(\n      isChange,\n      bip32Path,\n      attemptToKeepGenerating\n    );\n    this.updateNode(isChange, { bip32Path, ...multisigUpdates });\n  };\n\n  generateMultisig = async (isChange, bip32Path, attemptToKeepGenerating) => {\n    const {\n      extendedPublicKeyImporters,\n      network,\n      addressType,\n      requiredSigners,\n    } = this.props;\n\n    const extendedPublicKeys = this.generateRichExtendedPublicKeys(\n      extendedPublicKeyImporters\n    );\n    const index = isChange ? \"1\" : \"0\";\n    const braid = generateBraid(\n      network,\n      addressType,\n      extendedPublicKeys,\n      requiredSigners,\n      index\n    );\n    const multisig = deriveMultisigByPath(braid, bip32Path);\n\n    // FIXME: Add regtest option for private node, if you're on regtest have to change the prefix for p2wsh addresses.\n    // if (true) {\n    //   const multisigAddress = bitcoin.address.fromBech32(multisig.address);\n    //   multisig.address = bitcoin.address.toBech32(multisigAddress.data, multisigAddress.version, 'bcrt');\n    // }\n    const utxoUpdates = await this.fetchUTXOs(\n      isChange,\n      multisig,\n      attemptToKeepGenerating\n    );\n    return { multisig, ...utxoUpdates };\n  };\n\n  fetchUTXOs = async (isChange, multisig, attemptToKeepGenerating) => {\n    const { network, client } = this.props;\n    let addressStatus;\n    let updates = await fetchAddressUTXOs(multisig.address, network, client);\n\n    // only check for address status if there weren't any errors\n    // fetching the utxos for the address\n    if (updates && !updates.fetchUTXOsError.length)\n      addressStatus = await getAddressStatus(multisig.address, network, client);\n\n    if (addressStatus) {\n      updates = { ...updates, addressUsed: addressStatus.used };\n    }\n\n    if (attemptToKeepGenerating) {\n      setTimeout(() => this.generateNextNodeIfNecessary(isChange));\n    }\n    return updates;\n  };\n\n  generateNextNodeIfNecessary = (isChange) => {\n    const { change, deposits, initialLoadComplete } = this.props;\n    const { trailingEmptyNodes } = isChange ? change : deposits;\n    const { fetchUTXOsErrors } = isChange ? change : deposits;\n    const allBIP32Paths = Object.keys((isChange ? change : deposits).nodes);\n    if (\n      trailingEmptyNodes >= MAX_TRAILING_EMPTY_NODES ||\n      fetchUTXOsErrors >= MAX_FETCH_UTXOS_ERRORS\n    ) {\n      initialLoadComplete();\n      return;\n    }\n\n    allBIP32Paths.sort((p1, p2) => {\n      const p1Segments = (p1 || \"\").split(\"/\");\n      const p2Segments = (p2 || \"\").split(\"/\");\n      const p1Index = parseInt(p1Segments[2], 10);\n      const p2Index = parseInt(p2Segments[2], 10);\n      return p1Index - p2Index;\n    });\n    const pathSegments = (allBIP32Paths[allBIP32Paths.length - 1] || \"\").split(\n      \"/\"\n    ); // m, 0, 1\n    const maxIndex = parseInt(pathSegments[2], 10);\n    const nextBIP32Path = `m/${pathSegments[1]}/${maxIndex + 1}`;\n    // Similar to above, we wrap the call to add the next node with\n    // setTimeout with a timeout of zero to allow React time to\n    // render.\n    setTimeout(() => this.addNode(isChange, nextBIP32Path, true));\n  };\n\n  refreshNodes = async () => {\n    const { change, deposits, resetNodesFetchErrors } = this.props;\n    const allNodes = Object.values(deposits.nodes).concat(\n      Object.values(change.nodes)\n    );\n    const previousFetchErrors = Math.max(\n      change.fetchUTXOsErrors,\n      deposits.fetchUTXOsErrors\n    );\n\n    resetNodesFetchErrors();\n    await Promise.all(\n      allNodes.map(async (node) => {\n        const utxos = await this.fetchUTXOs(node.change, node.multisig);\n        this.updateNode(node.change, { bip32Path: node.bip32Path, ...utxos });\n      })\n    );\n\n    if (previousFetchErrors >= MAX_FETCH_UTXOS_ERRORS) {\n      const currentFetchErrors = Math.max(\n        change.fetchUTXOsErrors,\n        deposits.fetchUTXOsErrors\n      );\n      if (currentFetchErrors < 5) {\n        // eslint-disable-next-line no-console\n        console.log(\"we had errors but now looks good, try to build more\");\n      }\n    }\n  };\n\n  // eslint-disable-next-line class-methods-use-this\n  generateRichExtendedPublicKeys(extendedPublicKeyImporters) {\n    return Object.values(extendedPublicKeyImporters).map((importer) => {\n      const extendedPublicKey = ExtendedPublicKey.fromBase58(\n        importer.extendedPublicKey\n      );\n      extendedPublicKey.setRootFingerprint(\n        importer.rootXfp && !importer.rootXfp.toLowerCase().includes(\"unknown\")\n          ? importer.rootXfp\n          : \"00000000\"\n      );\n      extendedPublicKey.setBip32Path(\n        importer.bip32Path &&\n          !importer.bip32Path.toLowerCase().includes(\"unknown\")\n          ? importer.bip32Path\n          : `m${\"/0\".repeat(extendedPublicKey.depth)}`\n      );\n      extendedPublicKey.addBase58String();\n      return extendedPublicKey;\n    });\n  }\n\n  async handlePasswordEnter(event) {\n    event.preventDefault();\n    this.debouncedTestConnection.cancel();\n    await this.testConnection(this.props, this.generate);\n  }\n\n  async handlePasswordChange(event) {\n    event.preventDefault();\n    const { setPassword, setPasswordError } = this.props;\n    const password = event.target.value;\n    this.setState({ connectSuccess: false }, () => {\n      setPassword(password);\n      setPasswordError(\"\");\n    });\n  }\n\n  body() {\n    const {\n      totalSigners,\n      configuring,\n      downloadWalletDetails,\n      client,\n      generating,\n      extendedPublicKeyImporters,\n    } = this.props;\n    const { connectSuccess, unknownClient } = this.state;\n    const hasConflict = Object.values(extendedPublicKeyImporters).some(\n      (xpub) => xpub.conflict\n    );\n    if (this.extendedPublicKeyCount() === totalSigners) {\n      if (generating && !configuring) {\n        return (\n          <WalletControl addNode={this.addNode} updateNode={this.updateNode} />\n        );\n      }\n      if (!hasConflict) {\n        return (\n          <Card>\n            <CardHeader title={this.title()} />\n            <CardContent>\n              <Button href=\"#\" onClick={(e) => this.toggleImporters(e, false)}>\n                {configuring ? \"Hide Key Selection\" : \"Edit Details\"}\n              </Button>\n              <ConfirmWallet />\n              <p>\n                You have imported all&nbsp;\n                {totalSigners} extended public keys. You will need to save this\n                information.\n              </p>\n              <WalletConfigInteractionButtons\n                onClearFn={(e) => this.toggleImporters(e, true)}\n                onDownloadFn={downloadWalletDetails}\n              />\n              {unknownClient && (\n                <Box my={5}>\n                  <Typography variant=\"subtitle1\">\n                    This config does not contain client information. Please\n                    choose a client to connect to before importing your wallet.\n                  </Typography>\n                  <ClientPicker\n                    onSuccess={() => this.setState({ connectSuccess: true })}\n                  />\n                </Box>\n              )}\n              {client.type === \"private\" && !unknownClient && (\n                <Box my={5}>\n                  <Grid container spacing={2} alignItems=\"center\">\n                    <Grid item xs={12}>\n                      <Typography variant=\"subtitle1\">\n                        This config uses a private client. Please enter password\n                        if not set.\n                      </Typography>\n                    </Grid>\n                    <Grid item>\n                      <TextField\n                        id=\"client-username\"\n                        label=\"Username\"\n                        defaultValue={client.username}\n                        InputProps={{\n                          readOnly: true,\n                          disabled: true,\n                          startAdornment: (\n                            <InputAdornment position=\"start\">\n                              <AccountCircleIcon />\n                            </InputAdornment>\n                          ),\n                        }}\n                      />\n                    </Grid>\n                    <Grid item md={4} xs={10}>\n                      <form\n                        onSubmit={(event) => this.handlePasswordEnter(event)}\n                      >\n                        <TextField\n                          id=\"bitcoind-password\"\n                          fullWidth\n                          type=\"password\"\n                          label=\"Password\"\n                          placeholder=\"Enter bitcoind password\"\n                          value={client.password}\n                          onChange={(event) => this.handlePasswordChange(event)}\n                          error={client.passwordError.length > 0}\n                          helperText={client.passwordError}\n                        />\n                        {connectSuccess && (\n                          <FormHelperText>\n                            Connection confirmed with password!\n                          </FormHelperText>\n                        )}\n                      </form>\n                    </Grid>\n                  </Grid>\n                </Box>\n              )}\n              <p>\n                Please confirm that the above information is correct and you\n                wish to generate your wallet.\n              </p>\n              <Button\n                id=\"confirm-wallet\"\n                type=\"button\"\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={this.generate}\n                disabled={client.type !== \"public\" && !connectSuccess}\n              >\n                Confirm\n              </Button>\n            </CardContent>\n          </Card>\n        );\n      }\n      return (\n        <p>You must correct the conflict before the wallet can be generated.</p>\n      );\n    }\n    return (\n      <p>\n        {`Once you have imported all ${totalSigners} extended public keys, `}\n        {\"your wallet will be generated here.\"}\n        {hasConflict &&\n          ` You will not be able to continue until you address the conflict.`}\n      </p>\n    );\n  }\n\n  render() {\n    return <div>{this.body()}</div>;\n  }\n}\n\nWalletGenerator.propTypes = {\n  addressType: PropTypes.string.isRequired,\n  change: PropTypes.shape({\n    nodes: PropTypes.shape({}),\n    fetchUTXOsErrors: PropTypes.number,\n  }).isRequired,\n  client: PropTypes.shape({\n    password: PropTypes.string,\n    passwordError: PropTypes.string,\n    type: PropTypes.string,\n    username: PropTypes.string,\n  }).isRequired,\n  common: PropTypes.shape({\n    nodesLoaded: PropTypes.bool,\n  }).isRequired,\n  configuring: PropTypes.bool.isRequired,\n  deposits: PropTypes.shape({\n    nodes: PropTypes.shape({}),\n    fetchUTXOsErrors: PropTypes.number,\n  }).isRequired,\n  downloadWalletDetails: PropTypes.func.isRequired,\n  extendedPublicKeyImporters: PropTypes.shape({}).isRequired,\n  freeze: PropTypes.func.isRequired,\n  generating: PropTypes.bool.isRequired,\n  initialLoadComplete: PropTypes.func.isRequired,\n  network: PropTypes.string.isRequired,\n  setGenerating: PropTypes.func.isRequired,\n  startingAddressIndex: PropTypes.number.isRequired,\n  refreshNodes: PropTypes.func.isRequired,\n  requiredSigners: PropTypes.number.isRequired,\n  resetNodesFetchErrors: PropTypes.func.isRequired,\n  resetWallet: PropTypes.func.isRequired,\n  setImportersVisible: PropTypes.func.isRequired,\n  setIsWallet: PropTypes.func.isRequired,\n  setPassword: PropTypes.func.isRequired,\n  setPasswordError: PropTypes.func.isRequired,\n  totalSigners: PropTypes.number.isRequired,\n  updateChangeSlice: PropTypes.func.isRequired,\n  updateDepositSlice: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.settings,\n    ...{ client: state.client },\n    ...state.quorum,\n    ...state.wallet,\n    ...state.wallet.common,\n  };\n}\n\nconst mapDispatchToProps = {\n  freeze: setFrozen,\n  updateDepositSlice: updateDepositSliceAction,\n  updateChangeSlice: updateChangeSliceAction,\n  fetchSliceData: fetchSliceDataAction,\n  setImportersVisible: setExtendedPublicKeyImporterVisible,\n  setIsWallet: setIsWalletAction,\n  resetWallet: resetWalletAction,\n  resetNodesFetchErrors: resetNodesFetchErrorsAction,\n  ...wrappedActions({\n    setPassword: SET_CLIENT_PASSWORD,\n    setPasswordError: SET_CLIENT_PASSWORD_ERROR,\n  }),\n  initialLoadComplete: initialLoadCompleteAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WalletGenerator);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  UNSUPPORTED,\n  PENDING,\n  ACTIVE,\n  ERROR,\n  ExportExtendedPublicKey,\n} from \"unchained-wallets\";\nimport {\n  Button,\n  TextField,\n  FormHelperText,\n  Box,\n  Grid,\n} from \"@material-ui/core\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nclass DirectExtendedPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      extendedPublicKeyError: \"\",\n      status: this.interaction().isSupported() ? PENDING : UNSUPPORTED,\n    };\n  }\n\n  componentDidMount = () => {\n    this.resetBIP32Path();\n  };\n\n  interaction = () => {\n    const { network, extendedPublicKeyImporter } = this.props;\n    return ExportExtendedPublicKey({\n      network,\n      keystore: extendedPublicKeyImporter.method,\n      bip32Path: extendedPublicKeyImporter.bip32Path,\n      includeXFP: true,\n    });\n  };\n\n  render = () => {\n    const { extendedPublicKeyImporter } = this.props;\n    const { status, extendedPublicKeyError } = this.state;\n    const interaction = this.interaction();\n    if (status === UNSUPPORTED) {\n      return (\n        <FormHelperText className=\"text-danger\">\n          {interaction.messageTextFor({ status })}\n        </FormHelperText>\n      );\n    }\n    return (\n      <Box mt={2}>\n        <Grid container>\n          <Grid item md={6}>\n            <TextField\n              fullWidth\n              label=\"BIP32 Path\"\n              value={extendedPublicKeyImporter.bip32Path}\n              onChange={this.handleBIP32PathChange}\n              disabled={status !== PENDING}\n              error={this.hasBIP32PathError()}\n              helperText={this.bip32PathError()}\n            />\n          </Grid>\n          <Grid item md={6}>\n            {!this.bip32PathIsDefault() && (\n              <Button\n                type=\"button\"\n                variant=\"contained\"\n                size=\"small\"\n                onClick={this.resetBIP32Path}\n                disabled={status !== PENDING}\n              >\n                Default\n              </Button>\n            )}\n          </Grid>\n        </Grid>\n        <FormHelperText>\n          Use the default value if you don&rsquo;t understand BIP32 paths.\n        </FormHelperText>\n        <Box mt={2}>\n          <Button\n            type=\"button\"\n            variant=\"contained\"\n            color=\"primary\"\n            size=\"large\"\n            onClick={this.import}\n            disabled={this.hasBIP32PathError() || status === ACTIVE}\n          >\n            Import Extended Public Key\n          </Button>\n        </Box>\n        <InteractionMessages\n          messages={interaction.messagesFor({ state: status })}\n        />\n        <FormHelperText error>{extendedPublicKeyError}</FormHelperText>\n      </Box>\n    );\n  };\n\n  import = async () => {\n    const {\n      validateAndSetExtendedPublicKey,\n      validateAndSetRootFingerprint,\n      enableChangeMethod,\n      disableChangeMethod,\n    } = this.props;\n    disableChangeMethod();\n    this.setState({ extendedPublicKeyError: \"\", status: ACTIVE });\n    try {\n      const result = await this.interaction().run();\n      const extendedPublicKey = result.xpub;\n      validateAndSetRootFingerprint(result.rootFingerprint, (error) => {\n        this.setState({ extendedPublicKeyError: error, status: PENDING });\n      });\n      validateAndSetExtendedPublicKey(extendedPublicKey, (error) => {\n        this.setState({ extendedPublicKeyError: error, status: PENDING });\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      this.setState({ extendedPublicKeyError: e.message, status: PENDING });\n    }\n    enableChangeMethod();\n  };\n\n  hasBIP32PathError = () => {\n    const { status } = this.state;\n    return this.interaction().hasMessagesFor({\n      state: status,\n      level: ERROR,\n      code: \"bip32\",\n    });\n  };\n\n  bip32PathError = () => {\n    const { status } = this.state;\n    return this.interaction().messageTextFor({\n      state: status,\n      level: ERROR,\n      code: \"bip32\",\n    });\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(\n      bip32Path,\n      () => {},\n      () => {}\n    );\n  };\n\n  bip32PathIsDefault = () => {\n    const { extendedPublicKeyImporter, defaultBIP32Path } = this.props;\n    return extendedPublicKeyImporter.bip32Path === defaultBIP32Path;\n  };\n\n  resetBIP32Path = () => {\n    const { resetBIP32Path } = this.props;\n    resetBIP32Path();\n  };\n}\n\nDirectExtendedPublicKeyImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  extendedPublicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    method: PropTypes.string,\n  }).isRequired,\n  validateAndSetExtendedPublicKey: PropTypes.func.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetRootFingerprint: PropTypes.func.isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  enableChangeMethod: PropTypes.func.isRequired,\n  disableChangeMethod: PropTypes.func.isRequired,\n};\n\nexport default DirectExtendedPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\n// Components\nimport { TextField, Box } from \"@material-ui/core\";\n\nclass TextExtendedPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: \"\",\n    };\n  }\n\n  render = () => {\n    const { extendedPublicKeyImporter } = this.props;\n    const { error } = this.state;\n    return (\n      <Box mt={2}>\n        <TextField\n          fullWidth\n          name=\"publicKey\"\n          label=\"Extended Public Key\"\n          value={extendedPublicKeyImporter.extendedPublicKey}\n          onChange={this.handleChange}\n          error={this.hasError()}\n          helperText={error}\n        />\n      </Box>\n    );\n  };\n\n  hasError = () => {\n    const { error } = this.state;\n    return error !== \"\";\n  };\n\n  setError = (value) => {\n    this.setState({ error: value });\n  };\n\n  handleChange = (event) => {\n    const { validateAndSetExtendedPublicKey } = this.props;\n    validateAndSetExtendedPublicKey(event.target.value, this.setError);\n  };\n}\nTextExtendedPublicKeyImporter.propTypes = {\n  extendedPublicKeyImporter: PropTypes.shape({\n    extendedPublicKey: PropTypes.string,\n  }).isRequired,\n  validateAndSetExtendedPublicKey: PropTypes.func.isRequired,\n};\n\nexport default TextExtendedPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\n// Components\nimport {\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Typography,\n} from \"@material-ui/core\";\nimport { Warning } from \"@material-ui/icons\";\n\nconst Conflict = (props) => {\n  const { message } = props;\n\n  return (\n    <small>\n      <List>\n        <ListItem color=\"error.main\">\n          <ListItemIcon>\n            <Typography color=\"error\">\n              <Warning />\n            </Typography>\n          </ListItemIcon>\n          <ListItemText>\n            <Typography color=\"error\">{message}</Typography>\n          </ListItemText>\n        </ListItem>\n      </List>\n    </small>\n  );\n};\n\nConflict.propTypes = {\n  message: PropTypes.string.isRequired,\n};\n\nexport default Conflict;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  ERROR,\n  ExportExtendedPublicKey,\n  PENDING,\n  UNSUPPORTED,\n} from \"unchained-wallets\";\nimport { FormGroup, FormHelperText } from \"@material-ui/core\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nclass IndirectExtendedPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      status: this.interaction().isSupported() ? PENDING : UNSUPPORTED,\n      extendedPublicKeyError: \"\",\n    };\n  }\n\n  // The extendedPublicKeyImporter has a \"default\" root multisig bip32path\n  // which does not work on Coldcard, so the status will be UNSUPPORTED.\n  // this gets updated almost immediately, so just fire off another isSupported()\n  // to check if we're good.\n  componentDidUpdate() {\n    const { status } = this.state;\n    if (status !== PENDING && this.interaction().isSupported()) {\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({ status: PENDING });\n    }\n  }\n\n  interaction = () => {\n    const { network, extendedPublicKeyImporter } = this.props;\n    return new ExportExtendedPublicKey({\n      keystore: extendedPublicKeyImporter.method,\n      bip32Path: extendedPublicKeyImporter.bip32Path,\n      network,\n      includeXFP: true,\n    });\n  };\n\n  render = () => {\n    const {\n      Reader,\n      disableChangeMethod,\n      resetBIP32Path,\n      extendedPublicKeyImporter,\n    } = this.props;\n    const { status, extendedPublicKeyError } = this.state;\n    return (\n      <FormGroup>\n        <Reader\n          setError={this.setError}\n          hasError={this.hasBIP32PathError()}\n          errorMessage={this.bip32PathError()}\n          bip32PathIsDefault={this.bip32PathIsDefault}\n          handleBIP32PathChange={this.handleBIP32PathChange}\n          resetBIP32Path={resetBIP32Path}\n          onReceive={this.onReceive}\n          interaction={this.interaction()}\n          disableChangeMethod={disableChangeMethod}\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n        />\n        <InteractionMessages\n          messages={this.interaction().messagesFor({ state: status })}\n          excludeCodes={[\"bip32\"]}\n        />\n        <FormHelperText error>{extendedPublicKeyError}</FormHelperText>\n      </FormGroup>\n    );\n  };\n\n  hasBIP32PathError = () => {\n    const { status } = this.state;\n    return this.interaction().hasMessagesFor({\n      state: status,\n      level: ERROR,\n      code: \"bip32\",\n    });\n  };\n\n  bip32PathError = () => {\n    const { status } = this.state;\n    return this.interaction().messageTextFor({\n      state: status,\n      level: ERROR,\n      code: \"bip32\",\n    });\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(\n      bip32Path,\n      () => {},\n      () => {}\n    );\n  };\n\n  bip32PathIsDefault = () => {\n    const { extendedPublicKeyImporter, defaultBIP32Path } = this.props;\n    return extendedPublicKeyImporter.bip32Path === defaultBIP32Path;\n  };\n\n  resetBIP32Path = () => {\n    const { resetBIP32Path } = this.props;\n    resetBIP32Path();\n  };\n\n  setError = (value) => {\n    this.setState({ extendedPublicKeyError: value });\n  };\n\n  onReceive = (data) => {\n    const {\n      validateAndSetBIP32Path,\n      validateAndSetExtendedPublicKey,\n      validateAndSetRootFingerprint,\n      enableChangeMethod,\n    } = this.props;\n    if (enableChangeMethod) {\n      enableChangeMethod();\n    }\n    try {\n      const { xpub, bip32Path, rootFingerprint } = this.interaction().parse(\n        data\n      );\n      validateAndSetRootFingerprint(rootFingerprint, this.setError);\n      validateAndSetBIP32Path(\n        bip32Path,\n        () => {\n          validateAndSetExtendedPublicKey(xpub, this.setError);\n        },\n        this.setError\n      );\n    } catch (e) {\n      this.setError(e.message);\n    }\n  };\n}\n\nIndirectExtendedPublicKeyImporter.propTypes = {\n  enableChangeMethod: PropTypes.func,\n  extendedPublicKeyImporter: PropTypes.shape({\n    method: PropTypes.string,\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  disableChangeMethod: PropTypes.func,\n  network: PropTypes.string.isRequired,\n  Reader: PropTypes.func.isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetExtendedPublicKey: PropTypes.func.isRequired,\n  validateAndSetRootFingerprint: PropTypes.func.isRequired,\n};\n\nIndirectExtendedPublicKeyImporter.defaultProps = {\n  enableChangeMethod: null,\n  disableChangeMethod: null,\n};\n\nexport default IndirectExtendedPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { COLDCARD } from \"unchained-wallets\";\nimport { FormGroup, FormHelperText } from \"@material-ui/core\";\nimport { MAINNET, P2SH } from \"unchained-bitcoin\";\nimport { ColdcardJSONReader } from \".\";\nimport IndirectExtendedPublicKeyImporter from \"../Wallet/IndirectExtendedPublicKeyImporter\";\n\nclass ColdcardExtendedPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    const coldcardBIP32Path = this.getColdcardBip32Path();\n    this.state = {\n      COLDCARD_MULTISIG_BIP32_PATH: coldcardBIP32Path,\n    };\n  }\n\n  componentDidMount = () => {\n    const { extendedPublicKeyImporter, validateAndSetBIP32Path } = this.props;\n    const { COLDCARD_MULTISIG_BIP32_PATH } = this.state;\n    if (extendedPublicKeyImporter.method === COLDCARD) {\n      validateAndSetBIP32Path(\n        COLDCARD_MULTISIG_BIP32_PATH,\n        () => {},\n        () => {},\n        {}\n      );\n    }\n  };\n\n  componentDidUpdate(prevProps) {\n    const { validateAndSetBIP32Path, network, addressType } = this.props;\n    const coldcardBIP32Path = this.getColdcardBip32Path();\n\n    // Any updates to the network/addressType we should set the BIP32Path\n    if (\n      prevProps.network !== network ||\n      prevProps.addressType !== addressType\n    ) {\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({ COLDCARD_MULTISIG_BIP32_PATH: coldcardBIP32Path });\n      validateAndSetBIP32Path(\n        coldcardBIP32Path,\n        () => {},\n        () => {}\n      );\n    }\n  }\n\n  // Unfortunately not possible to use our Multisig P2SH ROOT on a Coldcard atm\n  // because they do not allow us to export m/45'/{0-1}'/0' yet.\n  getColdcardBip32Path = () => {\n    const { network, addressType, defaultBIP32Path } = this.props;\n    const coinPath = network === MAINNET ? \"0\" : \"1\";\n    const coldcardP2SHPath = `m/45'/${coinPath}/0`;\n    return addressType === P2SH ? coldcardP2SHPath : defaultBIP32Path;\n  };\n\n  render = () => {\n    const {\n      extendedPublicKeyImporter,\n      validateAndSetExtendedPublicKey,\n      validateAndSetBIP32Path,\n      validateAndSetRootFingerprint,\n      addressType,\n      network,\n    } = this.props;\n    const { extendedPublicKeyError, COLDCARD_MULTISIG_BIP32_PATH } = this.state;\n    return (\n      <FormGroup>\n        <IndirectExtendedPublicKeyImporter\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetExtendedPublicKey={validateAndSetExtendedPublicKey}\n          validateAndSetBIP32Path={validateAndSetBIP32Path}\n          validateAndSetRootFingerprint={validateAndSetRootFingerprint}\n          addressType={addressType}\n          network={network}\n          resetBIP32Path={this.resetColdcardBIP32Path}\n          defaultBIP32Path={COLDCARD_MULTISIG_BIP32_PATH}\n          Reader={ColdcardJSONReader}\n        />\n        <FormHelperText error>{extendedPublicKeyError}</FormHelperText>\n      </FormGroup>\n    );\n  };\n\n  resetColdcardBIP32Path = () => {\n    const { validateAndSetBIP32Path } = this.props;\n    const { COLDCARD_MULTISIG_BIP32_PATH } = this.state;\n    validateAndSetBIP32Path(\n      COLDCARD_MULTISIG_BIP32_PATH,\n      () => {},\n      () => {}\n    );\n  };\n}\n\nColdcardExtendedPublicKeyImporter.propTypes = {\n  extendedPublicKeyImporter: PropTypes.shape({\n    method: PropTypes.string,\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  network: PropTypes.string.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetExtendedPublicKey: PropTypes.func.isRequired,\n  validateAndSetRootFingerprint: PropTypes.func.isRequired,\n  addressType: PropTypes.string.isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n};\n\nexport default ColdcardExtendedPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { HermitExportExtendedPublicKey } from \"unchained-wallets\";\nimport { FormGroup, FormHelperText } from \"@material-ui/core\";\n\nimport HermitReader from \"./HermitReader\";\n\nclass HermitExtendedPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      extendedPublicKeyError: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    const { resetBIP32Path } = this.props;\n    resetBIP32Path();\n  };\n\n  interaction = () => {\n    const { network, extendedPublicKeyImporter } = this.props;\n    return new HermitExportExtendedPublicKey({\n      network,\n      bip32Path: extendedPublicKeyImporter.bip32Path,\n    });\n  };\n\n  render = () => {\n    const { disableChangeMethod } = this.props;\n    const { extendedPublicKeyError } = this.state;\n    // Here we are using the HermitReader directly instead of using the\n    // shared `Indirect` helper component class. This is because Hermit does\n    // not need any of the bip32 stuff that is useful from the indirect helper.\n    return (\n      <FormGroup>\n        <HermitReader\n          startText=\"Import Extended Public Key\"\n          interaction={this.interaction()}\n          onStart={disableChangeMethod}\n          onSuccess={this.import}\n          onClear={this.onClear}\n        />\n        <FormHelperText className=\"text-danger\">\n          {extendedPublicKeyError}\n        </FormHelperText>\n      </FormGroup>\n    );\n  };\n\n  setError = (value) => {\n    this.setState({ extendedPublicKeyError: value });\n  };\n\n  import = (data) => {\n    const {\n      validateAndSetBIP32Path,\n      validateAndSetExtendedPublicKey,\n      enableChangeMethod,\n    } = this.props;\n    enableChangeMethod();\n    const { xpub, bip32Path } = data;\n    validateAndSetBIP32Path(\n      bip32Path,\n      () => {\n        validateAndSetExtendedPublicKey(xpub, this.setError);\n      },\n      this.setError\n    );\n  };\n\n  onClear = () => {\n    const { reset, enableChangeMethod } = this.props;\n    reset(true); // clear BIP32 path\n    this.setError(\"\");\n    enableChangeMethod();\n  };\n}\n\nHermitExtendedPublicKeyImporter.propTypes = {\n  enableChangeMethod: PropTypes.func.isRequired,\n  extendedPublicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  disableChangeMethod: PropTypes.func.isRequired,\n  network: PropTypes.string.isRequired,\n  reset: PropTypes.func.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  validateAndSetExtendedPublicKey: PropTypes.func.isRequired,\n};\n\nexport default HermitExtendedPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  validateBIP32Path,\n  validateRootFingerprint,\n  convertExtendedPublicKey,\n  validateExtendedPublicKey,\n  NETWORKS,\n} from \"unchained-bitcoin\";\nimport { TREZOR, LEDGER, HERMIT, COLDCARD } from \"unchained-wallets\";\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  FormControl,\n  Select,\n  MenuItem,\n  InputLabel,\n  Button,\n  FormHelperText,\n  Box,\n  withStyles,\n} from \"@material-ui/core\";\nimport Copyable from \"../Copyable\";\nimport DirectExtendedPublicKeyImporter from \"./DirectExtendedPublicKeyImporter\";\nimport TextExtendedPublicKeyImporter from \"./TextExtendedPublicKeyImporter\";\nimport EditableName from \"../EditableName\";\nimport Conflict from \"../CreateAddress/Conflict\";\nimport {\n  setExtendedPublicKeyImporterName,\n  resetExtendedPublicKeyImporterBIP32Path,\n  setExtendedPublicKeyImporterBIP32Path,\n  setExtendedPublicKeyImporterMethod,\n  setExtendedPublicKeyImporterExtendedPublicKey,\n  setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint,\n  setExtendedPublicKeyImporterFinalized,\n} from \"../../actions/extendedPublicKeyImporterActions\";\nimport ColdcardExtendedPublicKeyImporter from \"../Coldcard/ColdcardExtendedPublicKeyImporter\";\nimport HermitExtendedPublicKeyImporter from \"../Hermit/HermitExtendedPublicKeyImporter\";\n\nconst TEXT = \"text\";\nconst UNKNOWN = \"unknown\";\n\nconst useStyles = () => ({\n  xpub: {\n    lineHeight: \".8rem\",\n    overflowWrap: \"break-word\",\n  },\n});\n\nclass ExtendedPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      disableChangeMethod: false,\n      conversionMessage: \"\",\n    };\n  }\n\n  title = () => {\n    const { number, extendedPublicKeyImporter, setName } = this.props;\n    return (\n      <EditableName\n        number={number}\n        name={extendedPublicKeyImporter.name}\n        setName={setName}\n      />\n    );\n  };\n\n  renderImport = () => {\n    const { extendedPublicKeyImporter, number } = this.props;\n    const { disableChangeMethod } = this.state;\n    const labelId = `xpub-${number}-importer-select-label`;\n    return (\n      <div>\n        <FormControl fullWidth>\n          <InputLabel id={labelId}>Select Method</InputLabel>\n\n          <Select\n            labelId={labelId}\n            id={`public-key-${number}-importer-select`}\n            disabled={disableChangeMethod}\n            value={extendedPublicKeyImporter.method}\n            onChange={this.handleMethodChange}\n          >\n            <MenuItem value={UNKNOWN}>{\"< Select method >\"}</MenuItem>\n            <MenuItem value={TREZOR}>Trezor</MenuItem>\n            <MenuItem value={COLDCARD}>Coldcard</MenuItem>\n            <MenuItem value={LEDGER}>Ledger</MenuItem>\n            <MenuItem value={HERMIT}>Hermit</MenuItem>\n            <MenuItem value={TEXT}>Enter as text</MenuItem>\n          </Select>\n        </FormControl>\n\n        {this.renderImportByMethod()}\n      </div>\n    );\n  };\n\n  renderImportByMethod = () => {\n    const {\n      extendedPublicKeyImporter,\n      network,\n      addressType,\n      defaultBIP32Path,\n    } = this.props;\n    const { method } = extendedPublicKeyImporter;\n\n    if (method === TREZOR || method === LEDGER) {\n      return (\n        <DirectExtendedPublicKeyImporter\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetExtendedPublicKey={this.validateAndSetExtendedPublicKey}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          validateAndSetRootFingerprint={this.validateAndSetRootFingerprint}\n          resetBIP32Path={this.resetBIP32Path}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n          addressType={addressType}\n          defaultBIP32Path={defaultBIP32Path}\n          network={network}\n        />\n      );\n    }\n    if (method === HERMIT) {\n      return (\n        <HermitExtendedPublicKeyImporter\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetExtendedPublicKey={this.validateAndSetExtendedPublicKey}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          validateAndSetRootFingerprint={this.validateAndSetRootFingerprint}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n          addressType={addressType}\n          defaultBIP32Path={defaultBIP32Path}\n          network={network}\n          resetBIP32Path={this.resetBIP32Path}\n          reset={this.reset}\n        />\n      );\n    }\n    if (method === COLDCARD) {\n      return (\n        <ColdcardExtendedPublicKeyImporter\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetExtendedPublicKey={this.validateAndSetExtendedPublicKey}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          validateAndSetRootFingerprint={this.validateAndSetRootFingerprint}\n          addressType={addressType}\n          defaultBIP32Path={defaultBIP32Path}\n          network={network}\n        />\n      );\n    }\n    if (method === TEXT) {\n      return (\n        <TextExtendedPublicKeyImporter\n          extendedPublicKeyImporter={extendedPublicKeyImporter}\n          validateAndSetExtendedPublicKey={this.validateAndSetExtendedPublicKey}\n        />\n      );\n    }\n    return null;\n  };\n\n  //\n  // Method\n  //\n\n  handleMethodChange = (event) => {\n    const { number, setMethod, setExtendedPublicKey } = this.props;\n    setMethod(number, event.target.value);\n    setExtendedPublicKey(number, \"\");\n  };\n\n  disableChangeMethod = () => {\n    this.setState({ disableChangeMethod: true });\n  };\n\n  enableChangeMethod = () => {\n    this.setState({ disableChangeMethod: false });\n  };\n\n  //\n  // State\n  //\n\n  finalize = () => {\n    const { number, setFinalized } = this.props;\n    setFinalized(number, true);\n  };\n\n  reset = (resetBIP32Path) => {\n    const { number, setExtendedPublicKey, setFinalized } = this.props;\n    setExtendedPublicKey(number, \"\");\n    setFinalized(number, false);\n    if (resetBIP32Path) {\n      this.resetBIP32Path();\n    }\n  };\n\n  //\n  // BIP32 Path\n  //\n\n  renderBIP32Path = () => {\n    const { extendedPublicKeyImporter } = this.props;\n    if (extendedPublicKeyImporter.method === TEXT) {\n      return (\n        <div className=\"mt-4\">\n          <p>\n            Make sure you <strong>record the corresponding BIP32 path.</strong>\n          </p>\n        </div>\n      );\n    }\n    return (\n      <div className=\"mt-4\">\n        <p>The BIP32 path for this extended public key is:</p>\n        <div className=\"text-center\">\n          <Copyable text={extendedPublicKeyImporter.bip32Path} showIcon />\n        </div>\n        <p className=\"mt-4\">\n          You will need this BIP32 path to sign for this key later.{\" \"}\n          <strong>Write down this BIP32 path!</strong>\n        </p>\n      </div>\n    );\n  };\n\n  validateAndSetBIP32Path = (bip32Path, callback, errback, options) => {\n    const { number, setBIP32Path } = this.props;\n    const error = validateBIP32Path(bip32Path, options);\n    setBIP32Path(number, bip32Path);\n    if (error) {\n      errback(error);\n    } else {\n      errback(\"\");\n      callback();\n    }\n  };\n\n  resetBIP32Path = () => {\n    const { number, resetBIP32Path } = this.props;\n    resetBIP32Path(number);\n  };\n\n  //\n  // Extended Public Key\n  //\n\n  renderExtendedPublicKey = () => {\n    const { extendedPublicKeyImporter, network, classes } = this.props;\n    const { conversionMessage } = this.state;\n    const conversionAppend =\n      extendedPublicKeyImporter.method === HERMIT &&\n      network === NETWORKS.TESTNET\n        ? \"this should not be an issue as hermit signing is not affected by the conversion.\"\n        : \"this may indicate an invalid network setting, if so correct setting, remove key and try again.\";\n    return (\n      <div>\n        <p>The following extended public key was imported:</p>\n        <div className={classes.xpub}>\n          <Copyable\n            text={extendedPublicKeyImporter.extendedPublicKey}\n            showIcon\n          />\n        </div>\n        {this.renderBIP32Path()}\n        {conversionMessage !== \"\" && (\n          <Box mb={2}>\n            <FormHelperText>\n              {conversionMessage}, {conversionAppend}{\" \"}\n            </FormHelperText>\n          </Box>\n        )}\n        <Button\n          variant=\"contained\"\n          color=\"secondary\"\n          size=\"small\"\n          onClick={() => {\n            this.reset(extendedPublicKeyImporter.method === HERMIT);\n          }}\n        >\n          Remove Extended Public Key\n        </Button>\n      </div>\n    );\n  };\n\n  validateAndSetExtendedPublicKey = (extendedPublicKey, errback, callback) => {\n    const {\n      number,\n      network,\n      extendedPublicKeyImporters,\n      setExtendedPublicKey,\n    } = this.props;\n    const networkError = validateExtendedPublicKey(extendedPublicKey, network);\n    let actualExtendedPublicKey = extendedPublicKey;\n    if (networkError !== \"\") {\n      try {\n        actualExtendedPublicKey = convertExtendedPublicKey(\n          extendedPublicKey,\n          network === \"testnet\" ? \"tpub\" : \"xpub\"\n        );\n      } catch (error) {\n        errback(error.message);\n        setExtendedPublicKey(number, extendedPublicKey);\n        return;\n      }\n    }\n\n    const validationError = validateExtendedPublicKey(\n      actualExtendedPublicKey,\n      network\n    );\n    if (validationError !== \"\") {\n      errback(validationError);\n      setExtendedPublicKey(number, extendedPublicKey);\n      return;\n    }\n    setExtendedPublicKey(number, actualExtendedPublicKey);\n\n    if (\n      actualExtendedPublicKey &&\n      Object.values(extendedPublicKeyImporters).find(\n        (extendedPublicKeyImporter, extendedPublicKeyImporterIndex) =>\n          extendedPublicKeyImporterIndex !== number - 1 &&\n          extendedPublicKeyImporter.extendedPublicKey ===\n            actualExtendedPublicKey\n      )\n    ) {\n      errback(\"This extended public key has already been imported.\");\n    } else {\n      errback(\"\");\n      const conversionMessage =\n        actualExtendedPublicKey === extendedPublicKey\n          ? \"\"\n          : `Your extended public key has been converted from ${extendedPublicKey.slice(\n              0,\n              4\n            )} to ${actualExtendedPublicKey.slice(0, 4)}`;\n      this.setState({ conversionMessage });\n      this.finalize();\n\n      if (callback) {\n        callback();\n      }\n    }\n  };\n\n  validateAndSetRootFingerprint = (rootFingerprint, errback) => {\n    const { number, setExtendedPublicKeyRootXfp } = this.props;\n    const error = validateRootFingerprint(rootFingerprint);\n    if (error) {\n      errback(error);\n    } else {\n      setExtendedPublicKeyRootXfp(number, rootFingerprint);\n    }\n  };\n\n  render() {\n    const { extendedPublicKeyImporter, finalizedNetwork, network } = this.props;\n    const hasConflict =\n      extendedPublicKeyImporter.method /* && extendedPublicKeyImporter.method !== TEXT */ &&\n      extendedPublicKeyImporter.conflict;\n    let conflictMessage = \"\";\n    if (hasConflict) {\n      if (finalizedNetwork !== network) {\n        conflictMessage =\n          \"Warning, you can not mix xpub and tpub.  Do not proceed without resolving by either removing conflicting imported keys or returning network type to original state!\";\n      } else {\n        conflictMessage =\n          \"Warning, BIP32 path is in conflict with the network and address type settings.  Do not proceed unless you are absolutely sure you know what you are doing!\";\n      }\n    }\n    return (\n      <Card>\n        <CardHeader title={this.title()} />\n        <CardContent>\n          {hasConflict && <Conflict message={conflictMessage} />}\n          {extendedPublicKeyImporter.finalized\n            ? this.renderExtendedPublicKey()\n            : this.renderImport()}\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nExtendedPublicKeyImporter.propTypes = {\n  addressType: PropTypes.string.isRequired,\n  classes: PropTypes.shape({\n    xpub: PropTypes.string,\n  }).isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n  extendedPublicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    conflict: PropTypes.bool,\n    extendedPublicKey: PropTypes.string,\n    finalized: PropTypes.bool,\n    name: PropTypes.string,\n    method: PropTypes.string,\n  }).isRequired,\n  extendedPublicKeyImporters: PropTypes.shape({}).isRequired,\n  finalizedNetwork: PropTypes.string.isRequired,\n  network: PropTypes.string.isRequired,\n  number: PropTypes.number.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  setBIP32Path: PropTypes.func.isRequired,\n  setExtendedPublicKey: PropTypes.func.isRequired,\n  setExtendedPublicKeyRootXfp: PropTypes.func.isRequired,\n  setFinalized: PropTypes.func.isRequired,\n  setName: PropTypes.func.isRequired,\n  setMethod: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state, ownProps) {\n  return {\n    ...state.settings,\n    ...state.quorum,\n    ...{\n      extendedPublicKeyImporter:\n        state.quorum.extendedPublicKeyImporters[ownProps.number],\n    },\n  };\n}\n\nconst mapDispatchToProps = {\n  setName: setExtendedPublicKeyImporterName,\n  resetBIP32Path: resetExtendedPublicKeyImporterBIP32Path,\n  setBIP32Path: setExtendedPublicKeyImporterBIP32Path,\n  setMethod: setExtendedPublicKeyImporterMethod,\n  setExtendedPublicKey: setExtendedPublicKeyImporterExtendedPublicKey,\n  setExtendedPublicKeyRootXfp: setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint,\n  setFinalized: setExtendedPublicKeyImporterFinalized,\n};\n\nconst ExtendedPublicKeyImporterWithStyles = withStyles(useStyles)(\n  ExtendedPublicKeyImporter\n);\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(ExtendedPublicKeyImporterWithStyles);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  ButtonGroup,\n  Grid,\n  makeStyles,\n  Tooltip,\n  withStyles,\n} from \"@material-ui/core\";\nimport MuiButton from \"@material-ui/core/Button\";\n\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport {\n  RefreshOutlined,\n  ExitToAppOutlined,\n  GetAppOutlined,\n} from \"@material-ui/icons\";\n\nimport { clientPropTypes } from \"../../proptypes\";\nimport { CARAVAN_CONFIG } from \"./constants\";\n\nimport ImportAddressesButton from \"../ImportAddressesButton\";\n\nconst useStyles = makeStyles(() => ({\n  card: {\n    height: \"100%\",\n    flexDirection: \"column\",\n    display: \"flex\",\n  },\n  cardContent: {\n    textAlign: \"center\",\n    paddingTop: \"0px\",\n    display: \"flex\",\n    flex: 1,\n  },\n}));\n\nconst Button = withStyles({\n  root: {\n    \"&.Mui-disabled\": {\n      pointerEvents: \"auto\",\n    },\n  },\n})(MuiButton);\n\nconst ButtonWithTooltip = ({ tooltipText, disabled, onClick, ...other }) => {\n  const adjustedButtonProps = {\n    disabled,\n    component: disabled ? \"div\" : undefined,\n    onClick: disabled ? undefined : onClick,\n  };\n  return (\n    <Tooltip title={tooltipText}>\n      <Button {...other} {...adjustedButtonProps} />\n    </Tooltip>\n  );\n};\n\nButtonWithTooltip.propTypes = {\n  tooltipText: PropTypes.string.isRequired,\n  disabled: PropTypes.bool.isRequired,\n  onClick: PropTypes.func.isRequired,\n};\n\nconst WalletActionsPanel = ({\n  addresses,\n  client,\n  handleRefresh,\n  onClearConfig,\n  onDownloadConfig,\n  onImportAddresses,\n  refreshing,\n  walletActivated,\n}) => {\n  const classes = useStyles();\n  const handleClearClick = (e) => {\n    e.preventDefault();\n    if (sessionStorage) sessionStorage.removeItem(CARAVAN_CONFIG);\n    onClearConfig(e);\n  };\n  return (\n    <Card className={classes.card}>\n      <CardHeader title=\"Wallet Actions\" />\n      <CardContent className={classes.cardContent}>\n        <Grid container spacing={1} alignItems=\"center\" justify=\"center\">\n          <Grid item xs={12}>\n            <ButtonGroup variant=\"outlined\">\n              <ButtonWithTooltip\n                tooltipText=\"Force a refresh for latest wallet state and balance.\"\n                disabled={!walletActivated}\n                onClick={handleRefresh}\n                startIcon={\n                  refreshing ? (\n                    <CircularProgress size={24} />\n                  ) : (\n                    <RefreshOutlined />\n                  )\n                }\n              >\n                Refresh\n              </ButtonWithTooltip>\n              <ButtonWithTooltip\n                tooltipText=\"Download wallet configuration to local machine for backup. No security is lost with this, but access to this file provides anyone who has it information about balances.\"\n                onClick={onDownloadConfig}\n                disabled={false}\n                startIcon={<GetAppOutlined />}\n              >\n                Download Configuration\n              </ButtonWithTooltip>\n              <ButtonWithTooltip\n                tooltipText=\"Only clears the wallet config from browser sessions. Funds remain unaffected.\"\n                disabled={!walletActivated}\n                startIcon={<ExitToAppOutlined />}\n                onClick={handleClearClick}\n              >\n                Clear Wallet\n              </ButtonWithTooltip>\n            </ButtonGroup>\n          </Grid>\n          {client.type === \"private\" && walletActivated && (\n            <Grid item>\n              <ImportAddressesButton\n                addresses={addresses}\n                client={client}\n                importCallback={onImportAddresses}\n              />\n            </Grid>\n          )}\n        </Grid>\n      </CardContent>\n    </Card>\n  );\n};\n\nWalletActionsPanel.propTypes = {\n  addresses: PropTypes.arrayOf(PropTypes.string),\n  onImportAddresses: PropTypes.func.isRequired,\n  walletActivated: PropTypes.bool,\n  handleRefresh: PropTypes.func.isRequired,\n  onClearConfig: PropTypes.func.isRequired,\n  onDownloadConfig: PropTypes.func.isRequired,\n  refreshing: PropTypes.bool,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n};\n\nWalletActionsPanel.defaultProps = {\n  walletActivated: false,\n  refreshing: false,\n  addresses: [],\n};\n\nexport default WalletActionsPanel;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  satoshisToBitcoins,\n  validateBIP32Index,\n  validateBIP32Path,\n  validateExtendedPublicKey,\n} from \"unchained-bitcoin\";\nimport { Box, Button, FormHelperText, Grid } from \"@material-ui/core\";\nimport { downloadFile } from \"../../utils\";\nimport {\n  resetWallet as resetWalletAction,\n  updateChangeSliceAction,\n  updateDepositSliceAction,\n  updateWalletNameAction as updateWalletNameActionImport,\n} from \"../../actions/walletActions\";\nimport { fetchSliceData as fetchSliceDataAction } from \"../../actions/braidActions\";\nimport walletSelectors from \"../../selectors\";\nimport { CARAVAN_CONFIG } from \"./constants\";\nimport WalletInfoCard from \"./WalletInfoCard\";\nimport NetworkPicker from \"../NetworkPicker\";\nimport QuorumPicker from \"../QuorumPicker\";\nimport AddressTypePicker from \"../AddressTypePicker\";\nimport ClientPicker from \"../ClientPicker\";\nimport StartingAddressIndexPicker from \"../StartingAddressIndexPicker\";\nimport WalletGenerator from \"./WalletGenerator\";\nimport ExtendedPublicKeyImporter from \"./ExtendedPublicKeyImporter\";\nimport WalletActionsPanel from \"./WalletActionsPanel\";\nimport {\n  getUnknownAddresses,\n  getUnknownAddressSlices,\n  getWalletDetailsText,\n} from \"../../selectors/wallet\";\nimport {\n  setAddressType as setAddressTypeAction,\n  setNetwork as setNetworkAction,\n  setRequiredSigners as setRequiredSignersAction,\n  setStartingAddressIndex as setStartingAddressIndexAction,\n  setTotalSigners as setTotalSignersAction,\n} from \"../../actions/settingsActions\";\nimport {\n  setExtendedPublicKeyImporterBIP32Path as setExtendedPublicKeyImporterBIP32PathAction,\n  setExtendedPublicKeyImporterExtendedPublicKey as setExtendedPublicKeyImporterExtendedPublicKeyAction,\n  setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint as setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprintAction,\n  setExtendedPublicKeyImporterFinalized as setExtendedPublicKeyImporterFinalizedAction,\n  setExtendedPublicKeyImporterMethod as setExtendedPublicKeyImporterMethodAction,\n  setExtendedPublicKeyImporterName as setExtendedPublicKeyImporterNameAction,\n  setExtendedPublicKeyImporterVisible as setExtendedPublicKeyImporterVisibleAction,\n} from \"../../actions/extendedPublicKeyImporterActions\";\nimport { wrappedActions } from \"../../actions/utils\";\nimport {\n  SET_CLIENT_PASSWORD,\n  SET_CLIENT_TYPE,\n  SET_CLIENT_URL,\n  SET_CLIENT_USERNAME,\n} from \"../../actions/clientActions\";\nimport { clientPropTypes, slicePropTypes } from \"../../proptypes\";\n\nclass CreateWallet extends React.Component {\n  static validateProperties(config, properties, key) {\n    for (let index = 0; index < properties.length; index += 1) {\n      const property = properties[index];\n      const configObj = key !== \"\" ? config[key] : config;\n      if (!Object.prototype.hasOwnProperty.call(configObj, property)) {\n        return `Configuration missing property \"${\n          key !== \"\" ? `${key}.` : \"\"\n        }${property}\"`;\n      }\n    }\n    return \"\";\n  }\n\n  static validateConfig(config) {\n    const configProperties = [\n      \"name\",\n      \"addressType\",\n      \"network\",\n      \"quorum\",\n      \"extendedPublicKeys\",\n    ];\n    const validProperties = CreateWallet.validateProperties(\n      config,\n      configProperties,\n      \"\"\n    );\n    if (validProperties !== \"\") return validProperties;\n\n    if (config.startingAddressIndex !== undefined) {\n      const startingAddressIndexError = validateBIP32Index(\n        String(config.startingAddressIndex),\n        { mode: \"unhardened \" }\n      ).replace(\"BIP32\", \"Starting Address\");\n      if (startingAddressIndexError !== \"\") return startingAddressIndexError;\n    }\n\n    if (config.client) {\n      const clientProperties =\n        config.client.type === \"public\"\n          ? [\"type\"]\n          : [\"type\", \"url\", \"username\"];\n      const validClient = CreateWallet.validateProperties(\n        config,\n        clientProperties,\n        \"client\"\n      );\n      if (validClient !== \"\") return validClient;\n    }\n\n    const quorumProperties = [\"requiredSigners\", \"totalSigners\"];\n    const validQuorum = CreateWallet.validateProperties(\n      config,\n      quorumProperties,\n      \"quorum\"\n    );\n    if (validQuorum !== \"\") return validQuorum;\n\n    return CreateWallet.validateExtendedPublicKeys(\n      config.extendedPublicKeys,\n      config.network\n    );\n  }\n\n  static validateExtendedPublicKeys(xpubs, network) {\n    let tmpNetwork = network;\n    if (network === \"regtest\") {\n      tmpNetwork = \"testnet\";\n    }\n    const xpubFields = {\n      name: (name, index) =>\n        typeof name === \"string\"\n          ? \"\"\n          : `Extended public key ${index} name must be a string`,\n      bip32Path: (bip32Path, index) => {\n        if (xpubs[index - 1].method === \"text\") return \"\";\n        if (typeof xpubs[index - 1].method === \"undefined\") return \"\";\n        const pathError = validateBIP32Path(bip32Path);\n        if (pathError !== \"\")\n          return `Extended public key ${index} error: ${pathError}`;\n        return \"\";\n      },\n      xpub: (xpub) => validateExtendedPublicKey(xpub, tmpNetwork),\n      method: (method, index) => {\n        if (\n          [\n            \"trezor\",\n            \"coldcard\",\n            \"ledger\",\n            \"hermit\",\n            \"xpub\",\n            \"text\",\n            undefined,\n          ].includes(method)\n        ) {\n          return \"\";\n        }\n        return `Invalid method for extended public key ${index}`;\n      },\n    };\n\n    const keys = Object.keys(xpubFields);\n    const seen = [];\n    for (let xpubIndex = 0; xpubIndex < xpubs.length; xpubIndex += 1) {\n      if (!seen.includes(xpubs[xpubIndex].xpub)) {\n        seen.push(xpubs[xpubIndex].xpub);\n      } else {\n        return \"Duplicate xpub found.\";\n      }\n      for (let keyIndex = 0; keyIndex < keys.length; keyIndex += 1) {\n        const key = keys[keyIndex];\n        const value = xpubs[xpubIndex][key];\n        const valueError = xpubFields[key](value, xpubIndex + 1);\n        if (valueError !== \"\") return valueError;\n      }\n    }\n    return \"\";\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      configError: \"\",\n      configJson: \"\",\n      refreshing: false,\n      generating: false,\n    };\n  }\n\n  componentDidMount() {\n    if (sessionStorage) {\n      const configJson = sessionStorage.getItem(CARAVAN_CONFIG);\n      if (configJson) this.setConfigJson(configJson);\n    }\n  }\n\n  setConfigJson(configJson) {\n    let configError;\n    try {\n      const config = JSON.parse(configJson);\n      configError = CreateWallet.validateConfig(config);\n    } catch (parseError) {\n      configError = \"Invalid JSON\";\n    }\n\n    if (sessionStorage && configError === \"\") {\n      sessionStorage.setItem(CARAVAN_CONFIG, configJson);\n    }\n\n    // async since importDetails needs the updated state for it to work\n    this.setState({ configJson, configError }, () => {\n      if (configError === \"\") this.importDetails();\n    });\n  }\n\n  setGenerating(_val) {\n    const { generating } = this.state;\n    let val = _val;\n    if (_val === undefined) val = !generating;\n    this.setState({ generating: val });\n  }\n\n  handleImport = ({ target }) => {\n    const fileReader = new FileReader();\n    if (target.files[0] && target.files[0].size < 1048576) {\n      fileReader.onload = (event) => {\n        const configJson = event.target.result;\n        this.setConfigJson(configJson);\n      };\n      fileReader.readAsText(target.files[0]);\n    } else {\n      this.setState({ configError: \"Problem uploading file.\" });\n    }\n  };\n\n  refresh = async () => {\n    this.setState({ refreshing: true });\n    await this.generatorRefresh();\n    this.setState({ refreshing: false });\n  };\n\n  resetErrorAndClearTargetValue = (event) => {\n    // eslint-disable-next-line no-param-reassign\n    event.target.value = \"\";\n    this.setState({ configError: \"\" });\n  };\n\n  importDetails = () => {\n    const { configJson } = this.state;\n    const {\n      setTotalSigners,\n      setRequiredSigners,\n      setAddressType,\n      setNetwork,\n      setStartingAddressIndex,\n      setExtendedPublicKeyImporterMethod,\n      setExtendedPublicKeyImporterExtendedPublicKey,\n      setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint,\n      setExtendedPublicKeyImporterBIP32Path,\n      setExtendedPublicKeyImporterFinalized,\n      setExtendedPublicKeyImporterName,\n      updateWalletNameAction,\n      setClientType,\n      setClientUrl,\n      setClientUsername,\n    } = this.props;\n\n    const walletConfiguration = JSON.parse(configJson);\n    setTotalSigners(walletConfiguration.quorum.totalSigners);\n    setRequiredSigners(walletConfiguration.quorum.requiredSigners);\n    setAddressType(walletConfiguration.addressType);\n    if (walletConfiguration.network === \"regtest\") {\n      setNetwork(\"testnet\");\n    } else {\n      setNetwork(walletConfiguration.network);\n    }\n    updateWalletNameAction(0, walletConfiguration.name);\n    // set client to unknown\n    if (walletConfiguration.client) {\n      setClientType(walletConfiguration.client.type);\n      if (walletConfiguration.client.type === \"private\") {\n        setClientUrl(walletConfiguration.client.url);\n        setClientUsername(walletConfiguration.client.username);\n      }\n    } else {\n      setClientType(\"unknown\");\n    }\n    // optionally, set starting address index\n    if (walletConfiguration.startingAddressIndex) {\n      setStartingAddressIndex(walletConfiguration.startingAddressIndex);\n    }\n    walletConfiguration.extendedPublicKeys.forEach(\n      (extendedPublicKey, index) => {\n        const number = index + 1;\n        setExtendedPublicKeyImporterName(number, extendedPublicKey.name);\n        if (extendedPublicKey.method) {\n          setExtendedPublicKeyImporterMethod(number, extendedPublicKey.method);\n        } else {\n          setExtendedPublicKeyImporterMethod(number, \"unknown\");\n        }\n\n        setExtendedPublicKeyImporterBIP32Path(\n          number,\n          extendedPublicKey.bip32Path\n        );\n        setExtendedPublicKeyImporterExtendedPublicKey(\n          number,\n          extendedPublicKey.xpub\n        );\n        if (extendedPublicKey.xfp) {\n          setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint(\n            number,\n            extendedPublicKey.xfp\n          );\n        } else {\n          setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint(\n            number,\n            \"unknown\"\n          );\n        }\n\n        setExtendedPublicKeyImporterFinalized(number, true);\n      }\n    );\n  };\n\n  // add client picker if client === 'unknown'\n  renderWalletImporter = () => {\n    const { configError } = this.state;\n    const { configuring } = this.props;\n\n    if (configuring)\n      return (\n        <>\n          <label htmlFor=\"upload-config\">\n            <input\n              style={{ display: \"none\" }}\n              id=\"upload-config\"\n              name=\"upload-config\"\n              accept=\"application/json\"\n              onChange={this.handleImport}\n              onClick={this.resetErrorAndClearTargetValue}\n              type=\"file\"\n            />\n\n            <Button\n              color=\"primary\"\n              variant=\"contained\"\n              component=\"span\"\n              style={{ marginTop: \"20px\" }}\n            >\n              Import Wallet Configuration\n            </Button>\n          </label>\n          <FormHelperText error>{configError}</FormHelperText>\n        </>\n      );\n    return \"\";\n  };\n\n  renderSettings = () => {\n    const { configuring } = this.props;\n    let settings = null;\n\n    if (configuring)\n      settings = (\n        <Grid item md={4}>\n          <Box>\n            <QuorumPicker />\n          </Box>\n          <Box mt={2}>\n            <AddressTypePicker />\n          </Box>\n          <Box mt={2}>\n            <NetworkPicker />\n          </Box>\n          <Box mt={2}>\n            <ClientPicker />\n          </Box>\n          <Box mt={2}>\n            <StartingAddressIndexPicker />\n          </Box>\n        </Grid>\n      );\n    return settings;\n  };\n\n  renderExtendedPublicKeyImporters = () => {\n    const { totalSigners, configuring } = this.props;\n    const extendedPublicKeyImporters = [];\n    for (\n      let extendedPublicKeyImporterNum = 1;\n      extendedPublicKeyImporterNum <= totalSigners;\n      extendedPublicKeyImporterNum += 1\n    ) {\n      extendedPublicKeyImporters.push(\n        <Box\n          key={extendedPublicKeyImporterNum}\n          mt={extendedPublicKeyImporterNum === 1 ? 0 : 2}\n          display={configuring ? \"block\" : \"none\"}\n        >\n          <ExtendedPublicKeyImporter\n            key={extendedPublicKeyImporterNum}\n            number={extendedPublicKeyImporterNum}\n          />\n        </Box>\n      );\n    }\n    return extendedPublicKeyImporters;\n  };\n\n  downloadWalletDetails = (event) => {\n    const { walletDetailsText } = this.props;\n    event.preventDefault();\n    const filename = this.walletDetailsFilename();\n    downloadFile(walletDetailsText, filename);\n  };\n\n  walletDetailsFilename = () => {\n    const {\n      totalSigners,\n      requiredSigners,\n      addressType,\n      walletName,\n    } = this.props;\n    return `bitcoin-${requiredSigners}-of-${totalSigners}-${addressType}-${walletName}.json`;\n  };\n\n  totalBalance = () => {\n    const { deposits, change } = this.props;\n    if (!Object.keys(deposits.nodes).length) return \"\";\n    return satoshisToBitcoins(\n      deposits.balanceSats.plus(change.balanceSats)\n    ).toFixed();\n  };\n\n  clearConfig = (e) => {\n    const { setExtendedPublicKeyImporterVisible, resetWallet } = this.props;\n    e.preventDefault();\n    resetWallet();\n    setExtendedPublicKeyImporterVisible(true);\n    this.setState({ generating: false });\n  };\n\n  /**\n   * Callback function to pass to the address importer\n   * after addresses have been imported we want\n   * @param {Array<string>} importedAddresses\n   * @param {boolean} rescan - whether or not a rescan is being performed\n   */\n  async afterImportAddresses(importedAddresses, rescan) {\n    // if rescan is true then there's no point in fetching\n    // the slice data yet since we likely won't get anything\n    // until the rescan is complete\n    if (rescan) return;\n\n    const { unknownSlices, fetchSliceData } = this.props;\n    const importedSlices = unknownSlices.reduce((slices, slice) => {\n      if (importedAddresses.indexOf(slice.multisig.address) > -1)\n        slices.push(slice);\n      return slice;\n    }, []);\n\n    await fetchSliceData(importedSlices);\n  }\n\n  render = () => {\n    const {\n      client,\n      configuring,\n      confirmedBalance,\n      walletName,\n      setName,\n      deposits,\n      change,\n      network,\n      pendingBalance,\n      nodesLoaded,\n      frozen,\n      unknownAddresses,\n    } = this.props;\n    const { refreshing, generating } = this.state;\n    const walletLoadError =\n      change.fetchUTXOsErrors + deposits.fetchUTXOsErrors > 0\n        ? \"Wallet loaded, but with errors...\"\n        : \"\";\n\n    return (\n      <>\n        <Box mt={3}>\n          <Grid container spacing={3}>\n            <Grid item xs={10} md={6}>\n              <WalletInfoCard\n                editable={\n                  !Object.keys(deposits.nodes).length ||\n                  !Object.keys(change.nodes).length\n                }\n                walletName={walletName}\n                setName={setName}\n                balance={+satoshisToBitcoins(confirmedBalance).toFixed()}\n                pendingBalance={+satoshisToBitcoins(pendingBalance).toFixed()}\n                network={network}\n              />\n            </Grid>\n            <Grid item xs={10} md={6}>\n              {(nodesLoaded || frozen) && (\n                <WalletActionsPanel\n                  addresses={unknownAddresses}\n                  refreshing={refreshing}\n                  walletActivated={nodesLoaded}\n                  handleRefresh={() => this.refresh()}\n                  onClearConfig={(e) => {\n                    this.clearConfig(e);\n                  }}\n                  onDownloadConfig={(e) => this.downloadWalletDetails(e)}\n                  client={client}\n                  onImportAddresses={(addresses, rescan) =>\n                    this.afterImportAddresses(rescan)\n                  }\n                />\n              )}\n            </Grid>\n          </Grid>\n        </Box>\n        {walletLoadError.length ? (\n          <FormHelperText\n            style={{ float: \"right\", padding: \"11px\", fontSize: \"1.5em\" }}\n            error\n          >\n            {walletLoadError}\n          </FormHelperText>\n        ) : (\n          \"\"\n        )}\n        <Box>\n          <Grid container spacing={3}>\n            <Grid item xs={12}>\n              {this.renderWalletImporter()}\n            </Grid>\n            <Grid item md={configuring ? 8 : 12}>\n              {this.renderExtendedPublicKeyImporters()}\n              <Box mt={2}>\n                <WalletGenerator\n                  generating={generating}\n                  setGenerating={(value) => this.setGenerating(value)}\n                  downloadWalletDetails={this.downloadWalletDetails}\n                  // eslint-disable-next-line no-return-assign\n                  refreshNodes={(click) => (this.generatorRefresh = click)} // FIXME TIGHT COUPLING ALERT, this calls function downstream\n                />\n              </Box>\n            </Grid>\n            {this.renderSettings()}\n          </Grid>\n        </Box>\n      </>\n    );\n  };\n}\n\nCreateWallet.propTypes = {\n  addressType: PropTypes.string.isRequired,\n  change: PropTypes.shape({\n    balanceSats: PropTypes.shape({}),\n    fetchUTXOsErrors: PropTypes.number,\n    nodes: PropTypes.shape({}),\n  }).isRequired,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n  configuring: PropTypes.bool.isRequired,\n  deposits: PropTypes.shape({\n    balanceSats: PropTypes.shape({\n      plus: PropTypes.func,\n    }),\n    fetchUTXOsErrors: PropTypes.number,\n    nodes: PropTypes.shape({}),\n  }).isRequired,\n  confirmedBalance: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n    .isRequired,\n  extendedPublicKeyImporters: PropTypes.shape({}).isRequired,\n  frozen: PropTypes.bool.isRequired,\n  fetchSliceData: PropTypes.func.isRequired,\n  network: PropTypes.string.isRequired,\n  nodesLoaded: PropTypes.bool.isRequired,\n  pendingBalance: PropTypes.number,\n  requiredSigners: PropTypes.number.isRequired,\n  resetWallet: PropTypes.func.isRequired,\n  setTotalSigners: PropTypes.func.isRequired,\n  setRequiredSigners: PropTypes.func.isRequired,\n  setAddressType: PropTypes.func.isRequired,\n  setName: PropTypes.func.isRequired,\n  setNetwork: PropTypes.func.isRequired,\n  setStartingAddressIndex: PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterMethod: PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterExtendedPublicKey: PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint:\n    PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterBIP32Path: PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterFinalized: PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterName: PropTypes.func.isRequired,\n  setExtendedPublicKeyImporterVisible: PropTypes.func.isRequired,\n  setClientType: PropTypes.func.isRequired,\n  setClientUrl: PropTypes.func.isRequired,\n  setClientUsername: PropTypes.func.isRequired,\n  totalSigners: PropTypes.number.isRequired,\n  updateWalletNameAction: PropTypes.func.isRequired,\n  unknownAddresses: PropTypes.arrayOf(PropTypes.string).isRequired,\n  unknownSlices: PropTypes.arrayOf(PropTypes.shape(slicePropTypes)).isRequired,\n  walletName: PropTypes.string.isRequired,\n  walletDetailsText: PropTypes.string.isRequired,\n};\n\nCreateWallet.defaultProps = {\n  pendingBalance: 0,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.settings,\n    ...state.quorum,\n    ...{\n      walletName: state.wallet.common.walletName,\n      nodesLoaded: state.wallet.common.nodesLoaded,\n      walletMode: state.wallet.common.walletMode,\n    },\n    confirmedBalance: walletSelectors.getConfirmedBalance(state),\n    pendingBalance: walletSelectors.getPendingBalance(state),\n    walletDetailsText: getWalletDetailsText(state),\n    unknownAddresses: getUnknownAddresses(state),\n    unknownSlices: getUnknownAddressSlices(state),\n    ...state.wallet,\n    client: state.client,\n  };\n}\n\nconst mapDispatchToProps = {\n  fetchSliceData: fetchSliceDataAction,\n  resetWallet: resetWalletAction,\n  setName: updateWalletNameActionImport,\n  setTotalSigners: setTotalSignersAction,\n  setRequiredSigners: setRequiredSignersAction,\n  setAddressType: setAddressTypeAction,\n  setNetwork: setNetworkAction,\n  setStartingAddressIndex: setStartingAddressIndexAction,\n  setExtendedPublicKeyImporterMethod: setExtendedPublicKeyImporterMethodAction,\n  setExtendedPublicKeyImporterExtendedPublicKey: setExtendedPublicKeyImporterExtendedPublicKeyAction,\n  setExtendedPublicKeyImporterBIP32Path: setExtendedPublicKeyImporterBIP32PathAction,\n  setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprint: setExtendedPublicKeyImporterExtendedPublicKeyRootFingerprintAction,\n  setExtendedPublicKeyImporterName: setExtendedPublicKeyImporterNameAction,\n  setExtendedPublicKeyImporterFinalized: setExtendedPublicKeyImporterFinalizedAction,\n  setExtendedPublicKeyImporterVisible: setExtendedPublicKeyImporterVisibleAction,\n  updateWalletNameAction: updateWalletNameActionImport,\n  ...wrappedActions({\n    setClientType: SET_CLIENT_TYPE,\n    setClientUrl: SET_CLIENT_URL,\n    setClientUsername: SET_CLIENT_USERNAME,\n    setClientPassword: SET_CLIENT_PASSWORD,\n  }),\n  updateDepositNode: updateDepositSliceAction,\n  updateChangeNode: updateChangeSliceAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateWallet);\n","import { wrappedNumberedActions } from \"./utils\";\n\nexport const SET_PUBLIC_KEY_IMPORTER_NAME = \"SET_PUBLIC_KEY_IMPORTER_NAME\";\nexport const RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH =\n  \"RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH\";\nexport const SET_PUBLIC_KEY_IMPORTER_BIP32_PATH =\n  \"SET_PUBLIC_KEY_IMPORTER_BIP32_PATH\";\nexport const SET_PUBLIC_KEY_IMPORTER_METHOD = \"SET_PUBLIC_KEY_IMPORTER_METHOD\";\nexport const SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY =\n  \"SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY\";\nexport const SET_PUBLIC_KEY_IMPORTER_FINALIZED =\n  \"SET_PUBLIC_KEY_IMPORTER_FINALIZED\";\nexport const MOVE_PUBLIC_KEY_IMPORTER_UP = \"MOVE_PUBLIC_KEY_IMPORTER_UP\";\nexport const MOVE_PUBLIC_KEY_IMPORTER_DOWN = \"MOVE_PUBLIC_KEY_IMPORTER_DOWN\";\nexport const SORT_PUBLIC_KEY_IMPORTERS = \"SORT_PUBLIC_KEY_IMPORTERS\";\nexport const UPDATE_MULTISIG_ADDRESS = \"UPDATE_MULTISIG_ADDRESS\";\n\nexport function sortPublicKeyImporters() {\n  return {\n    type: SORT_PUBLIC_KEY_IMPORTERS,\n  };\n}\n\nexport function setMultisigAddress(address) {\n  return {\n    type: UPDATE_MULTISIG_ADDRESS,\n    value: address,\n  };\n}\n\nexport const {\n  setPublicKeyImporterName,\n  setPublicKeyImporterBIP32Path,\n  resetPublicKeyImporterBIP32Path,\n  setPublicKeyImporterMethod,\n  setPublicKeyImporterPublicKey,\n  setPublicKeyImporterFinalized,\n  movePublicKeyImporterUp,\n  movePublicKeyImporterDown,\n} = wrappedNumberedActions({\n  setPublicKeyImporterName: SET_PUBLIC_KEY_IMPORTER_NAME,\n  resetPublicKeyImporterBIP32Path: RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  setPublicKeyImporterBIP32Path: SET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  setPublicKeyImporterMethod: SET_PUBLIC_KEY_IMPORTER_METHOD,\n  setPublicKeyImporterPublicKey: SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY,\n  setPublicKeyImporterFinalized: SET_PUBLIC_KEY_IMPORTER_FINALIZED,\n  movePublicKeyImporterUp: MOVE_PUBLIC_KEY_IMPORTER_UP,\n  movePublicKeyImporterDown: MOVE_PUBLIC_KEY_IMPORTER_DOWN,\n});\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  generateMultisigFromPublicKeys,\n  scriptToHex,\n  multisigRedeemScript,\n  multisigWitnessScript,\n  validatePublicKey,\n} from \"unchained-bitcoin\";\nimport {\n  Box,\n  Grid,\n  Button,\n  Card,\n  CardHeader,\n  CardContent,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport { externalLink, downloadFile } from \"../../utils\";\n\n// Actions\nimport {\n  sortPublicKeyImporters as sortPublicKeyImportersAction,\n  setMultisigAddress as setMultisigAddressAction,\n} from \"../../actions/publicKeyImporterActions\";\n\n// Components\nimport MultisigDetails from \"../MultisigDetails\";\nimport Conflict from \"./Conflict\";\n\nclass AddressGenerator extends React.Component {\n  isInConflict = () => {\n    const { publicKeyImporters } = this.props;\n    return Object.values(publicKeyImporters).some(\n      (importer) => importer.conflict\n    );\n  };\n\n  publicKeyCount = () => {\n    const { publicKeyImporters, addressType } = this.props;\n    return Object.values(publicKeyImporters).filter(\n      ({ publicKey, finalized }) => {\n        return finalized && !validatePublicKey(publicKey, addressType);\n      }\n    ).length;\n  };\n\n  publicKeysAreCanonicallySorted = () => {\n    const { publicKeyImporters } = this.props;\n    const publicKeys = Object.values(publicKeyImporters)\n      .map((publicKeyImporter) => publicKeyImporter.publicKey)\n      .filter((publicKey) => publicKey !== \"\");\n    const sortedPublicKeys = Object.values(publicKeyImporters)\n      .map((publicKeyImporter) => publicKeyImporter.publicKey)\n      .filter((publicKey) => publicKey !== \"\")\n      .sort(); // sort mutates the array\n    const sorted =\n      publicKeys.filter((publicKey, index) => {\n        return publicKey === sortedPublicKeys[index];\n      }).length === publicKeys.length;\n    return sorted;\n  };\n\n  canonicallySortPublicKeys = () => {\n    const { sortPublicKeyImporters } = this.props;\n    sortPublicKeyImporters();\n  };\n\n  generateMultisig = () => {\n    const {\n      network,\n      publicKeyImporters,\n      totalSigners,\n      requiredSigners,\n      addressType,\n      setMultisigAddress,\n    } = this.props;\n    const publicKeys = [];\n    for (\n      let publicKeyImporterNum = 1;\n      publicKeyImporterNum <= totalSigners;\n      publicKeyImporterNum += 1\n    ) {\n      publicKeys.push(publicKeyImporters[publicKeyImporterNum].publicKey);\n    }\n    const multisig = generateMultisigFromPublicKeys(\n      network,\n      addressType,\n      requiredSigners,\n      ...publicKeys\n    );\n    setMultisigAddress(multisig.address);\n    return multisig;\n  };\n\n  downloadAddressDetails = (event) => {\n    event.preventDefault();\n    const multisig = this.generateMultisig();\n    const body = this.addressDetailsText(multisig);\n    const filename = this.addressDetailsFilename(multisig);\n    downloadFile(body, filename);\n  };\n\n  addressDetailsFilename = (multisig) => {\n    const { totalSigners, requiredSigners, addressType } = this.props;\n    return `bitcoin-${requiredSigners}-of-${totalSigners}-${addressType}-${multisig.address}.txt`;\n  };\n\n  addressDetailsText = (multisig) => {\n    const { addressType, network, totalSigners, requiredSigners } = this.props;\n    const redeemScript = multisigRedeemScript(multisig);\n    const witnessScript = multisigWitnessScript(multisig);\n    const redeemScriptLine = redeemScript\n      ? `Redeem Script: ${scriptToHex(redeemScript)}`\n      : \"\";\n    const witnessScriptLine = witnessScript\n      ? `Witness Script: ${scriptToHex(witnessScript)}`\n      : \"\";\n    const scriptsSpacer = redeemScript && witnessScript ? \"\\n\\n\" : \"\";\n    return `Address: ${multisig.address}\n\nType: ${addressType}\n\nNetwork: ${network}\n\nQuorum: ${requiredSigners}-of-${totalSigners}\n\nBIP32 Paths:\n${this.publicKeyImporterBIP32Paths()}\n\n${redeemScriptLine}${scriptsSpacer}${witnessScriptLine}\n`;\n  };\n\n  publicKeyImporterBIP32Paths = () => {\n    const { totalSigners } = this.props;\n    const publicKeyImporterBIP32Paths = [];\n    for (\n      let publicKeyImporterNum = 1;\n      publicKeyImporterNum <= totalSigners;\n      publicKeyImporterNum += 1\n    ) {\n      publicKeyImporterBIP32Paths.push(\n        this.publicKeyImporterBIP32Path(publicKeyImporterNum)\n      );\n    }\n    return publicKeyImporterBIP32Paths.join(\"\\n\");\n  };\n\n  publicKeyImporterBIP32Path = (number) => {\n    const { publicKeyImporters } = this.props;\n    const publicKeyImporter = publicKeyImporters[number];\n    const bip32Path =\n      publicKeyImporter.method === \"text\"\n        ? \"Unknown (make sure you have written this down previously!)\"\n        : publicKeyImporter.bip32Path;\n    return `  * ${publicKeyImporter.name}: ${bip32Path}: ${publicKeyImporter.publicKey}`;\n  };\n\n  title = () => {\n    const { totalSigners, requiredSigners, addressType } = this.props;\n    return (\n      <Grid container justify=\"space-between\">\n        <Grid item>\n          {requiredSigners}\n          -of-\n          {totalSigners} Multisig {addressType}{\" \"}\n        </Grid>\n        <Grid item>\n          <small>{`Public Keys: ${this.publicKeyCount()}/${totalSigners}`}</small>\n        </Grid>\n      </Grid>\n    );\n  };\n\n  body() {\n    const { totalSigners } = this.props;\n    if (this.publicKeyCount() === totalSigners) {\n      const multisig = this.generateMultisig();\n\n      const canonicallySorted = this.publicKeysAreCanonicallySorted();\n      return (\n        <div>\n          {this.isInConflict() && <Conflict />}\n          {!canonicallySorted && (\n            <Grid container justify=\"space-between\">\n              <Grid item md={8}>\n                <FormHelperText error>\n                  WARNING: These public keys are not in the standard{\" \"}\n                  {externalLink(\n                    \"https://github.com/bitcoin/bips/blob/master/bip-0067.mediawiki\",\n                    \"BIP67 order\"\n                  )}\n                  .\n                </FormHelperText>\n              </Grid>\n              <Grid item md={4}>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  onClick={this.canonicallySortPublicKeys}\n                >\n                  Sort Public Keys\n                </Button>\n              </Grid>\n            </Grid>\n          )}\n\n          <Box mt={2}>\n            <MultisigDetails multisig={multisig} />\n          </Box>\n\n          <Box mt={2}>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={this.downloadAddressDetails}\n            >\n              Download Address Details\n            </Button>\n          </Box>\n        </div>\n      );\n    }\n    return (\n      <p>\n        {`Once you have imported all ${totalSigners} public keys, `}\n        {\"your address details will be displayed here.\"}\n      </p>\n    );\n  }\n\n  render() {\n    return (\n      <Card>\n        <CardHeader title={this.title()} />\n        <CardContent>{this.body()}</CardContent>\n      </Card>\n    );\n  }\n}\n\nAddressGenerator.propTypes = {\n  network: PropTypes.string.isRequired,\n  totalSigners: PropTypes.number.isRequired,\n  requiredSigners: PropTypes.number.isRequired,\n  addressType: PropTypes.string.isRequired,\n  publicKeyImporters: PropTypes.shape({}).isRequired,\n  sortPublicKeyImporters: PropTypes.func.isRequired,\n  setMultisigAddress: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.settings,\n    ...state.address,\n  };\n}\n\nconst mapDispatchToProps = {\n  sortPublicKeyImporters: sortPublicKeyImportersAction,\n  setMultisigAddress: setMultisigAddressAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddressGenerator);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { validatePublicKey } from \"unchained-bitcoin\";\n\n// Components\nimport { Button, TextField, Box } from \"@material-ui/core\";\n\nclass TextPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      error: \"\",\n      publicKey: \"\",\n    };\n  }\n\n  render = () => {\n    const { error, publicKey } = this.state;\n    return (\n      <Box mt={2}>\n        <TextField\n          fullWidth\n          name=\"publicKey\"\n          label=\"Public Key\"\n          value={publicKey}\n          onChange={this.handleChange}\n          error={this.hasError()}\n          helperText={error}\n        />\n\n        <Box mt={2}>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            size=\"large\"\n            onClick={this.import}\n            disabled={publicKey === \"\" || this.hasError()}\n          >\n            Add Public Key\n          </Button>\n        </Box>\n      </Box>\n    );\n  };\n\n  import = () => {\n    const { validateAndSetPublicKey } = this.props;\n    const { publicKey } = this.state;\n    validateAndSetPublicKey(publicKey, this.setError);\n  };\n\n  hasError = () => {\n    const { error } = this.state;\n    return error !== \"\";\n  };\n\n  setError = (value) => {\n    this.setState({ error: value });\n  };\n\n  handleChange = (event) => {\n    const publicKey = event.target.value;\n    const { addressType } = this.props;\n    const error = validatePublicKey(publicKey, addressType);\n    this.setState({ publicKey, error });\n  };\n}\n\nTextPublicKeyImporter.propTypes = {\n  publicKeyImporter: PropTypes.shape({}).isRequired,\n  validateAndSetPublicKey: PropTypes.func.isRequired,\n  addressType: PropTypes.string.isRequired,\n};\n\nexport default TextPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  convertExtendedPublicKey,\n  validateExtendedPublicKey,\n  validateExtendedPublicKeyForNetwork,\n  deriveChildPublicKey,\n} from \"unchained-bitcoin\";\n\n// Components\nimport {\n  Button,\n  TextField,\n  FormHelperText,\n  Box,\n  Grid,\n} from \"@material-ui/core\";\n\nconst DEFAULT_BIP32_PATH = \"m/0\";\n\nclass ExtendedPublicKeyPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      extendedPublicKey: \"\",\n      extendedPublicKeyError: \"\",\n      bip32PathError: \"\",\n      conversionMessage: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    this.setBIP32PathToDefault();\n  };\n\n  render = () => {\n    const { publicKeyImporter } = this.props;\n    const {\n      extendedPublicKey,\n      extendedPublicKeyError,\n      bip32PathError,\n      conversionMessage,\n    } = this.state;\n    return (\n      <div>\n        <Box mt={2}>\n          <TextField\n            fullWidth\n            name=\"extendedPublicKey\"\n            label=\"Extended Public Key\"\n            value={extendedPublicKey}\n            onChange={this.handleExtendedPublicKeyChange}\n            error={this.hasExtendedPublicKeyError()}\n            helperText={extendedPublicKeyError}\n          />\n        </Box>\n        {conversionMessage !== \"\" && (\n          <Box mb={2}>\n            <FormHelperText>\n              {conversionMessage}, this may indicate an invalid network setting,\n              if so correct setting, remove key and try again.\n            </FormHelperText>\n          </Box>\n        )}\n\n        <Box mt={2}>\n          <Grid container>\n            <Grid item md={10}>\n              <TextField\n                fullWidth\n                name=\"bip32Path\"\n                label=\"BIP32 Path (relative to xpub)\"\n                type=\"text\"\n                value={publicKeyImporter.bip32Path}\n                onChange={this.handleBIP32PathChange}\n                error={this.hasBIP32PathError()}\n                helperText={bip32PathError}\n              />\n              <FormHelperText>\n                Use the default value if you don&rsquo;t understand BIP32 paths.\n              </FormHelperText>\n            </Grid>\n            <Grid item md={2}>\n              {!this.bip32PathIsDefault() && (\n                <Button\n                  type=\"button\"\n                  variant=\"contained\"\n                  size=\"small\"\n                  onClick={this.resetBIP32Path}\n                >\n                  Default\n                </Button>\n              )}\n            </Grid>\n          </Grid>\n          <Box mt={2}>\n            <Button\n              type=\"button\"\n              variant=\"contained\"\n              color=\"primary\"\n              size=\"large\"\n              onClick={this.import}\n              disabled={extendedPublicKey === \"\" || this.hasError()}\n            >\n              Import Public Key\n            </Button>\n          </Box>\n        </Box>\n      </div>\n    );\n  };\n\n  import = () => {\n    const { network, publicKeyImporter, validateAndSetPublicKey } = this.props;\n    const { extendedPublicKey } = this.state;\n    const publicKey = deriveChildPublicKey(\n      extendedPublicKey,\n      publicKeyImporter.bip32Path,\n      network\n    );\n    validateAndSetPublicKey(publicKey, (bip32PathError) =>\n      this.setState({ bip32PathError })\n    );\n  };\n\n  setBIP32PathToDefault = () => {\n    const { validateAndSetBIP32Path } = this.props;\n    validateAndSetBIP32Path(\n      DEFAULT_BIP32_PATH,\n      () => {},\n      () => {}\n    );\n  };\n\n  hasBIP32PathError = () => {\n    const { bip32PathError } = this.state;\n    return bip32PathError !== \"\";\n  };\n\n  hasExtendedPublicKeyError = () => {\n    const { extendedPublicKeyError } = this.state;\n    return extendedPublicKeyError !== \"\";\n  };\n\n  hasError = () => this.hasBIP32PathError() || this.hasExtendedPublicKeyError();\n\n  setBIP32PathError = (value) => {\n    this.setState({ bip32PathError: value });\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(bip32Path, () => {}, this.setBIP32PathError, {\n      mode: \"unhardened\",\n    });\n  };\n\n  bip32PathIsDefault = () => {\n    const { publicKeyImporter } = this.props;\n    return publicKeyImporter.bip32Path === DEFAULT_BIP32_PATH;\n  };\n\n  resetBIP32Path = () => {\n    this.setBIP32PathToDefault();\n    this.setBIP32PathError(\"\");\n  };\n\n  handleExtendedPublicKeyChange = (event) => {\n    const { network } = this.props;\n\n    const extendedPublicKey = event.target.value;\n\n    const networkError = validateExtendedPublicKeyForNetwork(\n      extendedPublicKey,\n      network\n    );\n    let actualExtendedPublicKey = extendedPublicKey;\n    if (networkError !== \"\") {\n      try {\n        actualExtendedPublicKey = convertExtendedPublicKey(\n          extendedPublicKey,\n          network === \"testnet\" ? \"tpub\" : \"xpub\"\n        );\n      } catch (error) {\n        this.setState({\n          extendedPublicKey,\n          extendedPublicKeyError: error.message,\n          conversionMessage: \"\",\n        });\n        return;\n      }\n    }\n\n    const validationError = validateExtendedPublicKey(\n      actualExtendedPublicKey,\n      network\n    );\n    if (validationError !== \"\") {\n      this.setState({\n        extendedPublicKey,\n        extendedPublicKeyError: validationError,\n        conversionMessage: \"\",\n      });\n      return;\n    }\n    const conversionMessage =\n      actualExtendedPublicKey === extendedPublicKey\n        ? \"\"\n        : `Your extended public key has been converted from ${extendedPublicKey.slice(\n            0,\n            4\n          )} to ${actualExtendedPublicKey.slice(0, 4)}`;\n\n    this.setState({\n      extendedPublicKey: actualExtendedPublicKey,\n      extendedPublicKeyError: \"\",\n      conversionMessage,\n    });\n  };\n}\n\nExtendedPublicKeyPublicKeyImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  publicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  validateAndSetPublicKey: PropTypes.func.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n};\n\nexport default ExtendedPublicKeyPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { HERMIT, ExportPublicKey } from \"unchained-wallets\";\n\n// Components\nimport { FormGroup, FormHelperText } from \"@material-ui/core\";\n\nimport HermitReader from \"../Hermit/HermitReader\";\n\nclass HermitPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      publicKeyError: \"\",\n    };\n  }\n\n  componentDidMount = () => {\n    const { resetBIP32Path } = this.props;\n    resetBIP32Path();\n  };\n\n  interaction = () => {\n    const { network, publicKeyImporter } = this.props;\n    return ExportPublicKey({\n      keystore: HERMIT,\n      network,\n      bip32Path: publicKeyImporter.bip32Path,\n    });\n  };\n\n  render = () => {\n    const { disableChangeMethod } = this.props;\n    const { publicKeyError } = this.state;\n    return (\n      <FormGroup>\n        <HermitReader\n          startText=\"Import Public Key\"\n          interaction={this.interaction()}\n          onStart={disableChangeMethod}\n          onSuccess={this.import}\n          onClear={this.onClear}\n        />\n        <FormHelperText error>{publicKeyError}</FormHelperText>\n      </FormGroup>\n    );\n  };\n\n  setError = (value) => {\n    this.setState({ publicKeyError: value });\n  };\n\n  import = (data) => {\n    const {\n      validateAndSetBIP32Path,\n      validateAndSetPublicKey,\n      enableChangeMethod,\n    } = this.props;\n    enableChangeMethod();\n    const { pubkey, bip32Path } = data;\n    validateAndSetBIP32Path(\n      bip32Path,\n      () => {\n        validateAndSetPublicKey(pubkey, this.setError);\n      },\n      this.setError\n    );\n  };\n\n  onClear = () => {\n    const { reset, enableChangeMethod } = this.props;\n    reset(true); // clear BIP32 path\n    this.setError(\"\");\n    enableChangeMethod();\n  };\n}\n\nHermitPublicKeyImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  publicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n  }).isRequired,\n  validateAndSetPublicKey: PropTypes.func.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  reset: PropTypes.func.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  enableChangeMethod: PropTypes.func.isRequired,\n  disableChangeMethod: PropTypes.func.isRequired,\n};\n\nexport default HermitPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  UNSUPPORTED,\n  PENDING,\n  ACTIVE,\n  ERROR,\n  ExportPublicKey,\n} from \"unchained-wallets\";\n\n// Components\nimport {\n  Button,\n  TextField,\n  FormHelperText,\n  Box,\n  Grid,\n} from \"@material-ui/core\";\n\nimport InteractionMessages from \"../InteractionMessages\";\n\nclass HardwareWalletPublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      publicKeyError: \"\",\n      bip32PathError: \"\",\n      status: this.interaction().isSupported() ? PENDING : UNSUPPORTED,\n    };\n  }\n\n  componentDidMount = () => {\n    this.resetBIP32Path();\n  };\n\n  interaction = () => {\n    const { network, publicKeyImporter } = this.props;\n    return ExportPublicKey({\n      network,\n      keystore: publicKeyImporter.method,\n      bip32Path: publicKeyImporter.bip32Path,\n    });\n  };\n\n  render = () => {\n    const { publicKeyImporter } = this.props;\n    const { status, publicKeyError } = this.state;\n    const interaction = this.interaction();\n    if (status === UNSUPPORTED) {\n      return (\n        <FormHelperText error>\n          {interaction.messageTextFor({ status })}\n        </FormHelperText>\n      );\n    }\n    return (\n      <Box mt={2}>\n        <Grid container>\n          <Grid item md={6}>\n            <TextField\n              fullWidth\n              label=\"BIP32 Path\"\n              value={publicKeyImporter.bip32Path}\n              onChange={this.handleBIP32PathChange}\n              disabled={status !== PENDING}\n              error={this.hasBIP32PathError()}\n              helperText={this.bip32PathError()}\n            />\n          </Grid>\n          <Grid item md={6}>\n            {!this.bip32PathIsDefault() && (\n              <Button\n                type=\"button\"\n                variant=\"contained\"\n                size=\"small\"\n                onClick={this.resetBIP32Path}\n                disabled={status !== PENDING}\n              >\n                Default\n              </Button>\n            )}\n          </Grid>\n        </Grid>\n        <FormHelperText>\n          Use the default value if you don&rsquo;t understand BIP32 paths.\n        </FormHelperText>\n        <Box mt={2}>\n          <Button\n            type=\"button\"\n            variant=\"contained\"\n            color=\"primary\"\n            size=\"large\"\n            onClick={this.import}\n            disabled={this.hasBIP32PathError() || status === ACTIVE}\n          >\n            Import Public Key\n          </Button>\n        </Box>\n        <InteractionMessages\n          messages={interaction.messagesFor({ state: status })}\n          excludeCodes={[\"bip32\"]}\n        />\n        <FormHelperText error>{publicKeyError}</FormHelperText>\n      </Box>\n    );\n  };\n\n  import = async () => {\n    const {\n      validateAndSetPublicKey,\n      enableChangeMethod,\n      disableChangeMethod,\n    } = this.props;\n    disableChangeMethod();\n    this.setState({ publicKeyError: \"\", status: ACTIVE });\n    try {\n      const publicKey = await this.interaction().run();\n      validateAndSetPublicKey(publicKey, (error) => {\n        this.setState({ publicKeyError: error, status: PENDING });\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      this.setState({ publicKeyError: e.message, status: PENDING });\n    }\n\n    enableChangeMethod();\n  };\n\n  hasBIP32PathError = () => {\n    const { bip32PathError, status } = this.state;\n    return (\n      bip32PathError !== \"\" ||\n      this.interaction().hasMessagesFor({\n        state: status,\n        level: ERROR,\n        code: \"bip32\",\n      })\n    );\n  };\n\n  bip32PathError = () => {\n    const { bip32PathError, status } = this.state;\n    if (bip32PathError !== \"\") {\n      return bip32PathError;\n    }\n    return this.interaction().messageTextFor({\n      state: status,\n      level: ERROR,\n      code: \"bip32\",\n    });\n  };\n\n  setBIP32PathError = (value) => {\n    this.setState({ bip32PathError: value });\n  };\n\n  handleBIP32PathChange = (event) => {\n    const { validateAndSetBIP32Path } = this.props;\n    const bip32Path = event.target.value;\n    validateAndSetBIP32Path(bip32Path, () => {}, this.setBIP32PathError);\n  };\n\n  bip32PathIsDefault = () => {\n    const { publicKeyImporter, defaultBIP32Path } = this.props;\n    return publicKeyImporter.bip32Path === defaultBIP32Path;\n  };\n\n  resetBIP32Path = () => {\n    const { resetBIP32Path } = this.props;\n    this.setBIP32PathError(\"\");\n    resetBIP32Path();\n  };\n}\n\nHardwareWalletPublicKeyImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  publicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    method: PropTypes.string,\n  }).isRequired,\n  validateAndSetPublicKey: PropTypes.func.isRequired,\n  validateAndSetBIP32Path: PropTypes.func.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n  enableChangeMethod: PropTypes.func.isRequired,\n  disableChangeMethod: PropTypes.func.isRequired,\n};\n\nexport default HardwareWalletPublicKeyImporter;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { validateBIP32Path, validatePublicKey } from \"unchained-bitcoin\";\nimport { TREZOR, LEDGER, HERMIT } from \"unchained-wallets\";\n\n// Components\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  FormControl,\n  Select,\n  MenuItem,\n  InputLabel,\n  Button,\n  Grid,\n  Box,\n} from \"@material-ui/core\";\nimport { ArrowUpward, ArrowDownward } from \"@material-ui/icons\";\n\nimport Copyable from \"../Copyable\";\nimport TextPublicKeyImporter from \"./TextPublicKeyImporter\";\nimport ExtendedPublicKeyPublicKeyImporter from \"./ExtendedPublicKeyPublicKeyImporter\";\nimport HermitPublicKeyImporter from \"./HermitPublicKeyImporter\";\nimport HardwareWalletPublicKeyImporter from \"./HardwareWalletPublicKeyImporter\";\nimport EditableName from \"../EditableName\";\nimport Conflict from \"./Conflict\";\n\n// Actions\nimport {\n  setPublicKeyImporterName,\n  setPublicKeyImporterBIP32Path,\n  resetPublicKeyImporterBIP32Path,\n  setPublicKeyImporterMethod,\n  setPublicKeyImporterPublicKey,\n  setPublicKeyImporterFinalized,\n  movePublicKeyImporterUp,\n  movePublicKeyImporterDown,\n} from \"../../actions/publicKeyImporterActions\";\n\nconst XPUB = \"xpub\";\nconst TEXT = \"text\";\n\nclass PublicKeyImporter extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      disableChangeMethod: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const { number, setFinalized, addressType, publicKeyImporter } = this.props;\n    if (\n      prevProps.addressType !== addressType &&\n      validatePublicKey(publicKeyImporter.publicKey, addressType)\n    ) {\n      setFinalized(number, false);\n    }\n  }\n\n  title = () => {\n    const { number, totalSigners, publicKeyImporter, setName } = this.props;\n    return (\n      <Grid container justify=\"space-between\">\n        <Grid item>\n          <EditableName\n            number={number}\n            name={publicKeyImporter.name}\n            setName={setName}\n          />\n        </Grid>\n        <Grid item>\n          <Grid container justify=\"flex-end\">\n            <Button\n              type=\"button\"\n              variant=\"contained\"\n              onClick={this.moveUp}\n              disabled={number === 1}\n            >\n              <ArrowUpward />\n            </Button>\n            <span>&nbsp;</span>\n            <Button\n              type=\"button\"\n              variant=\"contained\"\n              onClick={this.moveDown}\n              disabled={number === totalSigners}\n            >\n              <ArrowDownward />\n            </Button>\n          </Grid>\n        </Grid>\n      </Grid>\n    );\n  };\n\n  renderImport = () => {\n    const { publicKeyImporter, number } = this.props;\n    const { disableChangeMethod } = this.state;\n    const labelId = `public-key-${number}-importer-select-label`;\n    return (\n      <div>\n        <FormControl fullWidth>\n          <InputLabel id={labelId}>Select Method</InputLabel>\n\n          <Select\n            labelId={labelId}\n            id={`public-key-${number}-importer-select`}\n            disabled={disableChangeMethod}\n            value={publicKeyImporter.method}\n            onChange={this.handleMethodChange}\n          >\n            <MenuItem value=\"\">{\"< Select method >\"}</MenuItem>\n            <MenuItem value={TREZOR}>Trezor</MenuItem>\n            <MenuItem value={LEDGER}>Ledger</MenuItem>\n            <MenuItem value={HERMIT}>Hermit</MenuItem>\n            <MenuItem value={XPUB}>Derive from extended public key</MenuItem>\n            <MenuItem value={TEXT}>Enter as text</MenuItem>\n          </Select>\n        </FormControl>\n\n        {this.renderImportByMethod()}\n      </div>\n    );\n  };\n\n  renderImportByMethod = () => {\n    const {\n      publicKeyImporter,\n      network,\n      addressType,\n      defaultBIP32Path,\n    } = this.props;\n    if (\n      publicKeyImporter.method === TREZOR ||\n      publicKeyImporter.method === LEDGER\n    ) {\n      return (\n        <HardwareWalletPublicKeyImporter\n          publicKeyImporter={publicKeyImporter}\n          validateAndSetPublicKey={this.validateAndSetPublicKey}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          resetBIP32Path={this.resetBIP32Path}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n          addressType={addressType}\n          defaultBIP32Path={defaultBIP32Path}\n          network={network}\n        />\n      );\n    }\n    if (publicKeyImporter.method === HERMIT) {\n      return (\n        <HermitPublicKeyImporter\n          publicKeyImporter={publicKeyImporter}\n          validateAndSetPublicKey={this.validateAndSetPublicKey}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          resetBIP32Path={this.resetBIP32Path}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n          reset={this.reset}\n        />\n      );\n    }\n    if (publicKeyImporter.method === XPUB) {\n      return (\n        <ExtendedPublicKeyPublicKeyImporter\n          network={network}\n          publicKeyImporter={publicKeyImporter}\n          validateAndSetPublicKey={this.validateAndSetPublicKey}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n        />\n      );\n    }\n    if (publicKeyImporter.method === TEXT) {\n      return (\n        <TextPublicKeyImporter\n          publicKeyImporter={publicKeyImporter}\n          validateAndSetPublicKey={this.validateAndSetPublicKey}\n          addressType={addressType}\n        />\n      );\n    }\n    return null;\n  };\n\n  //\n  // Method\n  //\n\n  handleMethodChange = (event) => {\n    const { number, setMethod, setPublicKey } = this.props;\n    setMethod(number, event.target.value);\n    setPublicKey(number, \"\");\n  };\n\n  disableChangeMethod = () => {\n    this.setState({ disableChangeMethod: true });\n  };\n\n  enableChangeMethod = () => {\n    this.setState({ disableChangeMethod: false });\n  };\n\n  //\n  // State\n  //\n\n  finalize = () => {\n    const { number, setFinalized } = this.props;\n    setFinalized(number, true);\n  };\n\n  reset = (resetBIP32Path) => {\n    const { number, setPublicKey, setFinalized } = this.props;\n    setPublicKey(number, \"\");\n    setFinalized(number, false);\n    if (resetBIP32Path) {\n      this.resetBIP32Path();\n    }\n  };\n\n  //\n  // Position\n  //\n\n  moveUp = (event) => {\n    const { moveUp, number } = this.props;\n    event.preventDefault();\n    moveUp(number);\n  };\n\n  moveDown = (event) => {\n    const { moveDown, number } = this.props;\n    event.preventDefault();\n    moveDown(number);\n  };\n\n  //\n  // BIP32 Path\n  //\n\n  renderBIP32Path = () => {\n    const { publicKeyImporter } = this.props;\n    if (publicKeyImporter.method !== TEXT) {\n      return (\n        <Box mt={4}>\n          <p>The BIP32 path for this public key is:</p>\n          <Grid container justify=\"center\">\n            <Copyable text={publicKeyImporter.bip32Path} code />\n          </Grid>\n          <Box mt={4}>\n            <p>\n              You will need this BIP32 path to sign for this key later.{\" \"}\n              <strong>Write down this BIP32 path!</strong>\n            </p>\n          </Box>\n        </Box>\n      );\n    }\n    return null;\n  };\n\n  validateAndSetBIP32Path = (bip32Path, callback, errback, options) => {\n    const { number, setBIP32Path } = this.props;\n    const error = validateBIP32Path(bip32Path, options);\n    setBIP32Path(number, bip32Path);\n    if (error) {\n      errback(error);\n    } else {\n      errback(\"\");\n      callback();\n    }\n  };\n\n  resetBIP32Path = () => {\n    const { number, resetBIP32Path } = this.props;\n    resetBIP32Path(number);\n  };\n\n  //\n  // Public Key\n  //\n\n  renderPublicKey = () => {\n    const { publicKeyImporter } = this.props;\n    return (\n      <div>\n        <p>The following public key was imported:</p>\n        <Grid container justify=\"center\">\n          <Copyable text={publicKeyImporter.publicKey} showIcon code />\n        </Grid>\n        {this.renderBIP32Path()}\n        <Box mt={2}>\n          <Button\n            variant=\"contained\"\n            color=\"secondary\"\n            size=\"small\"\n            onClick={() => {\n              this.reset(publicKeyImporter.method === HERMIT);\n            }}\n          >\n            Remove Public Key\n          </Button>\n        </Box>\n      </div>\n    );\n  };\n\n  validateAndSetPublicKey = (publicKey, errback, callback) => {\n    const { number, publicKeyImporters, setPublicKey } = this.props;\n    const error = validatePublicKey(publicKey);\n    setPublicKey(number, publicKey);\n    if (error) {\n      if (errback) errback(error);\n    } else if (\n      publicKey &&\n      Object.values(publicKeyImporters).find(\n        (publicKeyImporter, publicKeyImporterIndex) =>\n          publicKeyImporterIndex !== number - 1 &&\n          publicKeyImporter.publicKey === publicKey\n      )\n    ) {\n      if (errback) errback(\"This public key has already been imported.\");\n    } else {\n      if (errback) errback(\"\");\n      this.finalize();\n      if (callback) callback();\n    }\n  };\n\n  render() {\n    const { publicKeyImporter, addressType } = this.props;\n    const publicKeyError = validatePublicKey(\n      publicKeyImporter.publicKey,\n      addressType\n    );\n    return (\n      <Card>\n        <CardHeader title={this.title()} />\n        <CardContent>\n          {publicKeyImporter.method &&\n            publicKeyImporter.method !== TEXT &&\n            publicKeyImporter.conflict && (\n              <Conflict message=\"Warning, BIP32 path is in conflict with the network and address type settings.  Do not proceed unless you are absolutely sure you know what you are doing!\" />\n            )}\n          {publicKeyError.includes(\n            \"does not support uncompressed public keys\"\n          ) && <Conflict message={publicKeyError} />}\n          {publicKeyImporter.finalized\n            ? this.renderPublicKey()\n            : this.renderImport()}\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nPublicKeyImporter.propTypes = {\n  network: PropTypes.string.isRequired,\n  totalSigners: PropTypes.number.isRequired,\n  number: PropTypes.number.isRequired,\n  publicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    conflict: PropTypes.bool,\n    finalized: PropTypes.bool,\n    method: PropTypes.string,\n    name: PropTypes.string,\n    publicKey: PropTypes.string,\n  }).isRequired,\n  publicKeyImporters: PropTypes.shape({}).isRequired,\n  defaultBIP32Path: PropTypes.string.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  addressType: PropTypes.string.isRequired,\n  setName: PropTypes.func.isRequired,\n  setBIP32Path: PropTypes.func.isRequired,\n  setMethod: PropTypes.func.isRequired,\n  setPublicKey: PropTypes.func.isRequired,\n  setFinalized: PropTypes.func.isRequired,\n  moveUp: PropTypes.func.isRequired,\n  moveDown: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state, ownProps) {\n  return {\n    ...state.settings,\n    ...state.address,\n    ...{ publicKeyImporter: state.address.publicKeyImporters[ownProps.number] },\n  };\n}\n\nconst mapDispatchToProps = {\n  setName: setPublicKeyImporterName,\n  setBIP32Path: setPublicKeyImporterBIP32Path,\n  resetBIP32Path: resetPublicKeyImporterBIP32Path,\n  setMethod: setPublicKeyImporterMethod,\n  setPublicKey: setPublicKeyImporterPublicKey,\n  setFinalized: setPublicKeyImporterFinalized,\n  moveUp: movePublicKeyImporterUp,\n  moveDown: movePublicKeyImporterDown,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PublicKeyImporter);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Grid, Box } from \"@material-ui/core\";\nimport { connect } from \"react-redux\";\n\n// Components\nimport NetworkPicker from \"../NetworkPicker\";\nimport QuorumPicker from \"../QuorumPicker\";\nimport AddressTypePicker from \"../AddressTypePicker\";\nimport AddressGenerator from \"./AddressGenerator\";\nimport PublicKeyImporter from \"./PublicKeyImporter\";\nimport ClientPicker from \"../ClientPicker\";\nimport ImportAddressesButton from \"../ImportAddressesButton\";\n\nimport { clientPropTypes } from \"../../proptypes\";\nimport \"../styles.css\";\n\nclass CreateAddress extends React.Component {\n  render = () => {\n    const { address, client } = this.props;\n    return (\n      <Box mt={2}>\n        <Grid container spacing={3}>\n          <Grid item xs={12}>\n            <h1>Address Generator</h1>\n          </Grid>\n          <Grid item md={8}>\n            {this.renderPublicKeyImporters()}\n            <Box mt={2}>\n              <AddressGenerator />\n            </Box>\n          </Grid>\n          <Grid item md={4}>\n            <Box>\n              <QuorumPicker />\n            </Box>\n            <Box mt={2}>\n              <AddressTypePicker />\n            </Box>\n            <Box mt={2}>\n              <NetworkPicker />\n            </Box>\n            <Box mt={2}>\n              <ClientPicker\n                publicNotes={\n                  <span>\n                    If you plan to use this address with your own bitcoind node\n                    you can import the address created here by switching for\n                    &quot;Public&quot; to &quot;Private&quot;. Otherwise no\n                    action is needed here.\n                  </span>\n                }\n                privateNotes={\n                  <div>\n                    <ImportAddressesButton\n                      addresses={[address]}\n                      client={client}\n                    />\n                  </div>\n                }\n              />\n            </Box>\n          </Grid>\n        </Grid>\n      </Box>\n    );\n  };\n\n  renderPublicKeyImporters = () => {\n    const { totalSigners } = this.props;\n    const publicKeyImporters = [];\n    for (\n      let publicKeyImporterNum = 1;\n      publicKeyImporterNum <= totalSigners;\n      publicKeyImporterNum += 1\n    ) {\n      publicKeyImporters.push(\n        <Box key={publicKeyImporterNum} mt={publicKeyImporterNum === 1 ? 0 : 2}>\n          <PublicKeyImporter number={publicKeyImporterNum} />\n        </Box>\n      );\n    }\n    return publicKeyImporters;\n  };\n}\n\nfunction mapStateToProps(state) {\n  return {\n    ...{ totalSigners: state.settings.totalSigners },\n    ...state.address,\n    client: state.client,\n  };\n}\n\nCreateAddress.propTypes = {\n  address: PropTypes.string,\n  totalSigners: PropTypes.number.isRequired,\n  client: PropTypes.shape(clientPropTypes).isRequired,\n};\n\nCreateAddress.defaultProps = {\n  address: \"\",\n};\n\nexport default connect(mapStateToProps)(CreateAddress);\n","export const START_TEST_SUITE_RUN = \"START_TEST_SUITE_RUN\";\nexport const SET_CURRENT_TEST_RUN = \"SET_CURRENT_TEST_RUN\";\n\nexport function startTestSuiteRun() {\n  return {\n    type: START_TEST_SUITE_RUN,\n  };\n}\n\nexport function setCurrentTestRun(runIndex) {\n  return {\n    type: SET_CURRENT_TEST_RUN,\n    value: runIndex,\n  };\n}\n","export const SET_KEYSTORE = \"SET_KEYSTORE\";\nexport const SET_KEYSTORE_NOTE = \"SET_KEYSTORE_NOTE\";\nexport const SET_KEYSTORE_STATUS = \"SET_KEYSTORE_STATUS\";\n\nexport function setKeystore(keystoreType, version) {\n  return {\n    type: SET_KEYSTORE,\n    keystoreType,\n    version,\n  };\n}\n\nexport function setKeystoreNote(text) {\n  return {\n    type: SET_KEYSTORE_NOTE,\n    value: text,\n  };\n}\n\nexport function setKeystoreStatus(status) {\n  return {\n    type: SET_KEYSTORE_STATUS,\n    value: status,\n  };\n}\n","export const START_TEST_RUN = \"START_TEST_RUN\";\nexport const END_TEST_RUN = \"END_TEST_RUN\";\nexport const RESET_TEST_RUN = \"RESET_TEST_RUN\";\nexport const SET_TEST_RUN_NOTE = \"SET_TEST_RUN_NOTE\";\n\nexport function startTestRun(testRunIndex) {\n  return {\n    type: START_TEST_RUN,\n    testRunIndex,\n  };\n}\n\nexport function endTestRun(testRunIndex, status, message) {\n  return {\n    type: END_TEST_RUN,\n    testRunIndex,\n    status,\n    message,\n  };\n}\n\nexport function resetTestRun(testRunIndex) {\n  return {\n    type: RESET_TEST_RUN,\n    testRunIndex,\n  };\n}\n\nexport function setTestRunNote(testRunIndex, text) {\n  return {\n    type: SET_TEST_RUN_NOTE,\n    testRunIndex,\n    note: text,\n  };\n}\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { PropTypes } from \"prop-types\";\n\nimport { TextField } from \"@material-ui/core\";\nimport { setKeystoreNote } from \"../../actions/keystoreActions\";\nimport { setTestRunNote } from \"../../actions/testRunActions\";\n\nconst KEYSTORE_MODE = \"keystore\";\nconst TEST_RUN_MODE = \"testRun\";\n\nclass NoteBase extends React.Component {\n  handleChange = (event) => {\n    const { setNote, mode, testRunIndex } = this.props;\n    const newNote = event.target.value;\n    if (mode === TEST_RUN_MODE) {\n      setNote(testRunIndex, newNote);\n    } else {\n      setNote(newNote);\n    }\n  };\n\n  render() {\n    const { note } = this.props;\n    return (\n      <TextField\n        name=\"notes\"\n        label=\"Notes\"\n        value={note}\n        onChange={this.handleChange}\n        multiline\n        fullWidth\n        rows={3}\n      />\n    );\n  }\n}\n\nNoteBase.propTypes = {\n  note: PropTypes.string.isRequired,\n  mode: PropTypes.string.isRequired,\n  setNote: PropTypes.func.isRequired,\n  testRunIndex: PropTypes.number,\n};\n\nNoteBase.defaultProps = {\n  testRunIndex: 0,\n};\n\nconst mapStateToKeystoreNoteProps = (state) => {\n  return {\n    note: state.keystore.note,\n    mode: KEYSTORE_MODE,\n  };\n};\n\nconst mapDispatchToKeystoreNoteProps = {\n  setNote: setKeystoreNote,\n};\n\nconst mapStateToTestRunNoteProps = (state) => {\n  return {\n    mode: TEST_RUN_MODE,\n    testRunIndex: state.testSuiteRun.currentTestRunIndex,\n    note:\n      state.testSuiteRun.testRuns[state.testSuiteRun.currentTestRunIndex].note,\n  };\n};\n\nconst mapDispatchToTestRunNoteProps = {\n  setNote: setTestRunNote,\n};\n\nconst KeystoreNote = connect(\n  mapStateToKeystoreNoteProps,\n  mapDispatchToKeystoreNoteProps\n)(NoteBase);\nconst TestRunNote = connect(\n  mapStateToTestRunNoteProps,\n  mapDispatchToTestRunNoteProps\n)(NoteBase);\n\nexport { KeystoreNote, TestRunNote };\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport {\n  TREZOR,\n  LEDGER,\n  HERMIT,\n  COLDCARD,\n  PENDING,\n  ACTIVE,\n  INDIRECT_KEYSTORES,\n  GetMetadata,\n} from \"unchained-wallets\";\n\nimport {\n  Box,\n  Grid,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  TextField,\n  Button,\n} from \"@material-ui/core\";\nimport * as keystoreActions from \"../../actions/keystoreActions\";\nimport { setErrorNotification as setErrorNotificationAction } from \"../../actions/errorNotificationActions\";\n\nimport { KeystoreNote } from \"./Note\";\nimport InteractionMessages from \"../InteractionMessages\";\n\nconst NO_VERSION_DETECTION = [\"\", ...Object.values(INDIRECT_KEYSTORES)];\n\nclass KeystorePickerBase extends React.Component {\n  detectVersion = async () => {\n    const {\n      type,\n      setKeystore,\n      setKeystoreStatus,\n      setErrorNotification,\n    } = this.props;\n    setKeystoreStatus(ACTIVE);\n    try {\n      const result = await this.interaction().run();\n      if (result) {\n        setKeystore(type, result.spec);\n      }\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      setErrorNotification(e.message);\n    }\n    setKeystoreStatus(PENDING);\n  };\n\n  interaction = () => {\n    const { type } = this.props;\n    return GetMetadata({ keystore: type });\n  };\n\n  handleTypeChange = (event) => {\n    const { version, setKeystore } = this.props;\n    const newType = event.target.value;\n    setKeystore(newType, version);\n  };\n\n  handleVersionChange = (event) => {\n    const { type, setKeystore } = this.props;\n    const newVersion = event.target.value;\n    setKeystore(type, newVersion);\n  };\n\n  render() {\n    const { type, status, version } = this.props;\n    return (\n      <Box>\n        <Grid container spacing={2} justify=\"center\">\n          <Grid item md={4}>\n            <FormControl fullWidth>\n              <InputLabel id=\"keystore-select-label\">Type</InputLabel>\n              <Select\n                labelId=\"keystore-select-label\"\n                id=\"keystore-select\"\n                value={type}\n                onChange={this.handleTypeChange}\n              >\n                <MenuItem value=\"\">{\"< Select type >\"}</MenuItem>\n                <MenuItem value={TREZOR}>Trezor</MenuItem>\n                <MenuItem value={LEDGER}>Ledger</MenuItem>\n                <MenuItem value={COLDCARD}>Coldcard</MenuItem>\n                <MenuItem value={HERMIT}>Hermit</MenuItem>\n              </Select>\n            </FormControl>\n          </Grid>\n\n          <Grid item md={6}>\n            <TextField\n              name=\"version\"\n              fullWidth\n              label=\"Version\"\n              value={version}\n              disabled={type === \"\"}\n              onChange={this.handleVersionChange}\n            />\n          </Grid>\n\n          <Grid item md={2}>\n            <Button\n              disabled={\n                status === ACTIVE || NO_VERSION_DETECTION.includes(type)\n              }\n              onClick={this.detectVersion}\n            >\n              {status === ACTIVE ? \"Detecting...\" : \"Detect\"}\n            </Button>\n          </Grid>\n        </Grid>\n\n        {type && !NO_VERSION_DETECTION.includes(type) && (\n          <InteractionMessages\n            messages={this.interaction().messagesFor({ state: status })}\n          />\n        )}\n\n        <KeystoreNote />\n      </Box>\n    );\n  }\n}\n\nKeystorePickerBase.propTypes = {\n  setErrorNotification: PropTypes.func.isRequired,\n  setKeystore: PropTypes.func.isRequired,\n  setKeystoreStatus: PropTypes.func.isRequired,\n  status: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  version: PropTypes.string.isRequired,\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    ...state.keystore,\n  };\n};\n\nconst mapDispatchToProps = {\n  ...keystoreActions,\n  setErrorNotification: setErrorNotificationAction,\n};\n\nconst KeystorePicker = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(KeystorePickerBase);\n\nexport default KeystorePicker;\n","import { diffChars, diffArrays, diffJson } from \"diff\";\n\nconst SUCCESS = \"success\";\nconst FAILURE = \"failure\";\nconst ERROR = \"error\";\n\nclass Test {\n  static SUCCESS = SUCCESS;\n\n  static FAILURE = FAILURE;\n\n  static ERROR = ERROR;\n\n  // eslint-disable-next-line class-methods-use-this\n  postprocess(thing) {\n    return thing;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  interaction() {\n    throw Error(\"Define the `interaction` method in your subclass of `Test`.\");\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  matches(expected, actual) {\n    if (typeof expected === \"object\" && typeof actual === \"object\") {\n      return Object.keys(actual).every((key) => {\n        return expected[key] === actual[key];\n      });\n    }\n    return expected === actual;\n  }\n\n  constructor(params) {\n    this.params = params || {};\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  diff(expected, actual) {\n    if (typeof expected === \"string\" && typeof actual === \"string\") {\n      return diffChars(expected, actual);\n    }\n    if (typeof expected === \"object\" && typeof actual === \"object\") {\n      if (expected.length !== undefined && actual.length !== undefined) {\n        return diffArrays(expected, actual);\n      }\n      if (expected.length === undefined && actual.length === undefined) {\n        return diffJson(expected, actual);\n      }\n    }\n    return null;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  supports() {\n    return true;\n  }\n\n  name() {\n    return this.params.name;\n  }\n\n  description() {\n    return this.params.description;\n  }\n\n  expected() {\n    return this.params.expected;\n  }\n\n  async actual(data) {\n    return this.postprocess(\n      data ? this.interaction().parse(data) : this.interaction().run()\n    );\n  }\n\n  async run() {\n    try {\n      const actual = await this.actual();\n      return this.resolve(actual);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      return { status: ERROR, message: e.message };\n    }\n  }\n\n  async runParse(data) {\n    try {\n      const actual = await this.actual(data);\n      // Both Coldcard responses include Objects\n      // but the xpub object includes a rootFingerprint\n      // while signatures only includes pubkeys and signatures\n      const sendToResolver = actual.rootFingerprint\n        ? {\n            // Either an xpub or a pubkey\n            pubkey: actual.pubkey,\n            xpub: actual.xpub || actual.tpub,\n            rootFingerprint: actual.rootFingerprint,\n          }\n        : Object.values(actual)[0];\n      return this.resolve(sendToResolver);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n      return { status: ERROR, message: e.message };\n    }\n  }\n\n  resolve(actual) {\n    const expected = this.expected();\n    if (this.matches(expected, actual)) {\n      return { status: SUCCESS };\n    }\n    return {\n      status: FAILURE,\n      expected,\n      actual,\n      diff: this.diff(expected, actual),\n    };\n  }\n}\n\nexport default Test;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport moment from \"moment\";\nimport { connect } from \"react-redux\";\nimport Bowser from \"bowser\";\nimport {\n  TREZOR,\n  LEDGER,\n  HERMIT,\n  COLDCARD,\n  PENDING,\n  ACTIVE,\n  VERSION as UNCHAINED_WALLETS_VERSION,\n} from \"unchained-wallets\";\n\nimport {\n  Grid,\n  Box,\n  Typography,\n  Card,\n  CardHeader,\n  CardContent,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n  Tooltip,\n  CircularProgress,\n} from \"@material-ui/core\";\nimport {\n  ThumbUp as SuccessIcon,\n  ThumbDown as FailureIcon,\n  Error as ErrorIcon,\n  Notes as NoteIcon,\n  MoreHoriz as PendingIcon,\n} from \"@material-ui/icons\";\nimport Test from \"../../tests/Test\";\n\nimport { setCurrentTestRun as setCurrentTestRunAction } from \"../../actions/testSuiteRunActions\";\n\nimport \"./TestSuiteRunSummary.css\";\n\nclass TestSuiteRunSummaryBase extends React.Component {\n  render = () => {\n    const { testSuiteRun, keystore } = this.props;\n    const environment = Bowser.getParser(window.navigator.userAgent);\n    return (\n      <Grid container direction=\"column\" spacing={3}>\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Summary\" />\n            <CardContent>\n              <dl>\n                <dt>OS:</dt>\n                <dd>\n                  {environment.getOSName()} {environment.getOSVersion()}\n                </dd>\n                <dt>Browser:</dt>\n                <dd>\n                  {environment.getBrowserName()}{\" \"}\n                  {environment.getBrowserVersion()}\n                </dd>\n                <dt>unchained-wallets:</dt>\n                <dd>\n                  v.\n                  {UNCHAINED_WALLETS_VERSION}\n                </dd>\n                {keystore.type && (\n                  <Box>\n                    <dt>Keystore:</dt>\n                    <dd>\n                      {this.keystoreName(keystore.type)} {keystore.version}\n                    </dd>\n                  </Box>\n                )}\n                {keystore.note && (\n                  <Box>\n                    <dt>Notes:</dt>\n                    <dd>{keystore.note}</dd>\n                  </Box>\n                )}\n              </dl>\n            </CardContent>\n          </Card>\n        </Grid>\n\n        <Grid item>\n          <Card>\n            <CardHeader\n              title=\"Tests\"\n              subheader={`${testSuiteRun.testRuns.length} Total`}\n            />\n            <CardContent>{this.renderTests()}</CardContent>\n          </Card>\n        </Grid>\n      </Grid>\n    );\n  };\n\n  renderTests = () => {\n    const { testSuiteRun, keystore } = this.props;\n    if (keystore.type === \"\") {\n      return <p>Choose a keystore type to generate a test suite...</p>;\n    }\n    return (\n      <Box>\n        <Typography variant=\"h6\">\n          <span className=\"TestSuiteRunSummary-success\">\n            {\n              testSuiteRun.testRuns.filter(\n                (testRun) => testRun.status === Test.SUCCESS\n              ).length\n            }{\" \"}\n            <small>SUCCESS</small>\n          </span>\n          &nbsp; / &nbsp;\n          <span className=\"TestSuiteRunSummary-failure\">\n            {\n              testSuiteRun.testRuns.filter(\n                (testRun) => testRun.status === Test.FAILURE\n              ).length\n            }{\" \"}\n            <small>FAIL</small>\n          </span>\n          &nbsp; / &nbsp;\n          <span className=\"TestSuiteRunSummary-error\">\n            {\n              testSuiteRun.testRuns.filter(\n                (testRun) => testRun.status === Test.ERROR\n              ).length\n            }{\" \"}\n            <small>ERROR</small>\n          </span>\n        </Typography>\n\n        <Divider />\n\n        <List\n          style={{ maxHeight: \"200px\", overflow: \"auto\" }}\n          dense\n          component=\"nav\"\n        >\n          {testSuiteRun.testRuns.map(this.renderTestRun)}\n        </List>\n      </Box>\n    );\n  };\n\n  renderTestRun = (testRun, i) => {\n    const { testSuiteRun } = this.props;\n    return (\n      <ListItem\n        selected={testSuiteRun.currentTestRunIndex === i}\n        button\n        key={i}\n        onClick={this.testRunChooser(i)}\n        disabled={!testSuiteRun.started}\n      >\n        {this.renderTestRunResult(testRun)}\n        <ListItemText>\n          {testRun.test.name()}\n          {testRun.status !== PENDING && testRun.status !== ACTIVE && (\n            <small>\n              &nbsp; (\n              {moment\n                .duration(testRun.endedAt.diff(testRun.startedAt))\n                .asSeconds()}\n              s)\n            </small>\n          )}\n        </ListItemText>\n        {testRun.note && (\n          <ListItemIcon>\n            <Tooltip title={testRun.note}>\n              <NoteIcon />\n            </Tooltip>\n          </ListItemIcon>\n        )}\n      </ListItem>\n    );\n  };\n\n  renderTestRunResult = (testRun) => {\n    switch (testRun.status) {\n      case PENDING:\n        return (\n          <ListItemIcon>\n            <PendingIcon className=\"TestSuiteRunSummary-pending\" />\n          </ListItemIcon>\n        );\n      case Test.SUCCESS:\n        return (\n          <ListItemIcon>\n            <SuccessIcon className=\"TestSuiteRunSummary-success\" />\n          </ListItemIcon>\n        );\n      case Test.FAILURE:\n        return (\n          <ListItemIcon>\n            <FailureIcon className=\"TestSuiteRunSummary-failure\" />\n          </ListItemIcon>\n        );\n      case Test.ERROR:\n        return (\n          <ListItemIcon>\n            <ErrorIcon className=\"TestSuiteRunSummary-error\" />\n          </ListItemIcon>\n        );\n      case ACTIVE:\n        return (\n          <ListItemIcon>\n            <CircularProgress className=\"TestSuiteRunSummary-active\" />\n          </ListItemIcon>\n        );\n      default:\n        return null;\n    }\n  };\n\n  testRunChooser = (testRunIndex) => {\n    const { setCurrentTestRun } = this.props;\n    return () => {\n      setCurrentTestRun(testRunIndex);\n    };\n  };\n\n  keystoreName = (type) => {\n    switch (type) {\n      case TREZOR:\n        return \"Trezor\";\n      case LEDGER:\n        return \"Ledger\";\n      case HERMIT:\n        return \"Hermit\";\n      case COLDCARD:\n        return \"Coldcard\";\n      default:\n        return \"\";\n    }\n  };\n}\n\nTestSuiteRunSummaryBase.propTypes = {\n  keystore: PropTypes.shape({\n    note: PropTypes.string,\n    type: PropTypes.string,\n    version: PropTypes.string,\n  }).isRequired,\n  testSuiteRun: PropTypes.shape({\n    currentTestRunIndex: PropTypes.number,\n    started: PropTypes.bool,\n    testRuns: PropTypes.arrayOf(PropTypes.shape({})),\n  }).isRequired,\n  setCurrentTestRun: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    keystore: state.keystore,\n    testSuiteRun: state.testSuiteRun,\n  };\n};\n\nconst mapDispatchToProps = {\n  setCurrentTestRun: setCurrentTestRunAction,\n};\n\nconst TestSuiteRunSummary = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TestSuiteRunSummaryBase);\n\nexport default TestSuiteRunSummary;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport {\n  PENDING,\n  ACTIVE,\n  HERMIT,\n  COLDCARD,\n  INDIRECT_KEYSTORES,\n} from \"unchained-wallets\";\nimport {\n  Box,\n  Typography,\n  Card,\n  CardHeader,\n  CardContent,\n  CardActions,\n  Button,\n  CircularProgress,\n} from \"@material-ui/core\";\nimport {\n  ThumbUp as SuccessIcon,\n  ThumbDown as FailureIcon,\n  Error as ErrorIcon,\n} from \"@material-ui/icons\";\nimport moment from \"moment\";\nimport Test from \"../../tests/Test\";\nimport * as testRunActions from \"../../actions/testRunActions\";\nimport * as errorNotificationActions from \"../../actions/errorNotificationActions\";\nimport InteractionMessages from \"../InteractionMessages\";\nimport { TestRunNote } from \"./Note\";\nimport { HermitReader, HermitDisplayer } from \"../Hermit\";\nimport {\n  ColdcardJSONReader,\n  ColdcardPSBTReader,\n  ColdcardSigningButtons,\n} from \"../Coldcard\";\nimport \"./TestRun.css\";\nimport { downloadFile } from \"../../utils\";\n\nconst SPACEBAR_CODE = 32;\n\nclass TestRunBase extends React.Component {\n  componentDidMount = () => {\n    document.addEventListener(\"keydown\", this.handleKeyDown);\n  };\n\n  componentWillUnmount = () => {\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\n  };\n\n  handleKeyDown = (event) => {\n    const { status, isLastTest, nextTest } = this.props;\n    if (event.keyCode !== SPACEBAR_CODE) {\n      return;\n    }\n    if (event.target.tagName.toLowerCase() === \"textarea\") {\n      return;\n    }\n    event.preventDefault();\n    if (status === ACTIVE) {\n      return;\n    }\n    if (status === PENDING) {\n      this.start();\n    } else if (!isLastTest) {\n      nextTest();\n    }\n  };\n\n  handleDownloadPSBTClick = () => {\n    const { test } = this.props;\n    const interaction = test.interaction();\n    const nameBits = test.name().split(\" \");\n    const body = interaction.request().toBase64();\n    const timestamp = moment().format(\"HHmm\");\n    const filename = `${timestamp}-${nameBits[2]}-${nameBits[1][0]}.psbt`;\n    downloadFile(body, filename);\n  };\n\n  handledDownloadWalletConfigClick = () => {\n    const { test } = this.props;\n    const nameBits = test.name().split(\" \");\n    const name = `${nameBits[2].toLowerCase()}-${nameBits[1][0]}`;\n    // FIXME - need to know firmware version and then set P2WSH-P2SH vs P2SH-P2WSH appropriately\n    //   leaving it as P2WSH-P2SH for now.\n    let output = `# Coldcard Multisig setup file for test suite\n#\nName: ${name}\nPolicy: 2 of 2\nFormat: ${test.params.format.includes(\"-\") ? \"P2WSH-P2SH\" : test.params.format}\nDerivation: ${test.params.derivation}\n\n`;\n    // We need to loop over xpubs and output `xfp: xpub` for each\n    const xpubs = test.params.extendedPublicKeys.map(\n      (xpub) => `${xpub.rootFingerprint}: ${xpub.base58String}`\n    );\n    output += xpubs.join(\"\\r\\n\");\n    output += \"\\r\\n\";\n    const filename = `wc-${name}.txt`;\n    downloadFile(output, filename);\n  };\n\n  render = () => {\n    const { test, testRunIndex, status, keystore } = this.props;\n    if (!test) {\n      return (\n        <Box>\n          <p>No test selected.</p>\n        </Box>\n      );\n    }\n    return (\n      <Box>\n        <Card>\n          <CardHeader\n            title={test.name()}\n            subheader={`Test ${testRunIndex + 1}`}\n          />\n          <CardContent>\n            {test.description()}\n            {keystore.type === COLDCARD && !test.unsignedTransaction && (\n              <Box align=\"center\">\n                <ColdcardJSONReader\n                  interaction={test.interaction()}\n                  onReceive={this.startParse}\n                  onStart={this.start}\n                  setError={this.reset}\n                  isTest\n                />\n              </Box>\n            )}\n            {keystore.type === COLDCARD && test.unsignedTransaction && (\n              <Box align=\"center\" style={{ marginTop: \"2em\" }}>\n                <ColdcardSigningButtons\n                  handlePSBTDownloadClick={this.handleDownloadPSBTClick}\n                  handleWalletConfigDownloadClick={\n                    this.handledDownloadWalletConfigClick\n                  }\n                />\n                <ColdcardPSBTReader\n                  interaction={test.interaction()}\n                  onReceivePSBT={this.startParse}\n                  onStart={this.start}\n                  setError={this.reset}\n                  fileType=\"PSBT\"\n                  validFileFormats=\".psbt\"\n                />\n              </Box>\n            )}\n            {this.renderInteractionMessages()}\n            {status === PENDING &&\n              !Object.values(INDIRECT_KEYSTORES).includes(keystore.type) && (\n                <Box align=\"center\">\n                  <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    onClick={this.start}\n                  >\n                    Start Test\n                  </Button>\n                </Box>\n              )}\n            {keystore.type === HERMIT &&\n              test.interaction().displayer &&\n              status === PENDING && (\n                <Box align=\"center\">\n                  <HermitDisplayer\n                    width={400}\n                    string={test.interaction().request()}\n                  />\n                </Box>\n              )}\n            {keystore.type === HERMIT && !this.testComplete() && (\n              <Box>\n                <HermitReader\n                  onStart={this.start}\n                  onSuccess={this.resolve}\n                  onClear={this.reset}\n                  startText=\"Scan Hermit Response\"\n                  interaction={test.interaction()}\n                />\n              </Box>\n            )}\n            {this.testComplete() && this.renderResult()}\n\n            <TestRunNote />\n          </CardContent>\n          <CardActions>\n            {status === ACTIVE && (\n              <Button disabled>\n                <CircularProgress />\n                &nbsp; Running test...\n              </Button>\n            )}\n            {this.testComplete() && (\n              <Button color=\"secondary\" onClick={this.reset}>\n                Reset Test\n              </Button>\n            )}\n          </CardActions>\n        </Card>\n      </Box>\n    );\n  };\n\n  testComplete = () => {\n    const { status } = this.props;\n    return (\n      status === Test.SUCCESS ||\n      status === Test.ERROR ||\n      status === Test.FAILURE\n    );\n  };\n\n  renderInteractionMessages = () => {\n    const { status, test } = this.props;\n    if (status === PENDING || status === ACTIVE) {\n      return (\n        <InteractionMessages\n          excludeCodes={[\"hermit.command\"]}\n          messages={test.interaction().messagesFor({ state: status })}\n        />\n      );\n    }\n    return null;\n  };\n\n  renderResult = () => {\n    const { status, message } = this.props;\n    switch (status) {\n      case Test.SUCCESS:\n        return (\n          <Box mt={2} align=\"center\">\n            <Typography variant=\"h5\" className=\"TestRun-success\">\n              <SuccessIcon />\n              &nbsp; Test passed\n            </Typography>\n          </Box>\n        );\n      case Test.FAILURE:\n        return (\n          <Box mt={2}>\n            <Box align=\"center\">\n              <Typography variant=\"h5\" className=\"TestRun-failure\">\n                <FailureIcon />\n                &nbsp; Test failed\n              </Typography>\n            </Box>\n            {message}\n          </Box>\n        );\n      case Test.ERROR:\n        return (\n          <Box mt={2}>\n            <Box align=\"center\">\n              <Typography variant=\"h5\" className=\"TestRun-error\">\n                <ErrorIcon />\n                &nbsp; Test error\n              </Typography>\n            </Box>\n            {message}\n          </Box>\n        );\n      default:\n        return null;\n    }\n  };\n\n  start = async () => {\n    const { test, keystore, testRunIndex, startTestRun } = this.props;\n    startTestRun(testRunIndex);\n    if (keystore.type === HERMIT) {\n      return;\n    }\n    const result = await test.run();\n    this.handleResult(result);\n  };\n\n  startParse = async (data) => {\n    const { test, testRunIndex, startTestRun } = this.props;\n    startTestRun(testRunIndex);\n    const result = await test.runParse(data);\n    this.handleResult(result);\n  };\n\n  resolve = (actual) => {\n    const { test } = this.props;\n    const result = test.resolve(test.postprocess(actual));\n    this.handleResult(result);\n  };\n\n  handleResult = (result) => {\n    const { testRunIndex, endTestRun, setErrorNotification } = this.props;\n    if (result.status === Test.ERROR) {\n      setErrorNotification(result.message);\n    }\n    endTestRun(testRunIndex, result.status, this.formatMessage(result));\n  };\n\n  reset = () => {\n    const { testRunIndex, resetTestRun } = this.props;\n    resetTestRun(testRunIndex);\n  };\n\n  formatMessage = (result) => {\n    switch (result.status) {\n      case Test.FAILURE:\n        return (\n          <Box>\n            <dl>\n              <dt>Expected:</dt>\n              <dd>\n                <code className=\"TestRun-wrap\">\n                  {this.formatOutput(result.expected)}\n                </code>\n              </dd>\n              <dt>Actual:</dt>\n              <dd>\n                <code className=\"TestRun-wrap\">\n                  {this.formatOutput(result.actual)}\n                </code>\n              </dd>\n              {result.diff && (\n                <div>\n                  <dt>Diff:</dt>\n                  <dd>\n                    <code className=\"TestRun-wrap\">\n                      {result.diff.map(this.formatDiffSegment)}\n                    </code>\n                  </dd>\n                </div>\n              )}\n            </dl>\n          </Box>\n        );\n      case Test.ERROR:\n        return <code>{result.message}</code>;\n      default:\n        return \"\";\n    }\n  };\n\n  formatOutput = (output) => {\n    switch (typeof output) {\n      case \"object\":\n        return JSON.stringify(output);\n      case \"string\":\n      case \"number\":\n        return output;\n      default:\n        return \"Did not recognize output type\";\n    }\n  };\n\n  formatDiffSegment = (segment, i) => {\n    return (\n      <span\n        key={i}\n        className={`TestRun-diff-segment-${this.diffSegmentClass(segment)}`}\n      >\n        {segment.value}\n      </span>\n    );\n  };\n\n  diffSegmentClass = (segment) => {\n    if (segment.added) {\n      return \"added\";\n    }\n    if (segment.removed) {\n      return \"removed\";\n    }\n    return \"common\";\n  };\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    ...{ keystore: state.keystore },\n    ...(state.testSuiteRun.testRuns[ownProps.testRunIndex] || {}),\n    ...{ testRunIndex: ownProps.testRunIndex },\n  };\n};\n\nconst mapDispatchToProps = {\n  ...testRunActions,\n  ...errorNotificationActions,\n};\n\nconst TestRun = connect(mapStateToProps, mapDispatchToProps)(TestRunBase);\n\nTestRunBase.propTypes = {\n  endTestRun: PropTypes.func.isRequired,\n  isLastTest: PropTypes.bool.isRequired,\n  keystore: PropTypes.shape({\n    type: PropTypes.string.isRequired,\n  }).isRequired,\n  message: PropTypes.oneOfType([PropTypes.string, PropTypes.shape({})])\n    .isRequired,\n  nextTest: PropTypes.func.isRequired,\n  resetTestRun: PropTypes.func.isRequired,\n  testRunIndex: PropTypes.number.isRequired,\n  test: PropTypes.shape({\n    name: PropTypes.func.isRequired,\n    description: PropTypes.func.isRequired,\n    interaction: PropTypes.func.isRequired,\n    params: PropTypes.shape({\n      format: PropTypes.string,\n      derivation: PropTypes.string,\n      extendedPublicKeys: PropTypes.array,\n    }),\n    run: PropTypes.func.isRequired,\n    runParse: PropTypes.func.isRequired,\n    resolve: PropTypes.func.isRequired,\n    postprocess: PropTypes.func.isRequired,\n    unsignedTransaction: PropTypes.func,\n  }),\n  setErrorNotification: PropTypes.func.isRequired,\n  startTestRun: PropTypes.func.isRequired,\n  status: PropTypes.string.isRequired,\n};\n\nTestRunBase.defaultProps = {\n  test: {\n    unsignedTransaction: null,\n    params: {},\n  },\n};\n\nexport default TestRun;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { TEST_FIXTURES } from \"unchained-bitcoin\";\nimport { Grid } from \"@material-ui/core\";\nimport { COLDCARD } from \"unchained-wallets\";\nimport PropTypes from \"prop-types\";\n\nconst { bip39Phrase } = TEST_FIXTURES.keys.open_source;\n\nclass SeedBase extends React.Component {\n  static renderSeedWord(word, i) {\n    return (\n      <li key={i}>\n        <code>{word}</code>\n      </li>\n    );\n  }\n\n  render() {\n    const { keystore } = this.props;\n    return (\n      <>\n        <Grid container>\n          <Grid item md={3}>\n            <ol>{bip39Phrase.slice(0, 6).map(SeedBase.renderSeedWord)}</ol>\n          </Grid>\n          <Grid item md={3}>\n            <ol start={7}>\n              {bip39Phrase.slice(6, 12).map(SeedBase.renderSeedWord)}\n            </ol>\n          </Grid>\n          <Grid item md={3}>\n            <ol start={13}>\n              {bip39Phrase.slice(12, 18).map(SeedBase.renderSeedWord)}\n            </ol>\n          </Grid>\n          <Grid item md={3}>\n            <ol start={19}>\n              {bip39Phrase.slice(18, 24).map(SeedBase.renderSeedWord)}\n            </ol>\n          </Grid>\n        </Grid>\n        {keystore && keystore.type === COLDCARD && (\n          <Grid style={{ marginTop: \"2em\", marginBottom: \"2em\" }}>\n            If using the simulator, here&apos;s a handy command with the same\n            seed phrase:\n            <br />\n            <code>\n              ./simulator.py --seed &apos;{bip39Phrase.join(\" \")}&apos;\n            </code>\n          </Grid>\n        )}\n      </>\n    );\n  }\n}\n\nSeedBase.propTypes = {\n  keystore: PropTypes.shape({\n    note: PropTypes.string,\n    type: PropTypes.string,\n    status: PropTypes.string,\n    version: PropTypes.string,\n  }),\n};\n\nSeedBase.defaultProps = {\n  keystore: null,\n};\n\nconst mapStateToProps = () => {\n  return {};\n};\n\nconst mapDispatchToProps = {};\n\nconst Seed = connect(mapStateToProps, mapDispatchToProps)(SeedBase);\n\nexport default Seed;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { PENDING, ACTIVE } from \"unchained-wallets\";\n\nimport {\n  Grid,\n  Box,\n  Card,\n  CardHeader,\n  CardContent,\n  Button,\n  LinearProgress,\n} from \"@material-ui/core\";\nimport { ArrowBack, ArrowForward } from \"@material-ui/icons\";\nimport * as testSuiteRunActions from \"../../actions/testSuiteRunActions\";\nimport KeystorePicker from \"./KeystorePicker\";\nimport TestSuiteRunSummary from \"./TestSuiteRunSummary\";\nimport TestRun from \"./TestRun\";\nimport Seed from \"./Seed\";\n\nconst SPACEBAR_CODE = 32;\nconst LEFT_ARROW_CODE = 37;\nconst UP_ARROW_CODE = 38;\nconst RIGHT_ARROW_CODE = 39;\nconst DOWN_ARROW_CODE = 40;\n\nclass TestSuiteRunBase extends React.Component {\n  componentDidMount = () => {\n    document.addEventListener(\"keydown\", this.handleKeyDown);\n  };\n\n  componentWillUnmount = () => {\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\n  };\n\n  currentTestIsActive = () => {\n    const { testSuiteRun } = this.props;\n    if (!testSuiteRun.started) {\n      return false;\n    }\n    const test = testSuiteRun.testRuns[testSuiteRun.currentTestRunIndex];\n    if (!test) {\n      return false;\n    }\n    return test.status === ACTIVE;\n  };\n\n  handleKeyDown = (event) => {\n    const { testSuiteRun } = this.props;\n    if (testSuiteRun.started) {\n      if (this.currentTestIsActive()) {\n        return;\n      }\n      switch (event.keyCode) {\n        case LEFT_ARROW_CODE:\n          if (!this.isFirstTest()) {\n            this.previousTest();\n          }\n          break;\n        case UP_ARROW_CODE:\n          if (!this.isFirstTest()) {\n            this.previousTest();\n          }\n          break;\n        case RIGHT_ARROW_CODE:\n          if (!this.isLastTest()) {\n            this.nextTest();\n          }\n          break;\n        case DOWN_ARROW_CODE:\n          if (!this.isLastTest()) {\n            this.nextTest();\n          }\n          break;\n        default:\n          break;\n      }\n    } else {\n      if (event.keyCode !== SPACEBAR_CODE) {\n        return;\n      }\n      const tag = event.target.tagName.toLowerCase();\n      if (tag === \"textarea\" || tag === \"input\") {\n        return;\n      }\n      event.preventDefault();\n      if (this.startDisabled()) {\n        return;\n      }\n      this.start();\n    }\n  };\n\n  render = () => {\n    const { testSuiteRun } = this.props;\n    return (\n      <Box mt={2}>\n        {testSuiteRun.started && (\n          <Box mt={2} mb={2}>\n            <LinearProgress\n              variant=\"determinate\"\n              value={\n                100 *\n                (testSuiteRun.testRuns.filter(\n                  (testRun) =>\n                    testRun.status !== PENDING && testRun.status !== ACTIVE\n                ).length /\n                  testSuiteRun.testRuns.length)\n              }\n            />\n          </Box>\n        )}\n        <Grid container spacing={3}>\n          <Grid item md={4}>\n            <TestSuiteRunSummary />\n          </Grid>\n          <Grid item md={8}>\n            {this.renderBody()}\n          </Grid>\n        </Grid>\n      </Box>\n    );\n  };\n\n  renderSetup = () => {\n    const { keystore } = this.props;\n    return (\n      <Grid container direction=\"column\" spacing={3}>\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Choose Keystore\" />\n            <CardContent>\n              <KeystorePicker />\n              <Box align=\"center\" mt={2}>\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  disabled={this.startDisabled()}\n                  onClick={this.start}\n                  type=\"submit\"\n                >\n                  Begin Test Suite\n                </Button>\n              </Box>\n            </CardContent>\n          </Card>\n        </Grid>\n\n        <Grid item>\n          <Card>\n            <CardHeader title=\"Keystore Setup\" />\n            <CardContent>\n              <p>\n                Ensure your keystore has been initialized with the following\n                seed:\n              </p>\n              <Seed keystore={keystore} />\n            </CardContent>\n          </Card>\n        </Grid>\n      </Grid>\n    );\n  };\n\n  renderBody = () => {\n    const { testSuiteRun } = this.props;\n    if (testSuiteRun.started) {\n      return (\n        <Box>\n          <TestRun\n            isLastTest={this.isLastTest()}\n            nextTest={this.nextTest}\n            testRunIndex={testSuiteRun.currentTestRunIndex}\n          />\n          <Box mt={2}>\n            <Grid container justify=\"space-between\">\n              <Grid item>\n                <Button\n                  disabled={this.isFirstTest() || this.currentTestIsActive()}\n                  onClick={this.previousTest}\n                >\n                  <ArrowBack /> &nbsp; Previous\n                </Button>\n              </Grid>\n              <Grid item>\n                <Button\n                  disabled={this.isLastTest() || this.currentTestIsActive()}\n                  onClick={this.nextTest}\n                >\n                  Next &nbsp; <ArrowForward />\n                </Button>\n              </Grid>\n            </Grid>\n          </Box>\n        </Box>\n      );\n    }\n    return this.renderSetup();\n  };\n\n  start = () => {\n    const { startTestSuiteRun } = this.props;\n    startTestSuiteRun();\n  };\n\n  startDisabled = () => {\n    const { testSuiteRun, keystore } = this.props;\n    return (\n      keystore.type === \"\" ||\n      keystore.status === ACTIVE ||\n      testSuiteRun.started ||\n      testSuiteRun.testRuns.length === 0\n    );\n  };\n\n  isFirstTest = () => {\n    const { testSuiteRun } = this.props;\n    return testSuiteRun.currentTestRunIndex === 0;\n  };\n\n  isLastTest = () => {\n    const { testSuiteRun } = this.props;\n    return (\n      testSuiteRun.currentTestRunIndex === testSuiteRun.testRuns.length - 1\n    );\n  };\n\n  previousTest = () => {\n    const { testSuiteRun, setCurrentTestRun } = this.props;\n    if (testSuiteRun.currentTestRunIndex < 1) {\n      return;\n    }\n    setCurrentTestRun(testSuiteRun.currentTestRunIndex - 1);\n  };\n\n  nextTest = () => {\n    const { testSuiteRun, setCurrentTestRun } = this.props;\n    if (testSuiteRun.currentTestRunIndex === testSuiteRun.testRuns.length - 1) {\n      return;\n    }\n    setCurrentTestRun(testSuiteRun.currentTestRunIndex + 1);\n  };\n}\n\nTestSuiteRunBase.propTypes = {\n  keystore: PropTypes.shape({\n    note: PropTypes.string,\n    type: PropTypes.string,\n    status: PropTypes.string,\n    version: PropTypes.string,\n  }).isRequired,\n  setCurrentTestRun: PropTypes.func.isRequired,\n  startTestSuiteRun: PropTypes.func.isRequired,\n  testSuiteRun: PropTypes.shape({\n    currentTestRunIndex: PropTypes.number,\n    started: PropTypes.bool,\n    testRuns: PropTypes.arrayOf(PropTypes.shape({})),\n  }).isRequired,\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    keystore: state.keystore,\n    testSuiteRun: state.testSuiteRun,\n  };\n};\n\nconst mapDispatchToProps = {\n  ...testSuiteRunActions,\n};\n\nconst TestSuiteRun = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TestSuiteRunBase);\n\nexport default TestSuiteRun;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport {\n  P2SH,\n  P2SH_P2WSH,\n  P2WSH,\n  generateMultisigFromHex,\n  validateHex,\n  multisigRequiredSigners,\n  multisigTotalSigners,\n} from \"unchained-bitcoin\";\nimport {\n  Box,\n  Grid,\n  Card,\n  CardHeader,\n  CardContent,\n  Button,\n  TextField,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport { fetchAddressUTXOs } from \"../../blockchain\";\n\n// Components\nimport MultisigDetails from \"../MultisigDetails\";\nimport ImportAddressesButton from \"../ImportAddressesButton\";\n\n// Actions\nimport { setFrozen as setFrozenAction } from \"../../actions/settingsActions\";\nimport {\n  choosePerformSpend as chosePerformSpendAction,\n  setRequiredSigners as setRequiredSignersAction,\n  setTotalSigners as setTotalSignersAction,\n  setInputs as setInputsAction,\n} from \"../../actions/transactionActions\";\nimport {\n  chooseConfirmOwnership as chooseConfirmOwnershipAction,\n  setOwnershipMultisig as setOwnershipMultisigAction,\n} from \"../../actions/ownershipActions\";\n\nclass ScriptEntry extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      scriptHex: \"\",\n      scriptError: \"\",\n      fetchUTXOsError: \"\",\n      fetchedUTXOs: false,\n    };\n  }\n\n  disabled = () => {};\n\n  hasScriptError = () => {\n    const { scriptError } = this.state;\n    return scriptError !== \"\";\n  };\n\n  hasFetchUTXOsError = () => {\n    const { fetchUTXOsError } = this.state;\n    return fetchUTXOsError !== \"\";\n  };\n\n  hasError = () => this.hasScriptError() || this.hasFetchUTXOsError();\n\n  //\n  // Script\n  //\n\n  scriptName = () => {\n    const { addressType } = this.props;\n    switch (addressType) {\n      case P2SH:\n        return \"redeem\";\n      case P2SH_P2WSH:\n        return \"witness\";\n      case P2WSH:\n        return \"witness\";\n      default:\n        return null;\n    }\n  };\n\n  scriptTitle = () => {\n    const scriptName = this.scriptName();\n    return scriptName.charAt(0).toUpperCase() + scriptName.substring(1);\n  };\n\n  handleScriptChange = (event) => {\n    const scriptHex = event.target.value;\n    let scriptError = \"\";\n\n    if (scriptHex === \"\") {\n      scriptError = `${this.scriptTitle()} script cannot be blank.`;\n    }\n\n    if (\n      scriptError === \"\" &&\n      (scriptHex.includes(\"\\n\") ||\n        scriptHex.includes(\"\\t\") ||\n        scriptHex.includes(\" \"))\n    ) {\n      scriptError = `${this.scriptTitle()} script should not contain spaces, tabs, or newlines.`;\n    }\n\n    if (scriptError === \"\") {\n      const hexError = validateHex(scriptHex);\n      if (hexError !== \"\") {\n        scriptError = `${this.scriptTitle()} script is not valid hex.`;\n      }\n    }\n\n    if (scriptHex !== \"\" && scriptError === \"\") {\n      try {\n        this.generateMultisig(scriptHex);\n      } catch (parseError) {\n        // eslint-disable-next-line no-console\n        console.error(parseError);\n        scriptError = `Failed to parse ${this.scriptName()} script.`;\n      }\n    }\n\n    this.setState({\n      scriptHex,\n      scriptError,\n      fetchUTXOsError: \"\",\n      fetchedUTXOs: false,\n    });\n  };\n\n  generateMultisig = (newScriptHex) => {\n    const { network, addressType } = this.props;\n    const { scriptHex } = this.state;\n    let multisigScriptHex = scriptHex;\n    if (newScriptHex) multisigScriptHex = newScriptHex;\n\n    return generateMultisigFromHex(network, addressType, multisigScriptHex);\n  };\n\n  //\n  // Details\n  //\n\n  renderDetails = () => {\n    const { fetchUTXOsError } = this.state;\n    const { chosePerformSpend, choseConfirmOwnership, client } = this.props;\n    const multisig = this.generateMultisig();\n    const buttonsDisabled = chosePerformSpend || choseConfirmOwnership;\n    return (\n      <div>\n        <MultisigDetails multisig={multisig} />\n        <Box mt={2}>\n          <Grid container spacing={3}>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                size=\"large\"\n                onClick={this.performSpend}\n                disabled={buttonsDisabled}\n              >\n                Spend from this address\n              </Button>\n            </Grid>\n            <Grid item>\n              <Button\n                variant=\"contained\"\n                size=\"large\"\n                onClick={this.confirmOwnership}\n                disabled={buttonsDisabled}\n              >\n                Confirm ownership\n              </Button>\n            </Grid>\n          </Grid>\n          <FormHelperText error>{fetchUTXOsError}</FormHelperText>\n        </Box>\n        {client.type === \"private\" && (\n          <Box mt={2}>\n            <ImportAddressesButton\n              addresses={[multisig.address]}\n              client={client}\n            />\n          </Box>\n        )}\n      </div>\n    );\n  };\n\n  //\n  // Perform Spend\n  //\n\n  performSpend = async () => {\n    const {\n      setRequiredSigners,\n      setTotalSigners,\n      setInputs,\n      setFrozen,\n      choosePerformSpend,\n    } = this.props;\n    const multisig = this.generateMultisig();\n    const fetchUTXOsResult = await this.fetchUTXOs(multisig);\n    if (fetchUTXOsResult) {\n      const { utxos, balanceSats } = fetchUTXOsResult;\n      let fetchUTXOsError = \"\";\n      if (balanceSats.isLessThanOrEqualTo(0)) {\n        fetchUTXOsError = \"This address has a zero balance.\";\n      }\n      this.setState({\n        fetchedUTXOs: true,\n        fetchUTXOsError,\n      });\n      if (fetchUTXOsError === \"\") {\n        // transaction methods expect inputs to have a multisig prop\n        // that provides input info such as address\n        const inputs = utxos.map((utxo) => {\n          const input = { ...utxo, multisig };\n          return input;\n        });\n        setInputs(inputs);\n        setRequiredSigners(multisigRequiredSigners(multisig));\n        setTotalSigners(multisigTotalSigners(multisig));\n        setFrozen(true);\n        choosePerformSpend();\n      }\n    } else {\n      this.setState({\n        fetchedUTXOs: false,\n        fetchUTXOsError: \"Failed to fetch UTXOs.\",\n      });\n    }\n  };\n\n  fetchUTXOs = async (multisig) => {\n    const { network, client } = this.props;\n    const addressData = await fetchAddressUTXOs(\n      multisig.address,\n      network,\n      client\n    );\n\n    if (addressData && addressData.utxos && addressData.utxos.length)\n      return addressData;\n\n    return false;\n  };\n\n  //\n  // Confirm Ownership\n  //\n\n  confirmOwnership = () => {\n    const {\n      chooseConfirmOwnership,\n      setOwnershipMultisig,\n      setFrozen,\n    } = this.props;\n    setOwnershipMultisig(this.generateMultisig());\n    chooseConfirmOwnership();\n    setFrozen(true);\n  };\n\n  //\n  // Render\n  //\n  render() {\n    const { scriptHex, scriptError, fetchedUTXOs } = this.state;\n\n    return (\n      <Card>\n        <CardHeader title={`Enter ${this.scriptTitle()} Script`} />\n        <CardContent>\n          <form>\n            <TextField\n              fullWidth\n              multiline\n              autoFocus\n              variant=\"outlined\"\n              label={`${this.scriptTitle()} Script`}\n              value={scriptHex}\n              rows={5}\n              onChange={this.handleScriptChange}\n              disabled={fetchedUTXOs && !this.hasFetchUTXOsError()}\n              helperText={scriptError}\n              error={scriptError !== \"\"}\n            />\n          </form>\n\n          {scriptHex !== \"\" && !this.hasScriptError() ? (\n            this.renderDetails()\n          ) : (\n            <p>\n              Enter a valid {this.scriptName()} script to generate an address to\n              spend funds from.\n            </p>\n          )}\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nScriptEntry.propTypes = {\n  addressType: PropTypes.string.isRequired,\n  choosePerformSpend: PropTypes.func.isRequired,\n  chosePerformSpend: PropTypes.bool.isRequired,\n  choseConfirmOwnership: PropTypes.bool.isRequired,\n  chooseConfirmOwnership: PropTypes.func.isRequired,\n  client: PropTypes.shape({\n    type: PropTypes.string,\n  }).isRequired,\n  network: PropTypes.string.isRequired,\n  setFrozen: PropTypes.func.isRequired,\n  setInputs: PropTypes.func.isRequired,\n  setOwnershipMultisig: PropTypes.func.isRequired,\n  setRequiredSigners: PropTypes.func.isRequired,\n  setTotalSigners: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return {\n    ...state.settings,\n    ...{ client: state.client },\n    ...{\n      choseConfirmOwnership: state.spend.ownership.chosen,\n      chosePerformSpend: state.spend.transaction.chosen,\n    },\n  };\n}\n\nconst mapDispatchToProps = {\n  choosePerformSpend: chosePerformSpendAction,\n  setInputs: setInputsAction,\n  setTotalSigners: setTotalSignersAction,\n  setRequiredSigners: setRequiredSignersAction,\n  chooseConfirmOwnership: chooseConfirmOwnershipAction,\n  setOwnershipMultisig: setOwnershipMultisigAction,\n  setFrozen: setFrozenAction,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ScriptEntry);\n","export const CHOOSE_CONFIRM_OWNERSHIP = \"CHOOSE_CONFIRM_OWNERSHIP\";\nexport const SET_OWNERSHIP_MULTISIG = \"SET_OWNERSHIP_MULTISIG\";\nexport const RESET_PUBLIC_KEY_IMPORTER = \"RESET_PUBLIC_KEY_IMPORTER\";\nexport const RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH =\n  \"RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH\";\nexport const SET_PUBLIC_KEY_IMPORTER_BIP32_PATH =\n  \"SET_PUBLIC_KEY_IMPORTER_BIP32_PATH\";\nexport const SET_PUBLIC_KEY_IMPORTER_METHOD = \"SET_PUBLIC_KEY_IMPORTER_METHOD\";\nexport const SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY =\n  \"SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY\";\n\nexport function chooseConfirmOwnership() {\n  return {\n    type: CHOOSE_CONFIRM_OWNERSHIP,\n  };\n}\n\nexport function setOwnershipMultisig(value) {\n  return {\n    type: SET_OWNERSHIP_MULTISIG,\n    value,\n  };\n}\n\nexport function resetPublicKeyImporter() {\n  return {\n    type: RESET_PUBLIC_KEY_IMPORTER,\n  };\n}\n\nexport function resetPublicKeyImporterBIP32Path() {\n  return {\n    type: RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  };\n}\n\nexport function setPublicKeyImporterBIP32Path(value) {\n  return {\n    type: SET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n    value,\n  };\n}\n\nexport function setPublicKeyImporterMethod(value) {\n  return {\n    type: SET_PUBLIC_KEY_IMPORTER_METHOD,\n    value,\n  };\n}\n\nexport function setPublicKeyImporterPublicKey(value) {\n  return {\n    type: SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY,\n    value,\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { validatePublicKey, validateBIP32Path } from \"unchained-bitcoin\";\nimport { TREZOR, LEDGER, HERMIT } from \"unchained-wallets\";\n\n// Components\nimport CheckIcon from \"@material-ui/icons/Check\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport { styled } from \"@material-ui/core/styles\";\nimport {\n  Card,\n  CardHeader,\n  CardContent,\n  Select,\n  MenuItem,\n  InputLabel,\n  FormControl,\n  Button,\n  Typography,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n} from \"@material-ui/core\";\nimport HardwareWalletPublicKeyImporter from \"../CreateAddress/HardwareWalletPublicKeyImporter\";\nimport HermitPublicKeyImporter from \"../CreateAddress/HermitPublicKeyImporter\";\n\n// Actions\nimport {\n  resetPublicKeyImporter,\n  resetPublicKeyImporterBIP32Path,\n  setPublicKeyImporterBIP32Path,\n  setPublicKeyImporterMethod,\n  setPublicKeyImporterPublicKey,\n} from \"../../actions/ownershipActions\";\n\nimport \"react-table/react-table.css\";\n\nclass ConfirmOwnership extends React.Component {\n  titleRef = React.createRef();\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      disableChangeMethod: false,\n    };\n  }\n\n  componentDidMount = () => {\n    this.resetBIP32Path();\n    this.scrollToTitle();\n  };\n\n  componentDidUpdate = () => {\n    this.scrollToTitle();\n  };\n\n  scrollToTitle = () => {\n    this.titleRef.current.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  //\n  // Method\n  //\n\n  handleMethodChange = (event) => {\n    const { setMethod } = this.props;\n    setMethod(event.target.value);\n    this.reset();\n  };\n\n  disableChangeMethod = () => {\n    this.setState({ disableChangeMethod: true });\n  };\n\n  enableChangeMethod = () => {\n    this.setState({ disableChangeMethod: false });\n  };\n\n  //\n  // State\n  //\n\n  reset = () => {\n    const { reset } = this.props;\n    reset();\n  };\n\n  //\n  // BIP32 Path\n  //\n\n  resetBIP32Path = () => {\n    const { resetBIP32Path } = this.props;\n    resetBIP32Path();\n  };\n\n  validateAndSetBIP32Path = (bip32Path, callback, errback, options) => {\n    const { setBIP32Path } = this.props;\n    const error = validateBIP32Path(bip32Path, options);\n    setBIP32Path(bip32Path);\n    if (error) {\n      errback(error);\n    } else {\n      errback(\"\");\n      callback();\n    }\n  };\n\n  //\n  // Public Keey & Confirmation\n  //\n\n  validateAndSetPublicKey = (publicKey, errback, callback) => {\n    const { setPublicKey } = this.props;\n    const error = validatePublicKey(publicKey);\n    setPublicKey(publicKey);\n    if (error) {\n      if (errback) errback(error);\n    } else {\n      if (errback) errback(\"\");\n      if (callback) callback();\n    }\n  };\n\n  renderConfirmation = () => {\n    const { publicKeys, publicKeyImporter } = this.props;\n    if (publicKeyImporter.publicKey === \"\") {\n      return null;\n    }\n    if (publicKeys.includes(publicKeyImporter.publicKey)) {\n      const GreenListItemIcon = styled(ListItemIcon)({ color: \"green\" });\n      return (\n        <List>\n          <ListItem>\n            <GreenListItemIcon>\n              <CheckIcon />\n            </GreenListItemIcon>\n            <ListItemText>\n              The public key exported at BIP32 path{\" \"}\n              <code>{publicKeyImporter.bip32Path}</code> is present in the\n              provided redeem script.\n            </ListItemText>\n          </ListItem>\n        </List>\n      );\n    }\n    return (\n      <List>\n        <ListItem>\n          <ListItemIcon>\n            <Typography color=\"error\">\n              <ClearIcon />\n            </Typography>\n          </ListItemIcon>\n          <ListItemText>\n            The public key exported at BIP32 path{\" \"}\n            <code>{publicKeyImporter.bip32Path}</code> is not present in the\n            provided redeem script.\n          </ListItemText>\n        </ListItem>\n      </List>\n    );\n  };\n\n  renderImportByMethod = () => {\n    const { network, publicKeyImporter, defaultBIP32Path } = this.props;\n    if (publicKeyImporter.method === HERMIT) {\n      return (\n        <HermitPublicKeyImporter\n          publicKeyImporter={publicKeyImporter}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          validateAndSetPublicKey={this.validateAndSetPublicKey}\n          resetBIP32Path={this.resetBIP32Path}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n          reset={this.reset}\n        />\n      );\n    }\n    if (\n      publicKeyImporter.method === TREZOR ||\n      publicKeyImporter.method === LEDGER\n    ) {\n      return (\n        <HardwareWalletPublicKeyImporter\n          network={network}\n          publicKeyImporter={publicKeyImporter}\n          validateAndSetBIP32Path={this.validateAndSetBIP32Path}\n          resetBIP32Path={this.resetBIP32Path}\n          defaultBIP32Path={defaultBIP32Path}\n          validateAndSetPublicKey={this.validateAndSetPublicKey}\n          enableChangeMethod={this.enableChangeMethod}\n          disableChangeMethod={this.disableChangeMethod}\n        />\n      );\n    }\n    return null;\n  };\n\n  render() {\n    const { publicKeyImporter } = this.props;\n    const { disableChangeMethod } = this.state;\n    const labelId = \"public-key-importer-select-label\";\n    const selectLabelId = `${labelId}-select`;\n\n    return (\n      <Card>\n        <CardHeader ref={this.titleRef} title=\"Confirm Ownership\" />\n        <CardContent>\n          <form>\n            <p>How will you confirm your ownership of this address?</p>\n\n            <FormControl fullWidth>\n              <InputLabel id={labelId}>Select Method</InputLabel>\n\n              <Select\n                labelId={selectLabelId}\n                id=\"public-key-importer-select\"\n                disabled={disableChangeMethod}\n                value={publicKeyImporter.method}\n                onChange={this.handleMethodChange}\n              >\n                <MenuItem value=\"\">{\"< Select method >\"}</MenuItem>\n                <MenuItem value={TREZOR}>Trezor</MenuItem>\n                <MenuItem value={LEDGER}>Ledger</MenuItem>\n                <MenuItem value={HERMIT}>Hermit</MenuItem>\n              </Select>\n            </FormControl>\n\n            {this.renderImportByMethod()}\n\n            {this.renderConfirmation()}\n\n            {publicKeyImporter.method !== \"\" && (\n              <Button\n                variant=\"contained\"\n                size=\"small\"\n                color=\"secondary\"\n                role=\"button\"\n                onClick={this.reset}\n              >\n                Start Again\n              </Button>\n            )}\n          </form>\n        </CardContent>\n      </Card>\n    );\n  }\n}\n\nConfirmOwnership.propTypes = {\n  defaultBIP32Path: PropTypes.string.isRequired,\n  network: PropTypes.string.isRequired,\n  publicKeys: PropTypes.arrayOf(PropTypes.string).isRequired,\n  publicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n    method: PropTypes.string,\n    publicKey: PropTypes.string,\n  }).isRequired,\n  reset: PropTypes.func.isRequired,\n  resetBIP32Path: PropTypes.func.isRequired,\n  setMethod: PropTypes.func.isRequired,\n  setPublicKey: PropTypes.func.isRequired,\n  setBIP32Path: PropTypes.func.isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return state.spend.ownership;\n}\n\nconst mapDispatchToProps = {\n  setMethod: setPublicKeyImporterMethod,\n  setBIP32Path: setPublicKeyImporterBIP32Path,\n  setPublicKey: setPublicKeyImporterPublicKey,\n  resetBIP32Path: resetPublicKeyImporterBIP32Path,\n  reset: resetPublicKeyImporter,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ConfirmOwnership);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\n// Components\nimport { Grid, Box, Card, CardContent, Typography } from \"@material-ui/core\";\nimport NetworkPicker from \"../NetworkPicker\";\nimport ClientPicker from \"../ClientPicker\";\nimport AddressTypePicker from \"../AddressTypePicker\";\nimport ScriptEntry from \"./ScriptEntry\";\nimport UTXOSet from \"./UTXOSet\";\nimport OutputsForm from \"./OutputsForm\";\nimport SignatureImporter from \"./SignatureImporter\";\nimport Transaction from \"./Transaction\";\nimport ConfirmOwnership from \"./ConfirmOwnership\";\nimport UnsignedTransaction from \"../UnsignedTransaction\";\nimport \"../styles.css\";\n\nclass Spend extends React.Component {\n  render = () => {\n    return (\n      <Box mt={2}>\n        <Grid container spacing={3}>\n          <Grid item md={8}>\n            <Box>\n              <ScriptEntry />\n            </Box>\n            {this.renderBody()}\n          </Grid>\n          <Grid item md={4}>\n            <Box>\n              <AddressTypePicker />\n            </Box>\n            <Box mt={2}>\n              <NetworkPicker />\n            </Box>\n            <Box mt={2}>\n              <ClientPicker />\n            </Box>\n          </Grid>\n        </Grid>\n      </Box>\n    );\n  };\n\n  renderBody = () => {\n    const { transaction, ownership } = this.props;\n    if (ownership.chosen) {\n      return (\n        <Box mt={2}>\n          <ConfirmOwnership />\n        </Box>\n      );\n    }\n    return (\n      <Box>\n        {this.spendable() && (\n          <Box>\n            <Box mt={2}>\n              <Card>\n                <CardContent>\n                  <UTXOSet\n                    inputs={transaction.inputs}\n                    inputsTotalSats={transaction.inputsTotalSats}\n                  />\n                </CardContent>\n              </Card>\n            </Box>\n            <Box mt={2}>\n              <Card>\n                <CardContent>\n                  <Typography variant=\"h5\">Define Outputs</Typography>\n                  <OutputsForm />\n                </CardContent>\n              </Card>\n            </Box>\n          </Box>\n        )}\n\n        {transaction.finalizedOutputs && (\n          <div>\n            <Box mt={2}>\n              <UnsignedTransaction />\n            </Box>\n\n            <Box mt={2}>{this.renderSignatureImporters()}</Box>\n          </div>\n        )}\n\n        {this.signaturesFinalized() && (\n          <Box mt={2}>\n            <Transaction />\n          </Box>\n        )}\n      </Box>\n    );\n  };\n\n  renderSignatureImporters = () => {\n    const { transaction } = this.props;\n    const signatureImporters = [];\n    for (\n      let signatureImporterNum = 1;\n      signatureImporterNum <= transaction.requiredSigners;\n      signatureImporterNum += 1\n    ) {\n      signatureImporters.push(\n        <Box key={signatureImporterNum} mt={2}>\n          <SignatureImporter number={signatureImporterNum} />\n        </Box>\n      );\n    }\n    return signatureImporters;\n  };\n\n  spendable = () => {\n    const { transaction } = this.props;\n    return transaction.inputs.length > 0;\n  };\n\n  signaturesFinalized = () => {\n    const { signatureImporters } = this.props;\n    return (\n      Object.values(signatureImporters).length > 0 &&\n      Object.values(signatureImporters).every(\n        (signatureImporter) => signatureImporter.finalized\n      )\n    );\n  };\n\n  confirmOwnership = (value) => {\n    // TODO can this entire function be removed? The states aren't being used.\n    // eslint-disable-next-line react/no-unused-state\n    this.setState({ addressFinalized: true, confirmOwnership: value });\n  };\n}\n\nSpend.propTypes = {\n  transaction: PropTypes.shape({\n    finalizedOutputs: PropTypes.bool,\n    inputs: PropTypes.arrayOf(PropTypes.shape({})),\n    inputsTotalSats: PropTypes.shape({}),\n    requiredSigners: PropTypes.number,\n  }).isRequired,\n  ownership: PropTypes.shape({\n    chosen: PropTypes.bool,\n  }).isRequired,\n  signatureImporters: PropTypes.shape({}).isRequired,\n};\n\nfunction mapStateToProps(state) {\n  return state.spend;\n}\n\nexport default connect(mapStateToProps)(Spend);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  AppBar,\n  Toolbar,\n  Button,\n  makeStyles,\n  Typography,\n  Menu,\n  MenuItem,\n  Box,\n} from \"@material-ui/core\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n  title: {\n    flexGrow: 1,\n  },\n  menuItem: {\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n    paddingX: theme.spacing(3),\n  },\n  menuLink: {\n    color: \"inherit\",\n    textDecoration: \"none\",\n  },\n}));\n\n// This needs to be a class component because it uses a ref\n// eslint-disable-next-line react/prefer-stateless-function\nclass NavItem extends React.Component {\n  render() {\n    const { href, title, classes, handleClose } = this.props;\n    return (\n      <a href={href} className={classes.menuLink}>\n        <MenuItem className={classes.menuItem} onClick={handleClose}>\n          {title}\n        </MenuItem>\n      </a>\n    );\n  }\n}\n\nNavItem.propTypes = {\n  href: PropTypes.string.isRequired,\n  title: PropTypes.string.isRequired,\n  classes: PropTypes.shape({\n    menuLink: PropTypes.string.isRequired,\n    menuItem: PropTypes.string.isRequired,\n  }).isRequired,\n  handleClose: PropTypes.func.isRequired,\n};\n\nconst Navbar = () => {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  const handleClick = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const menuItems = [\n    { href: \"#/wallet\", title: \"Wallet\" },\n    { href: \"#/address\", title: \"Create Address\" },\n    { href: \"#/script\", title: \"Script Explorer\" },\n    { href: \"#/test\", title: \"Test Suite\" },\n    { href: \"#/help\", title: \"Help\" },\n  ];\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"static\">\n        <Toolbar>\n          <Typography variant=\"h6\" className={classes.title}>\n            <Button color=\"inherit\" href=\"#/\">\n              Caravan\n            </Button>\n          </Typography>\n\n          <Button\n            aria-controls=\"simple-menu\"\n            aria-haspopup=\"true\"\n            color=\"inherit\"\n            onClick={handleClick}\n          >\n            <Box mr={3}>\n              <Typography>Menu</Typography>\n            </Box>\n            <MenuIcon />\n          </Button>\n          <Menu\n            id=\"simple-menu\"\n            anchorEl={anchorEl}\n            keepMounted\n            open={Boolean(anchorEl)}\n            onClose={() => setAnchorEl(null)}\n          >\n            {menuItems.map(({ href, title }) => (\n              <NavItem\n                href={href}\n                title={title}\n                classes={classes}\n                key={href}\n                handleClose={() => setAnchorEl(null)}\n              />\n            ))}\n          </Menu>\n        </Toolbar>\n      </AppBar>\n    </div>\n  );\n};\n\nexport default Navbar;\n","import React from \"react\";\nimport { Grid, Box } from \"@material-ui/core\";\nimport { externalLink } from \"../utils\";\nimport { version } from \"../../package.json\";\n\n// Components\n\n// Assets\nconst logo = require(\"../images/logo.png\");\n\nconst Footer = () => (\n  <Box mt={2}>\n    <hr />\n    <Grid container justify=\"space-between\" alignItems=\"center\">\n      <Grid item sm={2}>\n        {externalLink(\n          \"https://www.unchained-capital.com\",\n          <img\n            src={logo}\n            className=\"logo\"\n            alt=\"Unchained Capital logo\"\n            height=\"32\"\n          />\n        )}\n      </Grid>\n\n      <Grid item sm={6}>\n        <p>\n          Copyright&nbsp;\n          {new Date(Date.now()).getFullYear()} by Unchained Capital and released\n          under an MIT license.\n        </p>\n      </Grid>\n\n      <Grid item sm={1} align=\"right\">\n        <p> v{version} </p>\n      </Grid>\n    </Grid>\n  </Box>\n);\n\nexport default Footer;\n","import { Box, Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst reportingURL = \"https://github.com/unchained-capital/caravan/issues\";\n\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { error: null, errorInfo: null };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    this.setState({\n      errorInfo,\n      error,\n    });\n  }\n\n  render() {\n    const { children } = this.props;\n    const { error, errorInfo } = this.state;\n    if (errorInfo) {\n      return (\n        <Box m={4}>\n          <Box m={2}>\n            <Typography variant=\"h3\" component=\"h1\">\n              Something went wrong.\n            </Typography>\n          </Box>\n          <Box m={2}>\n            <Typography variant=\"body1\">\n              Let us know what happened on{\" \"}\n              <a href={reportingURL} target=\"_blank\" rel=\"noopener noreferrer\">\n                github\n              </a>\n              .\n            </Typography>\n          </Box>\n          <Box mx={2} my={3}>\n            <details style={{ whiteSpace: \"pre-wrap\" }}>\n              {error && error.toString()}\n              <br />\n              {errorInfo.componentStack}\n            </details>\n          </Box>\n        </Box>\n      );\n    }\n\n    return children;\n  }\n}\n\nErrorBoundary.propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n  ]).isRequired,\n};\n\nexport default ErrorBoundary;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { Snackbar, IconButton } from \"@material-ui/core\";\nimport { Close } from \"@material-ui/icons\";\nimport { clearErrorNotification as clearErrorNotificationAction } from \"../actions/errorNotificationActions\";\n\nconst ErrorNotificationBase = (props) => {\n  const { open, message, clearErrorNotification } = props;\n\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: \"bottom\",\n        horizontal: \"left\",\n      }}\n      open={open}\n      /* autoHideDuration={6000} */\n      onClose={clearErrorNotification}\n      ContentProps={{\n        \"aria-describedby\": \"error-notification\",\n      }}\n      message={<span id=\"error-notification\">{message}</span>}\n      action={[\n        <IconButton\n          key=\"close\"\n          aria-label=\"close\"\n          color=\"inherit\"\n          onClick={clearErrorNotification}\n        >\n          <Close />\n        </IconButton>,\n      ]}\n    />\n  );\n};\n\nErrorNotificationBase.propTypes = {\n  open: PropTypes.bool.isRequired,\n  message: PropTypes.string.isRequired,\n  clearErrorNotification: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (state) => {\n  return state.errorNotification;\n};\n\nconst mapDispatchToProps = {\n  clearErrorNotification: clearErrorNotificationAction,\n};\n\nconst ErrorNotification = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(ErrorNotificationBase);\n\nexport default ErrorNotification;\n","import React from \"react\";\nimport {\n  HashRouter as Router,\n  Route,\n  Switch,\n  Redirect,\n} from \"react-router-dom\";\n\n// Components\nimport { CssBaseline, Container } from \"@material-ui/core\";\nimport { SnackbarProvider } from \"notistack\";\n\nimport Help from \"./Help\";\nimport Wallet from \"./Wallet\";\nimport CreateAddress from \"./CreateAddress\";\nimport TestSuiteRun from \"./TestSuiteRun\";\nimport ScriptExplorer from \"./ScriptExplorer\";\nimport Navbar from \"./Navbar\";\nimport Footer from \"./Footer\";\nimport ErrorBoundary from \"./ErrorBoundary\";\nimport ErrorNotification from \"./ErrorNotification\";\n\nconst App = () => (\n  <div className=\"App\">\n    <CssBaseline />\n    <SnackbarProvider maxSnack={3}>\n      <Container maxWidth=\"lg\">\n        <Navbar />\n        <ErrorBoundary>\n          <Router>\n            <Switch>\n              <Route path=\"/test\" component={TestSuiteRun} />\n              <Route path=\"/address\" component={CreateAddress} />\n              <Redirect from=\"/spend\" to=\"/script\" />\n              <Route path=\"/script\" component={ScriptExplorer} />\n              <Route path=\"/wallet\" component={Wallet} />\n              <Route path=\"/help\" component={Help} />\n              <Route path=\"/\" component={Help} />\n            </Switch>\n          </Router>\n          <ErrorNotification />\n        </ErrorBoundary>\n        <Footer />\n      </Container>\n    </SnackbarProvider>\n  </div>\n);\n\nexport default App;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { createBrowserHistory } from \"history\";\nimport { connect } from \"react-redux\";\n\nimport App from \"./App\";\n\nclass AppContainer extends Component {\n  history = createBrowserHistory();\n\n  componentDidMount() {\n    const { resetApp } = this.props;\n    // Listen for changes to the current location\n    // and reset the redux store which is needed\n    // to avoid conflicts in the state between views/pages\n    this.unlisten = this.history.listen(() => {\n      resetApp();\n    });\n  }\n\n  componentWillUnmount() {\n    this.unlisten();\n  }\n\n  render() {\n    return <App />;\n  }\n}\n\nAppContainer.propTypes = {\n  resetApp: PropTypes.func.isRequired,\n};\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    resetApp: () => dispatch({ type: \"RESET_APP_STATE\" }),\n  };\n}\n\nexport default connect(null, mapDispatchToProps)(AppContainer);\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      // TODO FIXME\n      // eslint-disable-next-line  no-param-reassign\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              // eslint-disable-next-line no-console\n              console.log(\"New content is available; please refresh.\");\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              // eslint-disable-next-line no-console\n              console.log(\"Content is cached for offline use.\");\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      // eslint-disable-next-line no-console\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get(\"content-type\").indexOf(\"javascript\") === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      // eslint-disable-next-line no-console\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport default function register() {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          // eslint-disable-next-line no-console\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://goo.gl/SC7cgQ\"\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","function updateState(state, change) {\n  return {\n    ...state,\n    ...change,\n  };\n}\n\nexport default updateState;\n","import { MAINNET, P2SH } from \"unchained-bitcoin\";\n\nimport updateState from \"./utils\";\nimport {\n  SET_NETWORK,\n  SET_TOTAL_SIGNERS,\n  SET_REQUIRED_SIGNERS,\n  SET_STARTING_ADDRESS_INDEX,\n  SET_ADDRESS_TYPE,\n  SET_FROZEN,\n} from \"../actions/settingsActions\";\n\nconst initialState = {\n  network: MAINNET,\n  totalSigners: 3,\n  requiredSigners: 2,\n  addressType: P2SH,\n  startingAddressIndex: 0,\n  frozen: false,\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_NETWORK:\n      return updateState(state, { network: action.value });\n    case SET_TOTAL_SIGNERS:\n      return updateState(state, { totalSigners: action.value });\n    case SET_REQUIRED_SIGNERS:\n      return updateState(state, { requiredSigners: action.value });\n    case SET_STARTING_ADDRESS_INDEX:\n      return updateState(state, { startingAddressIndex: action.value });\n    case SET_ADDRESS_TYPE:\n      return updateState(state, { addressType: action.value });\n    case SET_FROZEN:\n      return updateState(state, { frozen: action.value });\n    default:\n      return state;\n  }\n};\n","import updateState from \"./utils\";\nimport {\n  SET_CLIENT_TYPE,\n  SET_CLIENT_URL,\n  SET_CLIENT_USERNAME,\n  SET_CLIENT_PASSWORD,\n  SET_CLIENT_URL_ERROR,\n  SET_CLIENT_USERNAME_ERROR,\n  SET_CLIENT_PASSWORD_ERROR,\n} from \"../actions/clientActions\";\n\nconst initialState = {\n  type: \"public\",\n  url: \"\",\n  username: \"\",\n  password: \"\",\n  urlError: \"\",\n  usernameError: \"\",\n  passwordError: \"\",\n  status: \"unknown\",\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_CLIENT_TYPE:\n      return updateState(state, { type: action.value });\n    case SET_CLIENT_URL:\n      return updateState(state, { url: action.value });\n    case SET_CLIENT_USERNAME:\n      return updateState(state, { username: action.value });\n    case SET_CLIENT_PASSWORD:\n      return updateState(state, { password: action.value });\n    case SET_CLIENT_URL_ERROR:\n      return updateState(state, { urlError: action.value });\n    case SET_CLIENT_USERNAME_ERROR:\n      return updateState(state, { usernameError: action.value });\n    case SET_CLIENT_PASSWORD_ERROR:\n      return updateState(state, { passwordError: action.value });\n\n    default:\n      return state;\n  }\n};\n","import BigNumber from \"bignumber.js\";\nimport {\n  RESET_NODES_SPEND,\n  RESET_NODES_FETCH_ERRORS,\n} from \"../actions/walletActions\";\nimport updateState from \"./utils\";\n\nconst intialSliceState = {\n  present: true,\n  bip32Path: \"\",\n  publicKeys: [],\n  multisig: {},\n  address: \"\",\n  balanceSats: new BigNumber(0),\n  utxos: [],\n  change: false,\n  spend: false,\n  fetchedUTXOs: false,\n  fetchUTXOsError: \"\",\n  addressUsed: false,\n  addressKnown: true,\n};\n\nconst initialState = {\n  nodes: {},\n  trailingEmptyNodes: 0,\n  fetchUTXOsErrors: 0,\n  balanceSats: new BigNumber(0),\n  spendingSats: new BigNumber(0),\n  nextNode: null,\n};\n\nfunction getNextNode(state) {\n  const nodes = Object.values(state.nodes);\n  for (let i = 0; i < nodes.length; i += 1) {\n    const node = nodes[i];\n    if (node.balanceSats.isEqualTo(0) && !node.addressUsed) {\n      return node;\n    }\n  }\n  return null;\n}\n\nfunction updateSlice(state, action) {\n  const slice = {\n    ...intialSliceState,\n    ...(state.nodes[action.value.bip32Path] || {}),\n    ...action.value,\n  };\n  const newSlices = {};\n  newSlices[slice.bip32Path] = slice;\n\n  const updatedState = {\n    ...state,\n    ...{\n      nodes: {\n        ...state.nodes,\n        ...newSlices,\n      },\n    },\n  };\n  if (typeof action.value.spend !== \"undefined\") {\n    // TODO (BUCK): I'm not sure this works. If you change\n    // the output value of a spend before spending, this will just\n    // add the new value to the previous value. We also can't just\n    // reset spendingSats because there might be multiple outputs\n    updatedState.spendingSats = action.value.spend\n      ? state.spendingSats.plus(slice.balanceSats)\n      : state.spendingSats.minus(slice.balanceSats);\n  }\n\n  if (action.value.balanceSats) {\n    const currentNodeBalance = state.nodes[slice.bip32Path]\n      ? state.nodes[slice.bip32Path].balanceSats\n      : BigNumber(0);\n    updatedState.balanceSats = state.balanceSats.plus(\n      slice.balanceSats.minus(currentNodeBalance)\n    );\n  }\n\n  let trailingEmptyNodes = 0;\n  let fetchUTXOsErrors = 0;\n  const allBIP32Paths = Object.keys(updatedState.nodes);\n  allBIP32Paths.sort((p1, p2) => {\n    const p1Segments = (p1 || \"\").split(\"/\");\n    const p2Segments = (p2 || \"\").split(\"/\");\n    const p1Index = parseInt(p1Segments[2], 10);\n    const p2Index = parseInt(p2Segments[2], 10);\n    return p1Index - p2Index;\n  });\n  let nodeFoundWithValue = false;\n  for (let i = 0; i < allBIP32Paths.length; i += 1) {\n    const bip32Path = allBIP32Paths[allBIP32Paths.length - (i + 1)];\n    const otherNode = updatedState.nodes[bip32Path];\n    if (otherNode.fetchedUTXOs) {\n      if (\n        otherNode.balanceSats.isEqualTo(0) &&\n        !otherNode.addressUsed &&\n        !nodeFoundWithValue\n      ) {\n        trailingEmptyNodes += 1;\n      } else nodeFoundWithValue = true;\n    }\n    if (otherNode.fetchUTXOsError !== \"\") {\n      fetchUTXOsErrors += 1;\n    }\n  }\n  updatedState.trailingEmptyNodes = trailingEmptyNodes;\n  updatedState.fetchUTXOsErrors = fetchUTXOsErrors;\n  updatedState.nextNode = getNextNode(updatedState);\n  return updatedState;\n}\n\nfunction resetSpend(state) {\n  const updatedState = { ...state };\n  Object.values(updatedState.nodes).forEach((node) => {\n    node.spend = false; // eslint-disable-line no-param-reassign\n  });\n  return updatedState;\n}\n\nexport default (actionType) => (state = initialState, action) => {\n  switch (action.type) {\n    case RESET_NODES_SPEND:\n      return resetSpend(state);\n    case RESET_NODES_FETCH_ERRORS:\n      return updateState(state, {\n        fetchUTXOsErrors: 0,\n        nodes: Object.values(state.nodes).reduce((allNodes, thisNode) => {\n          const updatedNodes = allNodes;\n          updatedNodes[thisNode.bip32Path] = {\n            ...thisNode,\n            fetchUTXOsError: \"\",\n          };\n          return updatedNodes;\n        }, {}),\n      });\n    case actionType:\n      return updateSlice(state, action);\n    default:\n      return state;\n  }\n};\n","import { MAINNET, P2SH, multisigBIP32Root } from \"unchained-bitcoin\";\nimport updateState from \"./utils\";\nimport {\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_NAME,\n  RESET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_METHOD,\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY,\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY_ROOT_FINGERPRINT,\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_FINALIZED,\n  SET_EXTENDED_PUBLIC_KEY_IMPORTER_VISIBLE,\n} from \"../actions/extendedPublicKeyImporterActions\";\nimport {\n  SET_TOTAL_SIGNERS,\n  SET_NETWORK,\n  SET_ADDRESS_TYPE,\n} from \"../actions/settingsActions\";\n\nfunction fingerprint(state) {\n  const timestamp = new Date().getTime().toString();\n  const extendedPublicKeys = Object.values(state.extendedPublicKeyImporters)\n    .map(\n      (extendedPublicKeyImporter) => extendedPublicKeyImporter.extendedPublicKey\n    )\n    .join(\"\");\n  return `${timestamp}-${extendedPublicKeys}`;\n}\n\nconst initialExtendedPublicKeyImporterState = (name = \"\") => ({\n  name,\n  bip32Path: multisigBIP32Root(P2SH, MAINNET),\n  bip32PathModified: false,\n  method: \"\",\n  extendedPublicKey: \"\",\n  rootXfp: \"\",\n  finalized: false,\n  conflict: false,\n});\n\nfunction createInitialState() {\n  const extendedPublicKeyImporters = [...Array(4).keys()]\n    .slice(1)\n    .reduce((importers, index) => {\n      return {\n        ...importers,\n        [index]: initialExtendedPublicKeyImporterState(\n          `Extended Public Key ${index}`\n        ),\n      };\n    }, {});\n\n  return {\n    extendedPublicKeyImporters,\n    defaultBIP32Path: multisigBIP32Root(P2SH, MAINNET),\n    network: MAINNET,\n    addressType: P2SH,\n    fingerprint: \"\",\n    finalizedNetwork: \"\",\n    finalizedAddressType: \"\",\n    configuring: true,\n  };\n}\n\nfunction setConflict(extendedPublicKeyImporter, state) {\n  if (state.finalizedNetwork) {\n    // eslint-disable-next-line no-param-reassign\n    extendedPublicKeyImporter.conflict =\n      state.finalizedNetwork !== state.network ||\n      state.finalizedAddressType !== state.addressType;\n  }\n}\n\nfunction updateExtendedPublicKeyImporterState(state, action, field) {\n  const extendedPublicKeyImporterChange = {};\n  extendedPublicKeyImporterChange[field] = action.value;\n  const newState = {\n    ...state,\n    ...{ nodes: {} },\n  };\n  newState.extendedPublicKeyImporters[action.number] = updateState(\n    state.extendedPublicKeyImporters[action.number],\n    extendedPublicKeyImporterChange\n  );\n  const importCount = Object.values(newState.extendedPublicKeyImporters).reduce(\n    (sum, current) => {\n      return sum + current.finalized;\n    },\n    0\n  );\n  if (\n    importCount === Object.keys(newState.extendedPublicKeyImporters).length &&\n    field === \"finalized\" &&\n    Object.values(newState.extendedPublicKeyImporters).every(\n      (xpub) => !xpub.conflict\n    )\n  ) {\n    newState.configuring = false;\n  }\n  setConflict(newState.extendedPublicKeyImporters[action.number], state);\n  return updateState(newState, { fingerprint: fingerprint(newState) });\n}\n\nfunction updateTotalSigners(state, action) {\n  const totalSigners = action.value;\n  const extendedPublicKeyImporters = {};\n  for (\n    let extendedPublicKeyImporterNum = 1;\n    extendedPublicKeyImporterNum <= totalSigners;\n    extendedPublicKeyImporterNum += 1\n  ) {\n    extendedPublicKeyImporters[extendedPublicKeyImporterNum] =\n      state.extendedPublicKeyImporters[extendedPublicKeyImporterNum] ||\n      initialExtendedPublicKeyImporterState(\n        `Extended Public Key ${extendedPublicKeyImporterNum}`\n      );\n  }\n  let finalizedCount = 0;\n\n  Object.keys(extendedPublicKeyImporters).forEach((index) => {\n    const importer = extendedPublicKeyImporters[index];\n    if (importer.finalized) finalizedCount += 1;\n  });\n\n  return {\n    ...state,\n    configuring: finalizedCount < totalSigners,\n    ...{ extendedPublicKeyImporters },\n  };\n}\n\nfunction updateImporterPaths(state, newState, bip32Path) {\n  for (\n    let extendedPublicKeyImporterNum = 1;\n    extendedPublicKeyImporterNum <=\n    Object.values(state.extendedPublicKeyImporters).length;\n    extendedPublicKeyImporterNum += 1\n  ) {\n    const extendedPublicKeyImporter =\n      newState.extendedPublicKeyImporters[extendedPublicKeyImporterNum];\n    if (!extendedPublicKeyImporter.bip32PathModified) {\n      if (!extendedPublicKeyImporter.finalized)\n        extendedPublicKeyImporter.bip32Path = bip32Path;\n    }\n    setConflict(extendedPublicKeyImporter, newState);\n  }\n}\n\nfunction updateNetwork(state, action) {\n  const { addressType } = state;\n  const network = action.value;\n  const bip32Path = multisigBIP32Root(addressType, network);\n  const newState = { ...state, ...{ network, defaultBIP32Path: bip32Path } };\n  updateImporterPaths(state, newState, bip32Path);\n  return newState;\n}\n\nfunction updateAddressType(state, action) {\n  const addressType = action.value;\n  const { network } = state;\n  const bip32Path = multisigBIP32Root(addressType, network);\n  const newState = {\n    ...state,\n    ...{ addressType, defaultBIP32Path: bip32Path },\n  };\n  updateImporterPaths(state, newState, bip32Path);\n  return newState;\n}\n\nfunction updateFinalizedSettings(state, action) {\n  const newState = { ...state };\n  if (action.value === true && state.finalizedNetwork === \"\") {\n    newState.finalizedNetwork = state.network;\n    newState.finalizedAddressType = state.addressType;\n  } else if (action.value === false && state.finalizedNetwork !== \"\") {\n    const finalizedCount = Object.values(\n      state.extendedPublicKeyImporters\n    ).reduce((count, importer) => {\n      if (importer.finalized === true) return count + 1;\n      return count;\n    }, 0);\n    if (finalizedCount === 1) {\n      // last one to be removed\n      newState.finalizedNetwork = \"\";\n      newState.finalizedAddressType = \"\";\n      Object.values(newState.extendedPublicKeyImporters).forEach(\n        // eslint-disable-next-line no-param-reassign,no-return-assign\n        (importer) => (importer.conflict = false)\n      );\n    }\n  }\n  return newState;\n}\n\nexport default (state = createInitialState(), action) => {\n  switch (action.type) {\n    case SET_NETWORK:\n      return updateNetwork(state, action);\n    case SET_ADDRESS_TYPE:\n      return updateAddressType(state, action);\n    case SET_TOTAL_SIGNERS:\n      return updateTotalSigners(state, action);\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_NAME:\n      return updateExtendedPublicKeyImporterState(state, action, \"name\");\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH:\n      return updateExtendedPublicKeyImporterState(\n        updateExtendedPublicKeyImporterState(state, action, \"bip32Path\"),\n        { number: action.number, value: true },\n        \"bip32PathModified\"\n      );\n    case RESET_EXTENDED_PUBLIC_KEY_IMPORTER_BIP32_PATH:\n      return updateExtendedPublicKeyImporterState(\n        updateExtendedPublicKeyImporterState(\n          state,\n          { number: action.number, value: state.defaultBIP32Path },\n          \"bip32Path\"\n        ),\n        { number: action.number, value: false },\n        \"bip32PathModified\"\n      );\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_METHOD:\n      return updateExtendedPublicKeyImporterState(state, action, \"method\");\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY:\n      return updateExtendedPublicKeyImporterState(\n        state,\n        action,\n        \"extendedPublicKey\"\n      );\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_EXTENDED_PUBLIC_KEY_ROOT_FINGERPRINT:\n      return updateExtendedPublicKeyImporterState(state, action, \"rootXfp\");\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_FINALIZED:\n      return updateExtendedPublicKeyImporterState(\n        updateFinalizedSettings(state, action),\n        action,\n        \"finalized\"\n      );\n    case SET_EXTENDED_PUBLIC_KEY_IMPORTER_VISIBLE:\n      return { ...state, ...{ configuring: action.value } };\n    default:\n      return state;\n  }\n};\n","import { MAINNET, P2SH, multisigBIP32Path } from \"unchained-bitcoin\";\nimport updateState from \"./utils\";\nimport {\n  SET_TOTAL_SIGNERS,\n  SET_NETWORK,\n  SET_ADDRESS_TYPE,\n} from \"../actions/settingsActions\";\nimport {\n  SET_PUBLIC_KEY_IMPORTER_NAME,\n  RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  SET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  SET_PUBLIC_KEY_IMPORTER_METHOD,\n  SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY,\n  SET_PUBLIC_KEY_IMPORTER_FINALIZED,\n  MOVE_PUBLIC_KEY_IMPORTER_UP,\n  MOVE_PUBLIC_KEY_IMPORTER_DOWN,\n  SORT_PUBLIC_KEY_IMPORTERS,\n  UPDATE_MULTISIG_ADDRESS,\n} from \"../actions/publicKeyImporterActions\";\n\nconst TEXT = \"text\";\n\nfunction fingerprint(state) {\n  const timestamp = new Date().getTime().toString();\n  const publicKeys = Object.values(state.publicKeyImporters)\n    .map((publicKeyImporter) => publicKeyImporter.publicKey)\n    .join(\"\");\n  return `${timestamp}-${publicKeys}`;\n}\n\nconst initialPublicKeyImporterState = (name = \"\") => ({\n  name,\n  bip32Path: multisigBIP32Path(P2SH, MAINNET),\n  bip32PathModified: false,\n  method: \"\",\n  publicKey: \"\",\n  finalized: false,\n  conflict: false,\n});\n\n// function to create a new initial state so that it\n// is properly initialized when the state is cleared\n// i.e. a \"deep clean\" through the object\nfunction createInitialState() {\n  // need create new objects for each pub key importer\n  // otherwise does not properly reset when state is cleared\n  const publicKeyImporters = [...Array(4).keys()]\n    .slice(1)\n    .reduce((importers, index) => {\n      return {\n        ...importers,\n        [index]: initialPublicKeyImporterState(`Public Key ${index}`),\n      };\n    }, {});\n\n  return {\n    publicKeyImporters,\n    defaultBIP32Path: multisigBIP32Path(P2SH, MAINNET),\n    network: MAINNET,\n    addressType: P2SH,\n    fingerprint: \"\",\n    finalizedNetwork: \"\",\n    finalizedAddressType: \"\",\n    address: \"\",\n  };\n}\n\nfunction movePublicKeyImporterUp(state, action) {\n  if (action.number === 1) {\n    return state;\n  }\n  const newState = {\n    ...state,\n  };\n  const abovePublicKeyImporter = state.publicKeyImporters[action.number - 1];\n  const publicKeyImporter = state.publicKeyImporters[action.number];\n  newState.publicKeyImporters[action.number - 1] = publicKeyImporter;\n  newState.publicKeyImporters[action.number] = abovePublicKeyImporter;\n  return updateState(newState, { fingerprint: fingerprint(newState) });\n}\n\nfunction movePublicKeyImporterDown(state, action) {\n  if (action.number === Object.values(state.publicKeyImporters).length) {\n    return state;\n  }\n  const newState = {\n    ...state,\n  };\n  const belowPublicKeyImporter = state.publicKeyImporters[action.number + 1];\n  const publicKeyImporter = state.publicKeyImporters[action.number];\n  newState.publicKeyImporters[action.number + 1] = publicKeyImporter;\n  newState.publicKeyImporters[action.number] = belowPublicKeyImporter;\n  return updateState(newState, { fingerprint: fingerprint(newState) });\n}\n\nfunction sortPublicKeyImporters(state) {\n  const publicKeyImporters = Object.values(state.publicKeyImporters);\n  const sortedPublicKeys = publicKeyImporters\n    .map((publicKeyImporter) => publicKeyImporter.publicKey)\n    .sort();\n  const sortedPublicKeyImporters = sortedPublicKeys.map((publicKey) => {\n    return publicKeyImporters.find(\n      (publicKeyImporter) => publicKeyImporter.publicKey === publicKey\n    );\n  });\n  const publicKeyImportersChange = {};\n  for (\n    let publicKeyImporterNum = 1;\n    publicKeyImporterNum <= sortedPublicKeyImporters.length;\n    publicKeyImporterNum += 1\n  ) {\n    publicKeyImportersChange[publicKeyImporterNum] =\n      sortedPublicKeyImporters[publicKeyImporterNum - 1];\n  }\n\n  const newState = {\n    ...state,\n    ...{ publicKeyImporters: publicKeyImportersChange },\n  };\n  return updateState(newState, { fingerprint: fingerprint(newState) });\n}\n\nfunction setConflict(publicKeyImporterIndex, state) {\n  if (state.finalizedNetwork) {\n    const publicKeyImporters = { ...state.publicKeyImporters };\n    const publicKeyImporter = publicKeyImporters[publicKeyImporterIndex];\n\n    publicKeyImporter.conflict =\n      state.finalizedNetwork !== state.network ||\n      state.finalizedAddressType !== state.addressType;\n\n    return updateState(state, { publicKeyImporters });\n  }\n  return state;\n}\n\nfunction updatePublicKeyImporterState(state, action, field) {\n  const publicKeyImporterChange = {};\n  publicKeyImporterChange[field] = action.value;\n  let newState = {\n    ...state,\n  };\n  newState.publicKeyImporters[action.number] = updateState(\n    state.publicKeyImporters[action.number],\n    publicKeyImporterChange\n  );\n  newState = setConflict(action.number, state);\n  return updateState(newState, { fingerprint: fingerprint(newState) });\n}\n\nfunction updateTotalSigners(state, action) {\n  const totalSigners = action.value;\n  const publicKeyImporters = {};\n  for (\n    let publicKeyImporterNum = 1;\n    publicKeyImporterNum <= totalSigners;\n    publicKeyImporterNum += 1\n  ) {\n    publicKeyImporters[publicKeyImporterNum] = state.publicKeyImporters[\n      publicKeyImporterNum\n    ] || {\n      ...initialPublicKeyImporterState(),\n      ...{\n        name: `Public Key ${publicKeyImporterNum}`,\n      },\n    };\n  }\n  const newState = {\n    ...state,\n    ...{ publicKeyImporters, stub: action.type },\n  };\n  return updateState(newState, { fingerprint: fingerprint(newState) });\n}\n\nfunction updateImporterPaths(state, bip32Path) {\n  let newState = { ...state };\n  for (\n    let publicKeyImporterNum = 1;\n    publicKeyImporterNum <= Object.values(state.publicKeyImporters).length;\n    publicKeyImporterNum += 1\n  ) {\n    const publicKeyImporter = newState.publicKeyImporters[publicKeyImporterNum];\n    if (!publicKeyImporter.bip32PathModified) {\n      if (!publicKeyImporter.finalized) publicKeyImporter.bip32Path = bip32Path;\n    }\n    newState = setConflict(publicKeyImporterNum, newState);\n  }\n  return newState;\n}\n\nfunction updateNetwork(state, action) {\n  const network = action.value;\n  const { addressType } = state;\n  const bip32Path = multisigBIP32Path(addressType, network);\n  let newState = { ...state, ...{ network, defaultBIP32Path: bip32Path } };\n  newState = updateImporterPaths(newState, bip32Path);\n  return newState;\n}\n\nfunction updateAddressType(state, action) {\n  const { network } = state;\n  const addressType = action.value;\n  const bip32Path = multisigBIP32Path(addressType, network);\n  let newState = {\n    ...state,\n    ...{ addressType, defaultBIP32Path: bip32Path },\n  };\n  newState = updateImporterPaths(newState, bip32Path);\n  return newState;\n}\n\nfunction updateFinalizedSettings(state, action) {\n  const newState = { ...state };\n  if (\n    action.value === true &&\n    state.finalizedNetwork === \"\" &&\n    newState.publicKeyImporters[action.number].method !== TEXT\n  ) {\n    newState.finalizedNetwork = state.network;\n    newState.finalizedAddressType = state.addressType;\n  } else if (action.value === false && state.finalizedNetwork !== \"\") {\n    const finalizedCount = Object.values(state.publicKeyImporters).reduce(\n      (count, importer) => {\n        if (importer.finalized === true && importer.method !== TEXT)\n          return count + 1;\n        return count;\n      },\n      0\n    );\n    if (finalizedCount === 1) {\n      // last one to be removed\n      newState.finalizedNetwork = \"\";\n      newState.finalizedAddressType = \"\";\n      Object.values(newState.publicKeyImporters).forEach(\n        // eslint-disable-next-line no-param-reassign,no-return-assign\n        (importer) => (importer.conflict = false)\n      );\n    }\n  }\n  return newState;\n}\n\nexport default (state = createInitialState(), action) => {\n  switch (action.type) {\n    case SET_NETWORK:\n      return updateNetwork(state, action);\n    case SET_ADDRESS_TYPE:\n      return updateAddressType(state, action);\n    case SET_TOTAL_SIGNERS:\n      return updateTotalSigners(state, action);\n    case SET_PUBLIC_KEY_IMPORTER_NAME:\n      return updatePublicKeyImporterState(state, action, \"name\");\n    case RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH:\n      return updatePublicKeyImporterState(\n        updatePublicKeyImporterState(\n          state,\n          { number: action.number, value: state.defaultBIP32Path },\n          \"bip32Path\"\n        ),\n        { number: action.number, value: false },\n        \"bip32PathModified\"\n      );\n    case SET_PUBLIC_KEY_IMPORTER_BIP32_PATH:\n      return updatePublicKeyImporterState(\n        updatePublicKeyImporterState(state, action, \"bip32Path\"),\n        { number: action.number, value: true },\n        \"bip32PathModified\"\n      );\n    case SET_PUBLIC_KEY_IMPORTER_METHOD:\n      return updatePublicKeyImporterState(state, action, \"method\");\n    case SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY:\n      return updatePublicKeyImporterState(state, action, \"publicKey\");\n    case SET_PUBLIC_KEY_IMPORTER_FINALIZED:\n      return updatePublicKeyImporterState(\n        updateFinalizedSettings(state, action),\n        action,\n        \"finalized\"\n      );\n    case MOVE_PUBLIC_KEY_IMPORTER_UP:\n      return movePublicKeyImporterUp(state, action);\n    case MOVE_PUBLIC_KEY_IMPORTER_DOWN:\n      return movePublicKeyImporterDown(state, action);\n    case SORT_PUBLIC_KEY_IMPORTERS:\n      return sortPublicKeyImporters(state, action);\n    case UPDATE_MULTISIG_ADDRESS:\n      return updateState(state, { address: action.value });\n    default:\n      return state;\n  }\n};\n","import {\n  UPDATE_WALLET_NAME,\n  RESET_WALLET_VIEW,\n  WALLET_MODES,\n  UPDATE_WALLET_MODE,\n  INITIAL_LOAD_COMPLETE,\n} from \"../actions/walletActions\";\nimport updateState from \"./utils\";\n\nconst initialState = {\n  walletMode: WALLET_MODES.VIEW,\n  walletName: \"My Multisig Wallet\",\n  nodesLoaded: false,\n};\n\nfunction resetWalletViews(state) {\n  return updateState(state, {\n    walletMode: WALLET_MODES.VIEW,\n  });\n}\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case UPDATE_WALLET_MODE:\n      return updateState(state, { walletMode: action.value });\n    case UPDATE_WALLET_NAME:\n      return updateState(state, { walletName: action.value });\n    case RESET_WALLET_VIEW:\n      return resetWalletViews(state);\n    case INITIAL_LOAD_COMPLETE:\n      return updateState(state, { nodesLoaded: true });\n    default:\n      return state;\n  }\n};\n","import {\n  P2SH,\n  MAINNET,\n  multisigAddressType,\n  multisigBIP32Path,\n  multisigPublicKeys,\n} from \"unchained-bitcoin\";\nimport updateState from \"./utils\";\nimport { SET_NETWORK } from \"../actions/settingsActions\";\nimport {\n  CHOOSE_CONFIRM_OWNERSHIP,\n  SET_OWNERSHIP_MULTISIG,\n  RESET_PUBLIC_KEY_IMPORTER,\n  RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  SET_PUBLIC_KEY_IMPORTER_BIP32_PATH,\n  SET_PUBLIC_KEY_IMPORTER_METHOD,\n  SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY,\n} from \"../actions/ownershipActions\";\n\nconst initialPublicKeyImporterState = {\n  bip32Path: \"\",\n  method: \"\",\n  publicKey: \"\",\n};\n\nconst initialState = {\n  chosen: false,\n  publicKeyImporter: { ...initialPublicKeyImporterState },\n  network: MAINNET,\n  addressType: P2SH,\n  publicKeys: [],\n  address: \"\",\n  defaultBIP32Path: multisigBIP32Path(P2SH, MAINNET),\n};\n\nfunction updatePublicKeyImporterState(state, action, field) {\n  const publicKeyImporterChange = {};\n  publicKeyImporterChange[field] = action.value;\n  return {\n    ...state,\n    ...{\n      publicKeyImporter: {\n        ...state.publicKeyImporter,\n        ...publicKeyImporterChange,\n      },\n    },\n  };\n}\n\nfunction updateMultisig(state, action) {\n  const multisig = action.value;\n  const addressType = multisigAddressType(multisig);\n  const defaultBIP32Path = multisigBIP32Path(addressType, state.network);\n  return {\n    ...state,\n    ...{\n      network: state.network,\n      addressType,\n      publicKeys: multisigPublicKeys(multisig),\n      address: multisig.address,\n      defaultBIP32Path,\n    },\n  };\n}\n\nexport default (state = initialState, action) => {\n  const keyResetState = updatePublicKeyImporterState(\n    state,\n    { value: \"\" },\n    \"publicKey\"\n  );\n\n  switch (action.type) {\n    case CHOOSE_CONFIRM_OWNERSHIP:\n      return updateState(state, { chosen: true });\n    case SET_NETWORK:\n      return updateState(state, { network: action.value });\n    case SET_OWNERSHIP_MULTISIG:\n      return updateMultisig(state, action);\n    case SET_PUBLIC_KEY_IMPORTER_BIP32_PATH:\n      return updatePublicKeyImporterState(keyResetState, action, \"bip32Path\");\n    case SET_PUBLIC_KEY_IMPORTER_METHOD:\n      return updatePublicKeyImporterState(state, action, \"method\");\n    case SET_PUBLIC_KEY_IMPORTER_PUBLIC_KEY:\n      return updatePublicKeyImporterState(state, action, \"publicKey\");\n    case RESET_PUBLIC_KEY_IMPORTER_BIP32_PATH:\n      return updatePublicKeyImporterState(\n        state,\n        { value: state.defaultBIP32Path },\n        \"bip32Path\"\n      );\n    case RESET_PUBLIC_KEY_IMPORTER:\n      return {\n        ...state,\n        ...{\n          publicKeyImporter: {\n            ...state.publicKeyImporter,\n            ...{ bip32Path: state.defaultBIP32Path, publicKey: \"\" },\n          },\n        },\n      };\n    default:\n      return state;\n  }\n};\n","import updateState from \"./utils\";\nimport {\n  SET_SIGNATURE_IMPORTER_NAME,\n  SET_SIGNATURE_IMPORTER_METHOD,\n  SET_SIGNATURE_IMPORTER_BIP32_PATH,\n  SET_SIGNATURE_IMPORTER_SIGNATURE,\n  SET_SIGNATURE_IMPORTER_PUBLIC_KEYS,\n  SET_SIGNATURE_IMPORTER_FINALIZED,\n  SET_SIGNATURE_IMPORTER_COMPLETE,\n} from \"../actions/signatureImporterActions\";\nimport {\n  SET_REQUIRED_SIGNERS,\n  RESET_TRANSACTION,\n} from \"../actions/transactionActions\";\n\nconst initialSignatureImporterState = {\n  name: \"\",\n  method: \"\",\n  publicKeys: [],\n  signature: [],\n  bip32Path: \"\",\n  finalized: false,\n};\n\nconst initialState = {};\n\nfunction setRequiredSigners(state, action) {\n  const signatureImporters = {};\n  for (\n    let signatureImporterNum = 1;\n    signatureImporterNum <= action.value;\n    signatureImporterNum += 1\n  ) {\n    signatureImporters[signatureImporterNum] = {\n      ...initialSignatureImporterState,\n      ...{ name: `Signature ${signatureImporterNum}` },\n    };\n  }\n  return signatureImporters;\n}\n\nfunction updateSignatureImporterState(state, action, field) {\n  const signatureImporterChange = {};\n  signatureImporterChange[field] = action.value;\n  const newState = {\n    ...state,\n  };\n  newState[action.number] = updateState(\n    state[action.number],\n    signatureImporterChange\n  );\n  return newState;\n}\n\nfunction finalizeSignatureImporterState(state, action) {\n  const newState = {\n    ...state,\n  };\n  newState[action.number] = updateState(state[action.number], action.value);\n  return newState;\n}\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case RESET_TRANSACTION:\n      return { ...initialState };\n    case SET_REQUIRED_SIGNERS:\n      return setRequiredSigners(state, action);\n    case SET_SIGNATURE_IMPORTER_NAME:\n      return updateSignatureImporterState(state, action, \"name\");\n    case SET_SIGNATURE_IMPORTER_METHOD:\n      return updateSignatureImporterState(state, action, \"method\");\n    case SET_SIGNATURE_IMPORTER_BIP32_PATH:\n      return updateSignatureImporterState(state, action, \"bip32Path\");\n    case SET_SIGNATURE_IMPORTER_SIGNATURE:\n      return updateSignatureImporterState(state, action, \"signature\");\n    case SET_SIGNATURE_IMPORTER_PUBLIC_KEYS:\n      return updateSignatureImporterState(state, action, \"publicKeys\");\n    case SET_SIGNATURE_IMPORTER_FINALIZED:\n      return updateSignatureImporterState(state, action, \"finalized\");\n    case SET_SIGNATURE_IMPORTER_COMPLETE:\n      return finalizeSignatureImporterState(state, action);\n\n    default:\n      return state;\n  }\n};\n","import BigNumber from \"bignumber.js\";\nimport {\n  MAINNET,\n  P2SH,\n  estimateMultisigTransactionFee,\n  validateFeeRate,\n  validateFee,\n  validateOutputAmount,\n  satoshisToBitcoins,\n  bitcoinsToSatoshis,\n  validateAddress,\n  unsignedMultisigTransaction,\n  unsignedMultisigPSBT,\n  unsignedTransactionObjectFromPSBT,\n} from \"unchained-bitcoin\";\nimport updateState from \"./utils\";\nimport { SET_NETWORK, SET_ADDRESS_TYPE } from \"../actions/settingsActions\";\nimport {\n  CHOOSE_PERFORM_SPEND,\n  SET_REQUIRED_SIGNERS,\n  SET_TOTAL_SIGNERS,\n  SET_INPUTS,\n  ADD_OUTPUT,\n  SET_OUTPUT_ADDRESS,\n  SET_OUTPUT_AMOUNT,\n  DELETE_OUTPUT,\n  SET_FEE_RATE,\n  SET_FEE,\n  FINALIZE_OUTPUTS,\n  RESET_OUTPUTS,\n  SET_TXID,\n  RESET_TRANSACTION,\n  SET_IS_WALLET,\n  SET_CHANGE_OUTPUT_INDEX,\n  SET_CHANGE_OUTPUT_MULTISIG,\n  UPDATE_AUTO_SPEND,\n  SET_SIGNING_KEY,\n  SET_CHANGE_ADDRESS,\n  SET_BALANCE_ERROR,\n  SET_SPEND_STEP,\n  SPEND_STEP_CREATE,\n} from \"../actions/transactionActions\";\nimport { RESET_NODES_SPEND } from \"../actions/walletActions\";\n\nfunction sortInputs(a, b) {\n  const x = a.txid.toLowerCase();\n  const y = b.txid.toLowerCase();\n  if (x < y) {\n    return -1;\n  }\n  if (x > y) {\n    return 1;\n  }\n  if (a.n < b.n) {\n    return -1;\n  }\n  if (a.n > b.n) {\n    return 1;\n  }\n  return 0;\n}\n\nexport const initialOutputState = () => ({\n  address: \"\",\n  amount: \"\",\n  amountSats: \"\",\n  addressError: \"\",\n  amountError: \"\",\n});\n\nconst initialOutputsState = () => [initialOutputState()];\n\nexport const initialState = () => ({\n  chosen: false,\n  network: MAINNET,\n  inputs: [],\n  inputsTotalSats: new BigNumber(0),\n  outputs: initialOutputsState(),\n  changeOutputIndex: 0,\n  feeRate: \"\",\n  feeRateError: \"\",\n  fee: \"\",\n  feeError: \"\",\n  finalizedOutputs: false,\n  txid: \"\",\n  balanceError: \"\",\n  addressType: P2SH,\n  requiredSigners: 2,\n  totalSigners: 3,\n  unsignedTransaction: {},\n  isWallet: false,\n  autoSpend: true,\n  changeAddress: \"\",\n  updatesComplete: true,\n  signingKeys: [0, 0], // default 2 required signers\n  spendingStep: SPEND_STEP_CREATE,\n});\n\nfunction updateInputs(state, action) {\n  const inputsTotalSats = action.value.reduce(\n    (accumulator, input) => accumulator.plus(input.amountSats),\n    new BigNumber(0)\n  );\n  return updateState(state, {\n    inputs: action.value.sort(sortInputs),\n    inputsTotalSats,\n  });\n}\n\nfunction calcOutputTotalSats(state) {\n  return state.outputs.reduce(\n    (accumulator, { amount }) =>\n      accumulator.plus(bitcoinsToSatoshis(new BigNumber(amount || 0))),\n    new BigNumber(0)\n  );\n}\n\nfunction setFeeForRate(state, feeRateString, nout) {\n  return satoshisToBitcoins(\n    estimateMultisigTransactionFee({\n      addressType: state.addressType,\n      numInputs: state.inputs.length,\n      numOutputs: nout,\n      m: state.requiredSigners,\n      n: state.totalSigners,\n      feesPerByteInSatoshis: feeRateString,\n    })\n  )\n    .toFixed(8)\n    .toString();\n}\n\nfunction deleteOutput(state, action) {\n  const newState = { ...state };\n  const newOutputs = [];\n  for (let i = 0; i < newState.outputs.length; i += 1) {\n    if (i !== action.number - 1) {\n      newOutputs.push(newState.outputs[i]);\n    } else if (action.number === newState.changeOutputIndex) {\n      newState.changeOutputIndex = 0;\n    }\n    if (action.number < newState.changeOutputIndex)\n      newState.changeOutputIndex -= 1;\n  }\n  return {\n    ...newState,\n    ...{\n      outputs: newOutputs,\n      fee: setFeeForRate(newState, newState.feeRate, newOutputs.length),\n    },\n  };\n}\n\nfunction updateFeeRate(state, action) {\n  const feeRateString = action.value;\n  const feeRateError = validateFeeRate(feeRateString);\n  const fee =\n    feeRateError === \"\"\n      ? setFeeForRate(state, feeRateString, state.outputs.length)\n      : \"\";\n\n  return updateState(state, {\n    feeRate: feeRateString,\n    feeRateError,\n    fee,\n    feeError: \"\",\n  });\n}\n\nfunction updateFee(state, action) {\n  const feeString = action.value;\n  const feeSats = bitcoinsToSatoshis(feeString);\n  const feeError = validateFee(feeSats, state.inputsTotalSats);\n\n  return updateState(state, {\n    fee: feeString,\n    feeError,\n    feeRateError: \"\",\n  });\n}\n\nfunction addOutput(state) {\n  const newOutputs = state.outputs.concat(initialOutputState());\n  return {\n    ...state,\n    ...{\n      outputs: newOutputs,\n      fee: setFeeForRate(state, state.feeRate, newOutputs.length),\n    },\n  };\n}\n\nfunction updateOutputAddress(state, action) {\n  const newOutputs = [...state.outputs];\n  const address = action.value;\n  let error = validateAddress(address, state.network);\n  if (error === \"\") {\n    for (\n      let inputIndex = 0;\n      inputIndex < state.inputs.length;\n      inputIndex += 1\n    ) {\n      const input = state.inputs[inputIndex];\n      if (input.multisig && address === input.multisig.address) {\n        error = \"Output address cannot equal input address.\";\n        break;\n      }\n    }\n  }\n  if (error === \"\") {\n    for (\n      let outputIndex = 0;\n      outputIndex < state.outputs.length;\n      outputIndex += 1\n    ) {\n      if (outputIndex !== action.number - 1) {\n        if (state.outputs[outputIndex].address === address) {\n          error = \"Duplicate output address.\";\n          break;\n        }\n      }\n    }\n  }\n  newOutputs[action.number - 1].address = address;\n  newOutputs[action.number - 1].addressError = error;\n  return {\n    ...state,\n    ...{ outputs: newOutputs },\n  };\n}\n\nfunction updateOutputMultisig(state, action) {\n  const newOutputs = [...state.outputs];\n  newOutputs[action.number - 1].multisig = action.value;\n  return {\n    ...state,\n    ...{ outputs: newOutputs },\n  };\n}\n\nfunction updateOutputAmount(state, action) {\n  const newOutputs = [...state.outputs];\n  let amount = action.value;\n  const amountSats = bitcoinsToSatoshis(BigNumber(amount));\n  let error = validateOutputAmount(amountSats, state.inputsTotalSats);\n\n  if (state.isWallet && error === \"Total input amount must be positive.\")\n    error = \"\";\n  if (state.isWallet && error === \"Output amount is too large.\") error = \"\";\n\n  const dp = BigNumber(amount).dp();\n  if (dp > 8) amount = amount.slice(0, 8 - dp);\n\n  newOutputs[action.number - 1].amount = amount;\n  newOutputs[action.number - 1].amountError = error;\n  newOutputs[action.number - 1].amountSats = error ? \"\" : amountSats;\n  return {\n    ...state,\n    ...{ outputs: newOutputs },\n  };\n}\n\nfunction finalizeOutputs(state, action) {\n  let unsignedTransaction;\n  // First try to build the transaction via PSBT, if that fails (e.g. an input doesn't know about its braid),\n  // then try to build it using the old TransactionBuilder plumbing.\n  try {\n    const unsignedTransactionPSBT = unsignedMultisigPSBT(\n      state.network,\n      state.inputs,\n      state.outputs\n    );\n    unsignedTransaction = unsignedTransactionObjectFromPSBT(\n      unsignedTransactionPSBT\n    );\n  } catch (e) {\n    // probably has an input that isn't braid aware.\n    unsignedTransaction = unsignedMultisigTransaction(\n      state.network,\n      state.inputs,\n      state.outputs\n    ); // bitcoinjs-lib will throw a Deprecation warning for using TransactionBuilder\n  }\n  return {\n    ...state,\n    ...{ finalizedOutputs: action.value, unsignedTransaction },\n  };\n}\n\nfunction updateRequiredSigners(state, action) {\n  return updateState(state, {\n    requiredSigners: action.value,\n    signingKeys: Array(action.value).fill(0),\n  });\n}\n\nfunction updateSigningKey(state, action) {\n  const signingKeys = [...state.signingKeys];\n  signingKeys[action.number - 1] = action.value;\n  return updateState(state, { signingKeys });\n}\n\nfunction outputInitialStateForMode(state) {\n  return updateState(state, {\n    outputs: initialOutputsState(),\n    fee: \"\",\n    balanceError: \"\",\n    changeOutputIndex: 0,\n  });\n}\n\nfunction resetTransactionState(state) {\n  let newState = updateState(state, {\n    ...initialState(),\n    totalSigners: state.totalSigners,\n    network: state.network,\n    addressType: state.addressType,\n    isWallet: state.isWallet,\n    changeAddress: state.changeAddress,\n  });\n  newState = updateRequiredSigners(newState, { value: state.requiredSigners });\n  newState = outputInitialStateForMode(newState);\n  return newState;\n}\n\nfunction validateTransaction(state) {\n  let newState = { ...state };\n  // TODO: need less hacky way to supress error\n  if (\n    newState.outputs.find(\n      (output) => output.addressError !== \"\" || output.amountError !== \"\"\n    ) ||\n    newState.feeError !== \"\" ||\n    newState.feeRateError !== \"\" ||\n    newState.inputs.length === 0\n  ) {\n    return {\n      ...newState,\n      balanceError: \"\",\n    };\n  }\n  const feeSats = bitcoinsToSatoshis(new BigNumber(newState.fee));\n  const outputTotalSats = calcOutputTotalSats(newState);\n  if (!newState.inputsTotalSats.isEqualTo(outputTotalSats.plus(feeSats))) {\n    const diff = outputTotalSats.plus(feeSats).minus(newState.inputsTotalSats);\n    let balanceError;\n    if (diff.isNaN()) {\n      balanceError = \"Cannot calculate total.\";\n    } else {\n      newState = updateState(newState, { updatesComplete: true });\n      const action = diff.isLessThan(0) ? \"Increase\" : \"Decrease\";\n      balanceError = `${action} by ${satoshisToBitcoins(\n        diff.absoluteValue()\n      ).toFixed(8)}.`;\n    }\n    return {\n      ...newState,\n      balanceError,\n    };\n  }\n  const minFee = new BigNumber(setFeeForRate(newState, \"1\", 0));\n\n  if (new BigNumber(newState.fee).isLessThan(minFee)) {\n    return {\n      ...newState,\n      balanceError: `Fee is too small. Should be no less than ${bitcoinsToSatoshis(\n        minFee\n      )} satoshis.`,\n    };\n  }\n\n  return {\n    ...newState,\n    balanceError: \"\",\n  };\n}\n\nexport default (state = initialState(), action) => {\n  switch (action.type) {\n    case CHOOSE_PERFORM_SPEND:\n      return updateState(state, { chosen: true });\n    case SET_NETWORK:\n      return updateState(state, { network: action.value });\n    case SET_ADDRESS_TYPE:\n      return updateState(state, { addressType: action.value });\n    case SET_REQUIRED_SIGNERS:\n      return updateRequiredSigners(state, action);\n    case SET_TOTAL_SIGNERS:\n      return updateState(state, { totalSigners: action.value });\n    case SET_INPUTS:\n      return validateTransaction(updateInputs(state, action));\n    case ADD_OUTPUT:\n      return validateTransaction(addOutput(state, action));\n    case SET_CHANGE_OUTPUT_INDEX:\n      return updateState(state, { changeOutputIndex: action.value });\n    case SET_CHANGE_OUTPUT_MULTISIG:\n      return updateOutputMultisig(state, action);\n    case SET_OUTPUT_ADDRESS:\n      return validateTransaction(updateOutputAddress(state, action));\n    case SET_OUTPUT_AMOUNT:\n      return validateTransaction(updateOutputAmount(state, action));\n    case DELETE_OUTPUT:\n      return validateTransaction(deleteOutput(state, action));\n    case SET_FEE_RATE:\n      return validateTransaction(updateFeeRate(state, action));\n    case SET_FEE:\n      return validateTransaction(updateFee(state, action));\n    case FINALIZE_OUTPUTS:\n      return finalizeOutputs(state, action);\n    case RESET_OUTPUTS:\n      return outputInitialStateForMode(state);\n    case SET_TXID:\n      return updateState(state, { txid: action.value });\n    case SET_IS_WALLET:\n      return updateState(state, { isWallet: true });\n    case RESET_TRANSACTION:\n      return resetTransactionState(state);\n    case UPDATE_AUTO_SPEND:\n      return updateState(state, { autoSpend: action.value });\n    case SET_SIGNING_KEY:\n      return updateSigningKey(state, action);\n    case SET_CHANGE_ADDRESS:\n      return updateState(state, { changeAddress: action.value });\n    case RESET_NODES_SPEND:\n      return updateInputs(state, { value: [] });\n    case SET_BALANCE_ERROR:\n      return updateState(state, { balanceError: action.value });\n    case SET_SPEND_STEP:\n      return updateState(state, { spendingStep: action.value });\n    default:\n      return state;\n  }\n};\n","import { PENDING } from \"unchained-wallets\";\n\nimport {\n  SET_KEYSTORE,\n  SET_KEYSTORE_NOTE,\n  SET_KEYSTORE_STATUS,\n} from \"../actions/keystoreActions\";\n\nconst initialState = {\n  type: \"\",\n  version: \"\",\n  note: \"\",\n  status: PENDING,\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_KEYSTORE:\n      return {\n        ...state,\n        ...{ type: action.keystoreType, version: action.version },\n      };\n    case SET_KEYSTORE_NOTE:\n      return {\n        ...state,\n        ...{ note: action.value },\n      };\n    case SET_KEYSTORE_STATUS:\n      return {\n        ...state,\n        ...{ status: action.value },\n      };\n    default:\n      return state;\n  }\n};\n","import React from \"react\";\nimport { MAINNET, TESTNET, TEST_FIXTURES } from \"unchained-bitcoin\";\nimport { COLDCARD, ExportPublicKey, HERMIT } from \"unchained-wallets\";\n\nimport Test from \"./Test\";\n\nclass ExportPublicKeyTest extends Test {\n  // eslint-disable-next-line class-methods-use-this\n  postprocess(result) {\n    return result.pubkey ? result.pubkey : result;\n  }\n\n  name() {\n    return `Export ${this.params.network} public key at ${this.params.bip32Path}`;\n  }\n\n  description() {\n    return (\n      <p>\n        Export a public key at BIP32 path\n        <code>{this.params.bip32Path}</code>.\n      </p>\n    );\n  }\n\n  interaction() {\n    return ExportPublicKey({\n      keystore: this.params.keystore,\n      network: this.params.network,\n      bip32Path: this.params.bip32Path,\n      includeXFP: true,\n    });\n  }\n\n  expected() {\n    const { pub, rootFingerprint } = TEST_FIXTURES.keys.open_source.nodes[\n      this.params.bip32Path\n    ];\n    if (this.params.keystore === HERMIT) {\n      return pub;\n    }\n    return { publicKey: pub, rootFingerprint };\n  }\n}\n\nconst publicKeyTests = (keystore) => {\n  switch (keystore) {\n    case COLDCARD:\n      return [\n        new ExportPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/48'/1'/0'/1'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/48'/1'/0'/2'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/48'/0'/0'/1'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/48'/0'/0'/2'/0/0\",\n        }),\n      ];\n    default:\n      return [\n        new ExportPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/1'/0'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/48'/1'/0'/1'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/48'/1'/0'/2'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/48'/0'/0'/1'/0/0\",\n        }),\n        new ExportPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/48'/0'/0'/2'/0/0\",\n        }),\n      ];\n  }\n};\n\nexport default publicKeyTests;\n","import React from \"react\";\nimport { MAINNET, TESTNET, TEST_FIXTURES } from \"unchained-bitcoin\";\nimport {\n  LEDGER,\n  TREZOR,\n  COLDCARD,\n  ExportExtendedPublicKey,\n  HERMIT,\n} from \"unchained-wallets\";\nimport Test from \"./Test\";\n\nclass ExportExtendedPublicKeyTest extends Test {\n  // eslint-disable-next-line class-methods-use-this\n  postprocess(result) {\n    return result.pubkey ? result.pubkey : result;\n  }\n\n  name() {\n    return `Export ${this.params.network} xpub at ${this.params.bip32Path}`;\n  }\n\n  description() {\n    return (\n      <p>\n        Export an extended public key at BIP32 path{\" \"}\n        <code>{this.params.bip32Path}</code>\n      </p>\n    );\n  }\n\n  interaction() {\n    return ExportExtendedPublicKey({\n      keystore: this.params.keystore,\n      network: this.params.network,\n      bip32Path: this.params.bip32Path,\n      includeXFP: true,\n    });\n  }\n\n  expected() {\n    const {\n      xpub,\n      tpub,\n      rootFingerprint,\n    } = TEST_FIXTURES.keys.open_source.nodes[this.params.bip32Path];\n\n    if (this.params.keystore === HERMIT) {\n      return { xpub, bip32Path: this.params.bip32Path };\n    }\n    if (this.params.network === MAINNET || this.params.keystore === TREZOR)\n      return { xpub, rootFingerprint };\n    if (this.params.keystore === LEDGER || this.params.keystore === COLDCARD)\n      return { xpub: tpub, rootFingerprint };\n    return { tpub, rootFingerprint };\n  }\n}\n\nconst extendedPublicKeyTests = (keystore) => {\n  switch (keystore) {\n    case COLDCARD:\n      return [\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/1/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0/0\",\n        }),\n      ];\n    case LEDGER:\n      return [\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/4'/99'/2147483647/3/1\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/4'/99'/2147483647/3/1\",\n        }),\n      ];\n    case TREZOR:\n      return [\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/4'/99'/2147483647/3/1\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/4'/99'/2147483647/3/1\",\n        }),\n      ];\n    default:\n      return [\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: TESTNET,\n          bip32Path: \"m/45'/0'/4'/99'/2147483647/3/1\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/0'/0/0\",\n        }),\n        new ExportExtendedPublicKeyTest({\n          keystore,\n          network: MAINNET,\n          bip32Path: \"m/45'/0'/4'/99'/2147483647/3/1\",\n        }),\n      ];\n  }\n};\n\nexport default extendedPublicKeyTests;\n","import React from \"react\";\nimport {\n  blockExplorerAddressURL,\n  satoshisToBitcoins,\n  unsignedMultisigTransaction,\n  unsignedMultisigPSBT,\n  unsignedTransactionObjectFromPSBT,\n  TEST_FIXTURES,\n} from \"unchained-bitcoin\";\nimport { HERMIT, SignMultisigTransaction } from \"unchained-wallets\";\nimport { Box, Table, TableBody, TableRow, TableCell } from \"@material-ui/core\";\nimport { externalLink } from \"../utils\";\nimport Test from \"./Test\";\n\nclass SignMultisigTransactionTest extends Test {\n  // eslint-disable-next-line class-methods-use-this\n  postprocess(result) {\n    return result.signatures ? result.signatures : result;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  matches(expected, actual) {\n    return JSON.stringify(expected) === JSON.stringify(actual);\n  }\n\n  description() {\n    return (\n      <Box>\n        <p>Sign a transaction which{this.params.description}.</p>\n        <p>\n          <small>\n            This transaction is not meant to be broadcast, but just in case, the\n            output address is fixed and owned by Unchained Capital.\n          </small>\n        </p>\n        <Table>\n          <TableBody>\n            <TableRow>\n              <TableCell>Output Address:</TableCell>\n              <TableCell>\n                {externalLink(\n                  blockExplorerAddressURL(\n                    this.outputAddress(),\n                    this.params.network\n                  ),\n                  <code>{this.outputAddress()}</code>\n                )}\n              </TableCell>\n            </TableRow>\n\n            <TableRow>\n              <TableCell>Output Amount:</TableCell>\n              <TableCell>\n                {satoshisToBitcoins(this.outputAmountSats()).toString()} BTC\n              </TableCell>\n            </TableRow>\n\n            <TableRow>\n              <TableCell>Change Output Address:</TableCell>\n              <TableCell>\n                <code>{this.changeOutputAddress()}</code>\n              </TableCell>\n            </TableRow>\n\n            <TableRow>\n              <TableCell>Change Output Amount:</TableCell>\n              <TableCell>\n                {satoshisToBitcoins(this.changeOutputAmountSats()).toString()}{\" \"}\n                BTC\n              </TableCell>\n            </TableRow>\n\n            <TableRow>\n              <TableCell>Fees:</TableCell>\n              <TableCell>\n                {satoshisToBitcoins(this.feeSats()).toString()} BTC\n              </TableCell>\n            </TableRow>\n          </TableBody>\n        </Table>\n      </Box>\n    );\n  }\n\n  inputsTotalSats() {\n    return this.params.inputs.reduce((total, input) => {\n      return total + input.amountSats.toNumber();\n    }, 0);\n  }\n\n  outputAddress() {\n    return this.params.outputs[0].address;\n  }\n\n  outputAmountSats() {\n    return this.params.outputs[0].amountSats.toNumber();\n  }\n\n  changeOutputAddress() {\n    return this.params.outputs[1].address;\n  }\n\n  changeOutputAmountSats() {\n    return this.params.outputs[1].amountSats.toNumber();\n  }\n\n  feeSats() {\n    return (\n      this.inputsTotalSats() -\n      this.outputAmountSats() -\n      this.changeOutputAmountSats()\n    );\n  }\n\n  unsignedTransaction() {\n    let unsignedTx;\n    try {\n      const unsignedTransactionPSBT = unsignedMultisigPSBT(\n        this.params.network,\n        this.params.inputs,\n        this.params.outputs\n      );\n      unsignedTx = unsignedTransactionObjectFromPSBT(unsignedTransactionPSBT);\n    } catch (e) {\n      // probably has an input that isn't braid aware.\n      unsignedTx = unsignedMultisigTransaction(\n        this.params.network,\n        this.params.inputs,\n        this.params.outputs\n      ); // bitcoinjs-lib will throw a Deprecation warning for using TransactionBuilder\n    }\n    return unsignedTx;\n  }\n\n  interaction() {\n    return SignMultisigTransaction({\n      keystore: this.params.keystore,\n      network: this.params.network,\n      inputs: this.params.inputs,\n      outputs: this.params.outputs,\n      bip32Paths: this.params.bip32Paths,\n    });\n  }\n\n  expected() {\n    return this.params.signature;\n  }\n}\n\nexport function signingTests(keystore) {\n  const transactions = [];\n\n  switch (keystore) {\n    case HERMIT:\n      TEST_FIXTURES.transactions.forEach((fixture) => {\n        if (!fixture.segwit) {\n          transactions.push(\n            new SignMultisigTransactionTest({\n              ...fixture,\n              ...{ keystore },\n            })\n          );\n        }\n      });\n      return transactions;\n    default:\n      return TEST_FIXTURES.transactions.map((fixture) => {\n        return new SignMultisigTransactionTest({\n          ...fixture,\n          ...{ keystore },\n        });\n      });\n  }\n}\n\nexport default signingTests;\n","import { TREZOR } from \"unchained-wallets\";\n\nimport publicKeyTests from \"./publicKeys\";\nimport extendedPublicKeyTests from \"./extendedPublicKeys\";\nimport { signingTests } from \"./signing\";\n\nexport default publicKeyTests(TREZOR)\n  .concat(extendedPublicKeyTests(TREZOR))\n  .concat(signingTests(TREZOR));\n","import { LEDGER } from \"unchained-wallets\";\n\nimport publicKeyTests from \"./publicKeys\";\nimport extendedPublicKeyTests from \"./extendedPublicKeys\";\nimport { signingTests } from \"./signing\";\n\nexport default publicKeyTests(LEDGER)\n  .concat(extendedPublicKeyTests(LEDGER))\n  .concat(signingTests(LEDGER));\n","import { HERMIT } from \"unchained-wallets\";\n\nimport publicKeyTests from \"./publicKeys\";\nimport extendedPublicKeyTests from \"./extendedPublicKeys\";\nimport { signingTests } from \"./signing\";\n\nexport default publicKeyTests(HERMIT)\n  .concat(extendedPublicKeyTests(HERMIT))\n  .concat(signingTests(HERMIT));\n","import { COLDCARD } from \"unchained-wallets\";\n\nimport extendedPublicKeyTests from \"./extendedPublicKeys\";\nimport { signingTests } from \"./signing\";\nimport publicKeyTests from \"./publicKeys\";\n\nexport default publicKeyTests(COLDCARD)\n  .concat(extendedPublicKeyTests(COLDCARD))\n  .concat(signingTests(COLDCARD));\n","import { TREZOR, LEDGER, HERMIT, COLDCARD } from \"unchained-wallets\";\nimport { TEST_FIXTURES } from \"unchained-bitcoin\";\n\nimport trezorTests from \"./trezor\";\nimport ledgerTests from \"./ledger\";\nimport hermitTests from \"./hermit\";\nimport coldcardTests from \"./coldcard\";\n\nconst SUITE = {};\n\nSUITE[TREZOR] = trezorTests;\nSUITE[LEDGER] = ledgerTests;\nSUITE[HERMIT] = hermitTests;\nSUITE[COLDCARD] = coldcardTests;\n\nconst SEED = TEST_FIXTURES.bip39Phrase;\n\nexport { SUITE, SEED };\n","import moment from \"moment\";\nimport { PENDING, ACTIVE } from \"unchained-wallets\";\n\nimport { SUITE } from \"../tests\";\n\nimport { SET_KEYSTORE } from \"../actions/keystoreActions\";\nimport {\n  START_TEST_SUITE_RUN,\n  SET_CURRENT_TEST_RUN,\n} from \"../actions/testSuiteRunActions\";\nimport {\n  START_TEST_RUN,\n  END_TEST_RUN,\n  RESET_TEST_RUN,\n  SET_TEST_RUN_NOTE,\n} from \"../actions/testRunActions\";\n\nconst initialTestRunState = {\n  startedAt: \"\",\n  endedAt: \"\",\n  status: PENDING,\n  message: \"\",\n  note: \"\",\n};\n\nconst initialState = {\n  started: false,\n  startedAt: \"\",\n  endedAt: \"\",\n  testRuns: [],\n  currentTestRunIndex: -1,\n};\n\nconst testRunsForKeystore = (action) => {\n  if (action.keystoreType === \"\") {\n    return [];\n  }\n  return (SUITE[action.keystoreType] || []).map((test) => {\n    return {\n      ...initialTestRunState,\n      ...{ test },\n    };\n  });\n};\n\nconst updatedTestRun = (state, testRunIndex, update) => {\n  return {\n    ...state,\n    ...{\n      testRuns: state.testRuns.map((testRun, i) => {\n        if (i === testRunIndex) {\n          return {\n            ...testRun,\n            ...update,\n          };\n        }\n        return testRun;\n      }),\n    },\n  };\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_KEYSTORE:\n      return {\n        ...state,\n        ...{ testRuns: testRunsForKeystore(action) },\n      };\n    case START_TEST_SUITE_RUN:\n      return {\n        ...state,\n        ...{\n          started: true,\n          startedAt: moment(),\n          currentTestRunIndex: 0,\n        },\n      };\n    case SET_CURRENT_TEST_RUN:\n      return {\n        ...state,\n        ...{ currentTestRunIndex: action.value },\n      };\n    case START_TEST_RUN:\n      return updatedTestRun(state, action.testRunIndex, {\n        startedAt: moment(),\n        status: ACTIVE,\n      });\n    case END_TEST_RUN:\n      return updatedTestRun(state, action.testRunIndex, {\n        endedAt: moment(),\n        status: action.status,\n        message: action.message,\n      });\n    case RESET_TEST_RUN:\n      return updatedTestRun(state, action.testRunIndex, initialTestRunState);\n    case SET_TEST_RUN_NOTE:\n      return updatedTestRun(state, action.testRunIndex, { note: action.note });\n    default:\n      return state;\n  }\n};\n","import {\n  SET_ERROR_NOTIFICATION,\n  CLEAR_ERROR_NOTIFICATION,\n} from \"../actions/errorNotificationActions\";\n\nconst initialState = {\n  message: \"\",\n  open: false,\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_ERROR_NOTIFICATION:\n      return {\n        ...state,\n        ...{ open: true, message: action.value },\n      };\n    case CLEAR_ERROR_NOTIFICATION:\n      return {\n        ...state,\n        ...{ open: false, message: \"\" },\n      };\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from \"redux\";\n\nimport settingsReducer from \"./settingsReducer\";\nimport clientReducer from \"./clientReducer\";\nimport braidReducer from \"./braidReducer\";\nimport quorumReducer from \"./quorumReducer\";\nimport addressReducer from \"./addressReducer\";\nimport walletReducer from \"./walletReducer\";\n\nimport ownershipReducer from \"./ownershipReducer\";\nimport signatureImportersReducer from \"./signatureImportersReducer\";\nimport transactionReducer from \"./transactionReducer\";\nimport keystoreReducer from \"./keystoreReducer\";\nimport testSuiteRunReducer from \"./testSuiteRunReducer\";\nimport errorNotificationReducer from \"./errorNotificationReducer\";\n\nimport {\n  UPDATE_DEPOSIT_SLICE,\n  UPDATE_CHANGE_SLICE,\n  RESET_WALLET,\n} from \"../actions/walletActions\";\n\nconst spendReducers = combineReducers({\n  ownership: ownershipReducer,\n  transaction: transactionReducer,\n  signatureImporters: signatureImportersReducer,\n});\n\nconst walletReducers = combineReducers({\n  deposits: braidReducer(UPDATE_DEPOSIT_SLICE),\n  change: braidReducer(UPDATE_CHANGE_SLICE),\n  common: walletReducer,\n});\n\nconst appReducer = combineReducers({\n  settings: settingsReducer,\n  client: clientReducer,\n  address: addressReducer,\n  spend: spendReducers,\n  quorum: quorumReducer,\n  wallet: walletReducers,\n  testSuiteRun: testSuiteRunReducer,\n  keystore: keystoreReducer,\n  errorNotification: errorNotificationReducer,\n});\n\nconst rootReducer = (state, action) => {\n  let newState = state;\n  if (action.type === RESET_WALLET || action.type === \"RESET_APP_STATE\")\n    newState = undefined;\n\n  return appReducer(newState, action);\n};\n\nexport default rootReducer;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { createStore, applyMiddleware, compose } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport ReduxPromise from \"redux-promise\";\nimport thunk from \"redux-thunk\";\n\nimport App from \"./components/AppContainer\";\nimport registerServiceWorker from \"./registerServiceWorker\";\nimport reducers from \"./reducers\";\n\n/* eslint-disable-next-line no-underscore-dangle */\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst store = createStore(\n  reducers,\n  composeEnhancers(applyMiddleware(ReduxPromise, thunk))\n);\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"app\")\n);\nregisterServiceWorker();\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.IndirectKeystoreInteraction = exports.DirectKeystoreInteraction = exports.UnsupportedInteraction = exports.KeystoreInteraction = exports.LEVELS = exports.STATES = exports.ERROR = exports.WARNING = exports.INFO = exports.ACTIVE = exports.PENDING = exports.UNSUPPORTED = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.reflect.get\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nrequire(\"core-js/modules/es6.regexp.match\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nvar _bowser = _interopRequireDefault(require(\"bowser\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\n * Constant representing a keystore which is unsupported due to the\n * kind of interaction or combination of paramters provided.\n *\n * @type {string}\n */\nvar UNSUPPORTED = \"unsupported\";\n/**\n * Constant representing a keystore pending activation by the user.\n *\n * @type {string}\n */\n\nexports.UNSUPPORTED = UNSUPPORTED;\nvar PENDING = \"pending\";\n/**\n * Constant representing a keystore in active use.\n *\n * @type {string}\n */\n\nexports.PENDING = PENDING;\nvar ACTIVE = \"active\";\n/**\n * Constant for messages at the \"info\" level.\n *\n * @type {string}\n */\n\nexports.ACTIVE = ACTIVE;\nvar INFO = \"info\";\n/**\n * Constant for messages at the \"warning\" level.\n *\n * @type {string}\n */\n\nexports.INFO = INFO;\nvar WARNING = \"warning\";\n/**\n * Constant for messages at the \"error\" level.\n *\n * @type {string}\n */\n\nexports.WARNING = WARNING;\nvar ERROR = \"error\";\n/**\n * Enumeration of possible keystore states ([PENDING]{@link module:interaction.PENDING}|[ACTIVE]{@link module:interaction.ACTIVE}|[UNSUPPORTED]{@link module:interaction.UNSUPPORTED}).\n *\n * @constant\n * @enum {string}\n * @default\n *\n */\n\nexports.ERROR = ERROR;\nvar STATES = [PENDING, ACTIVE, UNSUPPORTED];\n/**\n * Enumeration of possible message levels ([INFO]{@link module:interaction.INFO}|[WARNING]{@link module:interaction.WARNING}|[ERROR]{@link module:interaction.ERROR}).\n *\n * @constant\n * @enum {string}\n * @default\n *\n */\n\nexports.STATES = STATES;\nvar LEVELS = [INFO, WARNING, ERROR];\n/**\n * Represents an image in a message returned by an interaction.\n *\n * @typedef module:interaction.MessageImage\n * @type {Object}\n * @property {string} label - a human-readable label for the image\n * @property {string} mimeType - the MIME type of the image\n * @property {string} data - base64-encoded image data\n */\n\n/**\n * Represents a message returned by an interaction.\n *\n * Message objects may have additional properties.\n *\n * @typedef module:interaction.Message\n * @type {Object}\n * @property {string} text - message text\n * @property {string} code - a dot-separated message code, e.g. `device.connect` (*Optional for submessages*)\n * @property {module:interaction.STATES} state - keystore state (*Optional for submessages*)\n * @property {module:interaction.LEVELS} level - message level (*Optional for submessages*)\n * @property {string} version - keystore version (can be a single version string or a range/spec) (*Optional*)\n * @property {string} action - keystore action user is expected to take (*Optional*)\n * @property {module:interaction.MessageImage} image - image for this message (*Optional*)\n * @property {Message[]} messages - submessages (*Optional*)\n */\n\n/**\n * Abstract base class for all keystore interactions.\n *\n * Concrete subclasses will want to subclass either\n * `DirectKeystoreInteraction` or `IndirectKeystoreInteraction`.\n *\n * Defines an API for subclasses to leverage and extend.\n *\n * - Subclasses should not have any internal state.  External tools\n *   (UI frameworks such as React) will maintain state and pass it\n *   into the interaction in order to display properly.\n *\n * - Subclasses may override the default constructor in order to allow\n *   users to pass in parameters.\n *\n * - Subclasses should override the `messages` method to customize\n *   what messages are surfaced in applications at what state of the\n *   user interface.\n *\n * - Subclasses should not try to catch all errors, instead letting\n *   them bubble up the stack.  This allows UI developers to deal with\n *   them as appropriate.\n *\n * @example\n * import {KeystoreInteraction, PENDING, ACTIVE, INFO} from \"unchained-wallets\";\n * class DoNothingInteraction extends KeystoreInteraction {\n *\n *   constructor({param}) {\n *     super();\n *     this.param = param;\n *   }\n *\n *   messages() {\n *     const messages = super.messages()\n *     messages.push({state: PENDING, level: INFO, text: `Interaction pending: ${this.param}` code: \"pending\"});\n *     messages.push({state: ACTIVE, level: INFO, text: `Interaction active: ${this.param}` code: \"active\"});\n *     return messages;\n *   }\n * \n * }\n *\n * // usage\n * const interaction = new DoNothingInteraction({param: \"foo\"});\n * console.log(interaction.messageTextFor({state: ACTIVE})); // \"Interaction active: foo\"\n * console.log(interaction.messageTextFor({state: PENDING})); // \"Interaction pending: foo\"\n *\n */\n\nexports.LEVELS = LEVELS;\n\nvar KeystoreInteraction =\n/*#__PURE__*/\nfunction () {\n  /**\n   * Base constructor.\n   *\n   * Subclasses will often override this constructor to accept options.\n   *\n   * Just make sure to call `super()` if you do that!\n   *\n   * @constructor\n   */\n  function KeystoreInteraction() {\n    _classCallCheck(this, KeystoreInteraction);\n\n    this.environment = _bowser[\"default\"].getParser(window.navigator.userAgent);\n  }\n  /**\n   * Subclasses can override this method to indicate they are not\n   * supported.\n   *\n   * This method has access to whatever options may have been passed\n   * in by the constructor as well as the ability to interact with\n   * `this.environment` to determine whether the functionality is\n   * supported.  See the Bowser documentation for more details:\n   * https://github.com/lancedikson/bowser\n   *\n   * @returns {boolean} whether this interaction is supported\n   * @example\n   * isSupported() {\n   *   return this.environment.satisfies({\n   *     * declare browsers per OS\n   *     windows: {\n   *       \"internet explorer\": \">10\",\n   *     },\n   *     macos: {\n   *       safari: \">10.1\"\n   *     },\n   *\n   *     * per platform (mobile, desktop or tablet)\n   *     mobile: {\n   *       safari: '>=9',\n   *       'android browser': '>3.10'\n   *     },\n   *\n   *     * or in general\n   *     chrome: \"~20.1.1432\",\n   *     firefox: \">31\",\n   *     opera: \">=22\",\n   *\n   *     * also supports equality operator\n   *     chrome: \"=20.1.1432\", * will match particular build only\n   *\n   *     * and loose-equality operator\n   *     chrome: \"~20\",        * will match any 20.* sub-version\n   *     chrome: \"~20.1\"       * will match any 20.1.* sub-version (20.1.19 as well as 20.1.12.42-alpha.1)\n   *   });\n   * }\n   */\n\n\n  _createClass(KeystoreInteraction, [{\n    key: \"isSupported\",\n    value: function isSupported() {\n      return true;\n    }\n    /**\n     * Return messages array for this interaction.\n     *\n     * The messages array is a (possibly empty) array of [`Message`]{@link module:interaction.Message} objects.\n     *\n     * Subclasses should override this method and add messages as\n     * needed.  Make sure to call `super.messages()` to return an empty\n     * messages array for you to begin populating.\n     *\n     * @returns {module:interaction.Message[]} []\n     */\n\n  }, {\n    key: \"messages\",\n    value: function messages() {\n      var messages = [];\n      return messages;\n    }\n    /**\n     * Return messages filtered by the given options.\n     *\n     * Multiple options can be given at once to filter along multiple\n     * dimensions.\n     *\n     * @param {object} options - options argument\n     * @param {string} options.state - must equal this keystore state\n     * @param {string} options.level - must equal this message level\n     * @param {string|regexp} options.code - code must match this regular expression\n     * @param {string|regexp} options.text - text must match this regular expression\n     * @param {string|regexp} options.version - version must match this regular expression\n     * @returns {module:interaction.Message[]} matching `Message` objects\n     * @example\n     * import {PENDING, ACTIVE} from \"unchained-bitcoin\";\n     * // Create any interaction instance\n     * interaction.messages().forEach(msg => console.log(msg));\n     *   { code: \"device.connect\", state: \"pending\", level: \"info\", text: \"Please plug in your device.\"}\n     *   { code: \"device.active\", state: \"active\", level: \"info\", text: \"Communicating with your device...\"}\n     *   { code: \"device.active.warning\", state: \"active\", level: \"warning\", text: \"Your device will warn you about...\", version: \"2.x\"}\n     * interaction.messagesFor({state: PENDING}).forEach(msg => console.log(msg));\n     *   { code: \"device.connect\", state: \"pending\", level: \"info\", text: \"Please plug in your device.\"}\n     * interaction.messagesFor({code: ACTIVE}).forEach(msg => console.log(msg));\n     *   { code: \"device.active\", state: \"active\", level: \"info\", text: \"Communicating with your device...\"}\n     *   { code: \"device.active.warning\", state: \"active\", level: \"warning\", text: \"Your device will warn you about...\", version: \"2.x\"}\n     * interaction.messagesFor({version: /^2/}).forEach(msg => console.log(msg));\n     *   { code: \"device.active\", state: \"active\", level: \"warning\", text: \"Your device will warn you about...\", version: \"2.x\"}\n     */\n\n  }, {\n    key: \"messagesFor\",\n    value: function messagesFor(_ref) {\n      var state = _ref.state,\n          level = _ref.level,\n          code = _ref.code,\n          text = _ref.text,\n          version = _ref.version;\n      return this.messages().filter(function (message) {\n        if (state && message.state !== state) {\n          return false;\n        }\n\n        if (level && message.level !== level) {\n          return false;\n        }\n\n        if (code && !(message.code || '').match(code)) {\n          return false;\n        }\n\n        if (text && !(message.text || '').match(text)) {\n          return false;\n        }\n\n        if (version && !(message.version || '').match(version)) {\n          return false;\n        }\n\n        return true;\n      });\n    }\n    /**\n     * Return whether there are any messages matching the given options.\n     *\n     * @param {object} options - options argument\n     * @param {string} options.state - must equal this keystore state\n     * @param {string} options.level - must equal this message level\n     * @param {string|regexp} options.code - code must match this regular expression\n     * @param {string|regexp} options.text - text must match this regular expression\n     * @param {string|regexp} options.version - version must match this regular expression\n     * @returns {boolean} - whether any messages match the given filters\n     */\n\n  }, {\n    key: \"hasMessagesFor\",\n    value: function hasMessagesFor(_ref2) {\n      var state = _ref2.state,\n          level = _ref2.level,\n          code = _ref2.code,\n          text = _ref2.text,\n          version = _ref2.version;\n      return this.messagesFor({\n        state: state,\n        level: level,\n        code: code,\n        text: text,\n        version: version\n      }).length > 0;\n    }\n    /**\n     * Return the first message matching the given options (or `null` if none is found).\n     *\n     * @param {object} options - options argument\n     * @param {string} options.state - must equal this keystore state\n     * @param {string} options.level - must equal this message level\n     * @param {string|regexp} options.code - code must match this regular expression\n     * @param {string|regexp} options.text - text must match this regular expression\n     * @param {string|regexp} options.version - version must match this regular expression\n     * @returns {module:interaction.Message|null} the first matching `Message` object (or `null` if none is found)\n     */\n\n  }, {\n    key: \"messageFor\",\n    value: function messageFor(_ref3) {\n      var state = _ref3.state,\n          level = _ref3.level,\n          code = _ref3.code,\n          text = _ref3.text,\n          version = _ref3.version;\n      var messages = this.messagesFor({\n        state: state,\n        level: level,\n        code: code,\n        text: text,\n        version: version\n      });\n\n      if (messages.length > 0) {\n        return messages[0];\n      }\n\n      return null;\n    }\n    /**\n     * Retrieve the text of the first message matching the given options\n     * (or `null` if none is found).\n     *\n     * @param {object} options - options argument\n     * @param {string} options.state - must equal this keystore state\n     * @param {string} options.level - must equal this message level\n     * @param {string|regexp} options.code - code must match this regular expression\n     * @param {string|regexp} options.text - text must match this regular expression\n     * @param {string|regexp} options.version - version must match this regular expression\n     * @returns {string|null} the text of the first matching message (or `null` if none is found)\n     */\n\n  }, {\n    key: \"messageTextFor\",\n    value: function messageTextFor(_ref4) {\n      var state = _ref4.state,\n          level = _ref4.level,\n          code = _ref4.code,\n          text = _ref4.text,\n          version = _ref4.version;\n      var message = this.messageFor({\n        state: state,\n        level: level,\n        code: code,\n        text: text,\n        version: version\n      });\n      return message ? message.text : null;\n    }\n  }]);\n\n  return KeystoreInteraction;\n}();\n/**\n * Class used for describing an unsupported interaction.\n *\n * - Always returns `false` when the `isSupported` method is called.\n *\n * - Has a keystore state `unsupported` message at the `error` level.\n *\n * - Throws errors when attempting to call API methods such as `run`,\n *   `request`, and `parse`.\n *\n * @extends {module:interaction.KeystoreInteraction}\n * @example\n * import {UnsupportedInteraction} from \"unchained-wallets\";\n * const interaction = new UnsupportedInteraction({text: \"failure text\", code: \"fail\"});\n * console.log(interaction.isSupported()); // false\n *\n */\n\n\nexports.KeystoreInteraction = KeystoreInteraction;\n\nvar UnsupportedInteraction =\n/*#__PURE__*/\nfunction (_KeystoreInteraction) {\n  _inherits(UnsupportedInteraction, _KeystoreInteraction);\n\n  /**\n   * Accepts parameters to describe what is unsupported and why.\n   *\n   * The `text` should be human-readable.  The `code` is for machines.\n   *\n   * @param {object} options - options argument\n   * @param {string} options.text - the text of the error message\n   * @param {string} options.code - the code of the error message\n   * @constructor\n   */\n  function UnsupportedInteraction(_ref5) {\n    var _this;\n\n    var text = _ref5.text,\n        code = _ref5.code;\n\n    _classCallCheck(this, UnsupportedInteraction);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UnsupportedInteraction).call(this));\n    _this.text = text;\n    _this.code = code;\n    return _this;\n  }\n  /**\n   * By design, this method always returns false.\n   *\n   * @returns {false} Always.\n   */\n\n\n  _createClass(UnsupportedInteraction, [{\n    key: \"isSupported\",\n    value: function isSupported() {\n      return false;\n    }\n    /**\n     * Returns a single `error` level message at the `unsupported`\n     * state.\n     *\n     * @returns {module:interaction.Message[]} the messages for this class\n     */\n\n  }, {\n    key: \"messages\",\n    value: function messages() {\n      var messages = _get(_getPrototypeOf(UnsupportedInteraction.prototype), \"messages\", this).call(this);\n\n      messages.push({\n        state: UNSUPPORTED,\n        level: ERROR,\n        code: this.code,\n        text: this.text\n      });\n      return messages;\n    }\n    /**\n     * Throws an error.\n     *\n     * @returns {void}\n     * @throws An error containing this `this.text`.\n     *\n     */\n\n  }, {\n    key: \"run\",\n    value: function () {\n      var _run = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                throw new Error(this.text);\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function run() {\n        return _run.apply(this, arguments);\n      }\n\n      return run;\n    }()\n    /**\n     * Throws an error.\n     *\n     * @returns {void}\n     * @throws An error containing this `this.text`.\n     *\n     */\n\n  }, {\n    key: \"request\",\n    value: function request() {\n      throw new Error(this.text);\n    }\n    /**\n     * Throws an error.\n     *\n     * @returns {void}\n     * @throws An error containing this `this.text`.\n     *\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse() {\n      throw new Error(this.text);\n    }\n  }]);\n\n  return UnsupportedInteraction;\n}(KeystoreInteraction);\n/**\n * Base class for direct keystore interactions.\n *\n * Subclasses *must* implement a `run` method which communicates\n * directly with the keystore.  This method must be asynchronous\n * (return a `Promise`) to accommodate delays with network, devices,\n * &c.\n *\n * @example\n * import {DirectKeystoreInteraction} from \"unchained-wallets\";\n * class SimpleDirectInteraction extends DirectKeystoreInteraction {   *\n *\n *   constructor({param}) {\n *     super();\n *     this.param = param;\n *   }\n *\n *   async run() {\n *     // Or do something complicated...\n *     return this.param;\n *   }\n * }\n *\n * const interaction = new SimpleDirectInteraction({param: \"foo\"});\n *\n * const result = await interaction.run();\n * console.log(result);\n * // \"foo\"\n *\n */\n\n\nexports.UnsupportedInteraction = UnsupportedInteraction;\n\nvar DirectKeystoreInteraction =\n/*#__PURE__*/\nfunction (_KeystoreInteraction2) {\n  _inherits(DirectKeystoreInteraction, _KeystoreInteraction2);\n\n  /**\n   * Sets the `this.direct` property to `true`.  This property can be\n   * utilized when introspecting on interaction classes..\n   *\n   * @constructor\n   */\n  function DirectKeystoreInteraction() {\n    var _this2;\n\n    _classCallCheck(this, DirectKeystoreInteraction);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(DirectKeystoreInteraction).call(this));\n    _this2.direct = true;\n    return _this2;\n  }\n  /**\n   * Initiate the intended interaction and return a result.\n   *\n   * Subclasses *must* override this function.  This function must\n   * always return a promise as it is designed to be called within an\n   * `await` block.\n   *\n   * @returns {Promise} Does the work of interacting with the keystore.\n   *\n   */\n\n\n  _createClass(DirectKeystoreInteraction, [{\n    key: \"run\",\n    value: function () {\n      var _run2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                throw new Error(\"Override the `run` method in this interaction.\");\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function run() {\n        return _run2.apply(this, arguments);\n      }\n\n      return run;\n    }()\n    /**\n     * Throws an error.\n     *\n     * @throws An error since this is a direct interaction.\n     * @returns {void}\n     *\n     */\n\n  }, {\n    key: \"request\",\n    value: function request() {\n      throw new Error(\"This interaction is direct and does not support a `request` method.\");\n    }\n    /**\n     * Throws an error.\n     *\n     * @throws An error since this is a direct interaction.\n     * @returns {void}\n     *\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse() {\n      throw new Error(\"This interaction is direct and does not support a `parse` method.\");\n    }\n  }]);\n\n  return DirectKeystoreInteraction;\n}(KeystoreInteraction);\n/**\n * Base class for indirect keystore interactions.\n *\n * Subclasses *must* implement two methods: `request` and `parse`.\n * Application code will pass the result of calling `request` to some\n * external process (HTTP request, QR code, &c.) and pass the response\n * to `parse` which should return a result.\n *\n * @example\n * import {IndirectKeystoreInteraction} from \"unchained-wallets\";\n * class SimpleIndirectInteraction extends IndirectKeystoreInteraction {   *\n *\n *   constructor({param}) {\n *     super();\n *     this.param = param;\n *   }\n *\n *   async request() {\n *     // Or do something complicated...\n *     return this.param;\n *   }\n *\n *   parse(response) {\n *     // Or do something complicated with `response`...\n *     return response;\n *   }\n *\n * }\n *\n * const interaction = new SimpleIndirectInteraction({param: \"foo\"});\n *\n * const request = interaction.request();\n * const response = \"bar\"; // Or do something complicated with `request`\n * const result = interaction.parse(response);\n * console.log(result);\n * // \"bar\"\n *\n */\n\n\nexports.DirectKeystoreInteraction = DirectKeystoreInteraction;\n\nvar IndirectKeystoreInteraction =\n/*#__PURE__*/\nfunction (_KeystoreInteraction3) {\n  _inherits(IndirectKeystoreInteraction, _KeystoreInteraction3);\n\n  /**\n   * Sets the `this.indirect` property to `true`.  This property can\n   * be utilized when introspecting on interaction classes..\n   *\n   * @constructor\n   */\n  function IndirectKeystoreInteraction() {\n    var _this3;\n\n    _classCallCheck(this, IndirectKeystoreInteraction);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(IndirectKeystoreInteraction).call(this));\n    _this3.indirect = true;\n    return _this3;\n  }\n  /**\n   * Provide the request.\n   *\n   * Subclasses *may* override this function.  It can return any kind\n   * of object.  Strings, data for QR codes, HTTP requests, command\n   * lines, functions, &c. are all allowed.  Whatever is appropriate\n   * for the interaction.\n   *\n   * @returns {Object} the request data\n   *\n   */\n\n\n  _createClass(IndirectKeystoreInteraction, [{\n    key: \"request\",\n    value: function request() {\n      throw new Error(\"Override the `request` method in this interaction.\");\n    }\n    /**\n     * Parse the response into a result.\n     *\n     * Subclasses *must* override this function.  It must accept an\n     * appropriate kind of `response` object and return the final result\n     * of this interaction.\n     *\n     * @param {Object} response - the raw response\n     * @returns {Object} the parsed response\n     *\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(response) {\n      console.log(response);\n      throw new Error(\"Override the `parse` method in this interaction.\");\n    }\n    /**\n     * Throws an error.\n     *\n     * @throws An error since this is an indirect interaction.\n     * @returns {void}\n     *\n     */\n\n  }, {\n    key: \"run\",\n    value: function () {\n      var _run3 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                throw new Error(\"This interaction is indirect and does not support a `run` method.\");\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function run() {\n        return _run3.apply(this, arguments);\n      }\n\n      return run;\n    }()\n  }]);\n\n  return IndirectKeystoreInteraction;\n}(KeystoreInteraction);\n\nexports.IndirectKeystoreInteraction = IndirectKeystoreInteraction;","// eslint-disable-next-line max-classes-per-file\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Dropzone from \"react-dropzone\";\nimport {\n  Box,\n  Button,\n  FormHelperText,\n  Grid,\n  TextField,\n} from \"@material-ui/core\";\nimport { CloudUpload as UploadIcon } from \"@material-ui/icons\";\nimport { PSBT_MAGIC_HEX } from \"unchained-bitcoin\";\nimport styles from \"./ColdcardFileReader.module.scss\";\n\nclass ColdcardFileReaderBase extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: props.fileType || \"JSON\",\n    };\n  }\n\n  render = () => {\n    const {\n      maxFileSize,\n      validFileFormats,\n      extendedPublicKeyImporter,\n      handleBIP32PathChange,\n      resetBIP32Path,\n      bip32PathIsDefault,\n      hasError,\n      errorMessage,\n      isTest,\n    } = this.props;\n    const { fileType } = this.state;\n    return (\n      <Grid container direction=\"column\">\n        {fileType === \"JSON\" && !isTest && (\n          <Grid container>\n            <Grid item md={6}>\n              <TextField\n                label=\"BIP32 Path\"\n                value={extendedPublicKeyImporter.bip32Path}\n                onChange={handleBIP32PathChange}\n                error={hasError}\n                helperText={errorMessage}\n              />\n            </Grid>\n            <Grid item md={6}>\n              {!bip32PathIsDefault() && (\n                <Button\n                  type=\"button\"\n                  variant=\"contained\"\n                  size=\"small\"\n                  onClick={resetBIP32Path}\n                >\n                  Default\n                </Button>\n              )}\n            </Grid>\n            <FormHelperText>\n              Use the default value if you don&rsquo;t understand BIP32 paths.\n            </FormHelperText>\n          </Grid>\n        )}\n        <p>\n          When you are ready, upload the {fileType} file from your Coldcard:\n        </p>\n        <Box>\n          <Dropzone\n            className={hasError ? styles.dropzoneDull : styles.dropzone}\n            onDrop={this.onDrop}\n            multiple={false}\n            minSize={1}\n            maxSize={maxFileSize}\n            accept={validFileFormats}\n            disableClick={hasError}\n          >\n            <UploadIcon classes={{ root: styles.uploadIcon }} />\n            <p className={styles.instruction}>\n              {fileType === \"JSON\" ? \"Upload The XPUB\" : \"Upload Signed PSBT\"}\n            </p>\n          </Dropzone>\n        </Box>\n      </Grid>\n    );\n  };\n\n  singleAcceptedFile = (acceptedFiles, rejectedFiles) => {\n    return rejectedFiles.length === 0 && acceptedFiles.length === 1;\n  };\n\n  onDrop = async (acceptedFiles, rejectedFiles) => {\n    const { onReceive, onReceivePSBT, setError, hasError } = this.props;\n    const { fileType } = this.state;\n    if (hasError) return; // do not continue if the bip32path is invalid\n    if (this.singleAcceptedFile(acceptedFiles, rejectedFiles)) {\n      const file = acceptedFiles[0];\n      if (fileType === \"JSON\") {\n        onReceive(await file.text());\n      } else {\n        // With PSBT files, the actual spec says it should be stored in binary.\n        // But it's not really required, and some vendors output the PSBT as\n        // base64 text in a .psbt file. We need to be able to support both cases\n        // when a signed PSBT is uploaded. Assume it is in the proper format,\n        // e.g. binary.\n        const psbtData = await file.arrayBuffer();\n        const psbtHex = Buffer.from(psbtData).toString(\"hex\");\n        // If the binary -> hex conversion starts with this magic number, we're\n        // good to go. Otherwise - it was likely not a binary file, meaning\n        // it was is probably base64 or hex, so we should try using text instead.\n        if (psbtHex.startsWith(PSBT_MAGIC_HEX)) {\n          onReceivePSBT(psbtHex);\n        } else {\n          onReceivePSBT(await file.text());\n        }\n      }\n    } else if (rejectedFiles.length === 1) {\n      setError(\n        `The file you attempted to upload was unacceptable. File type must be .${fileType.toLowerCase()}.`\n      );\n    } else if (rejectedFiles.length > 1) {\n      setError(`This dropzone only accepts a single file.`);\n    }\n  };\n}\n\nColdcardFileReaderBase.propTypes = {\n  onReceive: PropTypes.func,\n  onReceivePSBT: PropTypes.func,\n  setError: PropTypes.func.isRequired,\n  fileType: PropTypes.string,\n  maxFileSize: PropTypes.number,\n  validFileFormats: PropTypes.string,\n  extendedPublicKeyImporter: PropTypes.shape({\n    bip32Path: PropTypes.string,\n  }),\n  handleBIP32PathChange: PropTypes.func,\n  resetBIP32Path: PropTypes.func,\n  bip32PathIsDefault: PropTypes.func,\n  hasError: PropTypes.bool,\n  errorMessage: PropTypes.string,\n  isTest: PropTypes.bool,\n};\n\nColdcardFileReaderBase.defaultProps = {\n  onReceive: null,\n  onReceivePSBT: null,\n  handleBIP32PathChange: null,\n  resetBIP32Path: null,\n  bip32PathIsDefault: null,\n  errorMessage: \"\",\n  hasError: PropTypes.bool,\n  maxFileSize: 1048576, // 1MB\n  fileType: \"JSON\",\n  validFileFormats: \".json\",\n  extendedPublicKeyImporter: null,\n  isTest: false,\n};\n\nexport class ColdcardJSONReader extends ColdcardFileReaderBase {}\nColdcardJSONReader.defaultProps = {\n  fileType: \"JSON\",\n  validFileFormats: \".json\",\n};\n\nexport class ColdcardPSBTReader extends ColdcardFileReaderBase {}\nColdcardPSBTReader.defaultProps = {\n  fileType: \"PSBT\",\n  validFileFormats: \".psbt\",\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"uploadIcon\":\"ColdcardFileReader_uploadIcon__1gKkv\",\"instruction\":\"ColdcardFileReader_instruction__2JEz4\",\"dropzone\":\"ColdcardFileReader_dropzone__32-R_\",\"dropzoneDull\":\"ColdcardFileReader_dropzoneDull__2lJaF ColdcardFileReader_dropzone__32-R_\",\"uploadContainer\":\"ColdcardFileReader_uploadContainer__3NUxc\"};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _exportNames = {\n  VERSION: true,\n  MULTISIG_ROOT: true,\n  DIRECT_KEYSTORES: true,\n  INDIRECT_KEYSTORES: true,\n  KEYSTORES: true,\n  GetMetadata: true,\n  ExportPublicKey: true,\n  ExportExtendedPublicKey: true,\n  SignMultisigTransaction: true,\n  ConfirmMultisigAddress: true,\n  ConfigAdapter: true\n};\nexports.GetMetadata = GetMetadata;\nexports.ExportPublicKey = ExportPublicKey;\nexports.ExportExtendedPublicKey = ExportExtendedPublicKey;\nexports.SignMultisigTransaction = SignMultisigTransaction;\nexports.ConfirmMultisigAddress = ConfirmMultisigAddress;\nexports.ConfigAdapter = ConfigAdapter;\nexports.KEYSTORES = exports.INDIRECT_KEYSTORES = exports.DIRECT_KEYSTORES = exports.MULTISIG_ROOT = exports.VERSION = void 0;\n\nrequire(\"core-js/modules/es6.object.define-properties\");\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nvar _package = require(\"../package.json\");\n\nvar _interaction = require(\"./interaction\");\n\nObject.keys(_interaction).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _interaction[key];\n    }\n  });\n});\n\nvar _coldcard = require(\"./coldcard\");\n\nObject.keys(_coldcard).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _coldcard[key];\n    }\n  });\n});\n\nvar _custom = require(\"./custom\");\n\nObject.keys(_custom).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _custom[key];\n    }\n  });\n});\n\nvar _hermit = require(\"./hermit\");\n\nObject.keys(_hermit).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _hermit[key];\n    }\n  });\n});\n\nvar _ledger = require(\"./ledger\");\n\nObject.keys(_ledger).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _ledger[key];\n    }\n  });\n});\n\nvar _trezor = require(\"./trezor\");\n\nObject.keys(_trezor).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _trezor[key];\n    }\n  });\n});\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * Current unchained-wallets version.\n *\n * @type {string}\n */\nvar VERSION = _package.version;\nexports.VERSION = VERSION;\nvar MULTISIG_ROOT = \"m/45'\";\n/**\n * Enumeration of keystores which support direct interactions.\n *\n * @constant\n * @enum {string}\n * @default\n */\n\nexports.MULTISIG_ROOT = MULTISIG_ROOT;\nvar DIRECT_KEYSTORES = {\n  TREZOR: _trezor.TREZOR,\n  LEDGER: _ledger.LEDGER\n};\n/**\n * Enumeration of keystores which support indirect interactions.\n *\n * @constant\n * @enum {string}\n * @default\n */\n\nexports.DIRECT_KEYSTORES = DIRECT_KEYSTORES;\nvar INDIRECT_KEYSTORES = {\n  HERMIT: _hermit.HERMIT,\n  COLDCARD: _coldcard.COLDCARD,\n  CUSTOM: _custom.CUSTOM\n};\n/**\n * Enumeration of supported keystores.\n *\n * @type {string[]}\n */\n\nexports.INDIRECT_KEYSTORES = INDIRECT_KEYSTORES;\n\nvar KEYSTORES = _objectSpread({}, DIRECT_KEYSTORES, {}, INDIRECT_KEYSTORES);\n/**\n * Return an interaction class for obtaining metadata from the given\n * `keystore`.\n *\n * **Supported keystores:** Trezor, Ledger\n *\n * @param {Object} options - options argument\n * @param {KEYSTORES} options.keystore - keystore to use\n * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance\n * @example\n * import {GetMetadata, TREZOR} from \"unchained-wallets\";\n * // Works similarly for Ledger.\n * const interaction = GetMetadata({keystore: TREZOR});\n * const metadata = await interaction.run();\n */\n\n\nexports.KEYSTORES = KEYSTORES;\n\nfunction GetMetadata(_ref) {\n  var keystore = _ref.keystore;\n\n  switch (keystore) {\n    case _ledger.LEDGER:\n      return new _ledger.LedgerGetMetadata();\n\n    case _trezor.TREZOR:\n      return new _trezor.TrezorGetMetadata();\n\n    default:\n      return new _interaction.UnsupportedInteraction({\n        code: \"unsupported\",\n        text: \"This keystore does not return a version.\"\n      });\n  }\n}\n/**\n * Return an interaction class for exporting a public key from the\n * given `keystore` for the given `bip32Path` and `network`.\n *\n * **Supported keystores:** Trezor, Ledger, Hermit\n *\n * @param {Object} options - options argument\n * @param {KEYSTORES} options.keystore - keystore to use\n * @param {string} options.network - bitcoin network\n * @param {string} options.bip32Path - the BIP32 path of the HD node of the public key\n * @param {string} options.includeXFP - also return root fingerprint\n * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance\n * @example\n * import {MAINNET} from \"unchained-bitcoin\";\n * import {ExportPublicKey, TREZOR, HERMIT} from \"unchained-wallets\";\n * // Works similarly for Ledger\n * const interaction = ExportPublicKey({keystore: TREZOR, network: MAINNET, bip32Path: \"m/45'/0'/0'/0/0\"});\n * const publicKey = await interaction.run();\n */\n\n\nfunction ExportPublicKey(_ref2) {\n  var keystore = _ref2.keystore,\n      network = _ref2.network,\n      bip32Path = _ref2.bip32Path,\n      includeXFP = _ref2.includeXFP;\n\n  switch (keystore) {\n    case _coldcard.COLDCARD:\n      return new _coldcard.ColdcardExportPublicKey({\n        network: network,\n        bip32Path: bip32Path,\n        includeXFP: includeXFP\n      });\n\n    case _hermit.HERMIT:\n      return new _hermit.HermitExportPublicKey({\n        bip32Path: bip32Path\n      });\n\n    case _ledger.LEDGER:\n      return new _ledger.LedgerExportPublicKey({\n        bip32Path: bip32Path,\n        includeXFP: includeXFP\n      });\n\n    case _trezor.TREZOR:\n      return new _trezor.TrezorExportPublicKey({\n        network: network,\n        bip32Path: bip32Path,\n        includeXFP: includeXFP\n      });\n\n    default:\n      return new _interaction.UnsupportedInteraction({\n        code: \"unsupported\",\n        text: \"This keystore is not supported when exporting public keys.\"\n      });\n  }\n}\n/**\n * Return an interaction class for exporting an extended public key\n * from the given `keystore` for the given `bip32Path` and `network`.\n *\n * **Supported keystores:** Trezor, Hermit, Ledger\n *\n *\n * @param {Object} options - options argument\n * @param {KEYSTORES} options.keystore - keystore to use\n * @param {string} options.network - bitcoin network\n * @param {string} options.bip32Path - the BIP32 path of the HD node of the extended public key\n * @param {string} options.includeXFP - also return root fingerprint\n * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance\n * @example\n * import {MAINNET} from \"unchained-bitcoin\";\n * import {ExportExtendedPublicKey, TREZOR, HERMIT} from \"unchained-wallets\";\n * // Works similarly for Ledger\n * const interaction = ExportExtendedPublicKey({keystore: TREZOR, network: MAINNET, bip32Path: \"m/45'/0'/0'/0/0\"});\n * const xpub = await interaction.run();\n */\n\n\nfunction ExportExtendedPublicKey(_ref3) {\n  var keystore = _ref3.keystore,\n      network = _ref3.network,\n      bip32Path = _ref3.bip32Path,\n      includeXFP = _ref3.includeXFP;\n\n  switch (keystore) {\n    case _coldcard.COLDCARD:\n      return new _coldcard.ColdcardExportExtendedPublicKey({\n        bip32Path: bip32Path,\n        network: network,\n        includeXFP: includeXFP\n      });\n\n    case _custom.CUSTOM:\n      return new _custom.CustomExportExtendedPublicKey({\n        bip32Path: bip32Path,\n        network: network,\n        includeXFP: includeXFP\n      });\n\n    case _hermit.HERMIT:\n      return new _hermit.HermitExportExtendedPublicKey({\n        bip32Path: bip32Path\n      });\n\n    case _ledger.LEDGER:\n      return new _ledger.LedgerExportExtendedPublicKey({\n        bip32Path: bip32Path,\n        network: network,\n        includeXFP: includeXFP\n      });\n\n    case _trezor.TREZOR:\n      return new _trezor.TrezorExportExtendedPublicKey({\n        bip32Path: bip32Path,\n        network: network,\n        includeXFP: includeXFP\n      });\n\n    default:\n      return new _interaction.UnsupportedInteraction({\n        code: \"unsupported\",\n        text: \"This keystore is not supported when exporting extended public keys.\"\n      });\n  }\n}\n/**\n * Return an interaction class for signing a multisig transaction with\n * the given `keystore`.\n *\n * The inputs are objects which have `txid`, `index`, and a `multisig`\n * object, the last which is a `Multisig` object from\n * `unchained-bitcoin`.\n *\n * The outputs are objects which have `address` and `amountSats` (an\n * integer).\n *\n * `bip32Paths` is an array of BIP32 paths for the public keys on this\n * device, one for each input.\n *\n * **Supported keystores:** Trezor, Ledger, Hermit\n *\n *\n * @param {Object} options - options argument\n * @param {KEYSTORES} options.keystore - keystore to use\n * @param {string} options.network - bitcoin network\n * @param {object[]} options.inputs - transaction inputs\n * @param {object[]} options.outputs - transaction outputs\n * @param {string[]} options.bip32Paths - the BIP32 paths on this device corresponding to a public key in each input\n * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance\n * @example\n * import {\n *   generateMultisigFromHex, TESTNET, P2SH,\n * } from \"unchained-bitcoin\";\n * import {SignMultisigTransaction, TREZOR} from \"unchained-wallets\";\n * const redeemScript = \"5...ae\";\n * const inputs = [\n *   {\n *     txid: \"8d276c76b3550b145e44d35c5833bae175e0351b4a5c57dc1740387e78f57b11\",\n *     index: 1,\n *     multisig: generateMultisigFromHex(TESTNET, P2SH, redeemScript),\n *     amountSats: '1234000'\n *   },\n *   // other inputs...\n * ];\n * const outputs = [\n *   {\n *     amountSats: '1299659',\n *     address: \"2NGHod7V2TAAXC1iUdNmc6R8UUd4TVTuBmp\"\n *   },\n *   // other outputs...\n * ];\n * const interaction = SignMultisigTransaction({\n *   keystore: TREZOR, // works the same for Ledger\n *   network: TESTNET,\n *   inputs,\n *   outputs,\n *   bip32Paths: [\"m/45'/0'/0'/0\", // add more, 1 per input],\n * });\n * const signature = await interaction.run();\n * console.log(signatures);\n * // [\"ababab...\", // 1 per input]\n *\n */\n\n\nfunction SignMultisigTransaction(_ref4) {\n  var keystore = _ref4.keystore,\n      network = _ref4.network,\n      inputs = _ref4.inputs,\n      outputs = _ref4.outputs,\n      bip32Paths = _ref4.bip32Paths,\n      psbt = _ref4.psbt;\n\n  switch (keystore) {\n    case _coldcard.COLDCARD:\n      return new _coldcard.ColdcardSignMultisigTransaction({\n        network: network,\n        inputs: inputs,\n        outputs: outputs,\n        bip32Paths: bip32Paths,\n        psbt: psbt\n      });\n\n    case _custom.CUSTOM:\n      return new _custom.CustomSignMultisigTransaction({\n        network: network,\n        inputs: inputs,\n        outputs: outputs,\n        bip32Paths: bip32Paths,\n        psbt: psbt\n      });\n\n    case _hermit.HERMIT:\n      return new _hermit.HermitSignTransaction({\n        inputs: inputs,\n        outputs: outputs,\n        bip32Paths: bip32Paths\n      });\n\n    case _ledger.LEDGER:\n      return new _ledger.LedgerSignMultisigTransaction({\n        network: network,\n        inputs: inputs,\n        outputs: outputs,\n        bip32Paths: bip32Paths,\n        psbt: psbt\n      });\n\n    case _trezor.TREZOR:\n      return new _trezor.TrezorSignMultisigTransaction({\n        network: network,\n        inputs: inputs,\n        outputs: outputs,\n        bip32Paths: bip32Paths\n      });\n\n    default:\n      return new _interaction.UnsupportedInteraction({\n        code: \"unsupported\",\n        text: \"This keystore is not supported when signing multisig transactions.\"\n      });\n  }\n}\n/**\n * Return an interaction class for confirming a multisig address with\n * the given `keystore`.\n *\n * The `multisig` parameter is a `Multisig` object from\n * `unchained-bitcoin`.\n *\n * `bip32Path` is the BIP32 path for the publiic key in the address on\n * this device.\n *\n * `publicKey` optional, is the public key expected to be at `bip32Path`.\n *\n * **Supported keystores:** Trezor\n *\n * @param {Object} options - options argument\n * @param {KEYSTORES} options.keystore - keystore to use\n * @param {string} options.network - bitcoin network\n * @param {object} options.multisig - `Multisig` object representing the address\n * @param {string} options.bip32Path - the BIP32 path on this device containing a public key from the address\n * @param {string} options.publicKey - optional, the public key expected to be at the given BIP32 path\n * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance\n * @example\n * import {\n *   generateMultisigFromHex, TESTNET, P2SH,\n * } from \"unchained-bitcoin\";\n * import {\n *   ConfirmMultisigAddress,\n *   multisigPublicKeys,\n *   trezorPublicKey,\n *   TREZOR} from \"unchained-wallets\";\n * const redeemScript = \"5...ae\";\n * const multisig = generateMultisigFromHex(TESTNET, P2SH, redeemScript);\n * const interaction = ConfirmMultisigAddress({\n *   keystore: TREZOR,\n *   network: TESTNET,\n *   multisig,\n *   bip32Path: \"m/45'/1'/0'/0/0\",\n * });\n * await interaction.run();\n *\n * With publicKey:\n * const redeemScript = \"5...ae\";\n * const multisig = generateMultisigFromHex(TESTNET, P2SH, redeemScript);\n * const publicKey = trezorPublicKey(multisigPublicKeys(this.multisig)[2])\n * const interaction = ConfirmMultisigAddress({\n *   keystore: TREZOR,\n *   publicKey,\n *   network: TESTNET,\n *   multisig,\n *   bip32Path: \"m/45'/1'/0'/0/0\",\n * });\n * await interaction.run();\n *\n *\n */\n\n\nfunction ConfirmMultisigAddress(_ref5) {\n  var keystore = _ref5.keystore,\n      network = _ref5.network,\n      bip32Path = _ref5.bip32Path,\n      multisig = _ref5.multisig,\n      publicKey = _ref5.publicKey;\n\n  switch (keystore) {\n    case _trezor.TREZOR:\n      return new _trezor.TrezorConfirmMultisigAddress({\n        network: network,\n        bip32Path: bip32Path,\n        multisig: multisig,\n        publicKey: publicKey\n      });\n\n    default:\n      return new _interaction.UnsupportedInteraction({\n        code: \"unsupported\",\n        text: \"This keystore is not supported when confirming multisig addresses.\"\n      });\n  }\n}\n/**\n * Return a class for creating a multisig config file for a\n * given keystore or coordinator.\n *\n * @param {string} KEYSTORE - keystore to use\n * @param {string} jsonConfig - JSON wallet configuration file e.g. from Caravan\n * @returns {ColdcardMultisigWalletConfig|UnsupportedInteraction} - A class that can translate to shape of\n * config to match the specified keystore/coordinator requirements\n */\n\n\nfunction ConfigAdapter(_ref6) {\n  var KEYSTORE = _ref6.KEYSTORE,\n      jsonConfig = _ref6.jsonConfig;\n\n  switch (KEYSTORE) {\n    case _coldcard.COLDCARD:\n      return new _coldcard.ColdcardMultisigWalletConfig({\n        jsonConfig: jsonConfig\n      });\n\n    default:\n      return new _interaction.UnsupportedInteraction({\n        code: \"unsupported\",\n        text: \"This keystore is not supported when translating external spend configuration files.\"\n      });\n  }\n}"],"sourceRoot":""}